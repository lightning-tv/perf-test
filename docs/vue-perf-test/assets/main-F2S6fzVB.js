var wo=Object.defineProperty;var So=(s,t,e)=>t in s?wo(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var l=(s,t,e)=>So(s,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();var Eo={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function Co(s,t){const e={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},r=s.getContext("webgl",e)||s.getContext("experimental-webgl",e);if(!r)throw new Error("Unable to create WebGL context");return t?new Proxy(r,{get(i,n){const o=i[n];return typeof o=="function"?(t.increment(String(n)),o.bind(i)):o}}):r}function U(s,t){if(!kr()&&!s)throw new Error(t||"Assertion failed")}function gi(s,t,e){const r=Math.trunc(s>>>24),i=Math.trunc(s>>>16&255),n=Math.trunc(s>>>8&255),o=Math.trunc(s&255),a=Math.trunc(t>>>24),c=Math.trunc(t>>>16&255),h=Math.trunc(t>>>8&255),f=Math.trunc(t&255),u=Math.round(a*e+r*(1-e)),g=Math.round(c*e+i*(1-e)),_=Math.round(h*e+n*(1-e)),m=Math.round(f*e+o*(1-e));return(u<<24|g<<16|_<<8|m)>>>0}function Ao(s,t){const e=s>>>24,r=s>>>16&255,i=s>>>8&255,n=Math.trunc((s&255)*t);return(e<<24|r<<16|i<<8|n)>>>0}let rn=!0;function Mo(s){rn=s==="webgl"}function ps(s,t,e=!1){const r=(s&255)/255*t,i=rn?r:1,n=Math.trunc((s>>>24)*i),o=Math.trunc((s>>>16&255)*i),a=Math.trunc((s>>>8&255)*i),c=Math.trunc(r*255);return e?(c<<24|a<<16|o<<8|n)>>>0:(n<<24|o<<16|a<<8|c)>>>0}function Tr(s,t){return Object.prototype.hasOwnProperty.call(s,t)}function kr(){return Eo&&!0}let Io=1;function Po(){return Io++}class nt{constructor(){l(this,"eventListeners",{})}on(t,e){let r=this.eventListeners[t];r||(r=[]),r.push(e),this.eventListeners[t]=r}off(t,e){const r=this.eventListeners[t];if(!r)return;if(!e){delete this.eventListeners[t];return}const i=r.indexOf(e);i>=0&&r.splice(i,1)}once(t,e){const r=(i,n)=>{this.off(t,r),e(i,n)};this.on(t,r)}emit(t,e){const r=this.eventListeners[t];r&&[...r].forEach(i=>{i(this,e)})}removeAllListeners(){this.eventListeners={}}}const Lo=/^(data|ftps?|https?):/,cs=s=>{const t=s>>>24,e=s>>>16&255,r=s>>>8&255,i=s&255;return[t/255,e/255,r/255,i/255]},Fo=s=>{const t=s>>>24,e=s>>>16&255,r=s>>>8&255,i=s&255;return[t,e,r,i]};function Oo(s){return(s&255)/255}function nr(s){const t=Math.floor(s[0]*255),e=Math.floor(s[1]*255),r=Math.floor(s[2]*255),i=Math.floor(s[3]*255);return`rgba(${t},${e},${r},${i.toFixed(4)})`}function gs(s,t,e,r,i){return i?(i.x1=s,i.y1=t,i.x2=e,i.y2=r,i):{x1:s,y1:t,x2:e,y2:r}}function or(s,t){return s.x1<t.x2&&s.x2>t.x1&&s.y1<t.y2&&s.y2>t.y1}function Bo(s,t){return t?(t.x=s.x1,t.y=s.y1,t.width=s.x2-s.x1,t.height=s.y2-s.y1,t):{x:s.x1,y:s.y1,width:s.x2-s.x1,height:s.y2-s.y1}}function nn(s,t,e){const r=Math.max(s.x,t.x),i=Math.max(s.y,t.y),n=Math.min(s.x+s.width,t.x+t.width)-r,o=Math.min(s.y+s.height,t.y+t.height)-i;return n>0&&o>0?e?(e.x=r,e.y=i,e.width=n,e.height=o,e):{x:r,y:i,width:n,height:o}:e?(e.x=0,e.y=0,e.width=0,e.height=0,e):{x:0,y:0,width:0,height:0}}function on(s,t){return t?(t.x=s.x,t.y=s.y,t.width=s.width,t.height=s.height,t):{x:s.x,y:s.y,width:s.width,height:s.height}}function No(s,t){return s===t?!0:s===null||t===null?!1:s.x===t.x&&s.y===t.y&&s.width===t.width&&s.height===t.height}function mi(s,t){return s.x1<=t.x2&&s.y1<=t.y2&&s.x2>=t.x1&&s.y2>=t.y1}function Uo(s){return s.x1<s.x2&&s.y1<s.y2}function Do(s){if(self.location.protocol==="file:"&&!Lo.test(s)){const e=self.location.pathname.split("/");e.pop();const r=e.join("/"),i=self.location.protocol+"//"+r;return s.charAt(0)==="."&&(s=s.slice(1)),s.charAt(0)==="/"&&(s=s.slice(1)),i+"/"+s}return new URL(s,self.location.href).href}class we{constructor(){l(this,"ta");l(this,"tb");l(this,"tx");l(this,"tc");l(this,"td");l(this,"ty");l(this,"_floatArr",null);l(this,"mutation");this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return ko}static multiply(t,e,r){const i=t.ta*e.ta+t.tb*e.tc,n=t.ta*e.tb+t.tb*e.td,o=t.ta*e.tx+t.tb*e.ty+t.tx,a=t.tc*e.ta+t.td*e.tc,c=t.tc*e.tb+t.td*e.td,h=t.tc*e.tx+t.td*e.ty+t.ty;return r||(r=new we),r.ta=i,r.tb=n,r.tx=o,r.tc=a,r.td=c,r.ty=h,r.mutation=!0,r}static identity(t){return t||(t=new we),t.ta=1,t.tb=0,t.tx=0,t.tc=0,t.td=1,t.ty=0,t.mutation=!0,t}static translate(t,e,r){return r||(r=new we),r.ta=1,r.tb=0,r.tx=t,r.tc=0,r.td=1,r.ty=e,r.mutation=!0,r}static scale(t,e,r){return r||(r=new we),r.ta=t,r.tb=0,r.tx=0,r.tc=0,r.td=e,r.ty=0,r.mutation=!0,r}static rotate(t,e){const r=Math.cos(t),i=Math.sin(t);return e||(e=new we),e.ta=r,e.tb=-i,e.tx=0,e.tc=i,e.td=r,e.ty=0,e.mutation=!0,e}static copy(t,e){return e||(e=new we),e.ta=t.ta,e.tc=t.tc,e.tb=t.tb,e.td=t.td,e.tx=t.tx,e.ty=t.ty,e.mutation=!0,e}translate(t,e){return this.tx=this.ta*t+this.tb*e+this.tx,this.ty=this.tc*t+this.td*e+this.ty,this.mutation=!0,this}scale(t,e){return this.ta=this.ta*t,this.tb=this.tb*e,this.tc=this.tc*t,this.td=this.td*e,this.mutation=!0,this}rotate(t){if(t===0||!(t%Math.PI*2))return this;const e=Math.cos(t),r=Math.sin(t),i=this.ta*e+this.tb*r,n=this.tb*e-this.ta*r,o=this.tc*e+this.td*r,a=this.td*e-this.tc*r;return this.ta=i,this.tb=n,this.tc=o,this.td=a,this.mutation=!0,this}multiply(t){return we.multiply(this,t,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const ko=new we,ms=0,xs=2,_s=4,ys=6,Ts=1,vs=3,bs=5,Rs=7;class zs{constructor(t){l(this,"data");this.data=new Float32Array(8),t&&(this.data[ms]=t[ms],this.data[xs]=t[xs],this.data[_s]=t[_s],this.data[ys]=t[ys],this.data[Ts]=t[Ts],this.data[vs]=t[vs],this.data[bs]=t[bs],this.data[Rs]=t[Rs])}static translate(t,e,r,i,n,o,a,c,h){return h||(h=new zs),h.data[ms]=t,h.data[xs]=r,h.data[_s]=n,h.data[ys]=a,h.data[Ts]=e,h.data[vs]=i,h.data[bs]=o,h.data[Rs]=c,h}get x1(){return this.data[ms]}get x2(){return this.data[xs]}get x3(){return this.data[_s]}get x4(){return this.data[ys]}get y1(){return this.data[Ts]}get y2(){return this.data[vs]}get y3(){return this.data[bs]}get y4(){return this.data[Rs]}}const xi=s=>s&&!(s&s-1),an=(s,t,e,r)=>{const i=3*s,n=3*(e-s)-i,o=1-i-n,a=3*t,c=3*(r-t)-a,h=1-a-c;return function(f){if(f>=1)return 1;if(f<=0)return 0;let u=.5,g,_,m;for(let b=0;b<20;b++){if(g=u*(u*(u*o+n)+i),m=f-g,m>-1e-8&&m<1e-8)return u*(u*(u*h+c)+a);if(_=u*(u*(3*o)+2*n)+i,_>1e-10&&_<1e-10)break;u+=m/_}let x=0,v=1;for(let b=0;b<20;b++){if(u=.5*(x+v),g=u*(u*(u*o+n)+i),m=f-g,m>-1e-8&&m<1e-8)return u*(u*(u*h+c)+a);m<0?v=u:x=u}}},Fs={},$o={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},Os=s=>s,zo=s=>{const t=/-?\d*\.?\d+/g,e=s.match(t);if(e){const[r,i,n,o]=e,a=parseFloat(r||"0.42"),c=parseFloat(i||"0"),h=parseFloat(n||"1"),f=parseFloat(o||"1"),u=an(a,c,h,f);return Fs[s]=u,u}return console.warn("Unknown cubic-bezier timing: "+s),Os},Ho=s=>{if(s==="linear")return Os;if(Fs[s]!==void 0)return Fs[s]||Os;if(s==="step-start")return()=>1;if(s==="step-end")return e=>e===1?1:0;const t=$o[s];if(t!==void 0){const[e,r,i,n]=t,o=an(e,r,i,n);return Fs[s]=o,o}return s.startsWith("cubic-bezier")?zo(s):(console.warn("Unknown timing function: "+s),Os)};function _i(s){return(s/1024/1024).toFixed(2)}class Wo extends nt{constructor(e,r,i){super();l(this,"node");l(this,"props");l(this,"settings");l(this,"progress",0);l(this,"delayFor",0);l(this,"timingFunction");l(this,"propValuesMap",{});l(this,"dynPropValuesMap");this.node=e,this.props=r;for(const a in r)if(a!=="shaderProps")this.propValuesMap.props===void 0&&(this.propValuesMap.props={}),this.propValuesMap.props[a]={start:e[a],target:r[a]};else if(e.shader.type!=="DynamicShader"){this.propValuesMap.shaderProps={};for(const c in r.shaderProps)this.propValuesMap.shaderProps[c]={start:e.shader.props[c],target:r.shaderProps[c]}}else{const c=Object.keys(r.shaderProps),h=c.length;this.dynPropValuesMap={};for(let f=0;f<h;f++){const u=c[f],g=r.shaderProps[u];this.dynPropValuesMap[u]={};const _=Object.entries(g),m=_.length;for(let x=0;x<m;x++){const[v,b]=_[x];this.dynPropValuesMap[u][v]={start:e.shader.props[u][v],target:b}}}}const n=i.easing||"linear",o=i.delay??0;this.settings={duration:i.duration??0,delay:o,easing:n,loop:i.loop??!1,repeat:i.repeat??0,repeatDelay:i.repeatDelay??0,stopMethod:i.stopMethod??!1},this.timingFunction=Ho(n),this.delayFor=o}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(e,r){const i=Object.entries(r),n=i.length;for(let o=0;o<n;o++){const[a,c]=i[o];e[a]=c.start}}restore(){if(this.reset(),this.propValuesMap.props!==void 0&&this.restoreValues(this.node,this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),r=e.length;if(r>0)for(let i=0;i<r;i++){const n=e[i];this.restoreValues(this.node.shader.props[n],this.dynPropValuesMap[n])}}}reverseValues(e){const r=Object.entries(e),i=r.length;for(let n=0;n<i;n++){const[o,a]=r[n];e[o]={start:a.target,target:a.start}}}reverse(){if(this.progress=0,this.propValuesMap.props!==void 0&&this.reverseValues(this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.reverseValues(this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),r=e.length;if(r>0)for(let i=0;i<r;i++){const n=e[i];this.reverseValues(this.dynPropValuesMap[n])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,r,i){return(this.timingFunction(e)||e)*(i-r)+r}updateValue(e,r,i,n){if(this.progress===1)return r;if(this.progress===0)return i;const o=r;if(e.indexOf("color")!==-1){if(i===o)return i;if(n){const a=this.timingFunction(this.progress)||this.progress;return gi(i,o,a)}return gi(i,o,this.progress)}return n?this.applyEasing(this.progress,i,o):i+(o-i)*this.progress}updateValues(e,r,i){const n=Object.entries(r),o=n.length;for(let a=0;a<o;a++){const[c,h]=n[a];e[c]=this.updateValue(c,h.target,h.start,i)}}update(e){const{duration:r,loop:i,easing:n,stopMethod:o}=this.settings,{delayFor:a}=this;if(r===0&&a===0){this.emit("finished",{});return}if(this.delayFor>0){if(this.delayFor-=e,this.delayFor>=0)return;e=-this.delayFor,this.delayFor=0}if(r===0){this.emit("finished",{});return}if(this.progress===0&&this.emit("animating",{}),this.progress+=e/r,this.progress>1&&(this.progress=i?0:1,o)){this.emit("finished",{});return}if(this.propValuesMap.props!==void 0&&this.updateValues(this.node,this.propValuesMap.props,n),this.propValuesMap.shaderProps!==void 0&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,n),this.dynPropValuesMap!==void 0){const c=Object.keys(this.dynPropValuesMap),h=c.length;if(h>0)for(let f=0;f<h;f++){const u=c[f];this.updateValues(this.node.shader.props[u],this.dynPropValuesMap[u],n)}}this.progress===1&&this.emit("finished",{})}}class Go extends nt{constructor(e,r){super();l(this,"manager");l(this,"animation");l(this,"stoppedPromise");l(this,"stoppedResolve",null);l(this,"state");this.manager=e,this.animation=r,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this)}start(){return this.state!=="running"&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="running"),this}stop(){return this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating)}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(e=>{this.stoppedResolve=e}))}onFinished(){U(this.stoppedResolve);const{loop:e,stopMethod:r}=this.animation.settings;if(r==="reverse"){this.animation.once("finished",this.onFinished),this.animation.reverse();return}e||(this.unregisterAnimation(),this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this),this.state="stopped")}onAnimating(){this.emit("animating",this)}}var De;(function(s){s[s.Init=0]="Init",s[s.OutOfBounds=2]="OutOfBounds",s[s.InBounds=4]="InBounds",s[s.InViewport=8]="InViewport"})(De||(De={}));const hs=new Map;hs.set(De.Init,"init");hs.set(De.OutOfBounds,"outOfBounds");hs.set(De.InBounds,"inBounds");hs.set(De.InViewport,"inViewport");var P;(function(s){s[s.Children=1]="Children",s[s.ScaleRotate=2]="ScaleRotate",s[s.Local=4]="Local",s[s.Global=8]="Global",s[s.Clipping=16]="Clipping",s[s.CalculatedZIndex=32]="CalculatedZIndex",s[s.ZIndexSortedChildren=64]="ZIndexSortedChildren",s[s.PremultipliedColors=128]="PremultipliedColors",s[s.WorldAlpha=256]="WorldAlpha",s[s.RenderState=512]="RenderState",s[s.IsRenderable=1024]="IsRenderable",s[s.RenderTexture=2048]="RenderTexture",s[s.ParentRenderTexture=4096]="ParentRenderTexture",s[s.None=0]="None",s[s.All=8191]="All"})(P||(P={}));class vr extends nt{constructor(e,r){super();l(this,"stage");l(this,"children",[]);l(this,"_id",Po());l(this,"props");l(this,"updateType",P.All);l(this,"globalTransform");l(this,"scaleRotateTransform");l(this,"localTransform");l(this,"renderCoords");l(this,"renderBound");l(this,"strictBound");l(this,"preloadBound");l(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});l(this,"isRenderable",!1);l(this,"renderState",De.Init);l(this,"worldAlpha",1);l(this,"premultipliedColorTl",0);l(this,"premultipliedColorTr",0);l(this,"premultipliedColorBl",0);l(this,"premultipliedColorBr",0);l(this,"calcZIndex",0);l(this,"hasRTTupdates",!1);l(this,"parentHasRenderTexture",!1);l(this,"onTextureLoaded",(e,r)=>{var i,n;this.autosizeNode(r),this.stage.requestRender(),this.parentHasRenderTexture&&this.setRTTUpdates(1),this.emit("loaded",{type:"texture",dimensions:r}),((n=(i=this.props.textureOptions)==null?void 0:i.resizeMode)==null?void 0:n.type)==="contain"&&this.setUpdateType(P.Local)});l(this,"onTextureFailed",(e,r)=>{this.emit("failed",{type:"texture",error:r})});l(this,"onTextureFreed",()=>{this.emit("freed",{type:"texture"})});this.stage=e,this.props={...r,parent:null,texture:null,src:null,rtt:!1},this.parent=r.parent,this.texture=r.texture,this.src=r.src,this.rtt=r.rtt,this.updateScaleRotateTransform()}loadTexture(){const{texture:e}=this.props;U(e),queueMicrotask(()=>{this.textureOptions.preload&&e.ctxTexture.load(),e.state==="loaded"?(U(e.dimensions),this.onTextureLoaded(e,e.dimensions)):e.state==="failed"?(U(e.error),this.onTextureFailed(e,e.error)):e.state==="freed"&&this.onTextureFreed(e),e.on("loaded",this.onTextureLoaded),e.on("failed",this.onTextureFailed),e.on("freed",this.onTextureFreed)})}unloadTexture(){this.texture&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this,!1))}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}setUpdateType(e){this.updateType|=e;const r=this.props.parent;r&&!(r.updateType&P.Children)&&r.setUpdateType(P.Children),this.parentHasRenderTexture&&this.setRTTUpdates(e)}sortChildren(){this.children.sort((e,r)=>e.calcZIndex-r.calcZIndex)}updateScaleRotateTransform(){const{rotation:e,scaleX:r,scaleY:i}=this.props;if(e===0&&r===1&&i===1){this.scaleRotateTransform=void 0;return}this.scaleRotateTransform=we.rotate(e,this.scaleRotateTransform).scale(r,i)}updateLocalTransform(){var h,f;const{x:e,y:r,width:i,height:n}=this.props,o=this.props.mountX*i,a=this.props.mountY*n;if(this.scaleRotateTransform){const u=this.props.pivotX*i,g=this.props.pivotY*n;this.localTransform=we.translate(e-o+u,r-a+g,this.localTransform).multiply(this.scaleRotateTransform).translate(-u,-g)}else this.localTransform=we.translate(e-o,r-a,this.localTransform);const c=this.props.texture;if(c&&c.dimensions&&((f=(h=this.props.textureOptions)==null?void 0:h.resizeMode)==null?void 0:f.type)==="contain"){let u=1,g=1,_=0,m=0;const{width:x,height:v}=c.dimensions,b=x/v,M=i/n;if(b>M){const I=i/x,S=v*I;m=(n-S)/2,g=S/n}else{const I=n/v,S=x*I;_=(i-S)/2,u=S/i}this.localTransform.translate(_,m).scale(u,g)}this.setUpdateType(P.Global)}update(e,r){var o;this.updateType&P.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(P.Local)),this.updateType&P.Local&&(this.updateLocalTransform(),this.setUpdateType(P.Global));const i=this.props.parent;let n=P.None;if(this.updateType&P.ParentRenderTexture){let a=this.parent;for(;a;)a.rtt&&(this.parentHasRenderTexture=!0),a=a.parent}this.updateType^P.All&&this.updateType&P.RenderTexture&&this.children.forEach(a=>{a.setUpdateType(P.All)}),this.updateType&P.Global&&(U(this.localTransform),this.globalTransform=we.copy((i==null?void 0:i.globalTransform)||this.localTransform,this.globalTransform),this.parentHasRenderTexture&&((o=this.props.parent)!=null&&o.rtt)&&(this.globalTransform=we.identity()),i&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(P.Clipping|P.RenderState|P.Children),n|=P.Global),this.updateType&P.Clipping&&(this.calculateClippingRect(r),this.setUpdateType(P.Children),n|=P.Clipping),this.updateType&P.WorldAlpha&&(i?this.worldAlpha=i.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(P.Children|P.PremultipliedColors|P.IsRenderable),n|=P.WorldAlpha),this.updateType&P.PremultipliedColors&&(this.premultipliedColorTl=ps(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=ps(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=ps(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=ps(this.props.colorBr,this.worldAlpha,!0))),this.updateType&P.RenderState&&(this.updateRenderState(r),this.setUpdateType(P.IsRenderable)),this.updateType&P.IsRenderable&&this.updateIsRenderable(),i&&this.updateType&P.CalculatedZIndex&&(this.calculateZIndex(),i.setUpdateType(P.ZIndexSortedChildren)),this.updateType&P.Children&&this.children.length&&!this.rtt&&this.children.forEach(a=>{a.setUpdateType(n),a.updateType!==0&&a.update(e,this.clippingRect)}),this.updateType&P.ZIndexSortedChildren&&this.sortChildren(),this.updateType=0}checkRenderProps(){return this.props.texture?!0:!this.props.width||!this.props.height?!1:!!(this.props.shader!==this.stage.defShaderCtr||this.props.clipping||this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0)}checkRenderBounds(e){U(this.renderBound);const r=e.width||this.stage.root.width,i=e.height||this.stage.root.height;if(this.strictBound=gs(e.x,e.y,e.x+r,e.y+i,this.strictBound),mi(this.renderBound,this.strictBound))return De.InViewport;const n=this.stage.boundsMargin;return this.preloadBound=gs(this.strictBound.x1-n[3],this.strictBound.y1-n[0],this.strictBound.x2+n[1],this.strictBound.y2+n[2],this.preloadBound),mi(this.renderBound,this.preloadBound)?De.InBounds:De.OutOfBounds}updateRenderState(e){const r=this.checkRenderBounds(e);if(r===this.renderState)return;const i=this.renderState;this.renderState=r;const n=hs.get(r);U(n),this.emit(n,{previous:i,current:r})}updateIsRenderable(){let e;this.worldAlpha===0||!this.checkRenderProps()?e=!1:e=this.renderState>De.OutOfBounds,this.isRenderable!==e&&(this.isRenderable=e,this.onChangeIsRenderable(e))}onChangeIsRenderable(e){var r;(r=this.texture)==null||r.setRenderableOwner(this,e)}calculateRenderCoords(){const{width:e,height:r,globalTransform:i}=this;U(i);const{tx:n,ty:o,ta:a,tb:c,tc:h,td:f}=i;if(c===0&&h===0){const u=n,g=n+e*a,_=o,m=o+r*f;this.renderCoords=zs.translate(u,_,g,_,g,m,u,m,this.renderCoords)}else this.renderCoords=zs.translate(n,o,n+e*a,o+e*h,n+e*a+r*c,o+e*h+r*f,n+r*c,o+r*f,this.renderCoords)}updateBoundingRect(){const{renderCoords:e,globalTransform:r}=this;U(r),U(e);const{tb:i,tc:n}=r,{x1:o,y1:a,x3:c,y3:h}=e;if(i===0||n===0)this.renderBound=gs(o,a,c,h,this.renderBound);else{const{x2:f,x4:u,y2:g,y4:_}=e;this.renderBound=gs(Math.min(o,f,c,u),Math.min(a,g,h,_),Math.max(o,f,c,u),Math.max(a,g,h,_),this.renderBound)}}calculateClippingRect(e){U(this.globalTransform);const{clippingRect:r,props:i,globalTransform:n}=this,{clipping:o}=i,a=n.tb!==0||n.tc!==0;o&&!a?(r.x=n.tx,r.y=n.ty,r.width=this.width*n.ta,r.height=this.height*n.td,r.valid=!0):r.valid=!1,e.valid&&r.valid?nn(e,r,r):e.valid&&(on(e,r),r.valid=!0)}calculateZIndex(){var o,a;const e=this.props,r=e.zIndex||0,i=((o=e.parent)==null?void 0:o.zIndex)||0;let n=r;(a=e.parent)!=null&&a.zIndexLocked&&(n=r<i?r:i),this.calcZIndex=n}destroy(){this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,delete this.renderCoords,delete this.renderBound,delete this.strictBound,delete this.preloadBound,delete this.globalTransform,delete this.scaleRotateTransform,delete this.localTransform,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;const e=[...this.children];for(let r=0;r<e.length;r++)e[r].destroy();this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}renderQuads(e){const{texture:r,width:i,height:n,textureOptions:o,rtt:a,shader:c}=this.props;if(this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode))return;const{premultipliedColorTl:h,premultipliedColorTr:f,premultipliedColorBl:u,premultipliedColorBr:g}=this,{zIndex:_,worldAlpha:m,globalTransform:x,clippingRect:v,renderCoords:b}=this;U(x),U(b),e.addQuad({width:i,height:n,colorTl:h,colorTr:f,colorBl:u,colorBr:g,texture:r,textureOptions:o,zIndex:_,shader:c.shader,shaderProps:c.getResolvedProps(),alpha:m,clippingRect:v,tx:x.tx,ty:x.ty,ta:x.ta,tb:x.tb,tc:x.tc,td:x.td,renderCoords:b,rtt:a,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions})}get id(){return this._id}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(P.Local))}get absX(){var e,r,i;return this.props.x+(((e=this.props.parent)==null?void 0:e.absX)||((i=(r=this.props.parent)==null?void 0:r.globalTransform)==null?void 0:i.tx)||0)}get absY(){var e;return this.props.y+(((e=this.props.parent)==null?void 0:e.absY)??0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(P.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(P.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(P.RenderTexture)))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(P.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(P.RenderTexture)))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(P.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(P.ScaleRotate))}get mount(){return this.props.mount}set mount(e){(this.props.mountX!==e||this.props.mountY!==e)&&(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(P.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(P.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(P.Local))}get pivot(){return this.props.pivot}set pivot(e){(this.props.pivotX!==e||this.props.pivotY!==e)&&(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(P.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(P.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(P.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(P.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(P.PremultipliedColors|P.WorldAlpha)}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(P.Clipping)}get color(){return this.props.color}set color(e){this.colorTop=e,this.colorBottom=e,this.colorLeft=e,this.colorRight=e,this.props.color=e,this.setUpdateType(P.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){(this.props.colorTl!==e||this.props.colorTr!==e)&&(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(P.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){(this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(P.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){(this.props.colorTl!==e||this.props.colorBl!==e)&&(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(P.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){(this.props.colorTr!==e||this.props.colorBr!==e)&&(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(P.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(P.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(P.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(P.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(P.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(P.CalculatedZIndex|P.Children),this.children.forEach(r=>{r.setUpdateType(P.CalculatedZIndex)})}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(P.CalculatedZIndex|P.Children),this.children.forEach(r=>{r.setUpdateType(P.CalculatedZIndex)})}get parent(){return this.props.parent}set parent(e){const r=this.props.parent;if(r!==e){if(this.props.parent=e,r){const i=r.children.indexOf(this);U(i!==-1,"CoreNode.parent: Node not found in old parent's children!"),r.children.splice(i,1),r.setUpdateType(P.Children|P.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(P.All),e.setUpdateType(P.Children|P.ZIndexSortedChildren),(e.rtt||e.parentHasRenderTexture)&&this.setRTTUpdates(P.All)),this.updateScaleRotateTransform()}}get rtt(){return this.props.rtt}set rtt(e){var r,i;if(this.props.rtt===!0&&(this.props.rtt=e,e===!1&&this.texture!==null)){this.unloadTexture(),this.setUpdateType(P.All),this.children.forEach(n=>{n.parentHasRenderTexture=!1}),(r=this.stage.renderer)==null||r.removeRTTNode(this);return}e!==!1&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.props.rtt=!0,this.hasRTTupdates=!0,this.setUpdateType(P.All),this.children.forEach(n=>{n.setUpdateType(P.All)}),(i=this.stage.renderer)==null||i.renderToTexture(this))}get shader(){return this.props.shader}set shader(e){this.props.shader!==e&&(this.props.shader=e,this.setUpdateType(P.IsRenderable))}get src(){return this.props.src}set src(e){if(this.props.src!==e){if(this.props.src=e,!e){this.texture=null;return}this.texture=this.stage.txManager.loadTexture("ImageTexture",{src:e})}}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let e=this.parent;for(;e;){if(e.rtt)return e;e=e.parent}return null}get texture(){return this.props.texture}set texture(e){if(this.props.texture===e)return;const r=this.props.texture;r&&(r.setRenderableOwner(this,!1),this.unloadTexture()),this.props.texture=e,e&&(e.setRenderableOwner(this,this.isRenderable),this.loadTexture()),this.setUpdateType(P.IsRenderable)}set textureOptions(e){this.props.textureOptions=e}get textureOptions(){return this.props.textureOptions}setRTTUpdates(e){var r;this.hasRTTupdates=!0,(r=this.parent)==null||r.setRTTUpdates(e)}animate(e,r){const i=new Wo(this,e,r);return new Go(this.stage.animationManager,i)}flush(){}}const ws={alpha:s=>s===1?null:{prop:"opacity",value:`${s}`},x:s=>({prop:"left",value:`${s}px`}),y:s=>({prop:"top",value:`${s}px`}),width:s=>s===0?null:{prop:"width",value:`${s}px`},height:s=>s===0?null:{prop:"height",value:`${s}px`},zIndex:()=>"zIndex",fontFamily:()=>"font-family",fontSize:()=>"font-size",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",lineHeight:()=>"line-height",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:s=>s===!1?null:{prop:"overflow",value:s?"hidden":"visible"},rotation:s=>s===0?null:{prop:"transform",value:`rotate(${s}rad)`},scale:s=>s===1?null:{prop:"transform",value:`scale(${s})`},scaleX:s=>s===1?null:{prop:"transform",value:`scaleX(${s})`},scaleY:s=>s===1?null:{prop:"transform",value:`scaleY(${s})`},color:s=>s===0?null:{prop:"color",value:ln(s)}},ln=s=>{const t=(s&255)/255,e=s>>8&255,r=s>>16&255;return`rgba(${s>>24&255},${r},${e},${t})`},yi={id:"id"};class Vo{constructor(t,e){l(this,"root",null);l(this,"canvas",null);l(this,"height",1080);l(this,"width",1920);l(this,"scaleX",1);l(this,"scaleY",1);if(kr())return;if(!e)throw new Error("settings is required");this.height=Math.ceil(e.appHeight??1080/(e.deviceLogicalPixelRatio??1)),this.width=Math.ceil(e.appWidth??1900/(e.deviceLogicalPixelRatio??1)),this.scaleX=e.deviceLogicalPixelRatio??1,this.scaleY=e.deviceLogicalPixelRatio??1,this.canvas=t,this.root=document.createElement("div"),this.setRootPosition(),document.body.appendChild(this.root),new MutationObserver(this.setRootPosition.bind(this)).observe(t,{attributes:!0,childList:!1,subtree:!1}),new ResizeObserver(this.setRootPosition.bind(this)).observe(t),window.addEventListener("resize",this.setRootPosition.bind(this)),console.warn("Inspector is enabled, this will impact performance")}setRootPosition(){if(this.root===null||this.canvas===null)return;const t=this.canvas.getBoundingClientRect(),e=document.documentElement.scrollTop+t.top,r=document.documentElement.scrollLeft+t.left;this.root.id="root",this.root.style.left=`${r}px`,this.root.style.top=`${e}px`,this.root.style.width=`${this.width}px`,this.root.style.height=`${this.height}px`,this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform=`scale(${this.scaleX}, ${this.scaleY})`,this.root.style.overflow="hidden",this.root.style.zIndex="65534"}createDiv(t,e){const r=document.createElement("div");r.style.position="absolute",r.id=t.toString();for(const i in e)this.updateNodeProperty(r,i,e[i]);return r}createNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,this.createProxy(t,e)}createTextNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,this.createProxy(t,e)}createProxy(t,e){return new Proxy(t,{set:(r,i,n)=>(this.updateNodeProperty(e,i,n),Reflect.set(r,i,n)),get:(r,i,n)=>(i==="destroy"&&this.destroyNode(r.id),i==="animate"?(o,a)=>{const c=r.animate(o,a);return new Proxy(c,{get:(h,f,u)=>(f==="start"&&this.animateNode(e,o,a),Reflect.get(h,f,u))})}:Reflect.get(r,i,n))})}destroyNode(t){const e=document.getElementById(t.toString());e==null||e.remove()}updateNodeProperty(t,e,r){var i;if(!(this.root===null||r===void 0||r===null)){if(e==="parent"){const n=r.id;if(n===1){this.root.appendChild(t);return}const o=document.getElementById(n.toString());o==null||o.appendChild(t);return}if(e==="text"){t.innerHTML=String(r),t.style.visibility="hidden";return}if(e==="src"&&r){t.setAttribute("data-src",String(r));return}if(ws[e]){const n=(i=ws[e])==null?void 0:i.call(ws,r);if(n===null)return;if(typeof n=="string"){t.style.setProperty(n,String(r));return}typeof n=="object"&&t.style.setProperty(n.prop,n.value);return}if(yi[e]){const n=yi[e];if(!n)return;t.setAttribute(String(n),String(r));return}if(e==="data"){for(const n in r){const o=r[n];o===void 0?t.removeAttribute(`data-${n}`):t.setAttribute(`data-${n}`,String(o))}return}}}animateNode(t,e,r){const{duration:i=1e3,delay:n=0}=r,{x:o,y:a,width:c,height:h,alpha:f=1,rotation:u=0,scale:g=1,color:_}=e;function m(){setTimeout(()=>{t.style.top=`${a}px`,t.style.left=`${o}px`,t.style.width=`${c}px`,t.style.height=`${h}px`,t.style.opacity=`${f}`,t.style.rotate=`${u}rad`,t.style.scale=`${g}`,t.style.color=ln(_)},i)}setTimeout(m,n)}}const Xo=s=>{let t=!1;const e=()=>{if(s.updateFrameTime(),s.updateAnimations(),!s.hasSceneUpdates()){s.calculateFps(),setTimeout(e,16.666666666666668),t||(s.txMemManager.checkCleanup()&&s.txMemManager.cleanup(),s.eventBus.emit("idle"),t=!0),s.flushFrameEvents();return}t=!1,s.drawFrame(),s.flushFrameEvents(),requestAnimationFrame(e)};requestAnimationFrame(e)},Yo=()=>performance?performance.now():Date.now();class cn{constructor(t,e){l(this,"textureSource");l(this,"memManager");this.memManager=t,this.textureSource=e}setTextureMemUse(t){this.memManager.setTextureMemUse(this.textureSource,t)}get renderable(){return this.textureSource.renderable}}class hn{constructor(t){l(this,"options");l(this,"mode");l(this,"stage");l(this,"txManager");l(this,"txMemManager");l(this,"shManager");l(this,"rttNodes",[]);this.options=t,this.stage=t.stage,this.txManager=t.txManager,this.txMemManager=t.txMemManager,this.shManager=t.shManager}}class jo{}class fn{static makeCacheKey(t){return!1}static resolveDefaults(t){return{}}}function Ti(s,t,e){const r=s.createShader(t);if(!r)throw new Error;if(s.shaderSource(r,e),s.compileShader(r),s.getShaderParameter(r,s.COMPILE_STATUS))return r;console.log(s.getShaderInfoLog(r)),s.deleteShader(r)}function Ko(s,t,e){const r=s.createProgram();if(!r)throw new Error;if(s.attachShader(r,t),s.attachShader(r,e),s.linkProgram(r),s.getProgramParameter(r,s.LINK_STATUS))return r;console.log(s.getProgramInfoLog(r)),s.deleteProgram(r)}class ot extends fn{constructor(e){super();l(this,"boundBufferCollection",null);l(this,"buffersBound",!1);l(this,"program");l(this,"vao");l(this,"renderer");l(this,"glw");l(this,"attributeBuffers");l(this,"attributeLocations");l(this,"attributeNames");l(this,"uniformLocations");l(this,"uniformTypes");l(this,"supportsIndexedTextures");const r=this.renderer=e.renderer,i=this.glw=this.renderer.glw;this.supportsIndexedTextures=e.supportsIndexedTextures||!1;const n=i.isWebGl2(),o=n&&e.webgl2Extensions||!n&&e.webgl1Extensions||[],a=n?"2.0":"1.0";o.forEach(x=>{if(!i.getExtension(x))throw new Error(`Shader "${this.constructor.name}" requires extension "${x}" for WebGL ${a} but wasn't found`)});const c=e.shaderSources||this.constructor.shaderSources;if(c)n&&(c!=null&&c.webGl2)&&(c.fragment=c.webGl2.fragment,c.vertex=c.webGl2.vertex,delete c.webGl2);else throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);const h=r.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,f=c.vertex instanceof Function?c.vertex(h):c.vertex,u=c.fragment instanceof Function?c.fragment(h):c.fragment,g=Ti(i,i.VERTEX_SHADER,f),_=Ti(i,i.FRAGMENT_SHADER,u);if(!g||!_)throw new Error;const m=Ko(i,g,_);if(!m)throw new Error;if(this.program=m,n){const x=i.createVertexArray();if(!x)throw new Error;this.vao=x,i.bindVertexArray(this.vao)}this.attributeLocations={},this.attributeBuffers={},this.attributeNames=[],[...e.attributes].forEach(x=>{const v=i.getAttribLocation(this.program,x);if(v<0)throw new Error(`${this.constructor.name}: Vertex shader must have an attribute "${x}"!`);const b=i.createBuffer();if(!b)throw new Error(`${this.constructor.name}: Could not create buffer for attribute "${x}"`);this.attributeLocations[x]=v,this.attributeBuffers[x]=b,this.attributeNames.push(x)}),this.uniformLocations={},this.uniformTypes={},e.uniforms.forEach(x=>{const v=i.getUniformLocation(this.program,x.name);if(this.uniformTypes[x.name]=x.uniform,!v){console.warn(`Shader "${this.constructor.name}" could not get uniform location for "${x.name}"`);return}this.uniformLocations[x.name]=v})}bindBufferAttribute(e,r,i){const{glw:n}=this;n.enableVertexAttribArray(e),n.vertexAttribPointer(r,e,i.size,i.type,i.normalized,i.stride,i.offset)}disableAttribute(e){this.glw.disableVertexAttribArray(e)}disableAttributes(){for(const e in this.attributeLocations)this.disableAttribute(this.attributeLocations[e]);this.boundBufferCollection=null}canBatchShaderProps(e,r){return!1}bindRenderOp(e,r){this.bindBufferCollection(e.buffers),e.textures.length>0&&this.bindTextures(e.textures);const{glw:i,parentHasRenderTexture:n,renderToTexture:o}=e;if(!(o&&n)){if(n){const{width:a,height:c}=e.framebufferDimensions||{};this.setUniform("u_pixelRatio",1),this.setUniform("u_resolution",new Float32Array([a??0,c??0]))}else this.setUniform("u_pixelRatio",e.options.pixelRatio),this.setUniform("u_resolution",new Float32Array([i.canvas.width,i.canvas.height]));if(r){if(Tr(r,"$dimensions")){let a=r.$dimensions;a||(a=e.dimensions),this.setUniform("u_dimensions",[a.width,a.height])}if(Tr(r,"$alpha")){let a=r.$alpha;a||(a=e.alpha),this.setUniform("u_alpha",a)}this.bindProps(r)}}}setUniform(e,...r){this.glw.setUniform(this.uniformTypes[e],this.uniformLocations[e],...r)}bindBufferCollection(e){if(this.boundBufferCollection!==e){for(const r in this.attributeLocations){const i=e.getBuffer(r),n=e.getAttributeInfo(r);U(i,`Buffer for "${r}" not found`),U(n),this.bindBufferAttribute(this.attributeLocations[r],i,n)}this.boundBufferCollection=e}}bindProps(e){}bindTextures(e){}attach(){this.glw.useProgram(this.program),this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}l(ot,"shaderSources");class un extends jo{constructor(e,r,i,n,o,a,c,h,f,u,g,_,m){super();l(this,"glw");l(this,"options");l(this,"buffers");l(this,"shader");l(this,"shaderProps");l(this,"alpha");l(this,"clippingRect");l(this,"dimensions");l(this,"bufferIdx");l(this,"zIndex");l(this,"renderToTexture");l(this,"parentHasRenderTexture");l(this,"framebufferDimensions");l(this,"length",0);l(this,"numQuads",0);l(this,"textures",[]);l(this,"maxTextures");this.glw=e,this.options=r,this.buffers=i,this.shader=n,this.shaderProps=o,this.alpha=a,this.clippingRect=c,this.dimensions=h,this.bufferIdx=f,this.zIndex=u,this.renderToTexture=g,this.parentHasRenderTexture=_,this.framebufferDimensions=m,this.maxTextures=n.supportsIndexedTextures?e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(e){const{textures:r,maxTextures:i}=this,n=r.findIndex(a=>a===e);if(n!==-1)return n;const o=r.length;return o>=i?4294967295:(this.textures.push(e),o)}draw(){const{glw:e,shader:r,shaderProps:i,options:n}=this,{shManager:o}=n;o.useShader(r),r.bindRenderOp(this,i);const a=this.bufferIdx/24*6*2;if(this.clippingRect.valid){const{x:c,y:h,width:f,height:u}=this.clippingRect,g=n.pixelRatio,_=n.canvas.height,m=Math.round(c*g),x=Math.round(f*g),v=Math.round(u*g),b=Math.round(_-v-h*g);e.setScissorTest(!0),e.scissor(m,b,x,v)}else e.setScissorTest(!1);e.drawElements(e.TRIANGLES,6*this.numQuads,e.UNSIGNED_SHORT,a)}}function qo(s){const t={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(t).forEach(r=>{t[r]=s.getParameter(s[r])}),t}function Qo(s){const t={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(t).forEach(r=>{t[r]=s.getExtension(r)}),t}function Zo(s,t){const e=~~(t/80),r=new Uint16Array(e*6);for(let n=0,o=0;n<e;n+=6,o+=4)r[n]=o,r[n+1]=o+1,r[n+2]=o+2,r[n+3]=o+2,r[n+4]=o+1,r[n+5]=o+3;const i=s.createBuffer();s.elementArrayBufferData(i,r,s.STATIC_DRAW)}function Jo(s){return s!==null&&typeof s=="object"&&s.constructor&&s.constructor.name==="HTMLImageElement"}const ar=new Uint8Array([0,0,0,0]);class Hs extends cn{constructor(e,r,i){super(r,i);l(this,"glw");l(this,"_nativeCtxTexture",null);l(this,"_state","freed");l(this,"_w",0);l(this,"_h",0);this.glw=e}get ctxTexture(){return this._state==="freed"&&this.load(),U(this._nativeCtxTexture),this._nativeCtxTexture}get w(){return this._w}get h(){return this._h}load(){this._state==="loading"||this._state==="loaded"||(this._state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this.onLoadRequest().then(({width:e,height:r})=>{this._state!=="freed"&&(this._state="loaded",this._w=e,this._h=r,this.textureSource.setState("loaded",{width:e,height:r}))}).catch(e=>{this._state!=="freed"&&(this._state="failed",this.textureSource.setState("failed",e),console.error(e))}))}async onLoadRequest(){var o;const{glw:e}=this;e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(ar.byteLength);const r=await((o=this.textureSource)==null?void 0:o.getTextureData());if(!this._nativeCtxTexture)return U(this._state==="freed"),{width:0,height:0};let i=0,n=0;if(U(this._nativeCtxTexture),e.activeTexture(0),r.data instanceof ImageBitmap||r.data instanceof ImageData||Jo(r.data)){const a=r.data;i=a.width,n=a.height,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!r.premultiplyAlpha),e.texImage2D(0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),this.setTextureMemUse(i*n*4),(e.isWebGl2()||xi(i)&&xi(n))&&e.generateMipmap()}else if(r.data===null)i=0,n=0,e.bindTexture(this._nativeCtxTexture),e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,ar),this.setTextureMemUse(ar.byteLength);else if("mipmaps"in r.data&&r.data.mipmaps){const{mipmaps:a,width:c=0,height:h=0,type:f,glInternalFormat:u}=r.data,g=f==="ktx"?new DataView(a[0]??new ArrayBuffer(0)):a[0];e.bindTexture(this._nativeCtxTexture),e.compressedTexImage2D(0,u,c,h,0,g),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),this.setTextureMemUse(g.byteLength)}else console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",r);return{width:i,height:n}}free(){if(this._state==="freed"||(this._state="freed",this.textureSource.setState("freed"),this._w=0,this._h=0,!this._nativeCtxTexture))return;const{glw:e}=this;e.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null}createNativeCtxTexture(){const{glw:e}=this,r=e.createTexture();if(!r)throw new Error("Could not create WebGL Texture");return e.activeTexture(0),e.bindTexture(r),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r}}class Nt extends nt{constructor(e){super();l(this,"txManager");l(this,"dimensions",null);l(this,"error",null);l(this,"state","freed");l(this,"renderableOwners",new Set);l(this,"renderable",!1);l(this,"lastRenderableChangeTime",0);this.txManager=e}setRenderableOwner(e,r){var n,o;const i=this.renderableOwners.size;if(r){this.renderableOwners.add(e);const a=this.renderableOwners.size;a>i&&a===1&&(this.renderable=!0,this.lastRenderableChangeTime=this.txManager.frameTime,(n=this.onChangeIsRenderable)==null||n.call(this,!0))}else{this.renderableOwners.delete(e);const a=this.renderableOwners.size;a<i&&a===0&&(this.renderable=!1,this.lastRenderableChangeTime=this.txManager.frameTime,(o=this.onChangeIsRenderable)==null||o.call(this,!1))}}get ctxTexture(){const e=this.txManager.renderer.createCtxTexture(this);return Object.defineProperty(this,"ctxTexture",{value:e}),e}setState(e,...r){if(this.state!==e){if(this.state=e,e==="loaded"){const i=r;this.dimensions=i[0]}else if(e==="failed"){const i=r;this.error=i[0]}this.emit(e,...r)}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}}const Jt=class Jt extends Nt{constructor(e,r){super(e);l(this,"props");this.props=Jt.resolveDefaults(r||{})}get color(){return this.props.color}set color(e){this.props.color=e}async getTextureData(){const e=new Uint32Array([this.color]),r=new Uint8ClampedArray(e.buffer);return{data:new ImageData(r,1,1),premultiplyAlpha:!0}}static makeCacheKey(e){return`ColorTexture,${Jt.resolveDefaults(e).color}`}static resolveDefaults(e){return{color:e.color||4294967295}}};l(Jt,"z$__type__Props");let Ws=Jt;const js=class js extends Nt{constructor(e,r){super(e);l(this,"props");l(this,"parentTexture");l(this,"onParentTxLoaded",()=>{this.setState("loaded",{width:this.props.width,height:this.props.height})});l(this,"onParentTxFailed",(e,r)=>{this.setState("failed",r)});this.props=js.resolveDefaults(r||{}),this.parentTexture=this.props.texture,queueMicrotask(()=>{const i=this.parentTexture;i.state==="loaded"?this.onParentTxLoaded(i,i.dimensions):i.state==="failed"&&this.onParentTxFailed(i,i.error),i.on("loaded",this.onParentTxLoaded),i.on("failed",this.onParentTxFailed)})}onChangeIsRenderable(e){this.parentTexture.setRenderableOwner(this,e)}async getTextureData(){return{data:this.props}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{texture:e.texture,x:e.x||0,y:e.y||0,width:e.width||0,height:e.height||0}}};l(js,"z$__type__Props");let Lt=js;class ea extends Hs{constructor(t,e,r){super(t,e,r)}async onLoadRequest(){var e,r;const t=await this.textureSource.getTextureData();return{width:((e=t.data)==null?void 0:e.width)||0,height:((r=t.data)==null?void 0:r.height)||0}}}class dn extends ot{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}}l(dn,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;


      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio;
        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);

        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);
        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
          vec4 color = texture2D(u_texture, v_textureCoordinate);
          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);
      }
    `});class pn extends ot{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});l(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:r,glw:i}=this;if(e.length>r.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${r.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);e.forEach((o,a)=>{i.activeTexture(a),i.bindTexture(o.ctxTexture)});const n=Array.from(Array(e.length).keys());this.setUniform("u_textures[0]",n)}}l(pn,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_textureCoordinate;
      attribute vec2 a_position;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      void main(){
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;
        v_textureIndex = a_textureIndex;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:e=>`
      #define txUnits ${e}
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_image;
      uniform sampler2D u_textures[txUnits];

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      vec4 sampleFromTexture(sampler2D textures[${e}], int idx, vec2 uv) {
        ${Array.from(Array(e).keys()).map(r=>`
          ${r!==0?"else ":""}if (idx == ${r}) {
            return texture2D(textures[${r}], uv);
          }
        `).join("")}
        return texture2D(textures[0], uv);
      }

      void main(){
        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);
      }
    `});class xe{constructor(t){l(this,"priority",1);l(this,"name","");l(this,"ref");l(this,"target");l(this,"passParameters","");l(this,"declaredUniforms","");l(this,"uniformInfo",{});const{ref:e,target:r,props:i={}}=t;this.ref=e,this.target=r;const n={},o=[];let a="";const c=this.constructor.uniforms||{};for(const h in c){const f=c[h],u=f.type,g=`${e}_${h}`;let _="";f.size&&(_=`[${f.size(i)}]`),o.push(g),a+=`uniform ${u} ${g}${_};`,n[h]={name:g,uniform:c[h].method}}this.passParameters=o.join(","),this.declaredUniforms=a,this.uniformInfo=n}static getEffectKey(t){return""}static getMethodParameters(t,e){const r=[];for(const i in t){const n=t[i];let o="";n.size&&(o=`[${n.size(e)}]`),r.push(`${n.type} ${i}${o}`)}return r.join(",")}static resolveDefaults(t){return{}}static makeEffectKey(t){return!1}}l(xe,"uniforms",{}),l(xe,"methods"),l(xe,"onShaderMask"),l(xe,"onColorize"),l(xe,"onEffectMask");const lr=new Map,ta=(s,t)=>{const e=JSON.stringify(s);if(lr.has(e))return lr.get(e);s=s??[];const r=[],i=s.length;let n=0;for(;n<i;n++){const{name:o,type:a,props:c}=s[n],h={name:o,type:a,props:{}},f=t[a],u=f.resolveDefaults(c),g=f.uniforms,_=Object.keys(g),m=_.length;let x=0;for(;x<m;x++){const v=_[x],b=g[v],M={value:u[v],programValue:void 0,updateOnBind:b.updateOnBind||!1,hasValidator:b.validator!==void 0,hasProgramValueUpdater:b.updateProgramValue!==void 0},I=M.hasValidator&&b.validator(u[v],u)||u[v];u[v]!==I&&(M.validatedValue=I),M.hasProgramValueUpdater&&b.updateProgramValue(M),M.programValue===void 0&&(M.programValue=M.value),h.props[v]=M}r.push(h)}return lr.set(e,r),r},Xe=class Xe extends ot{constructor(e,r,i){const n=Xe.createShader(r,i);super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...n.uniforms],shaderSources:{vertex:n.vertex,fragment:n.fragment}});l(this,"effects",[]);this.effects=n.effects}bindTextures(e){const{glw:r}=this;r.activeTexture(0),r.bindTexture(e[0].ctxTexture)}bindProps(e){var o;const r=e.effects,i=r.length;let n=0;for(;n<i;n++){const a=r[n],c=this.effects[n].uniformInfo,h=Object.keys(a.props),f=h.length;let u=0;for(;u<f;u++){const g=h[u];if(a.props[g].updateOnBind===!0){const m=(o=this.renderer.shManager.getRegisteredEffects()[a.type])==null?void 0:o.uniforms[g];m==null||m.updateProgramValue(a.props[g],e)}this.setUniform(c[g].name,a.props[g].programValue)}}}canBatchShaderProps(e,r){if(e.$dimensions.width!==r.$dimensions.width||e.$dimensions.height!==r.$dimensions.height||e.effects.length!==r.effects.length)return!1;const i=e.effects.length;let n=0;for(;n<i;n++){const o=e.effects[n],a=r.effects[n];if(o.type!==a.type)return!1;for(const c in o.props)if(a.props&&!a.props[c]||o.props[c].value!==a.props[c].value)return!1}return!0}static createShader(e,r){const i={},n={};let o="";const a=[],c=[],h=e.effects.map(m=>{const x=r[m.type],v=x.getEffectKey(m.props||{});i[v]=i[v]?++i[v]:1;const b=i[v];b===1&&c.push({key:v,type:m.type,props:m.props});const M=new x({ref:`${v}${b===1?"":b}`,target:v,props:m.props});return o+=M.declaredUniforms,a.push(...Object.values(M.uniformInfo)),M});let f="";c==null||c.forEach(m=>{const x=r[m.type],v=x.resolveDefaults(m.props??{}),b=[];for(const B in x.methods){let V=B;const Y=x.methods[B];n[B]&&n[B]!==Y&&(V=Xe.resolveMethodDuplicate(B,Y,n)),n[V]=Y.replace("function",V),b.push({m:B,cm:V})}let M=x.onShaderMask instanceof Function?x.onShaderMask(v):x.onShaderMask,I=x.onColorize instanceof Function?x.onColorize(v):x.onColorize,S=x.onEffectMask instanceof Function?x.onEffectMask(v):x.onEffectMask;b.forEach(B=>{const{m:V,cm:Y}=B,G=new RegExp(`\\$${V}`,"g");M&&(M=M.replace(G,Y)),I&&(I=I.replace(G,Y)),S&&(S=S.replace(G,Y))});const L=x.getMethodParameters(x.uniforms,v),A=L.length>0?`, ${L}`:"";M&&(f+=`
        float fx_${m.key}_onShaderMask(float shaderMask ${A}) {
          ${M}
        }
        `),I&&(f+=`
          vec4 fx_${m.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${A}) {
            ${I}
          }
        `),S&&(f+=`
          vec4 fx_${m.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${A}) {
            ${S}
          }
        `)});let u="";for(const m in n)u+=n[m];let g="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",_=`

    `;for(let m=0;m<h.length;m++){const x=h[m],v=x.passParameters.length>0?`, ${x.passParameters}`:"",b=r[x.name];b.onShaderMask&&(_+=`
        shaderMask = fx_${x.target}_onShaderMask(shaderMask ${v});
        `),b.onColorize&&(_+=`
        maskColor = fx_${x.target}_onColorize(shaderMask, maskColor, shaderColor${v});
        `),b.onEffectMask&&(g=`fx_${x.target}_onEffectMask(shaderMask, maskColor, shaderColor${v})`);const M=h[m+1];(M===void 0||r[M.name].onEffectMask)&&(_+=`
          shaderColor = ${g};
        `)}return{effects:h,uniforms:a,fragment:Xe.fragment(o,u,f,_),vertex:Xe.vertex()}}static resolveMethodDuplicate(e,r,i,n=0){const o=e+(n>0?n:"");return i[o]&&i[o]!==r?this.resolveMethodDuplicate(e,r,i,++n):o}static resolveDefaults(e,r){return U(r),{effects:ta(e.effects??[],r),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,r){var n;let i="";return(n=e.effects)==null||n.forEach(o=>{const c=r[o.type].getEffectKey(o.props||{});i+=`,${c}`}),`DynamicShader${i}`}};l(Xe,"z$__type__Props"),l(Xe,"vertex",()=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    attribute vec2 a_textureCoordinate;
    attribute vec2 a_position;
    attribute vec4 a_color;
    attribute float a_textureIndex;

    uniform vec2 u_resolution;
    uniform float u_pixelRatio;

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;
    varying float v_textureIndex;

    void main(){
      vec2 normalized = a_position * u_pixelRatio / u_resolution;
      vec2 zero_two = normalized * 2.0;
      vec2 clip_space = zero_two - 1.0;

      // pass to fragment
      v_color = a_color;
      v_textureCoordinate = a_textureCoordinate;
      v_textureIndex = a_textureIndex;

      // flip y
      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
    }
  `),l(Xe,"fragment",(e,r,i,n)=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    #define PI 3.14159265359

    uniform vec2 u_resolution;
    uniform vec2 u_dimensions;
    uniform float u_alpha;
    uniform float u_radius;
    uniform sampler2D u_texture;
    uniform float u_pixelRatio;

    ${e}

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;

    ${r}

    ${i}

    void main() {
      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;
      vec2 d = abs(p) - (u_dimensions) * 0.5;
      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));

      vec4 shaderColor = vec4(0.0);
      float shaderMask = lng_DefaultMask;

      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;

      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));

      ${n}

      gl_FragColor = shaderColor * u_alpha;
    }
  `);let At=Xe;class br extends ot{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(t){return{radius:t.radius||10,$dimensions:{width:0,height:0}}}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=Math.min(t.$dimensions.width,t.$dimensions.height)/(2*t.radius);this.setUniform("u_radius",t.radius*Math.min(e,1))}canBatchShaderProps(t,e){return t.radius===e.radius&&t.$dimensions.width===e.$dimensions.width&&t.$dimensions.height===e.$dimensions.height}}l(br,"z$__type__Props"),l(br,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform vec2 u_dimensions;
      uniform float u_radius;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      float boxDist(vec2 p, vec2 size, float radius){
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }

      float fillMask(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }

      void main() {
        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;
        vec2 halfDimensions = u_dimensions * 0.5;

        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);
        gl_FragColor = mix(vec4(0.0), color, fillMask(d));
      }
    `});const sa=new Float32Array([1,0,0,0,1,0,0,0,1]),Ks=class Ks extends ot{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=Ks.resolveDefaults(t);for(const r in e)if(r==="transform")this.setUniform("u_transform",!1,e[r]);else if(r==="scrollY")this.setUniform("u_scrollY",e[r]);else if(r==="color"){const i=cs(e.color);this.setUniform("u_color",i)}else r==="size"?this.setUniform("u_size",e[r]):r==="distanceRange"?this.setUniform("u_distanceRange",e[r]):r==="debug"&&this.setUniform("u_debug",e[r]?1:0)}static resolveDefaults(t={}){return{transform:t.transform??sa,scrollY:t.scrollY??0,color:t.color??4294967295,size:t.size??16,distanceRange:t.distanceRange??1,debug:t.debug??!1}}};l(Ks,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      // an attribute is an input (in) to a vertex shader.
      // It will receive data from a buffer
      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;

      uniform vec2 u_resolution;
      uniform mat3 u_transform;
      uniform float u_scrollY;
      uniform float u_pixelRatio;
      uniform float u_size;

      varying vec2 v_texcoord;

      void main() {
        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);
        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;

        // Calculate screen space with pixel ratio
        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);

        gl_Position = vec4(screenSpace, 0.0, 1.0);
        v_texcoord = a_textureCoordinate;

      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      uniform vec4 u_color;
      uniform sampler2D u_texture;
      uniform float u_distanceRange;
      uniform float u_pixelRatio;
      uniform int u_debug;

      varying vec2 v_texcoord;

      float median(float r, float g, float b) {
          return max(min(r, g), min(max(r, g), b));
      }

      void main() {
          vec3 sample = texture2D(u_texture, v_texcoord).rgb;
          if (u_debug == 1) {
            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);
            return;
          }
          float scaledDistRange = u_distanceRange * u_pixelRatio;
          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);
          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;

          // Build the final color.
          // IMPORTANT: We must premultiply the color by the alpha value before returning it.
          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);
      }
    `});let Rr=Ks;const Ut=s=>{s.programValue===void 0&&(s.programValue=new Float32Array(4));const t=s.value,e=s.programValue;e[0]=(t>>>24)/255,e[1]=(t>>>16&255)/255,e[2]=(t>>>8&255)/255,e[3]=(t&255)/255},ra=s=>{const t=s.validatedValue||s.value;if(s.programValue instanceof Float32Array){const e=s.programValue;e[0]=t[0],e[1]=t[1]}else s.programValue=new Float32Array(t)},ia=s=>{const t=s.validatedValue||s.value;if(s.programValue instanceof Float32Array){const e=s.programValue;e[0]=t[0],e[1]=t[1],e[2]=t[1],e[3]=t[1]}else s.programValue=new Float32Array(t)},gn=s=>{const t=s.validatedValue||s.value;if(s.programValue instanceof Float32Array){const e=t.length,r=s.programValue;for(let i=0;i<e;i++)r[i]=t[i]}else s.programValue=new Float32Array(t)},$r=s=>{const t=Array.isArray(s);if(t){if(t&&s.length===4)return s;if(t&&s.length===2)return[s[0],s[1],s[0],s[1]];if(t&&s.length===3)return[s[0],s[1],s[2],s[0]]}else return[s,s,s,s];return[s[0],s[0],s[0],s[0]]},mn=(s,t)=>{s.programValue===void 0&&(s.programValue=new Float32Array(4));const e=s.programValue,r=s.validatedValue||s.value;if(t===void 0&&s.$dimensions===void 0){e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3];return}let i=s.$dimensions;if(t!==void 0){const{$dimensions:g}=t;if(i!==void 0&&(i.width===g.width||i.height===g.height))return;i===void 0&&(i={width:g==null?void 0:g.width,height:g==null?void 0:g.height},s.$dimensions=i)}const{width:n,height:o}=i,[a,c,h,f]=r,u=Math.min(Math.min(Math.min(n/Math.max(n,a+c),n/Math.max(n,h+f)),Math.min(o/Math.max(o,a+h),o/Math.max(o,c+f))),1);e[0]=a*u,e[1]=c*u,e[2]=h*u,e[3]=f*u};class vt extends xe{constructor(){super(...arguments);l(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){return{radius:e.radius??10}}}l(vt,"z$__type__Props"),l(vt,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:$r,updateProgramValue:mn}}),l(vt,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),l(vt,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);
  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);
  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);
  `),l(vt,"onEffectMask",`
  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));
  `);class zt extends xe{constructor(){super(...arguments);l(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(zt,"z$__type__Props"),l(zt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ut,method:"uniform4fv",type:"vec4"}}),l(zt,"onEffectMask",`
  float intR = shaderMask + 1.0;
  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);
  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);
  `),l(zt,"onColorize",`
    return color;
  `);const Je=class Je extends xe{constructor(){super(...arguments);l(this,"name","linearGradient")}static getEffectKey(e){return`linearGradient${e.colors.length}`}static resolveDefaults(e){const r=e.colors??[4278190080,4294967295];let i=e.stops||[];if(i.length===0||i.length!==r.length){const n=r.length;let o=0;const a=i;for(;o<n;o++)i[o]?(a[o]=i[o],i[o-1]===void 0&&a[o-2]!==void 0&&(a[o-1]=a[o-2]+(i[o]-a[o-2])/2)):a[o]=o*(1/(r.length-1));i=a}return{colors:r,stops:i,angle:e.angle??0}}};l(Je,"z$__type__Props"),l(Je,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.reduce((r,i)=>r.concat(cs(i)),[]),updateProgramValue:gn,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),l(Je,"methods",{fromLinear:`
      vec4 function(vec4 linearRGB) {
        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);
        vec4 lower = linearRGB * vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,toLinear:`
      vec4 function(vec4 sRGB) {
        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));
        vec4 lower = sRGB/vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,calcPoint:`
      vec2 function(float d, float angle) {
        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);
      }
    `}),l(Je,"ColorLoop",e=>{let r="";for(let i=2;i<e;i++)r+=`colorOut = mix(colorOut, colors[${i}], clamp((dist - stops[${i-1}]) / (stops[${i}] - stops[${i-1}]), 0.0, 1.0));`;return r}),l(Je,"onColorize",e=>{const r=e.colors.length||1;return`
      float a = angle - (PI / 180.0 * 90.0);
      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));
      vec2 f = $calcPoint(lineDist * 0.5, a);
      vec2 t = $calcPoint(lineDist * 0.5, a + PI);
      vec2 gradVec = t - f;
      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));
      ${Je.ColorLoop(r)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let wr=Je;class Sr extends xe{constructor(){super(...arguments);l(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){return{amount:e.amount??1}}}l(Sr,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),l(Sr,"onColorize",`
    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;
    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);
  `);class bt extends xe{constructor(){super(...arguments);l(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(bt,"z$__type__Props"),l(bt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ut,method:"uniform4fv",type:"vec4"}}),l(bt,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),l(bt,"onEffectMask",`
  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),l(bt,"onColorize",`
    return color;
  `);class Rt extends xe{constructor(){super(...arguments);l(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(Rt,"z$__type__Props"),l(Rt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ut,method:"uniform4fv",type:"vec4"}}),l(Rt,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),l(Rt,"onEffectMask",`
  vec2 pos = vec2(0.0, width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),l(Rt,"onColorize",`
    return color;
  `);class wt extends xe{constructor(){super(...arguments);l(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(wt,"z$__type__Props"),l(wt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ut,method:"uniform4fv",type:"vec4"}}),l(wt,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),l(wt,"onEffectMask",`
  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),l(wt,"onColorize",`
    return color;
  `);class St extends xe{constructor(){super(...arguments);l(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}l(St,"z$__type__Props"),l(St,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ut,method:"uniform4fv",type:"vec4"}}),l(St,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),l(St,"onEffectMask",`
  vec2 pos = vec2(width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),l(St,"onColorize",`
    return color;
  `);class Ht extends xe{constructor(){super(...arguments);l(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){return{amplitude:e.amplitude??.2,narrowness:e.narrowness??4,blockiness:e.blockiness??2,minimizer:e.minimizer??8,time:e.time??Date.now()}}}l(Ht,"z$__type__Props"),l(Ht,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:e=>{const r=e.value=(Date.now()-e.value)%1e3;e.programValue=r},type:"float"}}),l(Ht,"methods",{rand:`
      float function(vec2 p, float time) {
        float t = floor(time * 20.) / 10.;
        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);
      }
    `,noise:`
      float function(vec2 uv, float blockiness, float time) {
        vec2 lv = fract(uv);
        vec2 id = floor(uv);

        float n1 = rand(id, time);
        float n2 = rand(id+vec2(1,0), time);
        float n3 = rand(id+vec2(0,1), time);
        float n4 = rand(id+vec2(1,1), time);
        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);
        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);
      }
    `,fbm:`
      float function(vec2 uv, int count, float blockiness, float complexity, float time) {
        float val = 0.0;
        float amp = 0.5;
        const int MAX_ITERATIONS = 10;

        for(int i = 0; i < MAX_ITERATIONS; i++) {
          if(i >= count) {break;}
          val += amp * noise(uv, blockiness, time);
          amp *= 0.5;
          uv *= complexity;
        }
        return val;
      }
    `}),l(Ht,"onColorize",`
    vec2 uv = v_textureCoordinate.xy;
    float aspect = u_dimensions.x / u_dimensions.y;
    vec2 a = vec2(uv.x * aspect , uv.y);
    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));

    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);
    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);
    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);
    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);

    vec3 f = vec3(colR, colG, colB);
    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);
  `);class Bs extends xe{constructor(){super(...arguments);l(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){return{fade:e.fade??10}}}l(Bs,"z$__type__Props"),l(Bs,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:$r,updateProgramValue:ia}}),l(Bs,"onColorize",`
  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;
  vec2 pos1;
  vec2 pos2;
  vec2 d;
  float c;
  vec4 result = maskColor;


  if(fade[0] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x, point.y + fade[0]);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[1] > 0.0) {
    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);
    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[2] > 0.0) {
    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);
    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[3] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x + fade[3], point.y);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  return result;
  `);const dt=class dt extends xe{constructor(){super(...arguments);l(this,"name","radialGradient")}static getEffectKey(e){return`radialGradient${e.colors.length}`}static resolveDefaults(e){const r=e.colors??[4278190080,4294967295];let i=e.stops||[];if(i.length===0||i.length!==r.length){const n=r.length;let o=0;const a=i;for(;o<n;o++)i[o]?(a[o]=i[o],i[o-1]===void 0&&a[o-2]!==void 0&&(a[o-1]=a[o-2]+(i[o]-a[o-2])/2)):a[o]=o*(1/(r.length-1));i=a}return{colors:r,stops:i,width:e.width??0,height:e.height??e.width??0,pivot:e.pivot??[.5,.5]}}};l(dt,"z$__type__Props"),l(dt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:ra,method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.reduce((r,i)=>r.concat(cs(i)),[]),updateProgramValue:gn,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),l(dt,"ColorLoop",e=>{let r="";for(let i=2;i<e;i++)r+=`colorOut = mix(colorOut, colors[${i}], clamp((dist - stops[${i-1}]) / (stops[${i}] - stops[${i-1}]), 0.0, 1.0));`;return r}),l(dt,"onColorize",e=>{const r=e.colors.length||1;return`
      vec2 point = v_textureCoordinate.xy * u_dimensions;
      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);

      float dist = length((point - projection) / vec2(width, height));

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = mix(colors[0], colors[1], stopCalc);
      ${dt.ColorLoop(r)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let Er=dt;class Et extends xe{constructor(){super(...arguments);l(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){return{width:e.width??10,progress:e.progress??.5,offset:e.offset??0,range:e.range??Math.PI*2,rounded:e.rounded??!1,radius:e.radius??1,color:e.color??4294967295}}}l(Et,"z$__type__Props"),l(Et,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Ut,method:"uniform4fv",type:"vec4"}}),l(Et,"methods",{rotateUV:`
    vec2 function(vec2 uv, float d) {
      float s = sin(d);
      float c = cos(d);
      mat2 rotMatrix = mat2(c, -s, s, c);
      return uv * rotMatrix;
    }
    `,drawDot:`
    float function(vec2 uv, vec2 p, float r) {
      uv += p;
      float circle = length(uv) - r;
      return clamp(-circle, 0.0, 1.0);
    }
    `}),l(Et,"onEffectMask",`
    float outerRadius = radius * u_dimensions.y * 0.5;

    float endAngle = range * progress - 0.0005;

    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;

    uv = $rotateUV(uv, -(offset));
    float linewidth = width * u_pixelRatio;
    float circle = length(uv) - (outerRadius - linewidth) ;
    circle = abs(circle) - linewidth;
    circle = clamp(-circle, 0.0, 1.0);

    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);
    float p = endAngle / (PI * 2.);

    circle *= step(fract(angle), fract(p));

    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));
    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));

    return mix(shaderColor, maskColor, circle);
  `),l(Et,"onColorize",`
    return color;
  `);class Ct extends xe{constructor(){super(...arguments);l(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:e.radius??0}}}l(Ct,"z$__type__Props"),l(Ct,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:$r,updateProgramValue:mn}}),l(Ct,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),l(Ct,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  vec2 size = vec2(width, height) * 0.5;
  vec2 basePos = v_textureCoordinate.xy * u_dimensions.xy - vec2(x, y);
  vec2 pos = basePos - size;
  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);
  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);
  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);
  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);
  return $boxDist(pos, size, r);
  `),l(Ct,"onEffectMask",`
  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));
  `);const xn="RoundedRectangle";class zr extends fn{constructor(e){super();l(this,"shType");this.shType=e,e!==xn&&console.warn("Unsupported shader:",e)}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class na{constructor(t,e,r,i){l(this,"type");l(this,"shader");l(this,"resolvedProps");l(this,"props");this.type=t,this.shader=e,this.resolvedProps=r;const n=Object.keys(r),o=n.length,a={};for(let c=0;c<o;c++){const h=n[c];Object.defineProperty(a,h,{get:()=>this.resolvedProps[h],set:f=>{this.resolvedProps[h]=f,i.requestRender()}})}this.props=a}getResolvedProps(){return this.resolvedProps}}class oa{constructor(t,e,r){l(this,"shader");l(this,"resolvedProps");l(this,"props");l(this,"type");this.shader=t,this.type="DynamicShader",this.resolvedProps=e;const i=r.getRegisteredEffects(),n={},o=e.effects,a=o.length;for(let c=0;c<a;c++){const{name:h,props:f,type:u}=o[c];if(h===void 0)continue;const g={},_=Object.keys(f),m=_.length;for(let x=0;x<m;x++){const v=_[x];Object.defineProperty(g,v,{get:()=>this.resolvedProps.effects[c].props[v].value,set:b=>{var I,S;const M=this.resolvedProps.effects[c].props[v];M.value=b,M.hasValidator&&(b=M.validatedValue=(I=i[u].uniforms[v])==null?void 0:I.validator(b,f)),M.hasProgramValueUpdater?(S=i[u].uniforms[v])==null||S.updateProgramValue(M):M.programValue=b,r.renderer.stage.requestRender()}})}Object.defineProperty(n,h,{get:()=>g})}this.props=n}getResolvedProps(){return this.resolvedProps}}class aa{constructor(){l(this,"shCache",new Map);l(this,"shConstructors",{});l(this,"attachedShader",null);l(this,"effectConstructors",{});l(this,"renderer");this.registerShaderType("DefaultShader",dn),this.registerShaderType("DefaultShaderBatched",pn),this.registerShaderType("RoundedRectangle",br),this.registerShaderType("DynamicShader",At),this.registerShaderType("SdfShader",Rr),this.registerEffectType("border",zt),this.registerEffectType("borderBottom",wt),this.registerEffectType("borderLeft",St),this.registerEffectType("borderRight",bt),this.registerEffectType("borderTop",Rt),this.registerEffectType("fadeOut",Bs),this.registerEffectType("linearGradient",wr),this.registerEffectType("radialGradient",Er),this.registerEffectType("grayscale",Sr),this.registerEffectType("glitch",Ht),this.registerEffectType("radius",vt),this.registerEffectType("radialProgress",Et),this.registerEffectType("holePunch",Ct)}registerShaderType(t,e){this.shConstructors[t]=e}registerEffectType(t,e){this.effectConstructors[t]=e}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(t,e){if(!this.renderer)throw new Error("Renderer is not been defined");const r=this.shConstructors[t];if(!r)throw new Error(`Shader type "${t}" is not registered`);if(this.renderer.mode==="canvas"&&r.prototype instanceof ot)return this._createShaderCtr(t,new zr(t),e);if(t==="DynamicShader")return this.loadDynamicShader(e);const i=r.resolveDefaults(e),n=r.makeCacheKey(i)||r.name;if(n&&this.shCache.has(n))return this._createShaderCtr(t,this.shCache.get(n),i);const o=new r(this.renderer,e);return n&&this.shCache.set(n,o),this._createShaderCtr(t,o,i)}loadDynamicShader(t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=At.resolveDefaults(t,this.effectConstructors),r=At.makeCacheKey(e,this.effectConstructors);if(r&&this.shCache.has(r))return this._createDynShaderCtr(this.shCache.get(r),e);const i=new At(this.renderer,t,this.effectConstructors);return r&&this.shCache.set(r,i),this._createDynShaderCtr(i,e)}_createShaderCtr(t,e,r){return new na(t,e,r,this.renderer.stage)}_createDynShaderCtr(t,e){return new oa(t,e,this)}useShader(t){this.attachedShader!==t&&(this.attachedShader&&this.attachedShader.detach(),t.attach(),this.attachedShader=t)}}class _n{constructor(t){l(this,"config");this.config=t}getBuffer(t){var e;return(e=this.config.find(r=>r.attributes[t]))==null?void 0:e.buffer}getAttributeInfo(t){var e;return(e=this.config.find(r=>r.attributes[t]))==null?void 0:e.attributes[t]}}function la(s){return self.WebGL2RenderingContext&&s instanceof self.WebGL2RenderingContext}class ca{constructor(t){l(this,"gl");l(this,"activeTextureUnit",0);l(this,"texture2dUnits");l(this,"texture2dParams",new WeakMap);l(this,"scissorEnabled");l(this,"scissorX");l(this,"scissorY");l(this,"scissorWidth");l(this,"scissorHeight");l(this,"blendEnabled");l(this,"blendSrcRgb");l(this,"blendDstRgb");l(this,"blendSrcAlpha");l(this,"blendDstAlpha");l(this,"boundArrayBuffer");l(this,"boundElementArrayBuffer");l(this,"curProgram");l(this,"programUniforms",new WeakMap);l(this,"canvas");l(this,"MAX_RENDERBUFFER_SIZE");l(this,"MAX_TEXTURE_SIZE");l(this,"MAX_VIEWPORT_DIMS");l(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");l(this,"MAX_TEXTURE_IMAGE_UNITS");l(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");l(this,"MAX_VERTEX_ATTRIBS");l(this,"MAX_VARYING_VECTORS");l(this,"MAX_VERTEX_UNIFORM_VECTORS");l(this,"MAX_FRAGMENT_UNIFORM_VECTORS");l(this,"TEXTURE_MAG_FILTER");l(this,"TEXTURE_MIN_FILTER");l(this,"TEXTURE_WRAP_S");l(this,"TEXTURE_WRAP_T");l(this,"LINEAR");l(this,"CLAMP_TO_EDGE");l(this,"RGBA");l(this,"UNSIGNED_BYTE");l(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");l(this,"UNPACK_FLIP_Y_WEBGL");l(this,"FLOAT");l(this,"TRIANGLES");l(this,"UNSIGNED_SHORT");l(this,"ONE");l(this,"ONE_MINUS_SRC_ALPHA");l(this,"VERTEX_SHADER");l(this,"FRAGMENT_SHADER");l(this,"STATIC_DRAW");l(this,"COMPILE_STATUS");l(this,"LINK_STATUS");l(this,"DYNAMIC_DRAW");l(this,"COLOR_ATTACHMENT0");this.gl=t,this.activeTextureUnit=t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0;const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(e).fill(void 0).map((i,n)=>(this.activeTexture(n),t.getParameter(t.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=t.isEnabled(t.SCISSOR_TEST);const r=t.getParameter(t.SCISSOR_BOX);this.scissorX=r[0],this.scissorY=r[1],this.scissorWidth=r[2],this.scissorHeight=r[3],this.blendEnabled=t.isEnabled(t.BLEND),this.blendSrcRgb=t.getParameter(t.BLEND_SRC_RGB),this.blendDstRgb=t.getParameter(t.BLEND_DST_RGB),this.blendSrcAlpha=t.getParameter(t.BLEND_SRC_ALPHA),this.blendDstAlpha=t.getParameter(t.BLEND_DST_ALPHA),this.boundArrayBuffer=t.getParameter(t.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=t.getParameter(t.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=t.getParameter(t.CURRENT_PROGRAM),this.canvas=t.canvas,this.MAX_RENDERBUFFER_SIZE=t.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=t.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=t.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=t.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=t.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=t.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=t.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=t.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=t.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=t.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=t.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=t.TEXTURE_WRAP_T,this.LINEAR=t.LINEAR,this.CLAMP_TO_EDGE=t.CLAMP_TO_EDGE,this.RGBA=t.RGBA,this.UNSIGNED_BYTE=t.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=t.UNPACK_FLIP_Y_WEBGL,this.FLOAT=t.FLOAT,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.ONE=t.ONE,this.ONE_MINUS_SRC_ALPHA=t.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.VERTEX_SHADER=t.VERTEX_SHADER,this.FRAGMENT_SHADER=t.FRAGMENT_SHADER,this.STATIC_DRAW=t.STATIC_DRAW,this.COMPILE_STATUS=t.COMPILE_STATUS,this.LINK_STATUS=t.LINK_STATUS,this.DYNAMIC_DRAW=t.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=t.COLOR_ATTACHMENT0}isWebGl2(){return la(this.gl)}activeTexture(t){const{gl:e}=this;this.activeTextureUnit!==t&&(e.activeTexture(t+e.TEXTURE0),this.activeTextureUnit=t)}bindTexture(t){const{gl:e,activeTextureUnit:r,texture2dUnits:i}=this;i[r]!==t&&(i[r]=t,e.bindTexture(this.gl.TEXTURE_2D,t))}_getActiveTexture(){const{activeTextureUnit:t,texture2dUnits:e}=this;return e[t]}texParameteri(t,e){const{gl:r,texture2dParams:i}=this,n=this._getActiveTexture();if(!n)throw new Error("No active texture");let o=i.get(n);o||(o={},i.set(n,o)),o[t]!==e&&(o[t]=e,r.texParameteri(r.TEXTURE_2D,t,e))}texImage2D(t,e,r,i,n,o,a,c){const{gl:h}=this;o?h.texImage2D(h.TEXTURE_2D,t,e,r,i,n,o,a,c):h.texImage2D(h.TEXTURE_2D,t,e,r,i,n)}compressedTexImage2D(t,e,r,i,n,o){const{gl:a}=this;a.compressedTexImage2D(a.TEXTURE_2D,t,e,r,i,n,o)}pixelStorei(t,e){const{gl:r}=this;r.pixelStorei(t,e)}generateMipmap(){const{gl:t}=this;t.generateMipmap(t.TEXTURE_2D)}createTexture(){const{gl:t}=this;return t.createTexture()}deleteTexture(t){const{gl:e}=this;t&&this.texture2dParams.delete(t),e.deleteTexture(t)}viewport(t,e,r,i){const{gl:n}=this;n.viewport(t,e,r,i)}clearColor(t,e,r,i){const{gl:n}=this;n.clearColor(t,e,r,i)}setScissorTest(t){const{gl:e,scissorEnabled:r}=this;t!==r&&(t?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),this.scissorEnabled=t)}scissor(t,e,r,i){const{gl:n,scissorX:o,scissorY:a,scissorWidth:c,scissorHeight:h}=this;(t!==o||e!==a||r!==c||i!==h)&&(n.scissor(t,e,r,i),this.scissorX=t,this.scissorY=e,this.scissorWidth=r,this.scissorHeight=i)}setBlend(t){const{gl:e,blendEnabled:r}=this;t!==r&&(t?e.enable(e.BLEND):e.disable(e.BLEND),this.blendEnabled=t)}blendFunc(t,e){const{gl:r,blendSrcRgb:i,blendDstRgb:n,blendSrcAlpha:o,blendDstAlpha:a}=this;(t!==i||e!==n||t!==o||e!==a)&&(r.blendFunc(t,e),this.blendSrcRgb=t,this.blendDstRgb=e,this.blendSrcAlpha=t,this.blendDstAlpha=e)}createBuffer(){const{gl:t}=this;return t.createBuffer()}createFramebuffer(){const{gl:t}=this;return t.createFramebuffer()}bindFramebuffer(t){const{gl:e}=this;e.bindFramebuffer(e.FRAMEBUFFER,t)}framebufferTexture2D(t,e,r){const{gl:i}=this;i.framebufferTexture2D(i.FRAMEBUFFER,t,i.TEXTURE_2D,e,r)}clear(){const{gl:t}=this;t.clear(t.COLOR_BUFFER_BIT)}arrayBufferData(t,e,r){const{gl:i,boundArrayBuffer:n}=this;n!==t&&(i.bindBuffer(i.ARRAY_BUFFER,t),this.boundArrayBuffer=t),i.bufferData(i.ARRAY_BUFFER,e,r)}elementArrayBufferData(t,e,r){const{gl:i,boundElementArrayBuffer:n}=this;n!==t&&(i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),this.boundElementArrayBuffer=t),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e,r)}vertexAttribPointer(t,e,r,i,n,o,a){const{gl:c,boundArrayBuffer:h}=this;h!==t&&(c.bindBuffer(c.ARRAY_BUFFER,t),this.boundArrayBuffer=t),c.vertexAttribPointer(e,r,i,n,o,a)}useProgram(t){const{gl:e,curProgram:r}=this;r!==t&&(e.useProgram(t),this.curProgram=t)}setUniform(t,e,...r){const{gl:i,programUniforms:n}=this;let o=n.get(this.curProgram);o||(o=new Map,n.set(this.curProgram,o));const a=o.get(e);(!a||!ha(a,r))&&(o.set(e,r),i[t](e,...r))}getParameter(t){const{gl:e}=this;return e.getParameter(t)}drawElements(t,e,r,i){const{gl:n}=this;n.drawElements(t,e,r,i)}getExtension(t){const{gl:e}=this;return e.getExtension(t)}createVertexArray(){const{gl:t}=this;return U(t instanceof WebGL2RenderingContext),t.createVertexArray()}bindVertexArray(t){const{gl:e}=this;U(e instanceof WebGL2RenderingContext),e.bindVertexArray(t)}getAttribLocation(t,e){const{gl:r}=this;return r.getAttribLocation(t,e)}getUniformLocation(t,e){const{gl:r}=this;return r.getUniformLocation(t,e)}enableVertexAttribArray(t){const{gl:e}=this;e.enableVertexAttribArray(t)}disableVertexAttribArray(t){const{gl:e}=this;e.disableVertexAttribArray(t)}createShader(t){const{gl:e}=this;return e.createShader(t)}compileShader(t){const{gl:e}=this;e.compileShader(t)}attachShader(t,e){const{gl:r}=this;r.attachShader(t,e)}linkProgram(t){const{gl:e}=this;e.linkProgram(t)}deleteProgram(t){const{gl:e}=this;e.deleteProgram(t)}getShaderParameter(t,e){const{gl:r}=this;return r.getShaderParameter(t,e)}getShaderInfoLog(t){const{gl:e}=this;return e.getShaderInfoLog(t)}createProgram(){const{gl:t}=this;return t.createProgram()}getProgramParameter(t,e){const{gl:r}=this;return r.getProgramParameter(t,e)}getProgramInfoLog(t){const{gl:e}=this;return e.getProgramInfoLog(t)}shaderSource(t,e){const{gl:r}=this;r.shaderSource(t,e)}deleteShader(t){const{gl:e}=this;e.deleteShader(t)}}function ha(s,t){return s.length!==t.length?!1:s.every((e,r)=>Array.isArray(e)||e instanceof Float32Array?!1:e===t[r])}const qs=class qs extends Nt{constructor(e,r){super(e);l(this,"props");this.props=qs.resolveDefaults(r||{})}get width(){return this.props.width}set width(e){this.props.width=e}get height(){return this.props.height}set height(e){this.props.height=e}async getTextureData(){return{data:null,premultiplyAlpha:null}}static resolveDefaults(e){return{width:e.width||256,height:e.height||256}}};l(qs,"z$__type__Props");let ss=qs;class vi extends Hs{constructor(e,r,i){super(e,r,i);l(this,"framebuffer");const n=e.createFramebuffer();U(n,"Unable to create framebuffer"),this.framebuffer=n}async onLoadRequest(){const{glw:e}=this,r=this._nativeCtxTexture=this.createNativeCtxTexture(),{width:i,height:n}=this.textureSource;return e.texImage2D(0,e.RGBA,i,n,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(i*n*4),e.bindFramebuffer(this.framebuffer),e.framebufferTexture2D(e.COLOR_ATTACHMENT0,r,0),e.bindFramebuffer(null),{width:i,height:n}}}function fa(s){return/\.(ktx|pvr)$/.test(s)}const ua=async s=>{const e=await(await fetch(s)).arrayBuffer();return s.indexOf(".ktx")!==-1?da(e):pa(e)},da=async s=>{const t=new DataView(s),e=t.getUint32(12)===16909060,r=[],i={glInternalFormat:t.getUint32(28,e),pixelWidth:t.getUint32(36,e),pixelHeight:t.getUint32(40,e),numberOfMipmapLevels:t.getUint32(56,e),bytesOfKeyValueData:t.getUint32(60,e)};let n=64;n+=i.bytesOfKeyValueData;for(let o=0;o<i.numberOfMipmapLevels;o++){const a=t.getUint32(n);n+=4,r.push(t.buffer.slice(n,a)),n+=a}return{data:{glInternalFormat:i.glInternalFormat,mipmaps:r,width:i.pixelWidth||0,height:i.pixelHeight||0,type:"ktx"},premultiplyAlpha:!1}},pa=async s=>{const a=s,c=new Int32Array(a,0,13),h=c[12]+52,f=new Uint8Array(a,h),u=[],g={pixelWidth:c[7],pixelHeight:c[6],numberOfMipmapLevels:c[11]||0};let _=0,m=g.pixelWidth||0,x=g.pixelHeight||0;for(let v=0;v<g.numberOfMipmapLevels;v++){const b=(m+3>>2)*(x+3>>2)*8,M=new Uint8Array(a,f.byteOffset+_,b);u.push(M),_+=b,m=m>>1,x=x>>1}return{data:{glInternalFormat:36196,mipmaps:u,width:g.pixelWidth||0,height:g.pixelHeight||0,type:"pvr"},premultiplyAlpha:!1}},es=class es extends Nt{constructor(e,r){super(e);l(this,"props");this.props=es.resolveDefaults(r)}hasAlphaChannel(e){return e.indexOf("image/png")!==-1}async getTextureData(){const{src:e,premultiplyAlpha:r}=this.props;if(!e)return{data:null};if(typeof e!="string")return e instanceof ImageData?{data:e,premultiplyAlpha:r}:{data:e(),premultiplyAlpha:r};if(fa(e))return ua(e);const i=Do(e);if(this.txManager.imageWorkerManager)return await this.txManager.imageWorkerManager.getImage(i,r);if(this.txManager.hasCreateImageBitmap){const o=await(await fetch(i)).blob(),a=r??this.hasAlphaChannel(o.type);return{data:await createImageBitmap(o,{premultiplyAlpha:a?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:a}}else{const n=new Image;return e.substr(0,5)!=="data:"&&(n.crossOrigin="Anonymous"),n.src=i,await new Promise((o,a)=>{n.onload=()=>o(),n.onerror=()=>a(new Error("Failed to load image"))}).catch(o=>{console.error(o)}),{data:n,premultiplyAlpha:r??!0}}}static makeCacheKey(e){const r=es.resolveDefaults(e),i=r.key||r.src;return typeof i!="string"?!1:`ImageTexture,${i},${r.premultiplyAlpha??"true"}`}static resolveDefaults(e){return{src:e.src??"",premultiplyAlpha:e.premultiplyAlpha??!0,key:e.key??null}}};l(es,"z$__type__Props");let Gs=es;const ga=24;class Hr extends hn{constructor(e){super(e);l(this,"glw");l(this,"system");l(this,"quadBuffer");l(this,"fQuadBuffer");l(this,"uiQuadBuffer");l(this,"renderOps",[]);l(this,"curBufferIdx",0);l(this,"curRenderOp",null);l(this,"rttNodes",[]);l(this,"activeRttNode",null);l(this,"defShaderCtrl");l(this,"defaultShader");l(this,"quadBufferCollection");l(this,"defaultTexture");l(this,"quadBufferUsage",0);l(this,"renderToTextureActive",!1);this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";const{canvas:r,clearColor:i,bufferMemory:n}=e;this.defaultTexture=new Ws(this.txManager),this.defaultTexture.setRenderableOwner(this,!0),this.defaultTexture.once("loaded",()=>{this.stage.requestRender()});const o=Co(r,e.contextSpy),a=this.glw=new ca(o),c=cs(i);a.viewport(0,0,r.width,r.height),a.clearColor(c[0],c[1],c[2],c[3]),a.setBlend(!0),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),Zo(a,n),this.system={parameters:qo(this.glw),extensions:Qo(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const h=a.createBuffer();U(h);const f=6*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new _n([{buffer:h,attributes:{a_position:{name:"a_position",size:2,type:a.FLOAT,normalized:!1,stride:f,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:a.FLOAT,normalized:!1,stride:f,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:a.UNSIGNED_BYTE,normalized:!0,stride:f,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:a.FLOAT,normalized:!1,stride:f,offset:5*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:e}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,e.setScissorTest(!1),e.clear()}getShaderManager(){return this.shManager}createCtxTexture(e){return e instanceof Lt?new ea(this.glw,this.txMemManager,e):e instanceof ss?new vi(this.glw,this.txMemManager,e):new Hs(this.glw,this.txMemManager,e)}addQuad(e){const{fQuadBuffer:r,uiQuadBuffer:i}=this,{width:n,height:o,colorTl:a,colorTr:c,colorBl:h,colorBr:f,textureOptions:u,shader:g,shaderProps:_,alpha:m,clippingRect:x,tx:v,ty:b,ta:M,tb:I,tc:S,td:L,renderCoords:A,rtt:B,parentHasRenderTexture:V,framebufferDimensions:Y}=e;let{texture:G}=e;if(_&&Tr(_,"$dimensions")){const ye=_.$dimensions;ye.width=n,ye.height=o}G=G??this.defaultTexture,U(G instanceof Nt,"Invalid texture type");let{curBufferIdx:T,curRenderOp:J}=this;const te={width:n,height:o},ee=g||this.defaultShader;U(ee instanceof ot),this.reuseRenderOp(e)||(this.newRenderOp(ee,_,m,te,x,T,B,V,Y),J=this.curRenderOp,U(J));const W=(u==null?void 0:u.flipX)??!1;let z=(u==null?void 0:u.flipY)??!1;G instanceof ss&&(z=!z);let k=0,X=0,ne=1,oe=1;if(G instanceof Lt){const{x:ye,y:Te,width:he,height:fe}=G.props,{width:se=0,height:ve=0}=G.parentTexture.dimensions||{width:0,height:0};k=ye/se,ne=k+he/se,X=Te/ve,oe=X+fe/ve,G=G.parentTexture}const pe=(u==null?void 0:u.resizeMode)??!1;if(G instanceof Gs&&pe&&G.dimensions){const{width:ye,height:Te}=G.dimensions;if(pe.type==="cover"){const he=n/ye,fe=o/Te,se=Math.max(he,fe),ve=1/se;if(se&&he&&he<se){const ge=ve*n;k=(1-ge/ye)*(pe.clipX??.5),ne=k+ge/ye}if(se&&fe&&fe<se){const ge=ve*o;X=(1-ge/Te)*(pe.clipY??.5),oe=X+ge/Te}}}W&&([k,ne]=[ne,k]),z&&([X,oe]=[oe,X]);const le=G.ctxTexture;U(le instanceof Hs);const _e=this.addTexture(le,T);if(J=this.curRenderOp,U(J),A){const{x1:ye,y1:Te,x2:he,y2:fe,x3:se,y3:ve,x4:ge,y4:Ce}=A;r[T++]=ye,r[T++]=Te,r[T++]=k,r[T++]=X,i[T++]=a,r[T++]=_e,r[T++]=he,r[T++]=fe,r[T++]=ne,r[T++]=X,i[T++]=c,r[T++]=_e,r[T++]=ge,r[T++]=Ce,r[T++]=k,r[T++]=oe,i[T++]=h,r[T++]=_e,r[T++]=se,r[T++]=ve,r[T++]=ne,r[T++]=oe,i[T++]=f,r[T++]=_e}else if(I!==0||S!==0)r[T++]=v,r[T++]=b,r[T++]=k,r[T++]=X,i[T++]=a,r[T++]=_e,r[T++]=v+n*M,r[T++]=b+n*S,r[T++]=ne,r[T++]=X,i[T++]=c,r[T++]=_e,r[T++]=v+o*I,r[T++]=b+o*L,r[T++]=k,r[T++]=oe,i[T++]=h,r[T++]=_e,r[T++]=v+n*M+o*I,r[T++]=b+n*S+o*L,r[T++]=ne,r[T++]=oe,i[T++]=f,r[T++]=_e;else{const ye=v+n*M,Te=b+o*L;r[T++]=v,r[T++]=b,r[T++]=k,r[T++]=X,i[T++]=a,r[T++]=_e,r[T++]=ye,r[T++]=b,r[T++]=ne,r[T++]=X,i[T++]=c,r[T++]=_e,r[T++]=v,r[T++]=Te,r[T++]=k,r[T++]=oe,i[T++]=h,r[T++]=_e,r[T++]=ye,r[T++]=Te,r[T++]=ne,r[T++]=oe,i[T++]=f,r[T++]=_e}J.length+=ga,J.numQuads++,this.curBufferIdx=T}newRenderOp(e,r,i,n,o,a,c,h,f){const u=new un(this.glw,this.options,this.quadBufferCollection,e,r,i,o,n,a,0,c,h,f);this.curRenderOp=u,this.renderOps.push(u)}addTexture(e,r,i){const{curRenderOp:n}=this;U(n);const o=n.addTexture(e);if(o===4294967295){if(i)throw new Error("Unable to add texture to render op");const{shader:a,shaderProps:c,dimensions:h,clippingRect:f,alpha:u}=n;return this.newRenderOp(a,c,u,h,f,r),this.addTexture(e,r,!0)}return o}reuseRenderOp(e){var h;const{shader:r,shaderProps:i,parentHasRenderTexture:n,rtt:o,clippingRect:a}=e,c=r||this.defaultShader;return!(((h=this.curRenderOp)==null?void 0:h.shader)!==c||!No(this.curRenderOp.clippingRect,a)||n||o||this.curRenderOp.shader!==this.defaultShader&&(!i||!this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,i)))}addRenderOp(e){this.renderOps.push(e),this.curRenderOp=null}render(e="screen"){const{glw:r,quadBuffer:i}=this,n=new Float32Array(i,0,this.curBufferIdx),o=this.quadBufferCollection.getBuffer("a_position")??null;r.arrayBufferData(o,n,r.STATIC_DRAW),this.renderOps.forEach((a,c)=>{a.draw()}),this.quadBufferUsage=this.curBufferIdx*n.BYTES_PER_ELEMENT}renderToTexture(e){for(let r=0;r<this.rttNodes.length;r++)if(this.rttNodes[r]===e)return;this.rttNodes.unshift(e)}renderRTTNodes(){const{glw:e}=this;this.stage;for(let r=0;r<this.rttNodes.length;r++){const i=this.rttNodes[r];if(!i||!i.hasRTTupdates)continue;this.activeRttNode=i,U(i.texture,"RTT node missing texture");const n=i.texture.ctxTexture;U(n instanceof vi),this.renderToTextureActive=!0,e.bindFramebuffer(n.framebuffer),e.viewport(0,0,n.w,n.h),e.clear();for(let o=0;o<i.children.length;o++){const a=i.children[o];a&&(a.update(this.stage.deltaTime,{x:0,y:0,width:0,height:0,valid:!1}),this.stage.addQuads(a),a.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,i.hasRTTupdates=!1}e.bindFramebuffer(null),e.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(e){const r=this.rttNodes.indexOf(e);r!==-1&&this.rttNodes.splice(r,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}}class ma{constructor(){l(this,"activeAnimations",new Set)}registerAnimation(t){this.activeAnimations.add(t)}unregisterAnimation(t){this.activeAnimations.delete(t)}update(t){this.activeAnimations.forEach(e=>{e.update(t)})}}function xa(){function s(e){return e.indexOf("image/png")!==-1}function t(e,r){return new Promise(function(i,n){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){if(o.status!==200)return n(new Error("Failed to load image: "+o.statusText));var a=o.response,c=r!==void 0?r:s(a.type);createImageBitmap(a,{premultiplyAlpha:c?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}).then(function(h){i({data:h,premultiplyAlpha:r})}).catch(function(h){n(h)})},o.onerror=function(){n(new Error("Network error occurred while trying to fetch the image."))},o.send()})}self.onmessage=e=>{var r=e.data.src,i=e.data.id,n=e.data.premultiplyAlpha;t(r,n).then(function(o){self.postMessage({id:i,src:r,data:o})}).catch(function(o){self.postMessage({id:i,src:r,error:o.message})})}}class _a{constructor(t){l(this,"imageWorkersEnabled",!0);l(this,"messageManager",{});l(this,"workers",[]);l(this,"workerIndex",0);l(this,"nextId",0);this.workers=this.createWorkers(t),this.workers.forEach(e=>{e.onmessage=this.handleMessage.bind(this)})}handleMessage(t){const{id:e,data:r,error:i}=t.data,n=this.messageManager[e];if(n){const[o,a]=n;delete this.messageManager[e],i?a(new Error(i)):o(r)}}createWorkers(t=1){const e=`(${xa.toString()})()`,r=new Blob([e.replace('"use strict";',"")],{type:"application/javascript"}),i=(self.URL?URL:webkitURL).createObjectURL(r),n=[];for(let o=0;o<t;o++)n.push(new Worker(i));return n}getNextWorker(){const t=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,t}getImage(t,e){return new Promise((r,i)=>{try{if(this.workers){const n=this.nextId++;this.messageManager[n]=[r,i];const o=this.getNextWorker();o&&o.postMessage({id:n,src:t,premultiplyAlpha:e})}}catch(n){i(n)}})}}const ts=class ts extends Nt{constructor(e,r){super(e);l(this,"props");this.props=ts.resolveDefaults(r)}async getTextureData(){const{width:e,height:r}=this.props,i=e*r*4,n=new Uint8ClampedArray(i);for(let o=0;o<i;o+=4){const a=Math.floor(Math.random()*256);n[o]=a,n[o+1]=a,n[o+2]=a,n[o+3]=255}return{data:new ImageData(n,e,r)}}static makeCacheKey(e){if(e.cacheId===void 0)return!1;const r=ts.resolveDefaults(e);return`NoiseTexture,${r.width},${r.height},${r.cacheId}`}static resolveDefaults(e){return{width:e.width??128,height:e.height??128,cacheId:e.cacheId??0}}};l(ts,"z$__type__Props");let Cr=ts;class ya{constructor(t){l(this,"keyCache",new Map);l(this,"inverseKeyCache",new WeakMap);l(this,"txConstructors",{});l(this,"imageWorkerManager",null);l(this,"hasCreateImageBitmap",!!self.createImageBitmap);l(this,"hasWorker",!!self.Worker);l(this,"renderer");l(this,"frameTime",0);this.hasCreateImageBitmap&&this.hasWorker&&t>0&&(this.imageWorkerManager=new _a(t)),this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.registerTextureType("ImageTexture",Gs),this.registerTextureType("ColorTexture",Ws),this.registerTextureType("NoiseTexture",Cr),this.registerTextureType("SubTexture",Lt),this.registerTextureType("RenderTexture",ss)}registerTextureType(t,e){this.txConstructors[t]=e}loadTexture(t,e){let r;const i=this.txConstructors[t];if(!i)throw new Error(`Texture type "${t}" is not registered`);if(!r){const n=i.makeCacheKey(e);n&&this.keyCache.has(n)?r=this.keyCache.get(n):(r=new i(this,e),n&&this.initTextureToCache(r,n))}return r}initTextureToCache(t,e){const{keyCache:r,inverseKeyCache:i}=this;r.set(e,t),i.set(t,e)}removeTextureFromCache(t){const{inverseKeyCache:e,keyCache:r}=this,i=e.get(t);i&&r.delete(i)}}function Ta(s,t){var e=0,r,i;t=t||{};function n(){var o=r,a=arguments.length,c,h;e:for(;o;){if(o.args.length!==arguments.length){o=o.next;continue}for(h=0;h<a;h++)if(o.args[h]!==arguments[h]){o=o.next;continue e}return o!==r&&(o===i&&(i=o.prev),o.prev.next=o.next,o.next&&(o.next.prev=o.prev),o.next=r,o.prev=null,r.prev=o,r=o),o.val}for(c=new Array(a),h=0;h<a;h++)c[h]=arguments[h];return o={args:c,val:s.apply(null,c)},r?(r.prev=o,o.next=r):i=o,e===t.maxSize?(i=i.prev,i.next=null):e++,r=o,o.val}return n.clear=function(){r=null,i=null,e=0},n}const va={normal:400,bold:700,bolder:900,lighter:100},bi=s=>typeof s=="number"?s:va[s]||400;function ba(s,t,e,r,i){let n=bi(e);for(const o of s){const a=o[t];if(!a)continue;if(a.size===1)return console.warn(`TrFontManager: Only one font face found for family: '${t}' - will be used for all weights and styles`),a.values().next().value;const c=new Map;for(const f of a){const u=bi(f.descriptors.weight);if(u===n&&f.descriptors.style===r&&f.descriptors.stretch===i)return f;c.set(u,f)}const h=`TrFontManager: No exact match: '${t} Weight: ${n} Style: ${r} Stretch: ${i}'`;if(console.error(h),n===400&&c.has(500))return c.get(500);if(n===500&&c.has(400))return c.get(400);if(n<400){for(;n>0;){if(c.has(n))return c.get(n);n-=100}n=600}for(;n<1e3;){if(c.has(n))return c.get(n);n+=100}for(n=500;n>0;){if(c.has(n))return c.get(n);n-=100}}}const Ra=Ta(ba);class Wr{constructor(t){l(this,"textRenderers");this.textRenderers=t}addFontFace(t){for(const e in this.textRenderers){const r=this.textRenderers[e];r&&r.isFontFaceSupported(t)&&r.addFontFace(t)}}static resolveFontFace(t,e){const{fontFamily:r,fontWeight:i,fontStyle:n,fontStretch:o}=e;return Ra(t,r,i,n,o)}}const wa={x:(s,t)=>{s.props.x=t},y:(s,t)=>{s.props.y=t},width:(s,t)=>{s.props.width=t},height:(s,t)=>{s.props.height=t},color:(s,t)=>{s.props.color=t},zIndex:(s,t)=>{s.props.zIndex=t},fontFamily:(s,t)=>{s.props.fontFamily=t},fontWeight:(s,t)=>{s.props.fontWeight=t},fontStyle:(s,t)=>{s.props.fontStyle=t},fontStretch:(s,t)=>{s.props.fontStretch=t},fontSize:(s,t)=>{s.props.fontSize=t},text:(s,t)=>{s.props.text=t},textAlign:(s,t)=>{s.props.textAlign=t},contain:(s,t)=>{s.props.contain=t},offsetY:(s,t)=>{s.props.offsetY=t},scrollable:(s,t)=>{s.props.scrollable=t},scrollY:(s,t)=>{s.props.scrollY=t},letterSpacing:(s,t)=>{s.props.letterSpacing=t},lineHeight:(s,t)=>{s.props.lineHeight=t},maxLines:(s,t)=>{s.props.maxLines=t},textBaseline:(s,t)=>{s.props.textBaseline=t},verticalAlign:(s,t)=>{s.props.verticalAlign=t},overflowSuffix:(s,t)=>{s.props.overflowSuffix=t},debug:(s,t)=>{s.props.debug=t}};class yn{constructor(t){l(this,"stage");l(this,"set");this.stage=t;const e={...wa,...this.getPropertySetters()};this.set=Object.freeze(Object.fromEntries(Object.entries(e).map(([r,i])=>[r,(n,o)=>{n.props[r]!==o&&(i(n,o),this.stage.requestRender())}])))}setStatus(t,e,r){t.status!==e&&(t.status=e,t.emitter.emit(e,r))}setIsRenderable(t,e){t.isRenderable=e}destroyState(t){this.setStatus(t,"destroyed"),t.emitter.removeAllListeners()}scheduleUpdateState(t){t.updateScheduled||(t.updateScheduled=!0,queueMicrotask(()=>{t.status!=="destroyed"&&(t.updateScheduled=!1,this.updateState(t))}))}}class Tn extends nt{constructor(e){super();l(this,"fontFamily");l(this,"descriptors");l(this,"loaded",!1);l(this,"metrics",null);const{fontFamily:r,descriptors:i,metrics:n}=e;n&&(this.metrics={ascender:n.ascender/n.unitsPerEm,descender:n.descender/n.unitsPerEm,lineGap:n.lineGap/n.unitsPerEm}),this.fontFamily=r,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...i}}static convertToCssFontFaceDescriptors(e){return{style:e.style,weight:typeof e.weight=="number"?`${e.weight}`:e.weight,stretch:e.stretch,unicodeRange:e.unicodeRange,featureSettings:e.featureSettings,display:e.display}}}const Sa={LINE_FEED:10,CARRIAGE_RETURN:13,SPACE:32,TAB:9,ZERO_WIDTH_SPACE:8203,ZERO_WIDTH_NON_JOINER:8204,ZERO_WIDTH_JOINER:8205,LEFT_TO_RIGHT_MARK:8206,RIGHT_TO_LEFT_MARK:8207,LEFT_TO_RIGHT_EMBEDDING:8234,RIGHT_TO_LEFT_EMBEDDING:8235,POP_DIRECTIONAL_FORMATTING:8236,LEFT_TO_RIGHT_OVERRIDE:8237,RIGHT_TO_LEFT_OVERRIDE:8238,LINE_SEPARATOR:8232,PARAGRAPH_SEPARATOR:8233,OBJECT_REPLACEMENT_CHARACTER:65532,REPLACEMENT_CHARACTER:65533,ZERO_WIDTH_NO_BREAK_SPACE:65279,LEFT_TO_RIGHT_ISOLATE:8294,RIGHT_TO_LEFT_ISOLATE:8295,FIRST_STRONG_ISOLATE:8296,POP_DIRECTIONAL_ISOLATE:8297,INHIBIT_SYMMETRIC_SWAPPING:8298,ACTIVATE_SYMMETRIC_SWAPPING:8299,INHIBIT_ARABIC_FORM_SHAPING:8300,ACTIVATE_ARABIC_FORM_SHAPING:8301,NATIONAL_DIGIT_SHAPES:8302,NOMINAL_DIGIT_SHAPES:8303,LEFT_TO_RIGHT_BOUNDARY:8206,RIGHT_TO_LEFT_BOUNDARY:8207};class Ea{}class Ca extends Ea{constructor(e,r){super();l(this,"data");l(this,"glyphMap");l(this,"kernings");this.data=e,this.glyphMap=r;const i=this.kernings={};e.kernings.forEach(n=>{const o=n.second,a=i[o]=i[o]||{};a[n.first]=n.amount}),this.kernings=i}*shapeText(e,r){var o;let i,n;for(;(i=r.peek())&&!i.done;){const a=i.value,c=this.glyphMap.get(a);if(r.next(),c!==void 0){const h=n!==void 0?(((o=this.kernings[c.id])==null?void 0:o[n])||0)+e.letterSpacing:0;n=c.id,yield{mapped:!0,glyphId:c.id,codepoint:a,cluster:r.lastIndex,xAdvance:c.xadvance+h,yAdvance:0,xOffset:c.xoffset+h,yOffset:c.yoffset,xBearing:0,yBearing:0,width:c.width,height:c.height}}else a===Sa.LINE_FEED&&(n=void 0),yield{mapped:!1,codepoint:a,cluster:r.lastIndex}}}}class Xt extends Tn{constructor(e,r){super(r);l(this,"type");l(this,"texture");l(this,"maxCharHeight",0);l(this,"data");l(this,"shaper");l(this,"glyphMap",new Map);const{atlasUrl:i,atlasDataUrl:n,stage:o}=r;this.type=e;const a=o.renderer;U(a instanceof Hr,"SDF Font Faces can only be used with the WebGL Renderer"),this.texture=o.txManager.loadTexture("ImageTexture",{src:i,premultiplyAlpha:!1}),this.texture.on("loaded",()=>{this.checkLoaded(),o.requestRender()}),this.texture.ctxTexture.load(),fetch(n).then(async c=>{var f;this.data=await c.json(),U(this.data);let h=0;if(this.data.chars.forEach(u=>{this.glyphMap.set(u.id,u);const g=u.yoffset+u.height;g>h&&(h=g)}),this.maxCharHeight=h,this.shaper=new Ca(this.data,this.glyphMap),!this.metrics)if((f=this.data)!=null&&f.lightningMetrics){const{ascender:u,descender:g,lineGap:_,unitsPerEm:m}=this.data.lightningMetrics;this.metrics={ascender:u/m,descender:g/m,lineGap:_/m}}else throw new Error(`Font metrics not found in ${this.type} font ${this.fontFamily}. Make sure you are using the latest version of the Lightning 3 \`msdf-generator\` tool to generate your SDF fonts.`);this.checkLoaded()}).catch(console.error)}getAtlasEntry(e){const r=this.glyphMap.get(e);if(r===void 0)throw new Error(`Glyph ${e} not found in font ${this.fontFamily}`);return{x:r.x,y:r.y,width:r.width,height:r.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}const Aa=24;function Ma(s,t,e,r,i,n,o,a,c){const h=Math.min(Math.max(o.firstLineIdx,0),a.length),f=0,{metrics:u}=e;U(u,"Font metrics not loaded"),U(e.data,"Font data not loaded");const g=(u.ascender-u.descender)*s;let _=0;r==="middle"?_=(t-g)/2:r==="bottom"&&(_=t-g);const m=i/n,x=e.data.common.base,b=u.ascender*s-x,M=m+b+h*t+_;if(!(c&&M>=c/n))return{sdfX:f,sdfY:M,lineIndex:h}}class Wt{constructor(t,e=0){l(this,"iterator");l(this,"peekBuffer",[]);l(this,"_lastIndex");this.iterator=t,this.iterator=t,this._lastIndex=e-1,this.peekBuffer=[]}next(){const t=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return t.done?this._lastIndex=-1:this._lastIndex++,t}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const t=this.iterator.next();return this.peekBuffer.push(t),t}get lastIndex(){return this._lastIndex}}function*Gt(s,t=0){let e=t;for(;e<s.length;){const r=s.codePointAt(e);if(r===void 0)throw new Error("Invalid Unicode code point");yield r,e+=r<=65535?1:2}}function Ia(s,t,e){const r=e.shapeText(t,new Wt(Gt(s,0),0));let i=0;for(const n of r)n.mapped&&(i+=n.xAdvance);return i}function Pa(s,t,e,r,i,n,o,a,c,h,f,u,g,_,m,x,v,b,M){U(m,"Font face must be loaded"),U(m.loaded,"Font face must be loaded"),U(m.data,"Font face must be loaded"),U(m.shaper,"Font face must be loaded");const I=a/m.data.info.size,S=c/I,L=n/I,A=h/I,B=g[s],V=(B==null?void 0:B.codepointIndex)||0,Y=(B==null?void 0:B.maxX)||0,G=(B==null?void 0:B.maxY)||0;let T=Y,J=G,te=t,ee=e,W=0;const z={codepointIndex:-1,bufferOffset:-1,xStart:-1},k=m.shaper,X={letterSpacing:A};let ne=k.shapeText(X,new Wt(Gt(r,V),V)),oe,pe=-1;const le=[],_e=o/I,ye=Ia(b,X,k);let Te=!0;for(;Te;){const he=(M===0||s+1<M)&&(u!=="both"||v||ee+S+m.maxCharHeight<=_e),fe=he?L:L-ye;let se=0;const ve=ee+m.maxCharHeight>=_.y1,ge=ee<=_.y2,Ce=ve&&ge;for(;(oe=ne.next())&&!oe.done;){const ue=oe.value;if(s===g.length)g.push({codepointIndex:ue.cluster,maxY:J,maxX:T});else if(s>g.length)throw new Error("Unexpected lineCache length");if(ue.codepoint===32||ue.codepoint===10?z.codepointIndex!==-1&&(z.codepointIndex=-1,se=te):z.codepointIndex===-1&&(z.codepointIndex=ue.cluster,z.bufferOffset=W,z.xStart=se),ue.mapped){const d=te+ue.xOffset+ue.width;if(u!=="none"&&d>=fe&&z.codepointIndex!==-1&&z.xStart>0)if(he){ne=k.shapeText(X,new Wt(Gt(r,z.codepointIndex),z.codepointIndex)),W=z.bufferOffset;break}else ne=k.shapeText(X,new Wt(Gt(b,0),0)),te=z.xStart,W=z.bufferOffset,u="none";else{const p=te+ue.xOffset,y=ee+ue.yOffset;if(Ce){pe===-1&&(pe=W);const w=m.getAtlasEntry(ue.glyphId),R=w.x/m.data.common.scaleW,E=w.y/m.data.common.scaleH,N=w.width/m.data.common.scaleW,F=w.height/m.data.common.scaleH;f[W++]=p,f[W++]=y,f[W++]=R,f[W++]=E,f[W++]=p+ue.width,f[W++]=y,f[W++]=R+N,f[W++]=E,f[W++]=p,f[W++]=y+ue.height,f[W++]=R,f[W++]=E+F,f[W++]=p+ue.width,f[W++]=y+ue.height,f[W++]=R+N,f[W++]=E+F}J=Math.max(J,y+ue.height),T=Math.max(T,p+ue.width),te+=ue.xAdvance}}else if(ue.codepoint===10){if(he)break;ne=k.shapeText(X,new Wt(Gt(b,0),0)),u="none"}}pe!==-1&&(le.push({bufferStart:pe,bufferEnd:W}),pe=-1),te=0,ee+=S,s++,z.codepointIndex=-1,se=0,!x&&u==="both"&&ee>_.y2||oe&&oe.done?Te=!1:he||(Te=!1)}if(i==="center"){const he=u==="none"?T:L;for(let fe=0;fe<le.length;fe++){const se=le[fe],ve=f[se.bufferEnd-4]-f[se.bufferStart],ge=(he-ve)/2;for(let Ce=se.bufferStart;Ce<se.bufferEnd;Ce+=4)f[Ce]+=ge}}else if(i==="right"){const he=u==="none"?T:L;for(let fe=0;fe<le.length;fe++){const se=le[fe],ve=se.bufferEnd===se.bufferStart?0:f[se.bufferEnd-4]-f[se.bufferStart],ge=he-ve;for(let Ce=se.bufferStart;Ce<se.bufferEnd;Ce+=4)f[Ce]+=ge}}return U(oe),{bufferNumFloats:W,bufferNumQuads:W/16,layoutNumCharacters:oe.done?r.length-V:oe.value.cluster-V+1,fullyProcessed:!!oe.done,maxX:T,maxY:J,numLines:g.length}}function La(s,t){return Math.ceil(s/t)*t}function Fa(s,t){return Math.floor(s/t)*t}function Oa(s,t,e,r,i,n,o,a){const{screen:c,sdf:h}=s;if(!Uo(o))c.x1=0,c.y1=0,c.x2=0,c.y2=0,h.x1=0,h.y1=0,h.x2=0,h.y2=0,s.numLines=0,s.firstLineIdx=0;else{const f=o.x1-t,u=f+(o.x2-o.x1),g=o.y1-e+r,_=Fa(g-n,i||1),m=La(g+(o.y2-o.y1)+n,i||1);c.x1=f,c.y1=_,c.x2=u,c.y2=m,h.x1=f/a,h.y1=_/a,h.x2=u/a,h.y2=m/a,s.numLines=Math.ceil((m-_)/i),s.firstLineIdx=i?Math.floor(_/i):0}s.valid=!0}function vn(s,t){return t*(s.ascender-s.descender+s.lineGap)}const Ba={x:0,y:0,width:0,height:0};class Na extends yn{constructor(e){super(e);l(this,"ssdfFontFamilies",{});l(this,"msdfFontFamilies",{});l(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);l(this,"sdfShader");l(this,"rendererBounds");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,r)=>{e.props.fontFamily=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,r)=>{e.props.fontWeight=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,r)=>{e.props.fontStyle=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,r)=>{e.props.fontStretch=r,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,r)=>{e.props.fontSize=r,this.invalidateLayoutCache(e)},text:(e,r)=>{e.props.text=r,this.invalidateLayoutCache(e)},textAlign:(e,r)=>{e.props.textAlign=r,this.invalidateLayoutCache(e)},color:(e,r)=>{e.props.color=r},x:(e,r)=>{e.props.x=r,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&or(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,r)=>{e.props.y=r,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&or(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,r)=>{e.props.contain=r,this.invalidateLayoutCache(e)},width:(e,r)=>{e.props.width=r,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,r)=>{e.props.height=r,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,r)=>{e.props.offsetY=r,this.invalidateLayoutCache(e)},scrollable:(e,r)=>{e.props.scrollable=r,this.invalidateLayoutCache(e)},scrollY:(e,r)=>{e.props.scrollY=r,this.scheduleUpdateState(e)},letterSpacing:(e,r)=>{e.props.letterSpacing=r,this.invalidateLayoutCache(e)},lineHeight:(e,r)=>{e.props.lineHeight=r,e.resLineHeight=void 0,this.invalidateLayoutCache(e)},maxLines:(e,r)=>{e.props.maxLines=r,this.invalidateLayoutCache(e)},textBaseline:(e,r)=>{e.props.textBaseline=r,this.invalidateLayoutCache(e)},verticalAlign:(e,r)=>{e.props.verticalAlign=r,this.invalidateLayoutCache(e)},overflowSuffix:(e,r)=>{e.props.overflowSuffix=r,this.invalidateLayoutCache(e)},debug:(e,r)=>{e.props.debug=r}}}canRenderFont(e){const{fontFamily:r}=e;return r in this.ssdfFontFamilies||r in this.msdfFontFamilies||r==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(e){return e instanceof Xt}addFontFace(e){U(e instanceof Xt);const r=e.fontFamily,i=e.type==="ssdf"?this.ssdfFontFamilies:e.type==="msdf"?this.msdfFontFamilies:void 0;if(!i){console.warn(`Invalid font face type: ${e.type}`);return}let n=i[r];n||(n=new Set,i[r]=n),n.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new nt,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:r}=e;const{textH:i,lineCache:n,debugData:o,forceFullLayoutCalc:a}=e;if(o.updateCount++,e.status==="initialState"&&this.setStatus(e,"loading"),!r){if(r=this.resolveFontFace(e.props),e.trFontFace=r,!r){const k=`SdfTextRenderer: Could not resolve font face for family: '${e.props.fontFamily}'`;console.error(k),this.setStatus(e,"failed",new Error(k));return}r.texture.setRenderableOwner(e,!0)}if(!r.loaded){r.once("loaded",()=>{this.scheduleUpdateState(e)});return}U(r.data,"Font face data should be loaded"),U(r.metrics,"Font face metrics should be loaded");const{text:c,fontSize:h,x:f,y:u,contain:g,width:_,height:m,verticalAlign:x,scrollable:v,overflowSuffix:b,maxLines:M}=e.props,I=g==="both"&&v?e.props.scrollY:0,{renderWindow:S}=e,L=r.data.info.size,A=h/L;let B=e.resLineHeight;if(B===void 0){const k=e.props.lineHeight;k===void 0?B=vn(r.metrics,h):B=k,e.resLineHeight=B}const V=B/A;e.distanceRange=A*r.data.distanceField.distanceRange;const Y=c.length*Aa;let G=e.vertexBuffer;(!G||G.length<Y)&&(G=new Float32Array(Y*2));const T=e.elementBounds;if(T.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),T.valid=!0),!a&&S.valid){const k=S.screen;if(f+k.x1<=T.x1&&f+k.x2>=T.x2&&u-I+k.y1<=T.y1&&u-I+k.y2>=T.y2){this.setStatus(e,"loaded");return}S.valid=!1,this.setStatus(e,"loading")}const{offsetY:J,textAlign:te}=e.props;if(!S.valid){if(!or(T,this.rendererBounds))return;Oa(S,f,u,I,B,g==="both"?T.y2-T.y1:0,T,A)}const ee=Ma(L,V,r,x,J,A,S,n,i);if(!ee){this.setStatus(e,"loaded");return}const{letterSpacing:W}=e.props,z=Pa(ee.lineIndex,ee.sdfX,ee.sdfY,c,te,_,m,h,B,W,G,g,n,S.sdf,r,a,v,b,M);e.bufferUploaded=!1,e.bufferNumFloats=z.bufferNumFloats,e.bufferNumQuads=z.bufferNumQuads,e.vertexBuffer=G,e.renderWindow=S,o.lastLayoutNumCharacters=z.layoutNumCharacters,o.bufferSize=G.byteLength,z.fullyProcessed&&(e.textW=z.maxX*A,e.textH=z.numLines*V*A),this.setStatus(e,"loaded")}renderQuads(e,r,i,n,o,a){var T,J;if(!e.vertexBuffer)return;const c=this.stage.renderer;U(c instanceof Hr);const{fontSize:h,color:f,contain:u,scrollable:g,zIndex:_,debug:m}=e.props,x=u==="both"&&g?e.props.scrollY:0,{textW:v=0,textH:b=0,distanceRange:M,vertexBuffer:I,bufferUploaded:S,trFontFace:L,elementBounds:A}=e;let{webGlBuffers:B}=e;if(!B){const te=c.glw,ee=4*Float32Array.BYTES_PER_ELEMENT,W=te.createBuffer();U(W),e.webGlBuffers=new _n([{buffer:W,attributes:{a_position:{name:"a_position",size:2,type:te.FLOAT,normalized:!1,stride:ee,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:te.FLOAT,normalized:!1,stride:ee,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,U(e.webGlBuffers),B=e.webGlBuffers}if(!S){const te=c.glw,ee=(B==null?void 0:B.getBuffer("a_textureCoordinate"))??null;te.arrayBufferData(ee,I,te.STATIC_DRAW),e.bufferUploaded=!0}if(U(L),g&&u==="both"){U(A.valid);const te=Bo(A,Ba);i.valid?(e.clippingRect.valid=!0,i=nn(i,te,e.clippingRect)):(e.clippingRect.valid=!0,i=on(te,e.clippingRect))}const V=new un(c.glw,c.options,B,this.sdfShader,{transform:r.getFloatArr(),color:Ao(f,n),size:h/(((T=L.data)==null?void 0:T.info.size)||0),scrollY:x,distanceRange:M,debug:m.sdfShaderDebug},n,i,{height:b,width:v},0,_,!1,o,a),Y=(J=e.trFontFace)==null?void 0:J.texture;U(Y);const G=Y.ctxTexture;V.addTexture(G),V.length=e.bufferNumFloats,V.numQuads=e.bufferNumQuads,c.addRenderOp(V)}setIsRenderable(e,r){var i;super.setIsRenderable(e,r),(i=e.trFontFace)==null||i.texture.setRenderableOwner(e,r)}destroyState(e){var r;super.destroyState(e),(r=e.trFontFace)==null||r.texture.setRenderableOwner(e,!1)}resolveFontFace(e){return Wr.resolveFontFace(this.fontFamilyArray,e)}releaseFontFace(e){e.resLineHeight=void 0,e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){const{x:r,contain:i,width:n}=e.props,{elementBounds:o}=e;o.x1=r,o.x2=i!=="none"?r+n:1/0}setElementBoundsY(e){const{y:r,contain:i,height:n}=e.props,{elementBounds:o}=e;o.y1=r,o.y2=i==="both"?r+n:1/0}}class cr extends Tn{constructor(e){super(e);l(this,"fontFace");l(this,"fontUrl");const{fontFamily:r,fontUrl:i}=e,n=i.replace(/\(|\)/g,""),o=this.descriptors,a={style:o.style,weight:typeof o.weight=="number"?`${o.weight}`:o.weight,stretch:o.stretch,unicodeRange:o.unicodeRange,featureSettings:o.featureSettings,display:o.display},c=new FontFace(r,`url(${n})`,a);c.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error),this.fontFace=c,this.fontUrl=i}}function Ua(s,t,e){if(t.metrics)return t.metrics;const r=s.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz");console.warn(`Font metrics not provided for Canvas Web font ${t.fontFamily}. Using fallback values. It is HIGHLY recommended you use the latest version of the Lightning 3 \`msdf-generator\` tool to extract the default metrics for the font and provide them in the Canvas Web font definition.`);let i;return r.actualBoundingBoxDescent&&r.actualBoundingBoxAscent?i={ascender:r.actualBoundingBoxAscent/e,descender:-r.actualBoundingBoxDescent/e,lineGap:.2}:i={ascender:.8,descender:-.2,lineGap:.2},t.metrics=i,i}const Ri=2048;function wi(s,t,e,r,i){const n=s!=="bottom"?.5*t:0;return e*(r-1)+n+Math.max(e,t)+(i||0)}class Da{constructor(t,e){l(this,"_canvas");l(this,"_context");l(this,"_settings");this._canvas=t,this._context=e,this._settings=this.mergeDefaults({})}set settings(t){this._settings=this.mergeDefaults(t)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const t=[this._settings.fontFamily],e=[];for(let r=0,i=t.length;r<i;r++)t[r]==="serif"||t[r]==="sans-serif"?e.push(t[r]):e.push(`"${t[r]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${e.join(",")}`}_load(){if(document.fonts){const t=this._getFontSetting();try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch{console.warn("[Lightning] Can't check font loading for "+t)}}}calculateRenderInfo(){const t={},e=this.getPrecision(),r=this._settings.paddingLeft*e,i=this._settings.paddingRight*e,n=this._settings.fontSize*e;let o=this._settings.offsetY===null?null:this._settings.offsetY*e;const a=this._settings.w*e,c=this._settings.h*e;let h=this._settings.wordWrapWidth*e;const f=this._settings.cutSx*e,u=this._settings.cutEx*e,g=this._settings.cutSy*e,_=this._settings.cutEy*e,m=(this._settings.letterSpacing||0)*e,x=this._settings.textIndent*e,v=this._settings.trFontFace;this.setFontProperties(),U(v);const b=Ua(this._context,v,n),M=vn(b,n)*e,I=this._settings.lineHeight!==null?this._settings.lineHeight*e:M,S=this._settings.maxHeight,L=S!==null&&I>0?Math.floor(S/I):0,A=this._settings.maxLines,B=L>0&&A>0?Math.min(L,A):Math.max(L,A);let V=a||2048/this.getPrecision(),Y=V-r;if(Y<10&&(V+=10-Y,Y=10),h||(h=Y),this._settings.textOverflow&&!this._settings.wordWrap){let W;switch(this._settings.textOverflow){case"clip":W="";break;case"ellipsis":W=this._settings.overflowSuffix;break;default:W=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,h-x,W)}let G;if(this._settings.wordWrap)G=this.wrapText(this._settings.text,h,m,x);else{G={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const W=G.l.length;for(let z=0;z<W-1;z++)G.n.push(z)}let T=G.l;if(B&&T.length>B){const W=T.slice(0,B);let z=null;if(this._settings.overflowSuffix){const pe=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,le=this.wrapText(W[W.length-1],h-pe,m,x);W[W.length-1]=`${le.l[0]}${this._settings.overflowSuffix}`,z=[le.l.length>1?le.l[1]:""]}else z=[""];let k;const X=T.length;let ne=0;const oe=G.n.length;for(k=B;k<X;k++)z[ne]+=`${z[ne]?" ":""}${T[k]}`,k+1<oe&&G.n[k+1]&&ne++;t.remainingText=z.join(`
`),t.moreTextLines=!0,T=W}else t.moreTextLines=!1,t.remainingText="";let J=0;const te=[];for(let W=0;W<T.length;W++){const z=this.measureText(T[W],m)+(W===0?x:0);te.push(z),J=Math.max(J,z)}t.lineWidths=te,a||(V=J+r+i,Y=J);let ee;return c?ee=c:ee=wi(this._settings.textBaseline,n,I,T.length,o),o===null&&(o=n),t.w=V,t.h=ee,t.lines=T,t.precision=e,V||(V=1),ee||(ee=1),(f||u)&&(V=Math.min(V,u-f)),(g||_)&&(ee=Math.min(ee,_-g)),t.width=V,t.innerWidth=Y,t.height=ee,t.fontSize=n,t.cutSx=f,t.cutSy=g,t.cutEx=u,t.cutEy=_,t.lineHeight=I,t.defLineHeight=M,t.lineWidths=te,t.offsetY=o,t.paddingLeft=r,t.paddingRight=i,t.letterSpacing=m,t.textIndent=x,t.metrics=b,t}draw(t,e){const r=this.getPrecision(),i=(e==null?void 0:e.lines)||t.lines,n=(e==null?void 0:e.lineWidths)||t.lineWidths,o=e?wi(this._settings.textBaseline,t.fontSize,t.lineHeight,e.lines.length,this._settings.offsetY===null?null:this._settings.offsetY*r):t.height;this._canvas.width=Math.min(Math.ceil(t.width+this._settings.textRenderIssueMargin),Ri),this._canvas.height=Math.min(Math.ceil(o),Ri),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);let a,c;const h=[],{metrics:f}=t,u=f?f.ascender*t.fontSize:t.fontSize,g=(f.ascender-f.descender)*t.fontSize;for(let m=0,x=i.length;m<x;m++)a=m===0?t.textIndent:0,c=m*t.lineHeight+u,this._settings.verticalAlign=="middle"?c+=(t.lineHeight-g)/2:this._settings.verticalAlign=="bottom"&&(c+=t.lineHeight-g),this._settings.textAlign==="right"?a+=t.innerWidth-n[m]:this._settings.textAlign==="center"&&(a+=(t.innerWidth-n[m])/2),a+=t.paddingLeft,h.push({text:i[m],x:a,y:c,w:n[m]});if(this._settings.highlight){const m=this._settings.highlightColor,x=this._settings.highlightHeight*r||t.fontSize*1.5,v=this._settings.highlightOffset*r,b=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*r:t.paddingLeft,M=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*r:t.paddingRight;this._context.fillStyle=nr(m);for(let I=0;I<h.length;I++){const S=h[I];this._context.fillRect(S.x-b,S.y-t.offsetY+v,S.w+M+b,x)}}let _=null;this._settings.shadow&&(_=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=nr(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*r,this._context.shadowOffsetY=this._settings.shadowOffsetY*r,this._context.shadowBlur=this._settings.shadowBlur*r),this._context.fillStyle=nr(this._settings.textColor);for(let m=0,x=h.length;m<x;m++){const v=h[m];if(t.letterSpacing===0)this._context.fillText(v.text,v.x,v.y);else{const b=v.text.split("");let M=v.x;for(let I=0,S=b.length;I<S;I++)this._context.fillText(b[I],M,v.y),M+=this.measureText(b[I],t.letterSpacing)}}_&&(this._context.shadowColor=_[0],this._context.shadowOffsetX=_[1],this._context.shadowOffsetY=_[2],this._context.shadowBlur=_[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy)}wrapWord(t,e,r){const i=this._context.measureText(r).width,n=t.length,o=this._context.measureText(t).width;if(o<=e)return t;let a=Math.floor(e*n/o),c=this._context.measureText(t.substring(0,a)).width+i;if(c>e)for(;a>0&&(c=this._context.measureText(t.substring(0,a)).width+i,c>e);)a-=1;else for(;a<n;)if(c=this._context.measureText(t.substring(0,a)).width+i,c<e)a+=1;else{a-=1;break}return t.substring(0,a)+(e>=i?r:"")}wrapText(t,e,r,i=0){const n=t.split(/\r?\n/g);let o=[];const a=[];for(let c=0;c<n.length;c++){const h=[];let f="",u=e-i;const g=n[c].split(" ");for(let _=0;_<g.length;_++){const m=this.measureText(g[_],r),x=m+this.measureText(" ",r);_===0||x>u?(_>0&&(h.push(f),f=""),f+=g[_],u=e-m-(_===0?i:0)):(u-=x,f+=` ${g[_]}`)}h.push(f),f="",o=o.concat(h),c<n.length-1&&a.push(o.length)}return{l:o,n:a}}measureText(t,e=0){return e?t.split("").reduce((r,i)=>r+this._context.measureText(i).width+e,0):this._context.measureText(t).width}mergeDefaults(t){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFamily:null,trFontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxHeight:null,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...t}}}const Si=typeof self>"u"?globalThis:self;var sn;const Ei=((sn=Si.document)==null?void 0:sn.fonts)||Si.fonts;function ka(s){const{fontFamily:t,fontStyle:e,fontWeight:r,fontStretch:i,fontSize:n}=s;return[e,r,i,`${n}px`,t].join(" ")}class Ci extends yn{constructor(e){super(e);l(this,"canvas");l(this,"context");l(this,"fontFamilies",{});l(this,"fontFamilyArray",[this.fontFamilies]);l(this,"loadFont",e=>{const r=ka(e.props),i=Wr.resolveFontFace(this.fontFamilyArray,e.props);if(U(i,`Could not resolve font face for ${r}`),e.fontInfo={fontFace:i,cssString:r,loaded:!1},!e.fontInfo.loaded){Ei.load(r).then(this.onFontLoaded.bind(this,e,r)).catch(this.onFontLoadError.bind(this,e,r));return}});typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let r=this.canvas.getContext("2d",{willReadFrequently:!0});r||(this.canvas=document.createElement("canvas"),r=this.canvas.getContext("2d",{willReadFrequently:!0})),U(r),this.context=r,this.addFontFace(new cr({fontFamily:"sans-serif",descriptors:{},fontUrl:""}))}getPropertySetters(){return{fontFamily:(e,r)=>{e.props.fontFamily=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,r)=>{e.props.fontWeight=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,r)=>{e.props.fontStyle=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,r)=>{e.props.fontStretch=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,r)=>{e.props.fontSize=r,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,r)=>{e.props.text=r,this.invalidateLayoutCache(e)},textAlign:(e,r)=>{e.props.textAlign=r,this.invalidateLayoutCache(e)},color:(e,r)=>{e.props.color=r,this.invalidateLayoutCache(e)},x:(e,r)=>{e.props.x=r},y:(e,r)=>{e.props.y=r},contain:(e,r)=>{e.props.contain=r,this.invalidateLayoutCache(e)},width:(e,r)=>{e.props.width=r,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,r)=>{e.props.height=r,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,r)=>{e.props.offsetY=r,this.invalidateLayoutCache(e)},scrollY:(e,r)=>{e.props.scrollY=r},letterSpacing:(e,r)=>{e.props.letterSpacing=r,this.invalidateLayoutCache(e)},lineHeight:(e,r)=>{e.props.lineHeight=r,this.invalidateLayoutCache(e)},maxLines:(e,r)=>{e.props.maxLines=r,this.invalidateLayoutCache(e)},textBaseline:(e,r)=>{e.props.textBaseline=r,this.invalidateLayoutCache(e)},verticalAlign:(e,r)=>{e.props.verticalAlign=r,this.invalidateLayoutCache(e)},overflowSuffix:(e,r)=>{e.props.overflowSuffix=r,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof cr}addFontFace(e){U(e instanceof cr),e.fontFamily!=="sans-serif"&&Ei.add(e.fontFace);const{fontFamilies:r}=this,i=e.fontFace.family;let n=r[i];n||(n=new Set,r[i]=n),n.add(e)}createState(e,r){return{node:r,props:e,status:"initialState",updateScheduled:!1,emitter:new nt,textureNode:void 0,lightning2TextRenderer:new Da(this.canvas,this.context),renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if(e.status==="initialState"&&this.setStatus(e,"loading"),e.status!=="loaded"){if(!e.fontInfo)return this.loadFont(e);e.fontInfo.loaded&&(e.renderInfo||(e.renderInfo=this.calculateRenderInfo(e),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,this.renderSingleCanvasPage(e)))}}renderSingleCanvasPage(e){U(e.renderInfo);const r=e.node,i=this.stage.txManager.loadTexture("ImageTexture",{src:(function(n,o){return U(o),n.draw(o,{lines:o.lines,lineWidths:o.lineWidths}),this.canvas.width===0||this.canvas.height===0?null:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}).bind(this,e.lightning2TextRenderer,e.renderInfo)});if(e.textureNode)e.textureNode.texture=i;else{const n=this.stage.createNode({parent:r,texture:i,autosize:!0,alpha:Oo(e.props.color)});e.textureNode=n}this.setStatus(e,"loaded")}calculateRenderInfo(e){var r;return e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFamily:e.props.fontFamily,trFontFace:(r=e.fontInfo)==null?void 0:r.fontFace,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:cs(e.props.color),offsetY:e.props.offsetY,wordWrap:e.props.contain!=="none",wordWrapWidth:e.props.contain==="none"?void 0:e.props.width,letterSpacing:e.props.letterSpacing,lineHeight:e.props.lineHeight??null,maxLines:e.props.maxLines,maxHeight:e.props.contain==="both"?e.props.height-e.props.offsetY:null,textBaseline:e.props.textBaseline,verticalAlign:e.props.verticalAlign,overflowSuffix:e.props.overflowSuffix,w:e.props.contain!=="none"?e.props.width:void 0},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.renderInfo}renderQuads(){}destroyState(e){e.status!=="destroyed"&&(super.destroyState(e),e.textureNode&&(e.textureNode.destroy(),delete e.textureNode),delete e.renderInfo)}invalidateLayoutCache(e){e.renderInfo=void 0,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,r){var i;r!==((i=e.fontInfo)==null?void 0:i.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,r,i){var n;r!==((n=e.fontInfo)==null?void 0:n.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${e.fontInfo.cssString}'`,i),this.scheduleUpdateState(e))}}class $a{constructor(){l(this,"data",{})}reset(){this.data={}}increment(t){this.data[t]||(this.data[t]=0),this.data[t]++}getData(){return{...this.data}}}class za{constructor(t,e){l(this,"stage");l(this,"memUsed",0);l(this,"loadedTextures",new Map);l(this,"criticalThreshold");l(this,"targetThreshold");l(this,"cleanupInterval");l(this,"debugLogging");l(this,"lastCleanupTime",0);l(this,"criticalCleanupRequested",!1);l(this,"frameTime",0);this.stage=t;const{criticalThreshold:r}=e;this.criticalThreshold=Math.round(r);const i=Math.max(0,Math.min(1,e.targetThresholdLevel));if(this.targetThreshold=Math.round(r*i),this.cleanupInterval=e.cleanupInterval,this.debugLogging=e.debugLogging,e.debugLogging){let n=0;setInterval(()=>{n!==this.memUsed&&(n=this.memUsed,console.log(`[TextureMemoryManager] Memory used: ${_i(this.memUsed)} mb / ${_i(this.criticalThreshold)} mb (${(this.memUsed/this.criticalThreshold*100).toFixed(1)}%)`))},1e3)}r===0&&(this.setTextureMemUse=()=>{})}setTextureMemUse(t,e){if(this.loadedTextures.has(t)&&(this.memUsed-=this.loadedTextures.get(t)),e===0){this.loadedTextures.delete(t);return}else this.memUsed+=e,this.loadedTextures.set(t,e);this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}cleanup(){const t=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,this.criticalCleanupRequested=!1,t&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.debugLogging&&console.log(`[TextureMemoryManager] Cleaning up textures. Critical: ${t}`);const e=[...this.loadedTextures.keys()].sort((n,o)=>{const a=n.renderable,c=o.renderable;return a===c?n.lastRenderableChangeTime-o.lastRenderableChangeTime:a?1:c?-1:0}),r=this.targetThreshold,i=this.stage.txManager;for(const n of e)if(n.renderable||(n.ctxTexture.free(),i.removeTextureFromCache(n),this.memUsed<=r))break;this.memUsed>=this.criticalThreshold&&(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),console.warn(`[TextureMemoryManager] Memory usage above critical threshold after cleanup: ${this.memUsed}`))}getMemoryInfo(){let t=0;const e=[...this.loadedTextures.keys()].reduce((r,i)=>(t+=i.renderable?1:0,r+(i.renderable?this.loadedTextures.get(i):0)),0);return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:e,memUsed:this.memUsed,renderableTexturesLoaded:t,loadedTextures:this.loadedTextures.size}}}const Ha={isWhite:!0,a:1,r:255,g:255,b:255};function hr(s){if(s===4294967295)return Ha;const t=(s>>>24&255)/255,e=s>>>16&255&255,r=s>>>8&255&255,i=s&255&255;return{isWhite:!1,a:t,r:i,g:r,b:e}}function Ns({a:s,r:t,g:e,b:r}){return`rgba(${t},${e},${r},${s})`}class Wa extends cn{constructor(){super(...arguments);l(this,"image");l(this,"tintCache")}load(){this.textureSource.state==="freed"&&(this.textureSource.setState("loading"),this.onLoadRequest().then(e=>{this.textureSource.setState("loaded",e),this.updateMemSize()}).catch(e=>{this.textureSource.setState("failed",e)}))}free(){this.image=void 0,this.tintCache=void 0,this.textureSource.setState("freed"),this.setTextureMemUse(0)}updateMemSize(){const e=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:r,height:i}=this.textureSource.dimensions;this.setTextureMemUse(r*i*e)}}hasImage(){return this.image!==void 0}getImage(e){var o;const r=this.image;if(U(r,"Attempt to get unloaded image texture"),e.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),r;const i=Ns(e);if(((o=this.tintCache)==null?void 0:o.key)===i)return this.tintCache.image;const n=this.tintTexture(r,i);return this.tintCache={key:i,image:n},this.updateMemSize(),n}tintTexture(e,r){const{width:i,height:n}=e,o=document.createElement("canvas");o.width=i,o.height=n;const a=o.getContext("2d");return a&&(a.fillStyle=r,a.globalCompositeOperation="copy",a.fillRect(0,0,i,n),a.globalCompositeOperation="multiply",a.drawImage(e,0,0,i,n,0,0,i,n),a.globalCompositeOperation="destination-in",a.drawImage(e,0,0,i,n,0,0,i,n)),o}async onLoadRequest(){const{data:e}=await this.textureSource.getTextureData();if(e instanceof ImageData){const r=document.createElement("canvas");r.width=e.width,r.height=e.height;const i=r.getContext("2d");return i&&i.putImageData(e,0,0),this.image=r,{width:e.width,height:e.height}}else if(e instanceof ImageBitmap)return this.image=e,{width:e.width,height:e.height};return{width:0,height:0}}}function Ga(s){var t;return s.shader instanceof zr&&s.shader.shType===xn?((t=s.shaderProps)==null?void 0:t.radius)??0:0}class Va extends hn{constructor(e){super(e);l(this,"context");l(this,"canvas");l(this,"pixelRatio");l(this,"clearColor");l(this,"renderToTextureActive",!1);l(this,"activeRttNode",null);l(this,"defShaderCtr");this.mode="canvas",this.shManager.renderer=this;const{canvas:r,pixelRatio:i,clearColor:n}=e;this.canvas=r,this.context=r.getContext("2d"),this.pixelRatio=i,this.clearColor=n?Fo(n):void 0,this.defShaderCtr={type:"DefaultShader",props:{},shader:new zr("DefaultShader"),getResolvedProps:()=>()=>({})}}reset(){this.canvas.width=this.canvas.width;const e=this.context;if(this.clearColor){const[r,i,n,o]=this.clearColor;e.fillStyle=`rgba(${r}, ${i}, ${n}, ${o/255})`,e.fillRect(0,0,this.canvas.width,this.canvas.height)}e.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(e){const r=this.context,{tx:i,ty:n,width:o,height:a,alpha:c,colorTl:h,colorTr:f,colorBr:u,ta:g,tb:_,tc:m,td:x,clippingRect:v}=e;let b=e.texture,M,I;if(b){if(b instanceof Lt&&(I=b.props,b=b.parentTexture),M=b.ctxTexture,b.state==="freed"){M.load();return}if(b.state!=="loaded"||!M.hasImage())return}const S=hr(h),L=g!==1,A=v.width!==0&&v.height!==0,B=h!==f||h!==u,V=e.shader?Ga(e):0;if((L||A||V)&&r.save(),A){const Y=new Path2D,{x:G,y:T,width:J,height:te}=v;Y.rect(G,T,J,te),r.clip(Y)}if(L){const Y=this.pixelRatio;r.setTransform(g,m,_,x,i*Y,n*Y),r.scale(Y,Y),r.translate(-i,-n)}if(V){const Y=new Path2D;Y.roundRect(i,n,o,a,V),r.clip(Y)}if(M){const Y=M.getImage(S);r.globalAlpha=c,I?r.drawImage(Y,I.x,I.y,I.width,I.height,i,n,o,a):r.drawImage(Y,i,n,o,a),r.globalAlpha=1}else if(B){let Y=i,G=n,T;h===f?(Y=i,G=n+a,T=hr(u)):(Y=i+o,G=n,T=hr(f));const J=r.createLinearGradient(i,n,Y,G);J.addColorStop(0,Ns(S)),J.addColorStop(1,Ns(T)),r.fillStyle=J,r.fillRect(i,n,o,a)}else r.fillStyle=Ns(S),r.fillRect(i,n,o,a);(L||A||V)&&r.restore()}createCtxTexture(e){return new Wa(this.txMemManager,e)}getShaderManager(){return this.shManager}getDefShaderCtr(){return this.defShaderCtr}renderRTTNodes(){}removeRTTNode(e){}renderToTexture(e){}getBufferInfo(){return null}}class Xa extends vr{constructor(e,r){super(e,r);l(this,"textRenderer");l(this,"trState");l(this,"_textRendererOverride",null);l(this,"onTextLoaded",()=>{const{contain:e}=this,r=this.trState.props.width,i=this.trState.props.height,n=this.trState.textW||0,o=this.trState.textH||0;e==="both"?(this.props.width=r,this.props.height=i):e==="width"?(this.props.width=r,this.props.height=o):e==="none"&&(this.props.width=n,this.props.height=o),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});l(this,"onTextFailed",(e,r)=>{this.emit("failed",{type:"text",error:r})});this._textRendererOverride=r.textRendererOverride;const{resolvedTextRenderer:i,textRendererState:n}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:r.width,height:r.height,textAlign:r.textAlign,color:r.color,zIndex:r.zIndex,contain:r.contain,scrollable:r.scrollable,scrollY:r.scrollY,offsetY:r.offsetY,letterSpacing:r.letterSpacing,debug:r.debug,fontFamily:r.fontFamily,fontSize:r.fontSize,fontStretch:r.fontStretch,fontStyle:r.fontStyle,fontWeight:r.fontWeight,text:r.text,lineHeight:r.lineHeight,maxLines:r.maxLines,textBaseline:r.textBaseline,verticalAlign:r.verticalAlign,overflowSuffix:r.overflowSuffix});this.textRenderer=i,this.trState=n}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),this.contain==="none"&&this.setUpdateType(P.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),this.contain!=="both"&&this.setUpdateType(P.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);const{resolvedTextRenderer:r,textRendererState:i}=this.resolveTextRendererAndState(this.trState.props);this.textRenderer=r,this.trState=i}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight&&this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines&&this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline&&this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign&&this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix&&this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,r){super.update(e,r),U(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkRenderProps(){return this.trState.props.text!==""?!0:super.checkRenderProps()}onChangeIsRenderable(e){super.onChangeIsRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){var r;if(U(this.globalTransform),!this.textRenderer.renderQuads){super.renderQuads(e);return}this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode)||(this.parentHasRenderTexture&&((r=this.props.parent)!=null&&r.rtt)&&(this.globalTransform=we.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),U(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions))}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}resolveTextRendererAndState(e){const r=this.stage.resolveTextRenderer(e,this._textRendererOverride),i=r.createState(e,this);return i.emitter.on("loaded",this.onTextLoaded),i.emitter.on("failed",this.onTextFailed),r.scheduleUpdateState(i),{resolvedTextRenderer:r,textRendererState:i}}}function Ya(s){const t={boolean:!0,string:!0,number:!0,undefined:!0},e=Object.keys(s);for(let r=0;r<e.length;r++){const i=e[r];if(!i)continue;const n=s[i],o=typeof n;o==="string"&&n.length>2048&&(console.warn(`Custom Data value for ${i} is too long, it will be truncated to 2048 characters`),s[i]=n.substring(0,2048)),t[o]||(console.warn(`Custom Data value for ${i} is not a boolean, string, or number, it will be ignored`),delete s[i])}return s}const ja=2e6;class Ka{constructor(t){l(this,"options");l(this,"animationManager");l(this,"txManager");l(this,"txMemManager");l(this,"fontManager");l(this,"textRenderers");l(this,"shManager");l(this,"renderer");l(this,"root");l(this,"boundsMargin");l(this,"defShaderCtr");l(this,"eventBus");l(this,"deltaTime",0);l(this,"lastFrameTime",0);l(this,"currentFrameTime",0);l(this,"fpsNumFrames",0);l(this,"fpsElapsedTime",0);l(this,"renderRequested",!1);l(this,"frameEventQueue",[]);l(this,"contextSpy",null);this.options=t;const{canvas:e,clearColor:r,appWidth:i,appHeight:n,boundsMargin:o,enableContextSpy:a,numImageWorkers:c,textureMemory:h,renderMode:f}=t;this.eventBus=t.eventBus,this.txManager=new ya(c),this.txMemManager=new za(this,h),this.shManager=new aa,this.animationManager=new ma,this.contextSpy=a?new $a:null;let u=[0,0,0,0];o&&(u=Array.isArray(o)?o:[o,o,o,o]),this.boundsMargin=u;const g={stage:this,canvas:e,pixelRatio:t.devicePhysicalPixelRatio*t.deviceLogicalPixelRatio,clearColor:r??4278190080,bufferMemory:ja,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy};f==="canvas"?this.renderer=new Va(g):this.renderer=new Hr(g),this.defShaderCtr=this.renderer.getDefShaderCtr(),Mo(f),this.txManager.renderer=this.renderer,this.textRenderers=f==="webgl"?{canvas:new Ci(this),sdf:new Na(this)}:{canvas:new Ci(this)},this.fontManager=new Wr(this.textRenderers);const _=new vr(this,{x:0,y:0,width:i,height:n,alpha:1,autosize:!1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1});this.root=_,Xo(this)}updateFrameTime(){const t=Yo();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=t,this.deltaTime=this.lastFrameTime?t-this.lastFrameTime:100/6,this.txManager.frameTime=t,this.txMemManager.frameTime=t,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}updateAnimations(){const{animationManager:t}=this;this.root&&t.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){const{renderer:t,renderRequested:e}=this;U(t),this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),t.reset(),this.txMemManager.criticalCleanupRequested&&this.txMemManager.cleanup(),t.rttNodes.length>0&&t.renderRTTNodes(),this.addQuads(this.root),t==null||t.render(),this.calculateFps(),e&&(this.renderRequested=!1)}queueFrameEvent(t,e){this.frameEventQueue.push([t,e])}flushFrameEvents(){for(const[t,e]of this.frameEventQueue)this.eventBus.emit(t,e);this.frameEventQueue=[]}calculateFps(){var e,r;const{fpsUpdateInterval:t}=this.options;if(t&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=t)){const i=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:i,contextSpyData:((e=this.contextSpy)==null?void 0:e.getData())??null}),(r=this.contextSpy)==null||r.reset()}}addQuads(t){U(this.renderer&&t.globalTransform),t.isRenderable&&t.renderQuads(this.renderer);for(let e=0;e<t.children.length;e++){const r=t.children[e];r&&(r==null?void 0:r.worldAlpha)!==0&&this.addQuads(r)}}requestRender(){this.renderRequested=!0}resolveTextRenderer(t,e=null){let r=e,i=!1;if(r){const o=this.textRenderers[r];o?o.canRenderFont(t)||(console.warn(`Cannot use override text renderer '${r}' for font`,t),r=null,i=!0):(console.warn(`Text renderer override '${r}' not found.`),r=null,i=!0)}if(!r){for(const[o,a]of Object.entries(this.textRenderers))if(o!=="canvas"&&a.canRenderFont(t)){r=o;break}r||(r="canvas")}i&&console.warn(`Falling back to text renderer ${String(r)}`);const n=this.textRenderers[r];return U(n,"resolvedTextRenderer undefined"),n}createShaderCtr(t,e){return this.shManager.loadShader(t,e)}createNode(t){const e=this.resolveNodeDefaults(t);return new vr(this,e)}createTextNode(t){const e=t.fontSize??16,r={...this.resolveNodeDefaults(t),text:t.text??"",textRendererOverride:t.textRendererOverride??null,fontSize:e,fontFamily:t.fontFamily??"sans-serif",fontStyle:t.fontStyle??"normal",fontWeight:t.fontWeight??"normal",fontStretch:t.fontStretch??"normal",textAlign:t.textAlign??"left",contain:t.contain??"none",scrollable:t.scrollable??!1,scrollY:t.scrollY??0,offsetY:t.offsetY??0,letterSpacing:t.letterSpacing??0,lineHeight:t.lineHeight,maxLines:t.maxLines??0,textBaseline:t.textBaseline??"alphabetic",verticalAlign:t.verticalAlign??"middle",overflowSuffix:t.overflowSuffix??"...",debug:t.debug??{},shaderProps:null};return new Xa(this,r)}resolveNodeDefaults(t){const e=t.color??4294967295,r=t.colorTl??t.colorTop??t.colorLeft??e,i=t.colorTr??t.colorTop??t.colorRight??e,n=t.colorBl??t.colorBottom??t.colorLeft??e,o=t.colorBr??t.colorBottom??t.colorRight??e,a=Ya(t.data??{});return{x:t.x??0,y:t.y??0,width:t.width??0,height:t.height??0,alpha:t.alpha??1,autosize:t.autosize??!1,clipping:t.clipping??!1,color:e,colorTop:t.colorTop??e,colorBottom:t.colorBottom??e,colorLeft:t.colorLeft??e,colorRight:t.colorRight??e,colorBl:n,colorBr:o,colorTl:r,colorTr:i,zIndex:t.zIndex??0,zIndexLocked:t.zIndexLocked??0,parent:t.parent??null,texture:t.texture??null,textureOptions:t.textureOptions??{},shader:t.shader??this.defShaderCtr,src:t.src??null,scale:t.scale??null,scaleX:t.scaleX??t.scale??1,scaleY:t.scaleY??t.scale??1,mount:t.mount??0,mountX:t.mountX??t.mount??0,mountY:t.mountY??t.mount??0,pivot:t.pivot??.5,pivotX:t.pivotX??t.pivot??.5,pivotY:t.pivotY??t.pivot??.5,rotation:t.rotation??0,rtt:t.rtt??!1,data:a}}}class qa extends nt{constructor(e,r){var x,v,b,M;super();l(this,"root");l(this,"canvas");l(this,"settings");l(this,"stage");l(this,"inspector",null);const i={criticalThreshold:((x=e.textureMemory)==null?void 0:x.criticalThreshold)||124e6,targetThresholdLevel:((v=e.textureMemory)==null?void 0:v.targetThresholdLevel)||.5,cleanupInterval:((b=e.textureMemory)==null?void 0:b.cleanupInterval)||3e4,debugLogging:((M=e.textureMemory)==null?void 0:M.debugLogging)||!1},n={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,textureMemory:i,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:e.clearColor??0,fpsUpdateInterval:e.fpsUpdateInterval||0,numImageWorkers:e.numImageWorkers!==void 0?e.numImageWorkers:2,enableContextSpy:e.enableContextSpy??!1,enableInspector:e.enableInspector??!1,renderMode:e.renderMode??"webgl",quadBufferSize:e.quadBufferSize??4*1024*1024};this.settings=n;const{appWidth:o,appHeight:a,deviceLogicalPixelRatio:c,devicePhysicalPixelRatio:h,enableInspector:f}=n,u=o*c,g=a*c,_=document.createElement("canvas");this.canvas=_,_.width=u*h,_.height=g*h,_.style.width=`${u}px`,_.style.height=`${g}px`,this.stage=new Ka({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,fpsUpdateInterval:this.settings.fpsUpdateInterval,numImageWorkers:this.settings.numImageWorkers,renderMode:this.settings.renderMode,textureMemory:i,eventBus:this,quadBufferSize:this.settings.quadBufferSize}),this.root=this.stage.root;let m;if(typeof r=="string"?m=document.getElementById(r):m=r,!m)throw new Error("Could not find target element");m.appendChild(_),f&&!kr()&&(this.inspector=new Vo(_,n))}createNode(e){U(this.stage,"Stage is not initialized");const r=this.stage.createNode(e);return this.inspector?this.inspector.createNode(r):r}createTextNode(e){const r=this.stage.createTextNode(e);return this.inspector?this.inspector.createTextNode(r):r}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e.id),e.destroy()}createTexture(e,r){return this.stage.txManager.loadTexture(e,r)}createShader(e,r){return this.stage.shManager.loadShader(e,r)}createDynamicShader(e){return this.stage.shManager.loadDynamicShader({effects:e})}createEffect(e,r,i){return{name:i,type:e,props:r}}getNodeById(e){var n;const r=(n=this.stage)==null?void 0:n.root;if(!r)return null;const i=o=>{if(o.id===e)return o;for(const a of o.children){const c=i(a);if(c)return c}return null};return i(r)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){throw new Error("Not implemented")}}let Mt,Gr;function Qa(s={},t="app"){return Mt=new qa(s,t),Gr=Mt.createShader.bind(Mt),Mt}var Za={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function Ja(){return!!(Za&&!1)}const el=Ja()||!1,Fe={debug:!1,animationsEnabled:!0,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100},setActiveElement:()=>{}};function Ai(s){return tl(s)&&s.debug}function tt(s,t,...e){el&&(Fe.debug||Ai(t)||Ai(e[0]))&&console.log(s,t,...e)}const yt=s=>s instanceof Function;function tl(s){return typeof s=="object"}function rs(s){return Array.isArray(s)}function Mi(s){return typeof s=="string"}function sl(s){return typeof s=="number"}function rl(s){return"destroy"in s&&typeof s.destroy=="function"}function Ss(s){return s instanceof pt}function il(s,t){for(const e of t)if(e in s)return!0;return!1}function bn(s,t={}){if(rs(s))s.forEach(e=>{bn(e,t)});else if(s)for(const e in s)t[e]===void 0&&(t[e]=s[e]);return t}class Ii extends Array{constructor(e,r={}){var t=(...Ch)=>(super(...Ch),l(this,"onChange"),this);return rs(r)?t(...r):Mi(r)?t(r):t(...Object.entries(r).filter(([i,n])=>n).map(([i])=>i)),this.onChange=e,this}has(e){return this.indexOf(e)>=0}is(e){return this.indexOf(e)>=0}add(e){this.has(e)||(this.push(e),this.onChange())}toggle(e,r){r===!0?this.add(e):r===!1?this.remove(e):this.has(e)?this.remove(e):this.add(e)}merge(e){if(rs(e))this.length=0,this.push(...e);else if(Mi(e))this.length=0,this.push(e);else for(const r in e)this.toggle(r,e[r]);return this}remove(e){const r=this.indexOf(e);r>=0&&(this.splice(r,1),this.onChange())}}const et={Element:"element",TextNode:"textNode",Text:"text"};function nl(s){const t=[];let e=!1,r=0;for(let S=0;S<s.children.length;S++){const L=s.children[S];if(L._type!==et.Text&&L.flexItem!==!1){if(L._type===et.TextNode&&L.text&&!(L.width||L.height))return!1;L.flexOrder!==void 0&&(e=!0),L.flexGrow!==void 0&&(r+=L.flexGrow),t.push(L)}}e&&t.sort((S,L)=>(S.flexOrder||0)-(L.flexOrder||0));const i=t.length,o=(s.flexDirection||"row")==="row",a=o?"width":"height",c=o?"height":"width",h=o?"marginLeft":"marginTop",f=o?"marginRight":"marginBottom",u=o?"x":"y",g=o?"y":"x",_=s[a]||0,m=s[c]||0,x=s.gap||0,v=s.justifyContent||"flexStart",b=s.alignItems;if(r){const S=t.reduce((A,B)=>A+(B.flexGrow?0:B[a]||0)+(B[h]||0)+(B[f]||0),0),L=(_-S-x*(i-1))/r;for(let A=0;A<t.length;A++){const B=t[A];B.flexGrow!==void 0&&B.flexGrow>0&&(B[a]=B.flexGrow*L)}}let M=0;["center","spaceBetween","spaceEvenly"].includes(v)&&(M=t.reduce((S,L)=>S+(L[a]||0)+(L[h]||0)+(L[f]||0),0));const I=m&&b?S=>{b==="flexStart"?S[g]=0:b==="center"?S[g]=(m-(S[c]||0))/2:b==="flexEnd"&&(S[g]=m-(S[c]||0))}:S=>S;if(v==="flexStart"){let S=0;for(let L=0;L<t.length;L++){const A=t[L];A[u]=S+(A[h]||0),S+=(A[a]||0)+x+(A[h]||0)+(A[f]||0),I(A)}if(s.flexBoundary!=="fixed"){const L=S-x;if(L!==s[a])return s[a]=L,!0}}else if(v==="flexEnd"){let S=_;for(let L=i-1;L>=0;L--){const A=t[L];A[u]=S-(A[a]||0)-(A[f]||0),S-=(A[a]||0)+x+(A[h]||0)+(A[f]||0),I(A)}if(s.flexBoundary!=="fixed"){const L=S-x;if(L!==s[a])return s[a]=L,!0}}else if(v==="center"){let S=(_-(M+x*(i-1)))/2;for(let L=0;L<t.length;L++){const A=t[L];A[u]=S+(A[h]||0),S+=(A[a]||0)+x+(A[h]||0)+(A[f]||0),I(A)}}else if(v==="spaceBetween"){const S=(_-M)/(i-1);let L=0;for(let A=0;A<t.length;A++){const B=t[A];B[u]=L+(B[h]||0),L+=(B[a]||0)+S+(B[h]||0)+(B[f]||0),I(B)}}else if(v==="spaceEvenly"){const S=(_-M)/(i+1);let L=S;for(let A=0;A<t.length;A++){const B=t[A];B[u]=L+(B[h]||0),L+=(B[a]||0)+S+(B[h]||0)+(B[f]||0),I(B)}}return!1}let Pi;const ol=s=>{al(s,Pi),Pi=s};let Li=[];const al=(s,t)=>{var i,n;let e=s;const r=[];for(;e;)(!e.states.has("focus")||e===s)&&(e.states.add("focus"),(i=e.onFocus)==null||i.call(e,s,t),(n=e.onFocusChanged)==null||n.call(e,!0,s,t)),r.push(e),e=e.parent;return Li.forEach(o=>{var a,c;r.includes(o)||(o.states.remove("focus"),(a=o.onBlur)==null||a.call(o,s,t),(c=o.onFocusChanged)==null||c.call(o,!1,s,t))}),Li=r,r},Es=new Set;let fr=!0;function Fi(s){const t=[];let e=0;for(const[r,i]of Object.entries(s))t.push({name:`effect${e}`,type:r,props:i}),e++;return Gr("DynamicShader",{effects:t})}function kt(s=""){return{set(t){sl(t)&&(t={width:t,color:255}),this.effects=this.effects?{...this.effects||{},[`border${s}`]:t}:{[`border${s}`]:t}},get(){var t;return(t=this.effects)==null?void 0:t[`border${s}`]}}}const ll=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","scaleX","scaleY","width","worldX","worldY","x","y","zIndex","zIndexLocked"],cl=["absX","absY","autosize","clipping","contain","data","fontFamily","fontStretch","fontStyle","fontWeight","letterSpacing","maxLines","offsetY","overflowSuffix","rtt","scrollable","scrollY","src","text","textAlign","textBaseline","textOverflow","texture","textureOptions","verticalAlign","wordWrap"];class pt extends Object{constructor(t){super(),this._type=t==="text"?et.TextNode:et.Element,this.rendered=!1,this.lng={},this.children=[]}get effects(){return this._effects}set effects(t){this._effects=t,this.rendered&&(this.shader=Fi(t))}get parent(){return this._parent}set parent(t){this._parent=t,this.rendered&&(this.lng.parent=(t==null?void 0:t.lng)??null)}insertChild(t,e){if(t.parent=this,e){this.removeChild(t);const r=this.children.indexOf(e);if(r>=0){this.children.splice(r,0,t);return}}this.children.push(t)}removeChild(t){const e=this.children.indexOf(t);e>=0&&this.children.splice(e,1)}get selectedNode(){const t=this.selected||0;for(let e=t;e<this.children.length;e++){const r=this.children[e];if(Ss(r))return this.selected=e,r}}set shader(t){let e=t;rs(t)&&(e=Gr(...t)),this.lng.shader=e}_sendToLightningAnimatable(t,e){if(this.transition&&this.rendered&&Fe.animationsEnabled&&(this.transition===!0||this.transition[t])){const r=this.transition===!0||this.transition[t]===!0?void 0:this.transition[t],i=this.animate({[t]:e},r);return yt(this.onAnimationStarted)&&i.once("animating",n=>{var o;(o=this.onAnimationStarted)==null||o.call(this,n,t,e)}),yt(this.onAnimationFinished)&&i.once("stopped",n=>{var o;(o=this.onAnimationFinished)==null||o.call(this,n,t,e)}),i.start()}this.lng[t]=e}animate(t,e){return U(this.rendered,"Node must be rendered before animating"),this.lng.animate(t,e||this.animationSettings)}chain(t,e){return this._animationRunning&&(this._animationQueue=[],this._animationRunning=!1),e?this._animationQueueSettings=e:this._animationQueueSettings||(this._animationQueueSettings=e||this.animationSettings),e=e||this._animationQueueSettings,this._animationQueue=this._animationQueue||[],this._animationQueue.push({props:t,animationSettings:e}),this}async start(){let t=this._animationQueue.shift();for(;t;)this._animationRunning=!0,await this.animate(t.props,t.animationSettings).start().waitUntilStopped(),t=this._animationQueue.shift();this._animationRunning=!1,this._animationQueueSettings=void 0}setFocus(){if(!this.skipFocus)if(this.rendered){if(this.forwardFocus!==void 0)if(yt(this.forwardFocus)){if(this.forwardFocus.call(this,this)!==!1)return}else{const t=typeof this.forwardFocus=="number"?this.forwardFocus:null,e=this.children;if(t!==null&&t<e.length){const r=e[t];Ss(r)&&r.setFocus();return}}queueMicrotask(()=>ol(this))}else this._autofocus=!0}isTextNode(){return this._type===et.TextNode}_layoutOnLoad(){this.lng.on("loaded",(t,e)=>{const{dimensions:r}=e;this.parent.updateLayout(this,r)})}getText(){let t="";for(let e=0;e<this.children.length;e++)t+=this.children[e].text;return t}destroy(){this._queueDelete&&rl(this.lng)&&(this.lng.destroy(),this.parent&&this.parent.requiresLayout()&&this.parent.updateLayout())}set onEvents(t){this._events=t}get onEvents(){return this._events}set style(t){rs(t)?this._style=bn(t):this._style=t;for(const e in this._style)this[e]===void 0&&(this[e]=this._style[e])}get style(){return this._style}get hasChildren(){return this.children.length>0}getChildById(t){return this.children.find(e=>e.id===t)}searchChildrenById(t){for(let e=0;e<this.children.length;e++){const r=this.children[e];if(Ss(r)){if(r.id===t)return r;const i=r.searchChildrenById(t);if(i)return i}}}set states(t){this._states=this._states?this._states.merge(t):new Ii(this._stateChanged.bind(this),t),this.rendered&&this._stateChanged()}get states(){return this._states=this._states||new Ii(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||Fe.animationSettings}set animationSettings(t){this._animationSettings=t}set hidden(t){this.alpha=t?0:1}get hidden(){return this.alpha===0}set autofocus(t){this._autofocus=!!t,this._autofocus&&this.setFocus()}get autofocus(){return this._autofocus}requiresLayout(){return this.display==="flex"||this.onBeforeLayout}set updateLayoutOn(t){this.updateLayout()}get updateLayoutOn(){return null}updateLayout(t,e){var r,i;if(this.hasChildren){tt("Layout: ",this);let n=!1;yt(this.onBeforeLayout)&&(n=this.onBeforeLayout.call(this,this,t,e)||!1),this.display==="flex"?(nl(this)||n)&&((r=this.parent)==null||r.updateLayout()):n&&((i=this.parent)==null||i.updateLayout()),yt(this.onLayout)&&this.onLayout.call(this,this,t,e)}}_stateChanged(){if(tt("State Changed: ",this,this.states),this.forwardStates){const e=this.states.slice();this.children.forEach(r=>{r.states=e})}const t=this.states;if(this._undoStyles||this.style&&il(this.style,t)){this._undoStyles=this._undoStyles||[];const e={};this._undoStyles.forEach(i=>{e[i]=this.style[i]});const r=t.reduce((i,n)=>{const o=this.style[n];return o&&(i={...i,...o}),i},{});this._undoStyles=Object.keys(r),r.transition!==void 0&&(this.transition=r.transition),Object.assign(this,e,r)}}render(){var i;const t=this,e=this.parent;if(!e){console.warn("Parent not set - no node created for: ",this);return}if(!e.rendered){console.warn("Parent not rendered yet: ",this);return}if(e.requiresLayout()&&!Es.has(e)&&(Es.add(e),fr&&(fr=!1,queueMicrotask(()=>{fr=!0;const n=[...Es];Es.clear();for(let o=n.length-1;o>=0;o--)n[o].updateLayout()}))),this.rendered)return;this._states&&this._stateChanged();const r=t.lng;if(r.x=r.x||0,r.y=r.y||0,e.rendered&&(r.parent=e.lng),t._effects&&(r.shader=Fi(t._effects)),t.isTextNode()){const n=r;if(Fe.fontSettings)for(const o in Fe.fontSettings)n[o]===void 0&&(n[o]=Fe.fontSettings[o]);n.text=n.text||t.getText(),n.textAlign&&!n.contain&&console.warn("Text align requires contain: ",t.getText()),n.contain&&(n.width||(n.width=(e.width||0)-n.x-(n.marginRight||0)),n.contain==="both"&&!n.height&&!n.maxLines?n.height=(e.height||0)-n.y-(n.marginBottom||0):n.maxLines===1&&(n.height=n.height||n.lineHeight||n.fontSize)),tt("Rendering: ",this,r),t.lng=Mt.createTextNode(r),e.requiresLayout()&&(!r.width||!r.height)&&t._layoutOnLoad()}else r.texture||(isNaN(r.width)&&(r.width=(e.width||0)-r.x),isNaN(r.height)&&(r.height=(e.height||0)-r.y),r.rtt&&!r.color&&(r.color=4294967295),!r.color&&!r.src&&(r.color=0)),tt("Rendering: ",this,r),t.lng=Mt.createNode(r);if(t.rendered=!0,t.autosize&&e.requiresLayout()&&t._layoutOnLoad(),t.onFail&&t.lng.on("failed",t.onFail),t.onLoad&&t.lng.on("loaded",t.onLoad),yt(this.onCreate)&&this.onCreate.call(this,t),t.onEvents&&t.onEvents.forEach(([n,o])=>{t.lng.on(n,(a,c)=>o(t,c))}),(i=t.lng)!=null&&i.div&&(t.lng.div.element=t),t._type===et.Element)for(let n=0;n<t.children.length;n++){const o=t.children[n];U(o,"Child is undefined"),Ss(o)?o.render():o.text&&o._type===et.Text&&console.warn("TextNode outside of <Text>: ",o)}t._autofocus&&t.setFocus()}}for(const s of ll)Object.defineProperty(pt.prototype,s,{get(){return this.lng[s]},set(t){this._sendToLightningAnimatable(s,t)}});for(const s of cl)Object.defineProperty(pt.prototype,s,{get(){return this.lng[s]},set(t){this.lng[s]=t}});Object.defineProperties(pt.prototype,{borderRadius:{set(s){this.effects=this.effects?{...this.effects,radius:{radius:s}}:{radius:{radius:s}}},get(){var s,t;return(t=(s=this.effects)==null?void 0:s.radius)==null?void 0:t.radius}},border:kt(),borderLeft:kt("Left"),borderRight:kt("Right"),borderTop:kt("Top"),borderBottom:kt("Bottom"),linearGradient:{set(s={}){this.effects=this.effects?{...this.effects,linearGradient:s}:{linearGradient:s}},get(){var s;return(s=this.effects)==null?void 0:s.linearGradient}},radialGradient:{set(s={}){this.effects=this.effects?{...this.effects,radialGradient:s}:{radialGradient:s}},get(){var s;return(s=this.effects)==null?void 0:s.radialGradient}},radialProgress:{set(s={}){this.effects=this.effects?{...this.effects,radialProgressGradient:s}:{radialProgressGradient:s}},get(){var s;return(s=this.effects)==null?void 0:s.radialProgress}}});/**
* @vue/shared v3.4.36
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Rn(s,t){const e=new Set(s.split(","));return r=>e.has(r)}const ce={},It=[],Be=()=>{},hl=()=>!1,Vr=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&(s.charCodeAt(2)>122||s.charCodeAt(2)<97),wn=s=>s.startsWith("onUpdate:"),Ee=Object.assign,Xr=(s,t)=>{const e=s.indexOf(t);e>-1&&s.splice(e,1)},fl=Object.prototype.hasOwnProperty,Z=(s,t)=>fl.call(s,t),K=Array.isArray,Yt=s=>Qs(s)==="[object Map]",ul=s=>Qs(s)==="[object Set]",Q=s=>typeof s=="function",Me=s=>typeof s=="string",fs=s=>typeof s=="symbol",de=s=>s!==null&&typeof s=="object",Sn=s=>(de(s)||Q(s))&&Q(s.then)&&Q(s.catch),dl=Object.prototype.toString,Qs=s=>dl.call(s),pl=s=>Qs(s).slice(8,-1),gl=s=>Qs(s)==="[object Object]",Yr=s=>Me(s)&&s!=="NaN"&&s[0]!=="-"&&""+parseInt(s,10)===s,jt=Rn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Zs=s=>{const t=Object.create(null);return e=>t[e]||(t[e]=s(e))},ml=/-(\w)/g,Ft=Zs(s=>s.replace(ml,(t,e)=>e?e.toUpperCase():"")),xl=/\B([A-Z])/g,us=Zs(s=>s.replace(xl,"-$1").toLowerCase()),_l=Zs(s=>s.charAt(0).toUpperCase()+s.slice(1)),ur=Zs(s=>s?`on${_l(s)}`:""),it=(s,t)=>!Object.is(s,t),dr=(s,...t)=>{for(let e=0;e<s.length;e++)s[e](...t)},En=(s,t,e,r=!1)=>{Object.defineProperty(s,t,{configurable:!0,enumerable:!1,writable:r,value:e})},yl=s=>{const t=parseFloat(s);return isNaN(t)?s:t};let Oi;const Cn=()=>Oi||(Oi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function jr(s){if(K(s)){const t={};for(let e=0;e<s.length;e++){const r=s[e],i=Me(r)?Rl(r):jr(r);if(i)for(const n in i)t[n]=i[n]}return t}else if(Me(s)||de(s))return s}const Tl=/;(?![^(]*\))/g,vl=/:([^]+)/,bl=/\/\*[^]*?\*\//g;function Rl(s){const t={};return s.replace(bl,"").split(Tl).forEach(e=>{if(e){const r=e.split(vl);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function Kr(s){let t="";if(Me(s))t=s;else if(K(s))for(let e=0;e<s.length;e++){const r=Kr(s[e]);r&&(t+=r+" ")}else if(de(s))for(const e in s)s[e]&&(t+=e+" ");return t.trim()}/**
* @vue/reactivity v3.4.36
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ue;class wl{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ue,!t&&Ue&&(this.index=(Ue.scopes||(Ue.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const e=Ue;try{return Ue=this,t()}finally{Ue=e}}}on(){Ue=this}off(){Ue=this.parent}stop(t){if(this._active){let e,r;for(e=0,r=this.effects.length;e<r;e++)this.effects[e].stop();for(e=0,r=this.cleanups.length;e<r;e++)this.cleanups[e]();if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function Sl(s,t=Ue){t&&t.active&&t.effects.push(s)}function El(){return Ue}let gt;class qr{constructor(t,e,r,i){this.fn=t,this.trigger=e,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,Sl(this,i)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,at();for(let t=0;t<this._depsLength;t++){const e=this.deps[t];if(e.computed&&(Cl(e.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),lt()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=st,e=gt;try{return st=!0,gt=this,this._runnings++,Bi(this),this.fn()}finally{Ni(this),this._runnings--,gt=e,st=t}}stop(){this.active&&(Bi(this),Ni(this),this.onStop&&this.onStop(),this.active=!1)}}function Cl(s){return s.value}function Bi(s){s._trackId++,s._depsLength=0}function Ni(s){if(s.deps.length>s._depsLength){for(let t=s._depsLength;t<s.deps.length;t++)An(s.deps[t],s);s.deps.length=s._depsLength}}function An(s,t){const e=s.get(t);e!==void 0&&t._trackId!==e&&(s.delete(t),s.size===0&&s.cleanup())}let st=!0,Ar=0;const Mn=[];function at(){Mn.push(st),st=!1}function lt(){const s=Mn.pop();st=s===void 0?!0:s}function Qr(){Ar++}function Zr(){for(Ar--;!Ar&&Mr.length;)Mr.shift()()}function In(s,t,e){if(t.get(s)!==s._trackId){t.set(s,s._trackId);const r=s.deps[s._depsLength];r!==t?(r&&An(r,s),s.deps[s._depsLength++]=t):s._depsLength++}}const Mr=[];function Pn(s,t,e){Qr();for(const r of s.keys()){let i;r._dirtyLevel<t&&(i??(i=s.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=t),r._shouldSchedule&&(i??(i=s.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&Mr.push(r.scheduler)))}Zr()}const Ln=(s,t)=>{const e=new Map;return e.cleanup=s,e.computed=t,e},Ir=new WeakMap,mt=Symbol(""),Pr=Symbol("");function Ie(s,t,e){if(st&&gt){let r=Ir.get(s);r||Ir.set(s,r=new Map);let i=r.get(e);i||r.set(e,i=Ln(()=>r.delete(e))),In(gt,i)}}function Ye(s,t,e,r,i,n){const o=Ir.get(s);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(e==="length"&&K(s)){const c=Number(r);o.forEach((h,f)=>{(f==="length"||!fs(f)&&f>=c)&&a.push(h)})}else switch(e!==void 0&&a.push(o.get(e)),t){case"add":K(s)?Yr(e)&&a.push(o.get("length")):(a.push(o.get(mt)),Yt(s)&&a.push(o.get(Pr)));break;case"delete":K(s)||(a.push(o.get(mt)),Yt(s)&&a.push(o.get(Pr)));break;case"set":Yt(s)&&a.push(o.get(mt));break}Qr();for(const c of a)c&&Pn(c,4);Zr()}const Al=Rn("__proto__,__v_isRef,__isVue"),Fn=new Set(Object.getOwnPropertyNames(Symbol).filter(s=>s!=="arguments"&&s!=="caller").map(s=>Symbol[s]).filter(fs)),Ui=Ml();function Ml(){const s={};return["includes","indexOf","lastIndexOf"].forEach(t=>{s[t]=function(...e){const r=ie(this);for(let n=0,o=this.length;n<o;n++)Ie(r,"get",n+"");const i=r[t](...e);return i===-1||i===!1?r[t](...e.map(ie)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{s[t]=function(...e){at(),Qr();const r=ie(this)[t].apply(this,e);return Zr(),lt(),r}}),s}function Il(s){fs(s)||(s=String(s));const t=ie(this);return Ie(t,"has",s),t.hasOwnProperty(s)}class On{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,r){const i=this._isReadonly,n=this._isShallow;if(e==="__v_isReactive")return!i;if(e==="__v_isReadonly")return i;if(e==="__v_isShallow")return n;if(e==="__v_raw")return r===(i?n?Wl:Dn:n?Un:Nn).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(r)?t:void 0;const o=K(t);if(!i){if(o&&Z(Ui,e))return Reflect.get(Ui,e,r);if(e==="hasOwnProperty")return Il}const a=Reflect.get(t,e,r);return(fs(e)?Fn.has(e):Al(e))||(i||Ie(t,"get",e),n)?a:Pe(a)?o&&Yr(e)?a:a.value:de(a)?i?kn(a):ti(a):a}}class Bn extends On{constructor(t=!1){super(!1,t)}set(t,e,r,i){let n=t[e];if(!this._isShallow){const c=xt(n);if(!Ot(r)&&!xt(r)&&(n=ie(n),r=ie(r)),!K(t)&&Pe(n)&&!Pe(r))return c?!1:(n.value=r,!0)}const o=K(t)&&Yr(e)?Number(e)<t.length:Z(t,e),a=Reflect.set(t,e,r,i);return t===ie(i)&&(o?it(r,n)&&Ye(t,"set",e,r):Ye(t,"add",e,r)),a}deleteProperty(t,e){const r=Z(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&r&&Ye(t,"delete",e,void 0),i}has(t,e){const r=Reflect.has(t,e);return(!fs(e)||!Fn.has(e))&&Ie(t,"has",e),r}ownKeys(t){return Ie(t,"iterate",K(t)?"length":mt),Reflect.ownKeys(t)}}class Pl extends On{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const Ll=new Bn,Fl=new Pl,Ol=new Bn(!0);const Jr=s=>s,Js=s=>Reflect.getPrototypeOf(s);function Cs(s,t,e=!1,r=!1){s=s.__v_raw;const i=ie(s),n=ie(t);e||(it(t,n)&&Ie(i,"get",t),Ie(i,"get",n));const{has:o}=Js(i),a=r?Jr:e?ii:is;if(o.call(i,t))return a(s.get(t));if(o.call(i,n))return a(s.get(n));s!==i&&s.get(t)}function As(s,t=!1){const e=this.__v_raw,r=ie(e),i=ie(s);return t||(it(s,i)&&Ie(r,"has",s),Ie(r,"has",i)),s===i?e.has(s):e.has(s)||e.has(i)}function Ms(s,t=!1){return s=s.__v_raw,!t&&Ie(ie(s),"iterate",mt),Reflect.get(s,"size",s)}function Di(s,t=!1){!t&&!Ot(s)&&!xt(s)&&(s=ie(s));const e=ie(this);return Js(e).has.call(e,s)||(e.add(s),Ye(e,"add",s,s)),this}function ki(s,t,e=!1){!e&&!Ot(t)&&!xt(t)&&(t=ie(t));const r=ie(this),{has:i,get:n}=Js(r);let o=i.call(r,s);o||(s=ie(s),o=i.call(r,s));const a=n.call(r,s);return r.set(s,t),o?it(t,a)&&Ye(r,"set",s,t):Ye(r,"add",s,t),this}function $i(s){const t=ie(this),{has:e,get:r}=Js(t);let i=e.call(t,s);i||(s=ie(s),i=e.call(t,s)),r&&r.call(t,s);const n=t.delete(s);return i&&Ye(t,"delete",s,void 0),n}function zi(){const s=ie(this),t=s.size!==0,e=s.clear();return t&&Ye(s,"clear",void 0,void 0),e}function Is(s,t){return function(r,i){const n=this,o=n.__v_raw,a=ie(o),c=t?Jr:s?ii:is;return!s&&Ie(a,"iterate",mt),o.forEach((h,f)=>r.call(i,c(h),c(f),n))}}function Ps(s,t,e){return function(...r){const i=this.__v_raw,n=ie(i),o=Yt(n),a=s==="entries"||s===Symbol.iterator&&o,c=s==="keys"&&o,h=i[s](...r),f=e?Jr:t?ii:is;return!t&&Ie(n,"iterate",c?Pr:mt),{next(){const{value:u,done:g}=h.next();return g?{value:u,done:g}:{value:a?[f(u[0]),f(u[1])]:f(u),done:g}},[Symbol.iterator](){return this}}}}function qe(s){return function(...t){return s==="delete"?!1:s==="clear"?void 0:this}}function Bl(){const s={get(n){return Cs(this,n)},get size(){return Ms(this)},has:As,add:Di,set:ki,delete:$i,clear:zi,forEach:Is(!1,!1)},t={get(n){return Cs(this,n,!1,!0)},get size(){return Ms(this)},has:As,add(n){return Di.call(this,n,!0)},set(n,o){return ki.call(this,n,o,!0)},delete:$i,clear:zi,forEach:Is(!1,!0)},e={get(n){return Cs(this,n,!0)},get size(){return Ms(this,!0)},has(n){return As.call(this,n,!0)},add:qe("add"),set:qe("set"),delete:qe("delete"),clear:qe("clear"),forEach:Is(!0,!1)},r={get(n){return Cs(this,n,!0,!0)},get size(){return Ms(this,!0)},has(n){return As.call(this,n,!0)},add:qe("add"),set:qe("set"),delete:qe("delete"),clear:qe("clear"),forEach:Is(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{s[n]=Ps(n,!1,!1),e[n]=Ps(n,!0,!1),t[n]=Ps(n,!1,!0),r[n]=Ps(n,!0,!0)}),[s,e,t,r]}const[Nl,Ul,Dl,kl]=Bl();function ei(s,t){const e=t?s?kl:Dl:s?Ul:Nl;return(r,i,n)=>i==="__v_isReactive"?!s:i==="__v_isReadonly"?s:i==="__v_raw"?r:Reflect.get(Z(e,i)&&i in r?e:r,i,n)}const $l={get:ei(!1,!1)},zl={get:ei(!1,!0)},Hl={get:ei(!0,!1)};const Nn=new WeakMap,Un=new WeakMap,Dn=new WeakMap,Wl=new WeakMap;function Gl(s){switch(s){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Vl(s){return s.__v_skip||!Object.isExtensible(s)?0:Gl(pl(s))}function ti(s){return xt(s)?s:si(s,!1,Ll,$l,Nn)}function Xl(s){return si(s,!1,Ol,zl,Un)}function kn(s){return si(s,!0,Fl,Hl,Dn)}function si(s,t,e,r,i){if(!de(s)||s.__v_raw&&!(t&&s.__v_isReactive))return s;const n=i.get(s);if(n)return n;const o=Vl(s);if(o===0)return s;const a=new Proxy(s,o===2?r:e);return i.set(s,a),a}function Kt(s){return xt(s)?Kt(s.__v_raw):!!(s&&s.__v_isReactive)}function xt(s){return!!(s&&s.__v_isReadonly)}function Ot(s){return!!(s&&s.__v_isShallow)}function $n(s){return s?!!s.__v_raw:!1}function ie(s){const t=s&&s.__v_raw;return t?ie(t):s}function ri(s){return Object.isExtensible(s)&&En(s,"__v_skip",!0),s}const is=s=>de(s)?ti(s):s,ii=s=>de(s)?kn(s):s;class zn{constructor(t,e,r,i){this.getter=t,this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new qr(()=>t(this._value),()=>Us(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const t=ie(this);return(!t._cacheable||t.effect.dirty)&&it(t._value,t._value=t.effect.run())&&Us(t,4),Hn(t),t.effect._dirtyLevel>=2&&Us(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function Yl(s,t,e=!1){let r,i;const n=Q(s);return n?(r=s,i=Be):(r=s.get,i=s.set),new zn(r,i,n||!i,e)}function Hn(s){var t;st&&gt&&(s=ie(s),In(gt,(t=s.dep)!=null?t:s.dep=Ln(()=>s.dep=void 0,s instanceof zn?s:void 0)))}function Us(s,t=4,e,r){s=ie(s);const i=s.dep;i&&Pn(i,t)}function Pe(s){return!!(s&&s.__v_isRef===!0)}function Hi(s){return jl(s,!1)}function jl(s,t){return Pe(s)?s:new Kl(s,t)}class Kl{constructor(t,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?t:ie(t),this._value=e?t:is(t)}get value(){return Hn(this),this._value}set value(t){const e=this.__v_isShallow||Ot(t)||xt(t);t=e?t:ie(t),it(t,this._rawValue)&&(this._rawValue,this._rawValue=t,this._value=e?t:is(t),Us(this,4))}}function Wn(s){return Pe(s)?s.value:s}const ql={get:(s,t,e)=>Wn(Reflect.get(s,t,e)),set:(s,t,e,r)=>{const i=s[t];return Pe(i)&&!Pe(e)?(i.value=e,!0):Reflect.set(s,t,e,r)}};function Gn(s){return Kt(s)?s:new Proxy(s,ql)}/**
* @vue/runtime-core v3.4.36
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function rt(s,t,e,r){try{return r?s(...r):s()}catch(i){er(i,t,e)}}function Ve(s,t,e,r){if(Q(s)){const i=rt(s,t,e,r);return i&&Sn(i)&&i.catch(n=>{er(n,t,e)}),i}if(K(s)){const i=[];for(let n=0;n<s.length;n++)i.push(Ve(s[n],t,e,r));return i}}function er(s,t,e,r=!0){const i=t?t.vnode:null;if(t){let n=t.parent;const o=t.proxy,a=`https://vuejs.org/error-reference/#runtime-${e}`;for(;n;){const h=n.ec;if(h){for(let f=0;f<h.length;f++)if(h[f](s,o,a)===!1)return}n=n.parent}const c=t.appContext.config.errorHandler;if(c){at(),rt(c,null,10,[s,o,a]),lt();return}}Ql(s,e,i,r)}function Ql(s,t,e,r=!0){console.error(s)}let ns=!1,Lr=!1;const be=[];let We=0;const Pt=[];let Qe=null,ft=0;const Vn=Promise.resolve();let ni=null;function Zl(s){const t=ni||Vn;return s?t.then(this?s.bind(this):s):t}function Jl(s){let t=We+1,e=be.length;for(;t<e;){const r=t+e>>>1,i=be[r],n=os(i);n<s||n===s&&i.pre?t=r+1:e=r}return t}function oi(s){(!be.length||!be.includes(s,ns&&s.allowRecurse?We+1:We))&&(s.id==null?be.push(s):be.splice(Jl(s.id),0,s),Xn())}function Xn(){!ns&&!Lr&&(Lr=!0,ni=Vn.then(jn))}function ec(s){const t=be.indexOf(s);t>We&&be.splice(t,1)}function tc(s){K(s)?Pt.push(...s):(!Qe||!Qe.includes(s,s.allowRecurse?ft+1:ft))&&Pt.push(s),Xn()}function Wi(s,t,e=ns?We+1:0){for(;e<be.length;e++){const r=be[e];if(r&&r.pre){if(s&&r.id!==s.uid)continue;be.splice(e,1),e--,r()}}}function Yn(s){if(Pt.length){const t=[...new Set(Pt)].sort((e,r)=>os(e)-os(r));if(Pt.length=0,Qe){Qe.push(...t);return}for(Qe=t,ft=0;ft<Qe.length;ft++){const e=Qe[ft];e.active!==!1&&e()}Qe=null,ft=0}}const os=s=>s.id==null?1/0:s.id,sc=(s,t)=>{const e=os(s)-os(t);if(e===0){if(s.pre&&!t.pre)return-1;if(t.pre&&!s.pre)return 1}return e};function jn(s){Lr=!1,ns=!0,be.sort(sc);try{for(We=0;We<be.length;We++){const t=be[We];t&&t.active!==!1&&rt(t,t.i,t.i?15:14)}}finally{We=0,be.length=0,Yn(),ns=!1,ni=null,(be.length||Pt.length)&&jn()}}let Ge=null,Kn=null;function Vs(s){const t=Ge;return Ge=s,Kn=s&&s.type.__scopeId||null,t}function rc(s,t=Ge,e){if(!t||s._n)return s;const r=(...i)=>{r._d&&Qi(-1);const n=Vs(t);let o;try{o=s(...i)}finally{Vs(n),r._d&&Qi(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function ct(s,t,e,r){const i=s.dirs,n=t&&t.dirs;for(let o=0;o<i.length;o++){const a=i[o];n&&(a.oldValue=n[o].value);let c=a.dir[r];c&&(at(),Ve(c,e,8,[s.el,a,s,t]),lt())}}function qn(s,t){s.shapeFlag&6&&s.component?qn(s.component.subTree,t):s.shapeFlag&128?(s.ssContent.transition=t.clone(s.ssContent),s.ssFallback.transition=t.clone(s.ssFallback)):s.transition=t}const Ds=s=>!!s.type.__asyncLoader,Qn=s=>s.type.__isKeepAlive;function ic(s,t){Zn(s,"a",t)}function nc(s,t){Zn(s,"da",t)}function Zn(s,t,e=Se){const r=s.__wdc||(s.__wdc=()=>{let i=e;for(;i;){if(i.isDeactivated)return;i=i.parent}return s()});if(tr(t,r,e),e){let i=e.parent;for(;i&&i.parent;)Qn(i.parent.vnode)&&oc(r,t,e,i),i=i.parent}}function oc(s,t,e,r){const i=tr(t,s,r,!0);eo(()=>{Xr(r[t],i)},e)}function tr(s,t,e=Se,r=!1){if(e){const i=e[s]||(e[s]=[]),n=t.__weh||(t.__weh=(...o)=>{at();const a=ds(e),c=Ve(t,e,s,o);return a(),lt(),c});return r?i.unshift(n):i.push(n),n}}const Ke=s=>(t,e=Se)=>{(!ir||s==="sp")&&tr(s,(...r)=>t(...r),e)},ac=Ke("bm"),Jn=Ke("m"),lc=Ke("bu"),cc=Ke("u"),hc=Ke("bum"),eo=Ke("um"),fc=Ke("sp"),uc=Ke("rtg"),dc=Ke("rtc");function pc(s,t=Se){tr("ec",s,t)}const gc=Symbol.for("v-ndc");function mc(s,t,e,r){let i;const n=e;if(K(s)||Me(s)){i=new Array(s.length);for(let o=0,a=s.length;o<a;o++)i[o]=t(s[o],o,void 0,n)}else if(typeof s=="number"){i=new Array(s);for(let o=0;o<s;o++)i[o]=t(o+1,o,void 0,n)}else if(de(s))if(s[Symbol.iterator])i=Array.from(s,(o,a)=>t(o,a,void 0,n));else{const o=Object.keys(s);i=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const h=o[a];i[a]=t(s[h],h,a,n)}}else i=[];return i}const Fr=s=>s?vo(s)?hi(s):Fr(s.parent):null,qt=Ee(Object.create(null),{$:s=>s,$el:s=>s.vnode.el,$data:s=>s.data,$props:s=>s.props,$attrs:s=>s.attrs,$slots:s=>s.slots,$refs:s=>s.refs,$parent:s=>Fr(s.parent),$root:s=>Fr(s.root),$emit:s=>s.emit,$options:s=>ai(s),$forceUpdate:s=>s.f||(s.f=()=>{s.effect.dirty=!0,oi(s.update)}),$nextTick:s=>s.n||(s.n=Zl.bind(s.proxy)),$watch:s=>$c.bind(s)}),pr=(s,t)=>s!==ce&&!s.__isScriptSetup&&Z(s,t),xc={get({_:s},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:r,data:i,props:n,accessCache:o,type:a,appContext:c}=s;let h;if(t[0]!=="$"){const _=o[t];if(_!==void 0)switch(_){case 1:return r[t];case 2:return i[t];case 4:return e[t];case 3:return n[t]}else{if(pr(r,t))return o[t]=1,r[t];if(i!==ce&&Z(i,t))return o[t]=2,i[t];if((h=s.propsOptions[0])&&Z(h,t))return o[t]=3,n[t];if(e!==ce&&Z(e,t))return o[t]=4,e[t];Or&&(o[t]=0)}}const f=qt[t];let u,g;if(f)return t==="$attrs"&&Ie(s.attrs,"get",""),f(s);if((u=a.__cssModules)&&(u=u[t]))return u;if(e!==ce&&Z(e,t))return o[t]=4,e[t];if(g=c.config.globalProperties,Z(g,t))return g[t]},set({_:s},t,e){const{data:r,setupState:i,ctx:n}=s;return pr(i,t)?(i[t]=e,!0):r!==ce&&Z(r,t)?(r[t]=e,!0):Z(s.props,t)||t[0]==="$"&&t.slice(1)in s?!1:(n[t]=e,!0)},has({_:{data:s,setupState:t,accessCache:e,ctx:r,appContext:i,propsOptions:n}},o){let a;return!!e[o]||s!==ce&&Z(s,o)||pr(t,o)||(a=n[0])&&Z(a,o)||Z(r,o)||Z(qt,o)||Z(i.config.globalProperties,o)},defineProperty(s,t,e){return e.get!=null?s._.accessCache[t]=0:Z(e,"value")&&this.set(s,t,e.value,null),Reflect.defineProperty(s,t,e)}};function Gi(s){return K(s)?s.reduce((t,e)=>(t[e]=null,t),{}):s}let Or=!0;function _c(s){const t=ai(s),e=s.proxy,r=s.ctx;Or=!1,t.beforeCreate&&Vi(t.beforeCreate,s,"bc");const{data:i,computed:n,methods:o,watch:a,provide:c,inject:h,created:f,beforeMount:u,mounted:g,beforeUpdate:_,updated:m,activated:x,deactivated:v,beforeDestroy:b,beforeUnmount:M,destroyed:I,unmounted:S,render:L,renderTracked:A,renderTriggered:B,errorCaptured:V,serverPrefetch:Y,expose:G,inheritAttrs:T,components:J,directives:te,filters:ee}=t;if(h&&yc(h,r,null),o)for(const k in o){const X=o[k];Q(X)&&(r[k]=X.bind(e))}if(i){const k=i.call(e,e);de(k)&&(s.data=ti(k))}if(Or=!0,n)for(const k in n){const X=n[k],ne=Q(X)?X.bind(e,e):Q(X.get)?X.get.bind(e,e):Be,oe=!Q(X)&&Q(X.set)?X.set.bind(e):Be,pe=hh({get:ne,set:oe});Object.defineProperty(r,k,{enumerable:!0,configurable:!0,get:()=>pe.value,set:le=>pe.value=le})}if(a)for(const k in a)to(a[k],r,e,k);if(c){const k=Q(c)?c.call(e):c;Reflect.ownKeys(k).forEach(X=>{Sc(X,k[X])})}f&&Vi(f,s,"c");function z(k,X){K(X)?X.forEach(ne=>k(ne.bind(e))):X&&k(X.bind(e))}if(z(ac,u),z(Jn,g),z(lc,_),z(cc,m),z(ic,x),z(nc,v),z(pc,V),z(dc,A),z(uc,B),z(hc,M),z(eo,S),z(fc,Y),K(G))if(G.length){const k=s.exposed||(s.exposed={});G.forEach(X=>{Object.defineProperty(k,X,{get:()=>e[X],set:ne=>e[X]=ne})})}else s.exposed||(s.exposed={});L&&s.render===Be&&(s.render=L),T!=null&&(s.inheritAttrs=T),J&&(s.components=J),te&&(s.directives=te)}function yc(s,t,e=Be){K(s)&&(s=Br(s));for(const r in s){const i=s[r];let n;de(i)?"default"in i?n=ks(i.from||r,i.default,!0):n=ks(i.from||r):n=ks(i),Pe(n)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):t[r]=n}}function Vi(s,t,e){Ve(K(s)?s.map(r=>r.bind(t.proxy)):s.bind(t.proxy),t,e)}function to(s,t,e,r){const i=r.includes(".")?mo(e,r):()=>e[r];if(Me(s)){const n=t[s];Q(n)&&mr(i,n)}else if(Q(s))mr(i,s.bind(e));else if(de(s))if(K(s))s.forEach(n=>to(n,t,e,r));else{const n=Q(s.handler)?s.handler.bind(e):t[s.handler];Q(n)&&mr(i,n,s)}}function ai(s){const t=s.type,{mixins:e,extends:r}=t,{mixins:i,optionsCache:n,config:{optionMergeStrategies:o}}=s.appContext,a=n.get(t);let c;return a?c=a:!i.length&&!e&&!r?c=t:(c={},i.length&&i.forEach(h=>Xs(c,h,o,!0)),Xs(c,t,o)),de(t)&&n.set(t,c),c}function Xs(s,t,e,r=!1){const{mixins:i,extends:n}=t;n&&Xs(s,n,e,!0),i&&i.forEach(o=>Xs(s,o,e,!0));for(const o in t)if(!(r&&o==="expose")){const a=Tc[o]||e&&e[o];s[o]=a?a(s[o],t[o]):t[o]}return s}const Tc={data:Xi,props:Yi,emits:Yi,methods:Vt,computed:Vt,beforeCreate:Re,created:Re,beforeMount:Re,mounted:Re,beforeUpdate:Re,updated:Re,beforeDestroy:Re,beforeUnmount:Re,destroyed:Re,unmounted:Re,activated:Re,deactivated:Re,errorCaptured:Re,serverPrefetch:Re,components:Vt,directives:Vt,watch:bc,provide:Xi,inject:vc};function Xi(s,t){return t?s?function(){return Ee(Q(s)?s.call(this,this):s,Q(t)?t.call(this,this):t)}:t:s}function vc(s,t){return Vt(Br(s),Br(t))}function Br(s){if(K(s)){const t={};for(let e=0;e<s.length;e++)t[s[e]]=s[e];return t}return s}function Re(s,t){return s?[...new Set([].concat(s,t))]:t}function Vt(s,t){return s?Ee(Object.create(null),s,t):t}function Yi(s,t){return s?K(s)&&K(t)?[...new Set([...s,...t])]:Ee(Object.create(null),Gi(s),Gi(t??{})):t}function bc(s,t){if(!s)return t;if(!t)return s;const e=Ee(Object.create(null),s);for(const r in t)e[r]=Re(s[r],t[r]);return e}function so(){return{app:null,config:{isNativeTag:hl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Rc=0;function wc(s,t){return function(r,i=null){Q(r)||(r=Ee({},r)),i!=null&&!de(i)&&(i=null);const n=so(),o=new WeakSet;let a=!1;const c=n.app={_uid:Rc++,_component:r,_props:i,_container:null,_context:n,_instance:null,version:fh,get config(){return n.config},set config(h){},use(h,...f){return o.has(h)||(h&&Q(h.install)?(o.add(h),h.install(c,...f)):Q(h)&&(o.add(h),h(c,...f))),c},mixin(h){return n.mixins.includes(h)||n.mixins.push(h),c},component(h,f){return f?(n.components[h]=f,c):n.components[h]},directive(h,f){return f?(n.directives[h]=f,c):n.directives[h]},mount(h,f,u){if(!a){const g=je(r,i);return g.appContext=n,u===!0?u="svg":u===!1&&(u=void 0),f&&t?t(g,h):s(g,h,u),a=!0,c._container=h,h.__vue_app__=c,hi(g.component)}},unmount(){a&&(s(null,c._container),delete c._container.__vue_app__)},provide(h,f){return n.provides[h]=f,c},runWithContext(h){const f=Qt;Qt=c;try{return h()}finally{Qt=f}}};return c}}let Qt=null;function Sc(s,t){if(Se){let e=Se.provides;const r=Se.parent&&Se.parent.provides;r===e&&(e=Se.provides=Object.create(r)),e[s]=t}}function ks(s,t,e=!1){const r=Se||Ge;if(r||Qt){const i=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Qt._context.provides;if(i&&s in i)return i[s];if(arguments.length>1)return e&&Q(t)?t.call(r&&r.proxy):t}}const ro={},io=()=>Object.create(ro),no=s=>Object.getPrototypeOf(s)===ro;function Ec(s,t,e,r=!1){const i={},n=io();s.propsDefaults=Object.create(null),oo(s,t,i,n);for(const o in s.propsOptions[0])o in i||(i[o]=void 0);e?s.props=r?i:Xl(i):s.type.props?s.props=i:s.props=n,s.attrs=n}function Cc(s,t,e,r){const{props:i,attrs:n,vnode:{patchFlag:o}}=s,a=ie(i),[c]=s.propsOptions;let h=!1;if((r||o>0)&&!(o&16)){if(o&8){const f=s.vnode.dynamicProps;for(let u=0;u<f.length;u++){let g=f[u];if(sr(s.emitsOptions,g))continue;const _=t[g];if(c)if(Z(n,g))_!==n[g]&&(n[g]=_,h=!0);else{const m=Ft(g);i[m]=Nr(c,a,m,_,s,!1)}else _!==n[g]&&(n[g]=_,h=!0)}}}else{oo(s,t,i,n)&&(h=!0);let f;for(const u in a)(!t||!Z(t,u)&&((f=us(u))===u||!Z(t,f)))&&(c?e&&(e[u]!==void 0||e[f]!==void 0)&&(i[u]=Nr(c,a,u,void 0,s,!0)):delete i[u]);if(n!==a)for(const u in n)(!t||!Z(t,u))&&(delete n[u],h=!0)}h&&Ye(s.attrs,"set","")}function oo(s,t,e,r){const[i,n]=s.propsOptions;let o=!1,a;if(t)for(let c in t){if(jt(c))continue;const h=t[c];let f;i&&Z(i,f=Ft(c))?!n||!n.includes(f)?e[f]=h:(a||(a={}))[f]=h:sr(s.emitsOptions,c)||(!(c in r)||h!==r[c])&&(r[c]=h,o=!0)}if(n){const c=ie(e),h=a||ce;for(let f=0;f<n.length;f++){const u=n[f];e[u]=Nr(i,c,u,h[u],s,!Z(h,u))}}return o}function Nr(s,t,e,r,i,n){const o=s[e];if(o!=null){const a=Z(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&Q(c)){const{propsDefaults:h}=i;if(e in h)r=h[e];else{const f=ds(i);r=h[e]=c.call(null,t),f()}}else r=c}o[0]&&(n&&!a?r=!1:o[1]&&(r===""||r===us(e))&&(r=!0))}return r}const Ac=new WeakMap;function ao(s,t,e=!1){const r=e?Ac:t.propsCache,i=r.get(s);if(i)return i;const n=s.props,o={},a=[];let c=!1;if(!Q(s)){const f=u=>{c=!0;const[g,_]=ao(u,t,!0);Ee(o,g),_&&a.push(..._)};!e&&t.mixins.length&&t.mixins.forEach(f),s.extends&&f(s.extends),s.mixins&&s.mixins.forEach(f)}if(!n&&!c)return de(s)&&r.set(s,It),It;if(K(n))for(let f=0;f<n.length;f++){const u=Ft(n[f]);ji(u)&&(o[u]=ce)}else if(n)for(const f in n){const u=Ft(f);if(ji(u)){const g=n[f],_=o[u]=K(g)||Q(g)?{type:g}:Ee({},g),m=_.type;let x=!1,v=!0;if(K(m))for(let b=0;b<m.length;++b){const M=m[b],I=Q(M)&&M.name;if(I==="Boolean"){x=!0;break}else I==="String"&&(v=!1)}else x=Q(m)&&m.name==="Boolean";_[0]=x,_[1]=v,(x||Z(_,"default"))&&a.push(u)}}const h=[o,a];return de(s)&&r.set(s,h),h}function ji(s){return s[0]!=="$"&&!jt(s)}const lo=s=>s[0]==="_"||s==="$stable",li=s=>K(s)?s.map(He):[He(s)],Mc=(s,t,e)=>{if(t._n)return t;const r=rc((...i)=>li(t(...i)),e);return r._c=!1,r},co=(s,t,e)=>{const r=s._ctx;for(const i in s){if(lo(i))continue;const n=s[i];if(Q(n))t[i]=Mc(i,n,r);else if(n!=null){const o=li(n);t[i]=()=>o}}},ho=(s,t)=>{const e=li(t);s.slots.default=()=>e},fo=(s,t,e)=>{for(const r in t)(e||r!=="_")&&(s[r]=t[r])},Ic=(s,t,e)=>{const r=s.slots=io();if(s.vnode.shapeFlag&32){const i=t._;i?(fo(r,t,e),e&&En(r,"_",i,!0)):co(t,r)}else t&&ho(s,t)},Pc=(s,t,e)=>{const{vnode:r,slots:i}=s;let n=!0,o=ce;if(r.shapeFlag&32){const a=t._;a?e&&a===1?n=!1:fo(i,t,e):(n=!t.$stable,co(t,i)),o=t}else t&&(ho(s,t),o={default:1});if(n)for(const a in i)!lo(a)&&o[a]==null&&delete i[a]};function Ur(s,t,e,r,i=!1){if(K(s)){s.forEach((g,_)=>Ur(g,t&&(K(t)?t[_]:t),e,r,i));return}if(Ds(r)&&!i)return;const n=r.shapeFlag&4?hi(r.component):r.el,o=i?null:n,{i:a,r:c}=s,h=t&&t.r,f=a.refs===ce?a.refs={}:a.refs,u=a.setupState;if(h!=null&&h!==c&&(Me(h)?(f[h]=null,Z(u,h)&&(u[h]=null)):Pe(h)&&(h.value=null)),Q(c))rt(c,a,12,[o,f]);else{const g=Me(c),_=Pe(c);if(g||_){const m=()=>{if(s.f){const x=g?Z(u,c)?u[c]:f[c]:c.value;i?K(x)&&Xr(x,n):K(x)?x.includes(n)||x.push(n):g?(f[c]=[n],Z(u,c)&&(u[c]=f[c])):(c.value=[n],s.k&&(f[s.k]=c.value))}else g?(f[c]=o,Z(u,c)&&(u[c]=o)):_&&(c.value=o,s.k&&(f[s.k]=o))};o?(m.id=-1,Ae(m,e)):m()}}}const Lc=Symbol("_vte"),Fc=s=>s.__isTeleport,Ae=jc;function Oc(s){return Bc(s)}function Bc(s,t){const e=Cn();e.__VUE__=!0;const{insert:r,remove:i,patchProp:n,createElement:o,createText:a,createComment:c,setText:h,setElementText:f,parentNode:u,nextSibling:g,setScopeId:_=Be,insertStaticContent:m}=s,x=(d,p,y,w=null,R=null,E=null,N=void 0,F=null,O=!!p.dynamicChildren)=>{if(d===p)return;d&&!$t(d,p)&&(w=fe(d),le(d,R,E,!0),d=null),p.patchFlag===-2&&(O=!1,p.dynamicChildren=null);const{type:C,ref:D,shapeFlag:H}=p;switch(C){case rr:v(d,p,y,w);break;case as:b(d,p,y,w);break;case _r:d==null&&M(p,y,w,N);break;case ze:J(d,p,y,w,R,E,N,F,O);break;default:H&1?L(d,p,y,w,R,E,N,F,O):H&6?te(d,p,y,w,R,E,N,F,O):(H&64||H&128)&&C.process(d,p,y,w,R,E,N,F,O,ge)}D!=null&&R&&Ur(D,d&&d.ref,E,p||d,!p)},v=(d,p,y,w)=>{if(d==null)r(p.el=a(p.children),y,w);else{const R=p.el=d.el;p.children!==d.children&&h(R,p.children)}},b=(d,p,y,w)=>{d==null?r(p.el=c(p.children||""),y,w):p.el=d.el},M=(d,p,y,w)=>{[d.el,d.anchor]=m(d.children,p,y,w,d.el,d.anchor)},I=({el:d,anchor:p},y,w)=>{let R;for(;d&&d!==p;)R=g(d),r(d,y,w),d=R;r(p,y,w)},S=({el:d,anchor:p})=>{let y;for(;d&&d!==p;)y=g(d),i(d),d=y;i(p)},L=(d,p,y,w,R,E,N,F,O)=>{p.type==="svg"?N="svg":p.type==="math"&&(N="mathml"),d==null?A(p,y,w,R,E,N,F,O):Y(d,p,R,E,N,F,O)},A=(d,p,y,w,R,E,N,F)=>{let O,C;const{props:D,shapeFlag:H,transition:$,dirs:j}=d;if(O=d.el=o(d.type,E,D&&D.is,D),H&8?f(O,d.children):H&16&&V(d.children,O,null,w,R,gr(d,E),N,F),j&&ct(d,null,w,"created"),B(O,d,d.scopeId,N,w),D){for(const ae in D)ae!=="value"&&!jt(ae)&&n(O,ae,null,D[ae],E,w);"value"in D&&n(O,"value",null,D.value,E),(C=D.onVnodeBeforeMount)&&$e(C,w,d)}j&&ct(d,null,w,"beforeMount");const q=Nc(R,$);q&&$.beforeEnter(O),r(O,p,y),((C=D&&D.onVnodeMounted)||q||j)&&Ae(()=>{C&&$e(C,w,d),q&&$.enter(O),j&&ct(d,null,w,"mounted")},R)},B=(d,p,y,w,R)=>{if(y&&_(d,y),w)for(let E=0;E<w.length;E++)_(d,w[E]);if(R){let E=R.subTree;if(p===E){const N=R.vnode;B(d,N,N.scopeId,N.slotScopeIds,R.parent)}}},V=(d,p,y,w,R,E,N,F,O=0)=>{for(let C=O;C<d.length;C++){const D=d[C]=F?Ze(d[C]):He(d[C]);x(null,D,p,y,w,R,E,N,F)}},Y=(d,p,y,w,R,E,N)=>{const F=p.el=d.el;let{patchFlag:O,dynamicChildren:C,dirs:D}=p;O|=d.patchFlag&16;const H=d.props||ce,$=p.props||ce;let j;if(y&&ht(y,!1),(j=$.onVnodeBeforeUpdate)&&$e(j,y,p,d),D&&ct(p,d,y,"beforeUpdate"),y&&ht(y,!0),(H.innerHTML&&$.innerHTML==null||H.textContent&&$.textContent==null)&&f(F,""),C?G(d.dynamicChildren,C,F,y,w,gr(p,R),E):N||X(d,p,F,null,y,w,gr(p,R),E,!1),O>0){if(O&16)T(F,H,$,y,R);else if(O&2&&H.class!==$.class&&n(F,"class",null,$.class,R),O&4&&n(F,"style",H.style,$.style,R),O&8){const q=p.dynamicProps;for(let ae=0;ae<q.length;ae++){const re=q[ae],me=H[re],Ne=$[re];(Ne!==me||re==="value")&&n(F,re,me,Ne,R,y)}}O&1&&d.children!==p.children&&f(F,p.children)}else!N&&C==null&&T(F,H,$,y,R);((j=$.onVnodeUpdated)||D)&&Ae(()=>{j&&$e(j,y,p,d),D&&ct(p,d,y,"updated")},w)},G=(d,p,y,w,R,E,N)=>{for(let F=0;F<p.length;F++){const O=d[F],C=p[F],D=O.el&&(O.type===ze||!$t(O,C)||O.shapeFlag&70)?u(O.el):y;x(O,C,D,null,w,R,E,N,!0)}},T=(d,p,y,w,R)=>{if(p!==y){if(p!==ce)for(const E in p)!jt(E)&&!(E in y)&&n(d,E,p[E],null,R,w);for(const E in y){if(jt(E))continue;const N=y[E],F=p[E];N!==F&&E!=="value"&&n(d,E,F,N,R,w)}"value"in y&&n(d,"value",p.value,y.value,R)}},J=(d,p,y,w,R,E,N,F,O)=>{const C=p.el=d?d.el:a(""),D=p.anchor=d?d.anchor:a("");let{patchFlag:H,dynamicChildren:$,slotScopeIds:j}=p;j&&(F=F?F.concat(j):j),d==null?(r(C,y,w),r(D,y,w),V(p.children||[],y,D,R,E,N,F,O)):H>0&&H&64&&$&&d.dynamicChildren?(G(d.dynamicChildren,$,y,R,E,N,F),(p.key!=null||R&&p===R.subTree)&&uo(d,p,!0)):X(d,p,y,D,R,E,N,F,O)},te=(d,p,y,w,R,E,N,F,O)=>{p.slotScopeIds=F,d==null?p.shapeFlag&512?R.ctx.activate(p,y,w,N,O):ee(p,y,w,R,E,N,O):W(d,p,O)},ee=(d,p,y,w,R,E,N)=>{const F=d.component=ih(d,w,R);if(Qn(d)&&(F.ctx.renderer=ge),nh(F,!1,N),F.asyncDep){if(R&&R.registerDep(F,z,N),!d.el){const O=F.subTree=je(as);b(null,O,p,y)}}else z(F,d,p,y,R,E,N)},W=(d,p,y)=>{const w=p.component=d.component;if(Vc(d,p,y))if(w.asyncDep&&!w.asyncResolved){k(w,p,y);return}else w.next=p,ec(w.update),w.effect.dirty=!0,w.update();else p.el=d.el,w.vnode=p},z=(d,p,y,w,R,E,N)=>{const F=()=>{if(d.isMounted){let{next:D,bu:H,u:$,parent:j,vnode:q}=d;{const _t=po(d);if(_t){D&&(D.el=q.el,k(d,D,N)),_t.asyncDep.then(()=>{d.isUnmounted||F()});return}}let ae=D,re;ht(d,!1),D?(D.el=q.el,k(d,D,N)):D=q,H&&dr(H),(re=D.props&&D.props.onVnodeBeforeUpdate)&&$e(re,j,D,q),ht(d,!0);const me=xr(d),Ne=d.subTree;d.subTree=me,x(Ne,me,u(Ne.el),fe(Ne),d,R,E),D.el=me.el,ae===null&&Xc(d,me.el),$&&Ae($,R),(re=D.props&&D.props.onVnodeUpdated)&&Ae(()=>$e(re,j,D,q),R)}else{let D;const{el:H,props:$}=p,{bm:j,m:q,parent:ae}=d,re=Ds(p);if(ht(d,!1),j&&dr(j),!re&&(D=$&&$.onVnodeBeforeMount)&&$e(D,ae,p),ht(d,!0),H&&ue){const me=()=>{d.subTree=xr(d),ue(H,d.subTree,d,R,null)};re?p.type.__asyncLoader().then(()=>!d.isUnmounted&&me()):me()}else{const me=d.subTree=xr(d);x(null,me,y,w,d,R,E),p.el=me.el}if(q&&Ae(q,R),!re&&(D=$&&$.onVnodeMounted)){const me=p;Ae(()=>$e(D,ae,me),R)}(p.shapeFlag&256||ae&&Ds(ae.vnode)&&ae.vnode.shapeFlag&256)&&d.a&&Ae(d.a,R),d.isMounted=!0,p=y=w=null}},O=d.effect=new qr(F,Be,()=>oi(C),d.scope),C=d.update=()=>{O.dirty&&O.run()};C.i=d,C.id=d.uid,ht(d,!0),C()},k=(d,p,y)=>{p.component=d;const w=d.vnode.props;d.vnode=p,d.next=null,Cc(d,p.props,w,y),Pc(d,p.children,y),at(),Wi(d),lt()},X=(d,p,y,w,R,E,N,F,O=!1)=>{const C=d&&d.children,D=d?d.shapeFlag:0,H=p.children,{patchFlag:$,shapeFlag:j}=p;if($>0){if($&128){oe(C,H,y,w,R,E,N,F,O);return}else if($&256){ne(C,H,y,w,R,E,N,F,O);return}}j&8?(D&16&&he(C,R,E),H!==C&&f(y,H)):D&16?j&16?oe(C,H,y,w,R,E,N,F,O):he(C,R,E,!0):(D&8&&f(y,""),j&16&&V(H,y,w,R,E,N,F,O))},ne=(d,p,y,w,R,E,N,F,O)=>{d=d||It,p=p||It;const C=d.length,D=p.length,H=Math.min(C,D);let $;for($=0;$<H;$++){const j=p[$]=O?Ze(p[$]):He(p[$]);x(d[$],j,y,null,R,E,N,F,O)}C>D?he(d,R,E,!0,!1,H):V(p,y,w,R,E,N,F,O,H)},oe=(d,p,y,w,R,E,N,F,O)=>{let C=0;const D=p.length;let H=d.length-1,$=D-1;for(;C<=H&&C<=$;){const j=d[C],q=p[C]=O?Ze(p[C]):He(p[C]);if($t(j,q))x(j,q,y,null,R,E,N,F,O);else break;C++}for(;C<=H&&C<=$;){const j=d[H],q=p[$]=O?Ze(p[$]):He(p[$]);if($t(j,q))x(j,q,y,null,R,E,N,F,O);else break;H--,$--}if(C>H){if(C<=$){const j=$+1,q=j<D?p[j].el:w;for(;C<=$;)x(null,p[C]=O?Ze(p[C]):He(p[C]),y,q,R,E,N,F,O),C++}}else if(C>$)for(;C<=H;)le(d[C],R,E,!0),C++;else{const j=C,q=C,ae=new Map;for(C=q;C<=$;C++){const Le=p[C]=O?Ze(p[C]):He(p[C]);Le.key!=null&&ae.set(Le.key,C)}let re,me=0;const Ne=$-q+1;let _t=!1,ui=0;const Dt=new Array(Ne);for(C=0;C<Ne;C++)Dt[C]=0;for(C=j;C<=H;C++){const Le=d[C];if(me>=Ne){le(Le,R,E,!0);continue}let ke;if(Le.key!=null)ke=ae.get(Le.key);else for(re=q;re<=$;re++)if(Dt[re-q]===0&&$t(Le,p[re])){ke=re;break}ke===void 0?le(Le,R,E,!0):(Dt[ke-q]=C+1,ke>=ui?ui=ke:_t=!0,x(Le,p[ke],y,null,R,E,N,F,O),me++)}const di=_t?Uc(Dt):It;for(re=di.length-1,C=Ne-1;C>=0;C--){const Le=q+C,ke=p[Le],pi=Le+1<D?p[Le+1].el:w;Dt[C]===0?x(null,ke,y,pi,R,E,N,F,O):_t&&(re<0||C!==di[re]?pe(ke,y,pi,2):re--)}}},pe=(d,p,y,w,R=null)=>{const{el:E,type:N,transition:F,children:O,shapeFlag:C}=d;if(C&6){pe(d.component.subTree,p,y,w);return}if(C&128){d.suspense.move(p,y,w);return}if(C&64){N.move(d,p,y,ge);return}if(N===ze){r(E,p,y);for(let H=0;H<O.length;H++)pe(O[H],p,y,w);r(d.anchor,p,y);return}if(N===_r){I(d,p,y);return}if(w!==2&&C&1&&F)if(w===0)F.beforeEnter(E),r(E,p,y),Ae(()=>F.enter(E),R);else{const{leave:H,delayLeave:$,afterLeave:j}=F,q=()=>r(E,p,y),ae=()=>{H(E,()=>{q(),j&&j()})};$?$(E,q,ae):ae()}else r(E,p,y)},le=(d,p,y,w=!1,R=!1)=>{const{type:E,props:N,ref:F,children:O,dynamicChildren:C,shapeFlag:D,patchFlag:H,dirs:$,cacheIndex:j}=d;if(H===-2&&(R=!1),F!=null&&Ur(F,null,y,d,!0),j!=null&&(p.renderCache[j]=void 0),D&256){p.ctx.deactivate(d);return}const q=D&1&&$,ae=!Ds(d);let re;if(ae&&(re=N&&N.onVnodeBeforeUnmount)&&$e(re,p,d),D&6)Te(d.component,y,w);else{if(D&128){d.suspense.unmount(y,w);return}q&&ct(d,null,p,"beforeUnmount"),D&64?d.type.remove(d,p,y,ge,w):C&&!C.hasOnce&&(E!==ze||H>0&&H&64)?he(C,p,y,!1,!0):(E===ze&&H&384||!R&&D&16)&&he(O,p,y),w&&_e(d)}(ae&&(re=N&&N.onVnodeUnmounted)||q)&&Ae(()=>{re&&$e(re,p,d),q&&ct(d,null,p,"unmounted")},y)},_e=d=>{const{type:p,el:y,anchor:w,transition:R}=d;if(p===ze){ye(y,w);return}if(p===_r){S(d);return}const E=()=>{i(y),R&&!R.persisted&&R.afterLeave&&R.afterLeave()};if(d.shapeFlag&1&&R&&!R.persisted){const{leave:N,delayLeave:F}=R,O=()=>N(y,E);F?F(d.el,E,O):O()}else E()},ye=(d,p)=>{let y;for(;d!==p;)y=g(d),i(d),d=y;i(p)},Te=(d,p,y)=>{const{bum:w,scope:R,update:E,subTree:N,um:F,m:O,a:C}=d;Ki(O),Ki(C),w&&dr(w),R.stop(),E&&(E.active=!1,le(N,d,p,y)),F&&Ae(F,p),Ae(()=>{d.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&d.asyncDep&&!d.asyncResolved&&d.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},he=(d,p,y,w=!1,R=!1,E=0)=>{for(let N=E;N<d.length;N++)le(d[N],p,y,w,R)},fe=d=>{if(d.shapeFlag&6)return fe(d.component.subTree);if(d.shapeFlag&128)return d.suspense.next();const p=g(d.anchor||d.el),y=p&&p[Lc];return y?g(y):p};let se=!1;const ve=(d,p,y)=>{d==null?p._vnode&&le(p._vnode,null,null,!0):x(p._vnode||null,d,p,null,null,null,y),se||(se=!0,Wi(),Yn(),se=!1),p._vnode=d},ge={p:x,um:le,m:pe,r:_e,mt:ee,mc:V,pc:X,pbc:G,n:fe,o:s};let Ce,ue;return{render:ve,hydrate:Ce,createApp:wc(ve,Ce)}}function gr({type:s,props:t},e){return e==="svg"&&s==="foreignObject"||e==="mathml"&&s==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function ht({effect:s,update:t},e){s.allowRecurse=t.allowRecurse=e}function Nc(s,t){return(!s||s&&!s.pendingBranch)&&t&&!t.persisted}function uo(s,t,e=!1){const r=s.children,i=t.children;if(K(r)&&K(i))for(let n=0;n<r.length;n++){const o=r[n];let a=i[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[n]=Ze(i[n]),a.el=o.el),!e&&a.patchFlag!==-2&&uo(o,a)),a.type===rr&&(a.el=o.el)}}function Uc(s){const t=s.slice(),e=[0];let r,i,n,o,a;const c=s.length;for(r=0;r<c;r++){const h=s[r];if(h!==0){if(i=e[e.length-1],s[i]<h){t[r]=i,e.push(r);continue}for(n=0,o=e.length-1;n<o;)a=n+o>>1,s[e[a]]<h?n=a+1:o=a;h<s[e[n]]&&(n>0&&(t[r]=e[n-1]),e[n]=r)}}for(n=e.length,o=e[n-1];n-- >0;)e[n]=o,o=t[o];return e}function po(s){const t=s.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:po(t)}function Ki(s){if(s)for(let t=0;t<s.length;t++)s[t].active=!1}const Dc=Symbol.for("v-scx"),kc=()=>ks(Dc),Ls={};function mr(s,t,e){return go(s,t,e)}function go(s,t,{immediate:e,deep:r,flush:i,once:n,onTrack:o,onTrigger:a}=ce){if(t&&n){const A=t;t=(...B)=>{A(...B),L()}}const c=Se,h=A=>r===!0?A:ut(A,r===!1?1:void 0);let f,u=!1,g=!1;if(Pe(s)?(f=()=>s.value,u=Ot(s)):Kt(s)?(f=()=>h(s),u=!0):K(s)?(g=!0,u=s.some(A=>Kt(A)||Ot(A)),f=()=>s.map(A=>{if(Pe(A))return A.value;if(Kt(A))return h(A);if(Q(A))return rt(A,c,2)})):Q(s)?t?f=()=>rt(s,c,2):f=()=>(_&&_(),Ve(s,c,3,[m])):f=Be,t&&r){const A=f;f=()=>ut(A())}let _,m=A=>{_=I.onStop=()=>{rt(A,c,4),_=I.onStop=void 0}},x;if(ir)if(m=Be,t?e&&Ve(t,c,3,[f(),g?[]:void 0,m]):f(),i==="sync"){const A=kc();x=A.__watcherHandles||(A.__watcherHandles=[])}else return Be;let v=g?new Array(s.length).fill(Ls):Ls;const b=()=>{if(!(!I.active||!I.dirty))if(t){const A=I.run();(r||u||(g?A.some((B,V)=>it(B,v[V])):it(A,v)))&&(_&&_(),Ve(t,c,3,[A,v===Ls?void 0:g&&v[0]===Ls?[]:v,m]),v=A)}else I.run()};b.allowRecurse=!!t;let M;i==="sync"?M=b:i==="post"?M=()=>Ae(b,c&&c.suspense):(b.pre=!0,c&&(b.id=c.uid),M=()=>oi(b));const I=new qr(f,Be,M),S=El(),L=()=>{I.stop(),S&&Xr(S.effects,I)};return t?e?b():v=I.run():i==="post"?Ae(I.run.bind(I),c&&c.suspense):I.run(),x&&x.push(L),L}function $c(s,t,e){const r=this.proxy,i=Me(s)?s.includes(".")?mo(r,s):()=>r[s]:s.bind(r,r);let n;Q(t)?n=t:(n=t.handler,e=t);const o=ds(this),a=go(i,n.bind(r),e);return o(),a}function mo(s,t){const e=t.split(".");return()=>{let r=s;for(let i=0;i<e.length&&r;i++)r=r[e[i]];return r}}function ut(s,t=1/0,e){if(t<=0||!de(s)||s.__v_skip||(e=e||new Set,e.has(s)))return s;if(e.add(s),t--,Pe(s))ut(s.value,t,e);else if(K(s))for(let r=0;r<s.length;r++)ut(s[r],t,e);else if(ul(s)||Yt(s))s.forEach(r=>{ut(r,t,e)});else if(gl(s)){for(const r in s)ut(s[r],t,e);for(const r of Object.getOwnPropertySymbols(s))Object.prototype.propertyIsEnumerable.call(s,r)&&ut(s[r],t,e)}return s}const zc=(s,t)=>t==="modelValue"||t==="model-value"?s.modelModifiers:s[`${t}Modifiers`]||s[`${Ft(t)}Modifiers`]||s[`${us(t)}Modifiers`];function Hc(s,t,...e){if(s.isUnmounted)return;const r=s.vnode.props||ce;let i=e;const n=t.startsWith("update:"),o=n&&zc(r,t.slice(7));o&&(o.trim&&(i=e.map(f=>Me(f)?f.trim():f)),o.number&&(i=e.map(yl)));let a,c=r[a=ur(t)]||r[a=ur(Ft(t))];!c&&n&&(c=r[a=ur(us(t))]),c&&Ve(c,s,6,i);const h=r[a+"Once"];if(h){if(!s.emitted)s.emitted={};else if(s.emitted[a])return;s.emitted[a]=!0,Ve(h,s,6,i)}}function xo(s,t,e=!1){const r=t.emitsCache,i=r.get(s);if(i!==void 0)return i;const n=s.emits;let o={},a=!1;if(!Q(s)){const c=h=>{const f=xo(h,t,!0);f&&(a=!0,Ee(o,f))};!e&&t.mixins.length&&t.mixins.forEach(c),s.extends&&c(s.extends),s.mixins&&s.mixins.forEach(c)}return!n&&!a?(de(s)&&r.set(s,null),null):(K(n)?n.forEach(c=>o[c]=null):Ee(o,n),de(s)&&r.set(s,o),o)}function sr(s,t){return!s||!Vr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Z(s,t[0].toLowerCase()+t.slice(1))||Z(s,us(t))||Z(s,t))}function xr(s){const{type:t,vnode:e,proxy:r,withProxy:i,propsOptions:[n],slots:o,attrs:a,emit:c,render:h,renderCache:f,props:u,data:g,setupState:_,ctx:m,inheritAttrs:x}=s,v=Vs(s);let b,M;try{if(e.shapeFlag&4){const S=i||r,L=S;b=He(h.call(L,S,f,u,_,g,m)),M=a}else{const S=t;b=He(S.length>1?S(u,{attrs:a,slots:o,emit:c}):S(u,null)),M=t.props?a:Wc(a)}}catch(S){Zt.length=0,er(S,s,1),b=je(as)}let I=b;if(M&&x!==!1){const S=Object.keys(M),{shapeFlag:L}=I;S.length&&L&7&&(n&&S.some(wn)&&(M=Gc(M,n)),I=Bt(I,M,!1,!0))}return e.dirs&&(I=Bt(I,null,!1,!0),I.dirs=I.dirs?I.dirs.concat(e.dirs):e.dirs),e.transition&&(I.transition=e.transition),b=I,Vs(v),b}const Wc=s=>{let t;for(const e in s)(e==="class"||e==="style"||Vr(e))&&((t||(t={}))[e]=s[e]);return t},Gc=(s,t)=>{const e={};for(const r in s)(!wn(r)||!(r.slice(9)in t))&&(e[r]=s[r]);return e};function Vc(s,t,e){const{props:r,children:i,component:n}=s,{props:o,children:a,patchFlag:c}=t,h=n.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&c>=0){if(c&1024)return!0;if(c&16)return r?qi(r,o,h):!!o;if(c&8){const f=t.dynamicProps;for(let u=0;u<f.length;u++){const g=f[u];if(o[g]!==r[g]&&!sr(h,g))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?qi(r,o,h):!0:!!o;return!1}function qi(s,t,e){const r=Object.keys(t);if(r.length!==Object.keys(s).length)return!0;for(let i=0;i<r.length;i++){const n=r[i];if(t[n]!==s[n]&&!sr(e,n))return!0}return!1}function Xc({vnode:s,parent:t},e){for(;t;){const r=t.subTree;if(r.suspense&&r.suspense.activeBranch===s&&(r.el=s.el),r===s)(s=t.vnode).el=e,t=t.parent;else break}}const Yc=s=>s.__isSuspense;function jc(s,t){t&&t.pendingBranch?K(s)?t.effects.push(...s):t.effects.push(s):tc(s)}const ze=Symbol.for("v-fgt"),rr=Symbol.for("v-txt"),as=Symbol.for("v-cmt"),_r=Symbol.for("v-stc"),Zt=[];let Oe=null;function yr(s=!1){Zt.push(Oe=s?null:[])}function Kc(){Zt.pop(),Oe=Zt[Zt.length-1]||null}let ls=1;function Qi(s){ls+=s,s<0&&Oe&&(Oe.hasOnce=!0)}function _o(s){return s.dynamicChildren=ls>0?Oe||It:null,Kc(),ls>0&&Oe&&Oe.push(s),s}function Zi(s,t,e,r,i,n){return _o(To(s,t,e,r,i,n,!0))}function qc(s,t,e,r,i){return _o(je(s,t,e,r,i,!0))}function Qc(s){return s?s.__v_isVNode===!0:!1}function $t(s,t){return s.type===t.type&&s.key===t.key}const yo=({key:s})=>s??null,$s=({ref:s,ref_key:t,ref_for:e})=>(typeof s=="number"&&(s=""+s),s!=null?Me(s)||Pe(s)||Q(s)?{i:Ge,r:s,k:t,f:!!e}:s:null);function To(s,t=null,e=null,r=0,i=null,n=s===ze?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:s,props:t,key:t&&yo(t),ref:t&&$s(t),scopeId:Kn,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Ge};return a?(ci(c,e),n&128&&s.normalize(c)):e&&(c.shapeFlag|=Me(e)?8:16),ls>0&&!o&&Oe&&(c.patchFlag>0||n&6)&&c.patchFlag!==32&&Oe.push(c),c}const je=Zc;function Zc(s,t=null,e=null,r=0,i=null,n=!1){if((!s||s===gc)&&(s=as),Qc(s)){const a=Bt(s,t,!0);return e&&ci(a,e),ls>0&&!n&&Oe&&(a.shapeFlag&6?Oe[Oe.indexOf(s)]=a:Oe.push(a)),a.patchFlag=-2,a}if(ch(s)&&(s=s.__vccOpts),t){t=Jc(t);let{class:a,style:c}=t;a&&!Me(a)&&(t.class=Kr(a)),de(c)&&($n(c)&&!K(c)&&(c=Ee({},c)),t.style=jr(c))}const o=Me(s)?1:Yc(s)?128:Fc(s)?64:de(s)?4:Q(s)?2:0;return To(s,t,e,r,i,o,n,!0)}function Jc(s){return s?$n(s)||no(s)?Ee({},s):s:null}function Bt(s,t,e=!1,r=!1){const{props:i,ref:n,patchFlag:o,children:a,transition:c}=s,h=t?th(i||{},t):i,f={__v_isVNode:!0,__v_skip:!0,type:s.type,props:h,key:h&&yo(h),ref:t&&t.ref?e&&n?K(n)?n.concat($s(t)):[n,$s(t)]:$s(t):n,scopeId:s.scopeId,slotScopeIds:s.slotScopeIds,children:a,target:s.target,targetStart:s.targetStart,targetAnchor:s.targetAnchor,staticCount:s.staticCount,shapeFlag:s.shapeFlag,patchFlag:t&&s.type!==ze?o===-1?16:o|16:o,dynamicProps:s.dynamicProps,dynamicChildren:s.dynamicChildren,appContext:s.appContext,dirs:s.dirs,transition:c,component:s.component,suspense:s.suspense,ssContent:s.ssContent&&Bt(s.ssContent),ssFallback:s.ssFallback&&Bt(s.ssFallback),el:s.el,anchor:s.anchor,ctx:s.ctx,ce:s.ce};return c&&r&&qn(f,c.clone(f)),f}function eh(s=" ",t=0){return je(rr,null,s,t)}function He(s){return s==null||typeof s=="boolean"?je(as):K(s)?je(ze,null,s.slice()):typeof s=="object"?Ze(s):je(rr,null,String(s))}function Ze(s){return s.el===null&&s.patchFlag!==-1||s.memo?s:Bt(s)}function ci(s,t){let e=0;const{shapeFlag:r}=s;if(t==null)t=null;else if(K(t))e=16;else if(typeof t=="object")if(r&65){const i=t.default;i&&(i._c&&(i._d=!1),ci(s,i()),i._c&&(i._d=!0));return}else{e=32;const i=t._;!i&&!no(t)?t._ctx=Ge:i===3&&Ge&&(Ge.slots._===1?t._=1:(t._=2,s.patchFlag|=1024))}else Q(t)?(t={default:t,_ctx:Ge},e=32):(t=String(t),r&64?(e=16,t=[eh(t)]):e=8);s.children=t,s.shapeFlag|=e}function th(...s){const t={};for(let e=0;e<s.length;e++){const r=s[e];for(const i in r)if(i==="class")t.class!==r.class&&(t.class=Kr([t.class,r.class]));else if(i==="style")t.style=jr([t.style,r.style]);else if(Vr(i)){const n=t[i],o=r[i];o&&n!==o&&!(K(n)&&n.includes(o))&&(t[i]=n?[].concat(n,o):o)}else i!==""&&(t[i]=r[i])}return t}function $e(s,t,e,r=null){Ve(s,t,7,[e,r])}const sh=so();let rh=0;function ih(s,t,e){const r=s.type,i=(t?t.appContext:s.appContext)||sh,n={uid:rh++,vnode:s,type:r,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new wl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ao(r,i),emitsOptions:xo(r,i),emit:null,emitted:null,propsDefaults:ce,inheritAttrs:r.inheritAttrs,ctx:ce,data:ce,props:ce,attrs:ce,slots:ce,refs:ce,setupState:ce,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=Hc.bind(null,n),s.ce&&s.ce(n),n}let Se=null,Ys,Dr;{const s=Cn(),t=(e,r)=>{let i;return(i=s[e])||(i=s[e]=[]),i.push(r),n=>{i.length>1?i.forEach(o=>o(n)):i[0](n)}};Ys=t("__VUE_INSTANCE_SETTERS__",e=>Se=e),Dr=t("__VUE_SSR_SETTERS__",e=>ir=e)}const ds=s=>{const t=Se;return Ys(s),s.scope.on(),()=>{s.scope.off(),Ys(t)}},Ji=()=>{Se&&Se.scope.off(),Ys(null)};function vo(s){return s.vnode.shapeFlag&4}let ir=!1;function nh(s,t=!1,e=!1){t&&Dr(t);const{props:r,children:i}=s.vnode,n=vo(s);Ec(s,r,n,t),Ic(s,i,e);const o=n?oh(s,t):void 0;return t&&Dr(!1),o}function oh(s,t){const e=s.type;s.accessCache=Object.create(null),s.proxy=new Proxy(s.ctx,xc);const{setup:r}=e;if(r){const i=s.setupContext=r.length>1?lh(s):null,n=ds(s);at();const o=rt(r,s,0,[s.props,i]);if(lt(),n(),Sn(o)){if(o.then(Ji,Ji),t)return o.then(a=>{en(s,a,t)}).catch(a=>{er(a,s,0)});s.asyncDep=o}else en(s,o,t)}else bo(s,t)}function en(s,t,e){Q(t)?s.type.__ssrInlineRender?s.ssrRender=t:s.render=t:de(t)&&(s.setupState=Gn(t)),bo(s,e)}let tn;function bo(s,t,e){const r=s.type;if(!s.render){if(!t&&tn&&!r.render){const i=r.template||ai(s).template;if(i){const{isCustomElement:n,compilerOptions:o}=s.appContext.config,{delimiters:a,compilerOptions:c}=r,h=Ee(Ee({isCustomElement:n,delimiters:a},o),c);r.render=tn(i,h)}}s.render=r.render||Be}{const i=ds(s);at();try{_c(s)}finally{lt(),i()}}}const ah={get(s,t){return Ie(s,"get",""),s[t]}};function lh(s){const t=e=>{s.exposed=e||{}};return{attrs:new Proxy(s.attrs,ah),slots:s.slots,emit:s.emit,expose:t}}function hi(s){return s.exposed?s.exposeProxy||(s.exposeProxy=new Proxy(Gn(ri(s.exposed)),{get(t,e){if(e in t)return t[e];if(e in qt)return qt[e](s)},has(t,e){return e in t||e in qt}})):s.proxy}function ch(s){return Q(s)&&"__vccOpts"in s}const hh=(s,t)=>Yl(s,t,ir),fh="3.4.36",uh="comment";function dh(s,t,e){if(e){Ro(s,t);const r=s._rawNodes.indexOf(e);s._rawNodes.splice(r,0,t)}else s._rawNodes.push(t);t.parent=s}function Ro(s,t){const e=s._rawNodes.indexOf(t);e>=0&&s._rawNodes.splice(e,1)}const fi={createElement(s){const t=new pt(s);return t._rawNodes=[],ri(t),t},createText(s){return{_type:et.Text,text:s,parent:void 0,skipFocus:!0}},createComment(s){return{_type:uh,text:s,parent:void 0,skipFocus:!0}},setText(s,t){tt("Replace Text: ",s,t),s.text=t;const e=s.parent;U(e),e.text=e.getText()},setElementText(s,t){tt("SetElementText: ",s,t),s.text=t},setProperty(s,t,e,r){s[t]=r},insert(s,t,e){tt("INSERT: ",t,s,e),s._queueDelete=!1,dh(t,s,e),s instanceof pt?(t.insertChild(s,e),t.rendered&&s.render()):t.isTextNode()&&(t.insertChild(s,e),t.text=t.getText())},isTextNode(s){return s.isTextNode()},remove(s){tt("REMOVE: ",s),Ro(s.parent,s),s._queueDelete=!0,s instanceof pt&&(s.parent.removeChild(s),queueMicrotask(()=>s.destroy()))},querySelector(s){},setScopeId(s,t){return s.id=t},parentNode(s){return s.parent},nextSibling(s){const t=s.parent._rawNodes||[],e=t.indexOf(s)+1;if(e<t.length)return t[e]}},ph=fi.setProperty,gh=function(s,t){const e=Qa(Fe.rendererOptions,t),r=fi.createElement("App");return r.lng=e.root,r.rendered=!0,{app:mh(s),rootNode:r,renderer:e}},{render:Eh,createApp:mh}=Oc(Ee({patchProp:ph},fi)),Tt="/";function xh(s){s.fontManager.addFontFace(new Xt("msdf",{fontFamily:"Roboto",descriptors:{weight:700},atlasDataUrl:Tt+"fonts/Roboto-Bold.msdf.json",atlasUrl:Tt+"fonts/Roboto-Bold.msdf.png",stage:s})),s.fontManager.addFontFace(new Xt("msdf",{fontFamily:"Roboto",descriptors:{weight:400},atlasDataUrl:Tt+"fonts/Roboto-Regular.msdf.json",atlasUrl:Tt+"fonts/Roboto-Regular.msdf.png",stage:s})),s.fontManager.addFontFace(new Xt("msdf",{fontFamily:"Arial",descriptors:{weight:500},atlasDataUrl:Tt+"fonts/Roboto-Regular.msdf.json",atlasUrl:Tt+"fonts/Roboto-Regular.msdf.png",stage:s}))}function _h(s){return je("node",s.data,null)}const yh=800,Th=600,vh={__name:"Perf",setup(s){const t=Hi([]),e=Hi(null),r=(o,a)=>Math.floor(Math.random()*(a-o+1))+o,i=()=>"0x"+Math.floor(Math.random()*16777215).toString(16)+"FF",n=()=>{const o=ri([]);for(let a=0;a<1e3;a++)o.push({id:a,width:r(50,100),height:r(50,100),x:r(0,yh),y:r(0,Th),borderRadius:r(0,50),color:i()});t.value=o};return Jn(()=>{setInterval(()=>{n()},2e3)}),(o,a)=>(yr(),Zi("node",{ref_key:"blockContainer",ref:e},[(yr(!0),Zi(ze,null,mc(t.value,c=>(yr(),qc(Wn(_h),{data:c},null,8,["data"]))),256))],512))}};Fe.debug=!1;Fe.animationsEnabled=!0;Fe.fontSettings.fontFamily="Roboto";Fe.fontSettings.color=4143380223;Fe.fontSettings.fontSize=32;Fe.rendererOptions={fpsUpdateInterval:0,enableInspector:!1};const{app:bh,rootNode:Rh,renderer:wh}=gh(vh);xh(wh.stage);bh.mount(Rh);
//# sourceMappingURL=main-F2S6fzVB.js.map
