var dl=Object.defineProperty;var pl=(i,t,e)=>t in i?dl(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var h=(i,t,e)=>pl(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();const g={currentView:Symbol("currentView"),cursorTagStart:Symbol("cursorTagStart"),computedKeys:Symbol("computedKeys"),destroy:Symbol("destroy"),getChildren:Symbol("getChildren"),holder:Symbol("holder"),id:Symbol("id"),identifier:Symbol("identifier"),index:Symbol("index"),init:Symbol("init"),inputEvents:Symbol("inputEvents"),intervals:Symbol("intervals"),launched:Symbol("launched"),level:Symbol("level"),methodKeys:Symbol("methodKeys"),originalState:Symbol("originalState"),propKeys:Symbol("propKeys"),raw:Symbol("raw"),ready:Symbol("ready"),renderer:Symbol("renderer"),routes:Symbol("routes"),routerHooks:Symbol("routerHooks"),settings:Symbol("settings"),state:Symbol("state"),stateKeys:Symbol("stateKeys"),textnode:Symbol("textnode"),timeouts:Symbol("timeouts"),type:Symbol("type"),watchers:Symbol("watchers"),watchKeys:Symbol("watchKeys"),wrapper:Symbol("wrapper"),children:Symbol.for("children"),components:Symbol.for("components"),isSlot:Symbol.for("isSlot"),props:Symbol.for("props"),slots:Symbol.for("slots"),componentType:Symbol.for("componentType"),isComponent:Symbol.for("isComponent"),effects:Symbol.for("effects"),removeGlobalEffects:Symbol.for("removeGlobalEffects")},Ne={[g.settings]:{},get(i,t=null){return i in this[g.settings]?this[g.settings][i]:t},set(i,t){typeof i=="object"?Object.keys(i).forEach(e=>{this.set(e,i[e])}):this[g.settings][i]=t}},Wr=()=>{},Ao=()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),jn=i=>{const t=Ne.get("debugLevel"),e={};return Object.defineProperty(e,"info",{get(){return(t>=1||Array.isArray(t)&&t.indexOf("info")>-1)&&console.info.bind(window.console,`%c ⚡️ ${i} %c ${Ao()}`,"background-color: #0284c7; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Wr}}),Object.defineProperty(e,"warn",{get(){return(t>=1||Array.isArray(t)&&t.indexOf("warn")>-1)&&console.warn.bind(window.console,`%c ⚡️ ${i} %c ${Ao()}`,"background-color: #fbbf24; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Wr}}),Object.defineProperty(e,"error",{get(){return(t>=1||Array.isArray(t)&&t.indexOf("error")>-1)&&console.error.bind(window.console,`%c ⚡️ ${i} %c ${Ao()}`,"background-color: #dc2626; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Wr}}),Object.defineProperty(e,"debug",{get(){return(t>=2||Array.isArray(t)&&t.indexOf("debug")>-1)&&console.debug.bind(window.console,`%c ⚡️ ${i} %c (${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})`,"background-color: #e2e8f0; color: #334155; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Wr}}),e};let q;const ml=()=>{q=jn("Blits")},Vr={aliceblue:"0xf0f8ffff",antiquewhite:"0xfaebd7ff",aqua:"0xffffff00",aquamarine:"0x7fffd4ff",azure:"0xf0ffffff",beige:"0xf5f5dcff",bisque:"0xffe4c4ff",black:"0x000000ff",blanchedalmond:"0xffebcdff",blue:"0x0000ffff",blueviolet:"0x8a2be2ff",brown:"0xa52a2aff",burlywood:"0xdeb887ff",cadetblue:"0x5f9ea0ff",chartreuse:"0x7fff00ff",chocolate:"0xd2691eff",coral:"0xff7f50ff",cornflowerblue:"0x6495edff",cornsilk:"0xfff8dcff",crimson:"0xdc143cff",cyan:"0x00ffffff",darkblue:"0x00008bff",darkcyan:"0x008b8bff",darkgoldenrod:"0xb8860bff",darkgray:"0xa9a9a9ff",darkgreen:"0x006400ff",darkgrey:"0xa9a9a9ff",darkkhaki:"0xbdb76bff",darkmagenta:"0x8b008bff",darkolivegreen:"0x556b2fff",darkorange:"0xff8c00ff",darkorchid:"0x9932ccff",darkred:"0x8b0000ff",darksalmon:"0xe9967aff",darkseagreen:"0x8fbc8fff",darkslateblue:"0x483d8bff",darkslategray:"0x2f4f4fff",darkslategrey:"0x2f4f4fff",darkturquoise:"0x00ced1ff",darkviolet:"0x9400d3ff",deeppink:"0xff1493ff",deepskyblue:"0x00bfffff",dimgray:"0x696969ff",dimgrey:"0x696969ff",dodgerblue:"0x1e90ffff",firebrick:"0xb22222ff",floralwhite:"0xfffaf0ff",forestgreen:"0x228b22ff",fuchsia:"0xff00ffff",gainsboro:"0xdcdcdcff",ghostwhite:"0xf8f8ffff",gold:"0xffd700ff",goldenrod:"0xdaa520ff",gray:"0x808080ff",green:"0x008000ff",greenyellow:"0xadff2fff",grey:"0x808080ff",honeydew:"0xf0fff0ff",hotpink:"0xff69b4ff",indianred:"0xcd5c5cff",indigo:"0x4b0082ff",ivory:"0xfffff0ff",khaki:"0xf0e68cff",lavender:"0xe6e6faff",lavenderblush:"0xfff0f5ff",lawngreen:"0x7cfc00ff",lemonchiffon:"0xfffacdff",lightblue:"0xadd8e6ff",lightcoral:"0xf08080ff",lightcyan:"0xe0ffffff",lightgoldenrodyellow:"0xfafad2ff",lightgray:"0xd3d3d3ff",lightgreen:"0x90ee90ff",lightgrey:"0xd3d3d3ff",lightpink:"0xffb6c1ff",lightsalmon:"0xffa07aff",lightseagreen:"0x20b2aaff",lightskyblue:"0x87cefaff",lightslategray:"0x778899ff",lightslategrey:"0x778899ff",lightsteelblue:"0xb0c4deff",lightyellow:"0xffffe0ff",lime:"0x00ff00ff",limegreen:"0x32cd32ff",linen:"0xfaf0e6ff",magenta:"0xff00ffff",maroon:"0x800000ff",mediumaquamarine:"0x66cdaaff",mediumblue:"0x0000cdff",mediumorchid:"0xba55d3ff",mediumpurple:"0x9370dbff",mediumseagreen:"0x3cb371ff",mediumslateblue:"0x7b68eeff",mediumspringgreen:"0x00fa9aff",mediumturquoise:"0x48d1ccff",mediumvioletred:"0xc71585ff",midnightblue:"0x191970ff",mintcream:"0xf5fffaff",mistyrose:"0xffe4e1ff",moccasin:"0xffe4b5ff",navajowhite:"0xffdeadff",navy:"0x000080ff",oldlace:"0xfdf5e6ff",olive:"0x808000ff",olivedrab:"0x6b8e23ff",orange:"0xffa500ff",orangered:"0xff4500ff",orchid:"0xda70d6ff",palegoldenrod:"0xeee8aaff",palegreen:"0x98fb98ff",paleturquoise:"0xafeeeeff",palevioletred:"0xdb7093ff",papayawhip:"0xffefd5ff",peachpuff:"0xffdab9ff",peru:"0xcd853fff",pink:"0xffc0cbff",plum:"0xdda0ddff",powderblue:"0xb0e0e6ff",purple:"0x800080ff",rebeccapurple:"0x663399ff",red:"0xff0000ff",rosybrown:"0xbc8f8fff",royalblue:"0x4169e1ff",saddlebrown:"0x8b4513ff",salmon:"0xfa8072ff",sandybrown:"0xf4a460ff",seagreen:"0x2e8b57ff",seashell:"0xfff5eeff",sienna:"0xa0522dff",silver:"0xc0c0c0ff",skyblue:"0x87ceebff",slateblue:"0x6a5acdff",slategray:"0x708090ff",slategrey:"0x708090ff",snow:"0xfffafaff",springgreen:"0x00ff7fff",steelblue:"0x4682b4ff",tan:"0xd2b48cff",teal:"0x008080ff",thistle:"0xd8bfd8ff",tomato:"0xff6347ff",transparent:"0x00000000",turquoise:"0x40e0d0ff",violet:"0xee82eeff",wheat:"0xf5deb3ff",white:"0xffffffff",whitesmoke:"0xf5f5f5ff",yellow:"0xffff00ff",yellowgreen:"0x9acd32ff"},gl=/^#?([0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,yl=/^(rgba?)\((\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*)(,(\s*(-?\d+(?:\.\d+)?)\s*))?\)$/,xl=/^(hsla?)\((\s*(360|3[0-5][0-9]|[12]?[0-9]{1,2})\s*),(\s*(100|[1-9]?[0-9])\s*)%,(\s*(100|[1-9]?[0-9])\s*)%(,(\s*(1|0(?:\.\d+)?)\s*))?\)$/,Mo={},Xr=i=>{if(Mo[i]!==void 0)return Mo[i];const t=parseInt(i).toString(16).padStart(2,"0");return Mo[i]=t,t},ti={normalize:(i="",t="0xffffffff")=>{if(i=i.toString(),i.startsWith("0x")&&i.length===10)return i;if(Vr[i]!==void 0)return Vr[i];if(gl.test(i)){i=i.replace("#","").toLowerCase(),i.length===3&&(i=i.split("").map(r=>r+r).join(""));const s="0x"+i.padEnd(8,"f");return Vr[i]=s,s}const e=yl.exec(i);if(e){const s=Xr(e[3]),r=Xr(e[5]),a=Xr(e[7]);let l="ff";if(e[10]&&e[1]==="rgba"){const o=Math.min(Math.max(Math.round(parseFloat(e[10])*255),0),255);l=Xr(o)}const u="0x"+s+r+a+l;return Vr[i]=u,u}return xl.test(i)?(console.warn("HSL(A) color format is not supported yet"),"0xffffffff"):t}},Tl=(i="",t,e,s=null)=>{let r=0,a=0,l=[],u=null,o=0;const n=/^<\/?([a-zA-Z0-9_\-.]+)\s*/,c=/^\s*(\/?>)\s*/,f=/^([A-Za-z0-9:.\-_@$]+)=\s*(["'])/,d=/^<>\s*/,p=/^\s*(<\/>)\s*/,m=()=>{i=b(i);try{return y(S),U(l)}catch(v){throw(v.name=="TemplateParseError"||v.name=="TemplateStructureError")&&(v.message=`${v.message}
${v.context}`),v}},y=v=>{r>=i.length||v()},b=v=>v.replace(/<!--.*?-->/gms,"").replace(/\r?\n\s*\r\n/gm," ").replace(/\r?\n\s*(\S)/gm," $1").replace(/\r?\n/g,"").trim(),w=v=>{const A=i.slice(r).match(v);return A&&(a=r,r+=A[0].length),A},S=()=>{w(d)?(l.push({[Symbol.for("componentType")]:null,[g.type]:"opening",[g.level]:o,[g.cursorTagStart]:a}),o++,y(S)):y(_)},_=()=>{w(p)?(o--,l.push({[Symbol.for("componentType")]:null,[g.type]:"closing",[g.level]:o}),y(S)):y(x)},x=()=>{const v=w(n);if(v)u={[Symbol.for("componentType")]:v[1],[g.level]:o,[g.cursorTagStart]:a},v[0].startsWith("</")?(o--,u[g.type]="closing",u[g.level]=o):(u[g.type]="opening",o++),y($);else throw B("InvalidTag")},$=()=>{const v=w(c);if(v){if(v[1]==="/>"){if(u[g.type]==="closing")throw B("InvalidClosingTag");u[g.type]="self-closing",o--}if(u[g.type]==="opening"){const A=i.slice(r,i.indexOf("<",r));A&&(u.content=A,r+=A.length)}l.push(u),y(S)}else y(M)},M=()=>{const v=w(f);if(v){if(u[g.type]==="closing")throw B("AttributesInClosingTag");const A=v[2],D=new RegExp(`^(.*?)${A}\\s*`),z=w(D);if(z){const X=P(v[1],z[1]);u[X.name]=X.value,y($)}else throw B("MissingOrInvalidAttributeValue")}else throw B("InvalidAttribute")},P=(v,A)=>{if(v.includes(".")){const[D,z]=v.split(".");return{name:D,value:`{${z}: ${A}}`}}return["color",":color",":effects","effects"].includes(v)?L(v,A):{name:v,value:A}},L=(v,A)=>{let D=A,z=ti.normalize(D,null);if(z===null){const X=/'([^']+)'/g;let G,W=0,j="";for(;(G=X.exec(A))!==null;){const Y=G[1],ae=G.index,K=G[0].length;j+=A.slice(W,ae),z=ti.normalize(Y,null),z===null?j+=A.slice(ae,ae+K):j+=`'${z}'`,W=ae+K}j+=A.slice(W),D=j}else D=z;return{name:v,value:D}},U=v=>{let A=[],D=!1,z={children:[]},X=z;for(let G=0;G<v.length;G++){let W=v[G];if(W[g.level]===0&&W[g.type]!=="closing"){if(D)throw E("MultipleTopLevelTags",W);if(W[":for"]!==void 0)throw E("ForAttributeOnRootElement",W);D=!0}if(W[g.type]==="opening")A.push({[g.level]:W[g.level],[g.type]:W[g.type],[g.cursorTagStart]:W[g.cursorTagStart],[Symbol.for("componentType")]:W[Symbol.for("componentType")],parent:X});else if(W[g.type]==="closing"){const Y=A.length===0;let ae=!1,K=!1;if(Y||(ae=A[A.length-1][g.level]!==W[g.level],K=A[A.length-1][Symbol.for("componentType")]!==W[Symbol.for("componentType")]),Y||ae||K)throw E("MismatchedClosingTag",W);X=A.pop().parent}const j={...W};delete j[g.type],delete j[g.level],delete j[g.cursorTagStart],W[g.type]==="opening"?(G+1<v.length&&v[G+1][g.type]!=="closing"&&(j.children=[]),X.children.push(j),X=j):W[g.type]==="self-closing"&&X.children.push(j)}if(A.length>0)throw E("UnclosedTags",A);return z},k=10,F=50,B=v=>{const A=I();v=`${v} in ${A}`;const D=new Error(v);D.name="TemplateParseError";const z=Math.max(0,a-k),X=Math.min(i.length,r+F),G=i.slice(z,X),W=r-z;return D.context=C(W,G),D},E=(v,A)=>{const D=I();v=`${v} in ${D}`;const z=new Error(v);z.name="TemplateStructureError",Array.isArray(A)?z.context=A.map(G=>X(G)).join(`
`):z.context=X(A);function X(G){const W=Math.max(0,G[g.cursorTagStart]-k),j=i.slice(W,W+F);return C(k,j)}return z},C=(v,A)=>{const D=" ".repeat(v)+"^";return`
${A}
${D}
`},I=()=>s||"Blits.Application";return m()};let V,ho;function bl(i={children:[]},t=!1){const e={renderCode:["const elms = []","let componentType","const rootComponent = component","let propData","let slotComponent","let inSlot = false","let slotChildCounter = 0"],effectsCode:[],context:{props:[],components:this.components}};return V=-1,ho=t,ho===!0&&e.renderCode.push(`
      function propInComponent(prop, kind="dynamic") {
        const property = prop.includes('.') ? prop.split('.')[0] : prop
        if (kind === 'reactive' || prop.includes('.') === false) {
          if (property in component === false) {
            Log.warn('Property ' +  property + ' was accessed during render but is not defined on instance')
          }
        } else {
          const nestedKeys = prop.split('.')
          let base = component
          for(let i =0; i<nestedKeys.length;i++){
            if (base[nestedKeys[i]] === undefined) {
              Log.warn('Property ' +  nestedKeys.slice(0,i+1).join('.') + ' was accessed during render but is not defined on instance')
            }
            base = base[nestedKeys[i]]
          }
        }
      }
    `),Qn.call(e,i),e.renderCode.push("return elms"),{render:new Function("parent","component","context","components","effect","getRaw","Log",e.renderCode.join(`
`)),effects:e.effectsCode.map(s=>new Function("component","elms","context","components","rootComponent","effect",s)),context:e.context}}const wl=function(i){const t=/\$\$?\w+(\.\w+)?/g,e=i.match(t);if(e!==null){const s=/\$shader/;return e.filter(r=>!s.test(r))}else return!1},pn=function(i,t,e="dynamic"){const s=wl(i);if(s!==!1)for(let r=0;r<s.length;r++){let a=s[r];e==="reactive"&&a.includes(".")&&(a=a.split(".")[0]),t.push(`propInComponent('${a.replace("$","")}', '${e}')`)}},po=function(i,t=!1,e={key:!1,component:"component.",forceEffect:!1,forloop:!1}){const s=e.forceEffect?this.effectsCode:this.renderCode;t&&s.push(`parent = ${t}`),"key"in i&&(e.key=Ce(i.key,e.component));const r=e.key?`elms[${V}][${e.key}]`:`elms[${V}]`;e.key&&s.push(`
      if(elms[${V}] === undefined) {
        elms[${V}] = {}
      }
    `),s.push(`const elementConfig${V} = {}`),e.forloop&&s.push(`if(${r} === undefined) {`),s.push(`
    ${r} = this.element({parent: parent || 'root'}, inSlot === true ? slotComponent : component)
  `),e.forloop&&s.push("}");const a=i.children;delete i.children,i[Symbol.for("componentType")]==="Slot"&&s.push(`elementConfig${V}[Symbol.for('isSlot')] = true`),Object.keys(i).forEach(l=>{if(l==="slot"&&s.push(`
        elementConfig${V}['parent'] = component[Symbol.for('slots')] !== undefined && Array.isArray(component[Symbol.for('slots')]) === true && component[Symbol.for('slots')].filter(slot => slot.ref === '${i.slot}').shift() || parent
      `),l==="key")return;const u=i[l];if(Zn(l)){if(e.holder&&l===":color")return;e.holder?this.effectsCode.push(`
        if(typeof skip${V} === 'undefined' ||
          skip${V}.indexOf('${l.substring(1)}') === -1)
          ${r}.set('${l.substring(1)}', ${Ce(i[l],e.component)})
        `):this.effectsCode.push(`
            ${r}.set('${l.substring(1)}', ${Ce(i[l],e.component)})
          `),ho===!0&&e.component!=="scope."&&u.includes("$")&&pn(u,s,"reactive"),s.push(`elementConfig${V}['${l.substring(1)}'] = ${Ce(u,e.component)}`)}else ho===!0&&e.component!=="scope."&&u.includes("$")&&pn(u,s),s.push(`elementConfig${V}['${l}'] = ${an(u,l,e.component)}`)}),e.holder===!0&&s.push(`
    const skip${V} = []
    if(typeof cmp${V} !== 'undefined') {
      for(let key in cmp${V}.config.props) {
        delete elementConfig${V}[cmp${V}.config.props[key]]
        skip${V}.push(cmp${V}.config.props[key])
      }
    }
    `),e.forloop&&s.push(`if(${r}.nodeId === undefined) {`),s.push(`${r}.populate(elementConfig${V})`),s.push(`
    if(inSlot === true) {
      slotChildCounter -= 1
    }
  `),e.forloop&&s.push("}"),a&&Qn.call(this,{children:a},`${r}`,e)},qn=function(i,t=!1,e={key:!1,component:"component.",forceEffect:!1,holder:!1,forloop:!1}){const s=e.forceEffect?this.effectsCode:this.renderCode;s.push(`
    const cmp${V} =
      (context.components && context.components['${i[Symbol.for("componentType")]}']) || components['${i[Symbol.for("componentType")]}']
  `),"key"in i&&(e.key=Ce(i.key,e.component));const r=i.children;delete i.children,po.call(this,i,t,{...e,holder:!0}),t=e.key?`elms[${V}][${e.key}]`:`elms[${V}]`,V++;const a=e.key?`elms[${V}][${e.key}]`:`elms[${V}]`;e.key&&s.push(`
      if(elms[${V}] === undefined) {
        elms[${V}] = {}
      }
    `),t&&s.push(`parent = ${t}`),s.push(`const props${V} = {}`),e.forloop&&s.push(`if(${a} === undefined) {`),Object.keys(i).forEach(l=>{Zn(l)?(this.effectsCode.push(`
        ${a}[Symbol.for('props')]['${l.substring(1)}'] = ${Ce(i[l],e.component)}`),s.push(`
        propData = ${Ce(i[l],e.component)}
        if (Array.isArray(propData) === true) {
          propData = getRaw(propData).slice(0)
        }
        props${V}['${l.substring(1)}'] = propData`)):s.push(`props${V}['${l}'] = ${an(i[l],l,e.component)}`)}),s.push(`
    componentType = props${V}['is'] || '${i[Symbol.for("componentType")]}'

    let component${V}
    if(typeof componentType === 'string') {
      component${V} = context.components && context.components[componentType] || components[componentType]
      if(!component${V}) {
        throw new Error('Component "${i[Symbol.for("componentType")]}" not found')
      }
    } else if(typeof componentType === 'function' && componentType[Symbol.for('isComponent')] === true) {
      component${V} = componentType
    }

    ${a} = component${V}.call(null, {props: props${V}}, ${t}, component)

    if (${a}[Symbol.for('slots')][0]) {
      parent = ${a}[Symbol.for('slots')][0]
      slotComponent = ${a}
      inSlot = true
    } else {
      parent = ${a}[Symbol.for('children')][0]
    }
  `),e.forloop&&s.push("}"),r&&(e.forloop||s.push(`
        if(inSlot === true) {
          slotChildCounter = ${r.length}  + 1
        }
      `),V++,po.call(this,{children:r},!1,{...e})),e.forloop||s.push(`
      if (inSlot === true && slotChildCounter === 0) {
        inSlot = false
      }
    `)},Sl=function(i,t){const e=i[":for"];delete i[":for"];const s=i.range||i[":range"]||"{}";delete i.range,delete i[":range"];const r=i.key,a=Ce(r,"scope."),l=!(i.$shallow&&i.$shallow.toLowerCase()==="false");delete i.$shallow,delete i.key;const o=/(.+)\s+in\s+(.+)/gi.exec(e),[n,c]=o[1].replace("(","").replace(")","").split(/\s*,\s*/),f=new RegExp(`(scope\\.(?!${n}\\.|${c}|key)(\\w+))`,"gi"),d={renderCode:[],effectsCode:[],context:{props:[],components:this.components}};if(t&&d.renderCode.push(`parent = ${t}`),c!==void 0){const P=new RegExp(`\\$${c}(?!['\\w])`).exec(r);Array.isArray(P)&&d.renderCode.push(`console.warn(" Using '${c}' in the key, like key=${r},  is not recommended")`)}const p=V;d.renderCode.push(`
    const created${p} = []

    let from${p}
    let to${p}

    const forloop${p} = (collection = [], elms, created) => {
      const rawCollection = getRaw(collection)
      const keys = new Set()
      let l = rawCollection.length

      const range = ${Ce(s)} || {}
      from${p} = range['from'] || 0
      to${p} = 'to' in range ? range['to'] : rawCollection.length

      while(l--) {
        const ${n} = rawCollection[l]
  `),c!==void 0&&d.renderCode.push(`
        const ${c} = l
    `),d.renderCode.push(`
        if(l < to${p} && l >= from${p}) {
          keys.add('' +  ${Ce(r,"")||"l"})
        }
      }
  `);const m=d.renderCode.length;d.renderCode.push(`
      created.length = 0
      const length = rawCollection.length
      const effects = []
      for(let __index = 0; __index < length; __index++) {
        if(__index < from${p} || __index >= to${p}) continue
        const scope = Object.create(component)
        parent = ${t}
        scope['${n}'] = rawCollection[__index]
  `),c!==""&&d.renderCode.push(`
        scope['${c}'] = __index
    `),d.renderCode.push(`
        scope['key'] = '' + ${a||"__index"}
  `),"ref"in i&&i.ref.indexOf("$")===-1&&(d.renderCode.push(`
        scope['__ref'] = '${i.ref}' + __index
    `),i.ref="$__ref"),d.renderCode.push(`
        created.push(scope.key)
  `),i[Symbol.for("componentType")]==="Element"||i[Symbol.for("componentType")]==="Slot"||i[Symbol.for("componentType")]==="Text"?(i[Symbol.for("componentType")]==="Text"&&(i.__textnode="true"),po.call(d,i,t,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0})):qn.call(d,i,!1,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0});const y=d.effectsCode.filter(M=>[...M.matchAll(f)].length===0),b=d.effectsCode.filter(M=>[...M.matchAll(f)].length!==0);l===!1&&d.renderCode.push(`
      scope['${n}'] = null
      scope['${n}'] = collection[__index]
  `),y.forEach((M,P)=>{const L=M.indexOf(`scope.${P}`)>-1?`'${Ce(o[2],"")}'`:null;M.indexOf("Symbol.for('props')")===-1?d.renderCode.push(`
        let eff${P} = () => {
          ${M}
        }
        effect(eff${P}, ${L})
        effects.push(eff${P})
      `):d.renderCode.push(`
        ${M}
      `)}),d.renderCode.push(`
    }
    return effects
  }`);const w=[];w.push(`
      let i = created.length

      while (i--) {
        if (keys.has(created[i]) === false) {
          const key = created[i]
  `);const S=V;for(let M=p;M<=S;M++)w.push(`
          elms[${M}][key] && elms[${M}][key].destroy()
          delete elms[${M}][key]
      `);w.push(`
      }
    }
  `),d.renderCode.splice(m,0,...w);let _=`${Ce(o[2],"")}`;_&&_.includes(".")&&(_=_.match(/[^.]+$/)[0]);const x=/\$([^,} ]+)/g,$=[...s.matchAll(x)].map(M=>`'${M[1]}'`);d.renderCode.push(`
    let forEffects${p}
    effect(() => {
      component[Symbol.for('removeGlobalEffects')](forEffects${p})
      forEffects${p} = null
      forEffects${p} = forloop${p}(${an(o[2],":for")}, elms, created${p})
    }, ['${_}', ${$.join(",")}] )
  `),b.forEach(M=>{const P=[...M.matchAll(f)];let L=P.length;const U=[];for(;L--;){const k=P[L],F=`component.${k[2]}`;U.indexOf(F)===-1&&U.push(F),k[2]!==n&&(M=M.substring(0,k.index)+F+M.substring(k.index+k[1].length))}d.renderCode.push(`
      effect(() => {
        void ${U.join(", ")}
        for(let __index = 0; __index < ${Ce(o[2])}.length; __index++) {
          if(__index < from${p} || __index >= to${p}) continue
          const scope = {}
          scope['${c}'] = __index
          scope['${n}'] = ${Ce(o[2])}[__index]
          scope['key'] = ${a||"__index"}
    `),d.renderCode.push(`
          ${M}
        }
      })
    `)}),this.renderCode.push(d.renderCode.join(`
`))},Qn=function(i,t=!1,e={}){i.children&&i.children.forEach(s=>{V++,Object.keys(s).indexOf(":for")>-1?Sl.call(this,s,t):s[Symbol.for("componentType")]==="Element"||s[Symbol.for("componentType")]==="Slot"||s[Symbol.for("componentType")]==="Text"||s[Symbol.for("componentType")]==="Layout"?(s[Symbol.for("componentType")]==="Text"&&(s.__textnode="true"),s[Symbol.for("componentType")]==="Layout"&&(s.__layout="true"),po.call(this,s,t,e)):qn.call(this,s,t,e)})},Ce=(i,t="component.")=>{if(i===void 0)return i;const e=/('.*?')+/gi,s=/\$(\$(?=\$)|\$?)/g,r=i.matchAll(e),a=[];let l=0;for(const u of r)a.push(u[0]),i=i.replace(u[0],`[@@REPLACEMENT${l}@@]`),l++;return i=i.replace(s,(u,o)=>{if(o==="")return t;if(o==="$")return t+"$"}),a.forEach((u,o)=>{i=i.replace(`[@@REPLACEMENT${o}@@]`,u)}),i},an=(i="",t=!1,e="component.")=>{const s=/\$\w+/gi;let r;if(t==="content")if(i.startsWith("$"))r=`${e}${i.replace("$","")}`;else{const a=i.replace(/\\\\/g,"__DOUBLE_BACKSLASH__").replace(/(^|[^\\])'/g,"$1\\'").replace(/__DOUBLE_BACKSLASH__/g,"\\\\");r=`'${Cl(a,e)}'`}else if(t!=="color"&&!isNaN(parseFloat(i))){if(r=parseFloat(i),i.endsWith("%")){const l={w:"width",width:"width",x:"width",h:"height",height:"height",y:"height"}[t];l&&(r=`parent.node.${l} * (${r} / 100)`)}}else if(i.toLowerCase()==="true")r=!0;else if(i.toLowerCase()==="false")r=!1;else if(t.startsWith("@")&&i){const a=e.slice(0,-1);r=`${a}['${i.replace("$","")}'] && ${a}['${i.replace("$","")}'].bind(${a})`}else if(i.startsWith("$"))r=`${e}${i.replace("$","")}`;else if(s.exec(i)){const a=/\w+\s*:\s*(?:[^\s,}]+|".*?"|'.*?')/g,l=i.match(a);if(r={},l)for(let u=0;u<l.length;u++){const o=l[u].split(/\s*:\s*/);o&&vl(o[0],o[1],e,r)}return Rl(r)}else r=`"${i}"`;return r},Zn=i=>i.startsWith(":"),Cl=(i,t)=>{const e=/\{\{\s*(\$\S+)\s*\}\}/g,s=[...i.matchAll(e)];if(s.length)for(let[r,a]of s)i=i.replace(r,`${a.replace("$",`'+${t}`)}+'`);return i},vl=(i,t,e,s)=>{t.startsWith("$")?s[i]=`${e}${t.replace("$","")}`:s[i]=t},Rl=i=>{const t=[];return Object.keys(i).forEach(e=>{t.push(`${e}: ${i[e]}`)}),` { ${t.join(", ")} }`},mn={};let _l=0;const El=i=>`BlitsComponent::${i}_${mn[i]=(mn[i]||0)+1}`,Al=()=>++_l,ft={},No=(i,t,e,s=[])=>{ft[t]&&ft[t][i]&&ft[t][i].apply(e,s)},Ml=(i,t,e)=>{const s=g[i];ft[t]&&ft[t][s]&&ft[t][s].apply(e)},kl=(i={},t)=>{ft[t]={},[...Object.keys(i),...Object.getOwnPropertySymbols(i)].forEach(s=>{typeof i[s]=="function"&&(ft[t][s]=i[s])})};let si=null,js=null,Co=!1;const Il=()=>{Co=!0},Ll=()=>{Co=!1},mo=new WeakMap,io=new Map,gn=i=>{if(io.size!==0)for(const[t,e]of io){if(i.indexOf(t)===-1)continue;const s=mo.get(e);if(s!==void 0)for(const r of s.values())r.delete(t),io.delete(t)}},ro=(i,t,e=!1)=>{if(si!==null){if(Co)return;if(Array.isArray(js)===!0){if(js.includes(t)===!1)return}else if(js!==null&&t!==js)return;let s=mo.get(i);s===void 0&&(s=new Map,mo.set(i,s));let r=s.get(t);r===void 0&&(r=new Set,s.set(t,r)),r.add(si),e===!0&&io.set(si,i)}},ii=(i,t,e=!1)=>{if(Co===!0)return;const s=mo.get(i);if(s===void 0)return;const r=s.get(t);if(r!==void 0)for(let a of r)a(e)},Gr=(i,t=null)=>{si=i,js=t,si(),si=null,js=null},zo=(i,t)=>{if(i===t)return!0;if(i.length!==t.length)return!1;let e=i.length;for(;e--;){const s=i[e],r=t[e];if(Array.isArray(s)&&Array.isArray(r)){if(zo(s,r)===!1)return!1}else if(typeof s=="object"&&s!==null&&typeof r=="object"&&r!==null){if(zo(Object.entries(s),Object.entries(r))===!1)return!1}else if(s!==r)return!1}return!0},oo=["push","pop","shift","unshift","splice","sort"],yn=new WeakMap,Es=i=>{const t=i&&i[g.raw];return t?Es(t):i},Wo=(i,t=null,e,s)=>{if(typeof i=="object"&&Array.isArray(i)===!1&&Object.getPrototypeOf(i)!==Object.prototype)return i;const r=yn.get(i);if(r!==void 0)return r;const a={get(u,o,n){return o===g.raw?i:Array.isArray(u)===!0?typeof u[o]=="object"&&u[o]!==null?(Array.isArray(u[o])===!0&&ro(u,o,s),Wo(Es(u[o]),u,o)):oo.indexOf(o)!==-1?function(...c){Il();const f=u[o].apply(this,c);return Ll(),ii(t,e),f}:o==="length"?i.length:Reflect.get(u,o,n):typeof u[o]=="object"&&u[o]!==null?(Array.isArray(u[o])===!0&&ro(u,o,s),Wo(Es(u[o]),u,o)):(ro(u,o,s),Reflect.get(u,o,n))},set(u,o,n,c){const f=Es(u[o]),d=Es(n);let p=!0,m=!1;return Array.isArray(d)===!0&&Array.isArray(f)===!0?m=zo(f,d):f===d&&(m=!0),m===!1&&(typeof n=="object"&&(Array.isArray(n)===!0?n=Es(n).slice(0):n!==null&&u[o]!==null&&u[o]!==void 0&&Array.isArray(u)===!1&&Object.getPrototypeOf(n)===Object.prototype&&(n=Object.assign(c[o],n))),p=Reflect.set(u,o,n,c)),p===!0&&m===!1&&(Array.isArray(u)===!0&&o in u&&ii(t,e,!0),ii(u,o,!0)),p}},l=new Proxy(i,a);return yn.set(i,l),l},Jn=(i,t)=>(Object.keys(i).forEach(e=>{let s=i[e];if(i[e]!==null&&typeof i[e]=="object"){if(Object.getPrototypeOf(i[e])===Object.prototype)return Jn(i[e]);if(Array.isArray(i[e])===!0)for(let r=0;r<oo.length-1;r++)i[e][oo[r]]=function(a){Array.prototype[oo[r]].call(this,a),ii(i,e)}}Object.defineProperty(i,e,{enumerable:!0,configurable:!0,get(){return ro(i,e,t),s},set(r){s!==r&&(s=r,ii(i,e))}})}),i),Pl=typeof Proxy<"u",Vo=(i,t="Proxy",e=!1)=>(Pl===!1&&(t="defineProperty"),t==="defineProperty"?Jn(i,e):Wo(i,void 0,void 0,e)),Bl=["init","ready","focus","unfocus","destroy","attach","detach","enter","exit"],Fl={previous:null,current:null,get state(){return this.current},set state(i){Bl.indexOf(i)>-1&&(i!==this.current||i==="focus")&&(q.debug(`Setting lifecycle state from ${this.current} to ${i} for ${this.component.componentId}`),this.previous=this.current,this.current=i,Ml(i,this.component[g.identifier],this.component),No(i,this.component[g.identifier],this.component))}},Ol={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function Ul(i,t=!1,e){const s={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},r=i.getContext(t?"webgl2":"webgl",s)||i.getContext("experimental-webgl",s);if(!r)throw new Error("Unable to create WebGL context");return e?new Proxy(r,{get(a,l){const u=a[l];return typeof u=="function"?(e.increment(String(l)),u.bind(a)):u}}):r}function O(i,t){if(ni()!==!0&&!i)throw new Error(t||"Assertion failed")}function xn(i,t,e){const s=Math.trunc(i>>>24),r=Math.trunc(i>>>16&255),a=Math.trunc(i>>>8&255),l=Math.trunc(i&255),u=Math.trunc(t>>>24),o=Math.trunc(t>>>16&255),n=Math.trunc(t>>>8&255),c=Math.trunc(t&255),f=Math.round(u*e+s*(1-e)),d=Math.round(o*e+r*(1-e)),p=Math.round(n*e+a*(1-e)),m=Math.round(c*e+l*(1-e));return(f<<24|d<<16|p<<8|m)>>>0}function $l(i,t){const e=i>>>24,s=i>>>16&255,r=i>>>8&255,a=Math.trunc((i&255)*t);return(e<<24|s<<16|r<<8|a)>>>0}let ea=!0;function Dl(i){ea=i==="webgl"}function Hr(i,t,e=!1){const s=(i&255)/255*t,r=ea?s:1,a=Math.trunc((i>>>24)*r),l=Math.trunc((i>>>16&255)*r),u=Math.trunc((i>>>8&255)*r),o=Math.trunc(s*255);return e?(o<<24|u<<16|l<<8|a)>>>0:(a<<24|l<<16|u<<8|o)>>>0}function go(i,t){return Object.prototype.hasOwnProperty.call(i,t)}function ni(){return Ol&&!0}let Nl=1;function zl(){return Nl++}class it{constructor(){h(this,"eventListeners",{})}on(t,e){let s=this.eventListeners[t];s||(s=[]),s.push(e),this.eventListeners[t]=s}off(t,e){const s=this.eventListeners[t];if(!s)return;if(!e){delete this.eventListeners[t];return}const r=s.indexOf(e);r>=0&&s.splice(r,1)}once(t,e){const s=(r,a)=>{this.off(t,s),e(r,a)};this.on(t,s)}emit(t,e){const s=this.eventListeners[t];s&&[...s].forEach(r=>{r(this,e)})}removeAllListeners(){this.eventListeners={}}}var Q;(function(i){i[i.generic=0]="generic",i[i.color=1]="color",i[i.image=2]="image",i[i.noise=3]="noise",i[i.renderToTexture=4]="renderToTexture",i[i.subTexture=5]="subTexture"})(Q||(Q={}));class _i extends it{constructor(e){super();h(this,"txManager");h(this,"_dimensions",null);h(this,"_error",null);h(this,"state","initial");h(this,"renderableOwners",new Set);h(this,"renderable",!1);h(this,"type",Q.generic);h(this,"preventCleanup",!1);h(this,"ctxTexture");h(this,"textureData",null);this.txManager=e}get dimensions(){return this._dimensions}get error(){return this._error}setRenderableOwner(e,s){var a,l;const r=this.renderableOwners.size;if(s===!0){this.renderableOwners.has(e)===!1&&this.renderableOwners.add(e);const u=this.renderableOwners.size;u>r&&u===1&&(this.renderable=!0,(a=this.onChangeIsRenderable)==null||a.call(this,!0),this.load())}else{this.renderableOwners.delete(e);const u=this.renderableOwners.size;u<r&&u===0&&(this.renderable=!1,(l=this.onChangeIsRenderable)==null||l.call(this,!1),this.txManager.orphanTexture(this))}}load(){this.txManager.loadTexture(this)}loadCtxTexture(){return this.ctxTexture===void 0&&(this.ctxTexture=this.txManager.renderer.createCtxTexture(this)),this.ctxTexture}free(){var e;(e=this.ctxTexture)==null||e.free()}freeTextureData(){this.textureData=null}setState(e,s){if(this.state===e)return;let r=null;e==="loaded"?(s!==void 0&&"width"in s&&"height"in s&&s.width!==void 0&&s.height!==void 0&&(this._dimensions=s),r=this._dimensions):e==="failed"&&(this._error=s,r=this._error),this.state=e,this.emit(e,r)}async getTextureData(){return this.textureData===null&&(this.textureData=await this.getTextureSource()),this.textureData}static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}}const Wl=/^(data|ftps?|https?):/,Ei=i=>{const t=i>>>24,e=i>>>16&255,s=i>>>8&255,r=i&255;return[t/255,e/255,s/255,r/255]},Tn=i=>{const t=i>>>24,e=i>>>16&255,s=i>>>8&255,r=i&255;return[t,e,s,r]};function bn(i){return(i&255)/255}function ko(i){const t=Math.floor(i[0]*255),e=Math.floor(i[1]*255),s=Math.floor(i[2]*255),r=Math.floor(i[3]*255);return`rgba(${t},${e},${s},${r.toFixed(4)})`}function qs(i,t,e,s,r){return r?(r.x1=i,r.y1=t,r.x2=e,r.y2=s,r):{x1:i,y1:t,x2:e,y2:s}}function Io(i,t){return i.x1<t.x2&&i.x2>t.x1&&i.y1<t.y2&&i.y2>t.y1}function Vl(i,t){return t?(t.x=i.x1,t.y=i.y1,t.width=i.x2-i.x1,t.height=i.y2-i.y1,t):{x:i.x1,y:i.y1,width:i.x2-i.x1,height:i.y2-i.y1}}function ta(i,t,e){const s=Math.max(i.x,t.x),r=Math.max(i.y,t.y),a=Math.min(i.x+i.width,t.x+t.width)-s,l=Math.min(i.y+i.height,t.y+t.height)-r;return a>0&&l>0?e?(e.x=s,e.y=r,e.width=a,e.height=l,e):{x:s,y:r,width:a,height:l}:e?(e.x=0,e.y=0,e.width=0,e.height=0,e):{x:0,y:0,width:0,height:0}}function sa(i,t){return t?(t.x=i.x,t.y=i.y,t.width=i.width,t.height=i.height,t):{x:i.x,y:i.y,width:i.width,height:i.height}}function Xl(i,t){return i===t?!0:i===null||t===null?!1:i.x===t.x&&i.y===t.y&&i.width===t.width&&i.height===t.height}function Lo(i,t){return i.x1<=t.x2&&i.y1<=t.y2&&i.x2>=t.x1&&i.y2>=t.y1}function Gl(i,t){return i.x1<t.x1&&i.x2>t.x2&&i.y1<t.y1&&i.y2>t.y2}function Hl(i){return i.x1<i.x2&&i.y1<i.y2}function Xo(i,t){return qs(i.x1-t[3],i.y1-t[0],i.x2+t[1],i.y2+t[2])}function Yl(i){if(self.location.protocol==="file:"&&!Wl.test(i)){const e=self.location.pathname.split("/");e.pop();const s=e.join("/"),r=self.location.protocol+"//"+s;return i.charAt(0)==="."&&(i=i.slice(1)),i.charAt(0)==="/"&&(i=i.slice(1)),r+"/"+i}return new URL(i,self.location.href).href}function Po(i){return i.startsWith("data:")===!0}function Kl(i){var o,n;i=i.replace(/^data:/,"");const t=((o=i.match(/image\/[^;]+/))==null?void 0:o[0])||"",e=i.replace(/^[^,]+,/,""),s=1024,r=atob(e),a=r.length,l=Math.ceil(a/s),u=new Array(l);for(let c=0;c<l;++c){const f=c*s,d=Math.min(f+s,a),p=new Array(d-f);for(let m=f,y=0;m<d;++y,++m)p[y]=(n=r[m])==null?void 0:n.charCodeAt(0);u[c]=new Uint8Array(p)}return new Blob(u,{type:t})}class te{constructor(){h(this,"ta");h(this,"tb");h(this,"tx");h(this,"tc");h(this,"td");h(this,"ty");h(this,"_floatArr",null);h(this,"mutation");this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return jl}static multiply(t,e,s){const r=t.ta*e.ta+t.tb*e.tc,a=t.ta*e.tb+t.tb*e.td,l=t.ta*e.tx+t.tb*e.ty+t.tx,u=t.tc*e.ta+t.td*e.tc,o=t.tc*e.tb+t.td*e.td,n=t.tc*e.tx+t.td*e.ty+t.ty;return s||(s=new te),s.ta=r,s.tb=a,s.tx=l,s.tc=u,s.td=o,s.ty=n,s.mutation=!0,s}static identity(t){return t||(t=new te),t.ta=1,t.tb=0,t.tx=0,t.tc=0,t.td=1,t.ty=0,t.mutation=!0,t}static translate(t,e,s){return s||(s=new te),s.ta=1,s.tb=0,s.tx=t,s.tc=0,s.td=1,s.ty=e,s.mutation=!0,s}static scale(t,e,s){return s||(s=new te),s.ta=t,s.tb=0,s.tx=0,s.tc=0,s.td=e,s.ty=0,s.mutation=!0,s}static rotate(t,e){const s=Math.cos(t),r=Math.sin(t);return e||(e=new te),e.ta=s,e.tb=-r,e.tx=0,e.tc=r,e.td=s,e.ty=0,e.mutation=!0,e}static copy(t,e){return e||(e=new te),e.ta=t.ta,e.tc=t.tc,e.tb=t.tb,e.td=t.td,e.tx=t.tx,e.ty=t.ty,e.mutation=!0,e}translate(t,e){return this.tx=this.ta*t+this.tb*e+this.tx,this.ty=this.tc*t+this.td*e+this.ty,this.mutation=!0,this}scale(t,e){return this.ta=this.ta*t,this.tb=this.tb*e,this.tc=this.tc*t,this.td=this.td*e,this.mutation=!0,this}rotate(t){if(t===0||!(t%Math.PI*2))return this;const e=Math.cos(t),s=Math.sin(t),r=this.ta*e+this.tb*s,a=this.tb*e-this.ta*s,l=this.tc*e+this.td*s,u=this.td*e-this.tc*s;return this.ta=r,this.tb=a,this.tc=l,this.td=u,this.mutation=!0,this}multiply(t){return te.multiply(this,t,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const jl=new te,Yr=0,Kr=2,jr=4,qr=6,Qr=1,Zr=3,Jr=5,eo=7;class Qs{constructor(t){h(this,"data");this.data=new Float32Array(8),t&&(this.data[Yr]=t[Yr],this.data[Kr]=t[Kr],this.data[jr]=t[jr],this.data[qr]=t[qr],this.data[Qr]=t[Qr],this.data[Zr]=t[Zr],this.data[Jr]=t[Jr],this.data[eo]=t[eo])}static translate(t,e,s,r,a,l,u,o,n){return n||(n=new Qs),n.data[Yr]=t,n.data[Kr]=s,n.data[jr]=a,n.data[qr]=u,n.data[Qr]=e,n.data[Zr]=r,n.data[Jr]=l,n.data[eo]=o,n}get x1(){return this.data[Yr]}get x2(){return this.data[Kr]}get x3(){return this.data[jr]}get x4(){return this.data[qr]}get y1(){return this.data[Qr]}get y2(){return this.data[Zr]}get y3(){return this.data[Jr]}get y4(){return this.data[eo]}}const ia=(i,t,e,s)=>{const r=3*i,a=3*(e-i)-r,l=1-r-a,u=3*t,o=3*(s-t)-u,n=1-u-o;return function(c){if(c>=1)return 1;if(c<=0)return 0;let f=.5,d,p,m;for(let w=0;w<20;w++){if(d=f*(f*(f*l+a)+r),m=c-d,m>-1e-8&&m<1e-8)return f*(f*(f*n+o)+u);if(p=f*(f*(3*l)+2*a)+r,p>1e-10&&p<1e-10)break;f+=m/p}let y=0,b=1;for(let w=0;w<20;w++){if(f=.5*(y+b),d=f*(f*(f*l+a)+r),m=c-d,m>-1e-8&&m<1e-8)return f*(f*(f*n+o)+u);m<0?b=f:y=f}}},no={},ql={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},ao=i=>i,Ql=i=>{const t=/-?\d*\.?\d+/g,e=i.match(t);if(e){const[s,r,a,l]=e,u=parseFloat(s||"0.42"),o=parseFloat(r||"0"),n=parseFloat(a||"1"),c=parseFloat(l||"1"),f=ia(u,o,n,c);return no[i]=f,f}return console.warn("Unknown cubic-bezier timing: "+i),ao},Zl=i=>{if(i==="linear")return ao;if(no[i]!==void 0)return no[i]||ao;if(i==="step-start")return()=>1;if(i==="step-end")return e=>e===1?1:0;const t=ql[i];if(t!==void 0){const[e,s,r,a]=t,l=ia(e,s,r,a);return no[i]=l,l}return i.startsWith("cubic-bezier")?Ql(i):(console.warn("Unknown timing function: "+i),ao)};function wn(i){return(i/1024/1024).toFixed(2)}class Jl extends it{constructor(e,s,r){super();h(this,"node");h(this,"props");h(this,"settings");h(this,"progress",0);h(this,"delayFor",0);h(this,"delay",0);h(this,"timingFunction");h(this,"propValuesMap",{});h(this,"dynPropValuesMap");this.node=e,this.props=s;for(const u in s)if(u!=="shaderProps")this.propValuesMap.props===void 0&&(this.propValuesMap.props={}),this.propValuesMap.props[u]={start:e[u]||0,target:s[u]};else if(e.shader.type!=="DynamicShader"){this.propValuesMap.shaderProps={};for(const o in s.shaderProps)this.propValuesMap.shaderProps[o]={start:e.shader.props[o],target:s.shaderProps[o]}}else{const o=Object.keys(s.shaderProps),n=o.length;this.dynPropValuesMap={};for(let c=0;c<n;c++){const f=o[c],d=s.shaderProps[f];this.dynPropValuesMap[f]={};const p=Object.entries(d),m=p.length;for(let y=0;y<m;y++){const[b,w]=p[y];this.dynPropValuesMap[f][b]={start:e.shader.props[f][b],target:w}}}}const a=r.easing||"linear",l=r.delay??0;this.settings={duration:r.duration??0,delay:l,easing:a,loop:r.loop??!1,repeat:r.repeat??0,repeatDelay:r.repeatDelay??0,stopMethod:r.stopMethod??!1},this.timingFunction=Zl(a),this.delayFor=l,this.delay=l}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(e,s){const r=Object.entries(s),a=r.length;for(let l=0;l<a;l++){const[u,o]=r[l];e[u]=o.start}}restore(){if(this.reset(),this.propValuesMap.props!==void 0&&this.restoreValues(this.node,this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),s=e.length;if(s>0)for(let r=0;r<s;r++){const a=e[r];this.restoreValues(this.node.shader.props[a],this.dynPropValuesMap[a])}}}reverseValues(e){const s=Object.entries(e),r=s.length;for(let a=0;a<r;a++){const[l,u]=s[a];e[l]={start:u.target,target:u.start}}}reverse(){if(this.progress=0,this.propValuesMap.props!==void 0&&this.reverseValues(this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.reverseValues(this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),s=e.length;if(s>0)for(let r=0;r<s;r++){const a=e[r];this.reverseValues(this.dynPropValuesMap[a])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,s,r){return(this.timingFunction(e)||e)*(r-s)+s}updateValue(e,s,r,a){if(this.progress===1)return s;if(this.progress===0)return r;const l=s;if(e.indexOf("color")!==-1){if(r===l)return r;if(a){const u=this.timingFunction(this.progress)||this.progress;return xn(r,l,u)}return xn(r,l,this.progress)}return a?this.applyEasing(this.progress,r,l):r+(l-r)*this.progress}updateValues(e,s,r){const a=Object.entries(s),l=a.length;for(let u=0;u<l;u++){const[o,n]=a[u];e[o]=this.updateValue(o,n.target,n.start,r)}}update(e){const{duration:s,loop:r,easing:a,stopMethod:l}=this.settings,{delayFor:u}=this;if(s===0&&u===0){this.emit("finished",{});return}if(this.delayFor>0){if(this.delayFor-=e,this.delayFor>=0)return;e=-this.delayFor,this.delayFor=0}if(s===0){this.emit("finished",{});return}if(this.progress===0&&this.emit("animating",{}),this.progress+=e/s,this.progress>1&&(this.progress=r?0:1,this.delayFor=this.delay,l)){this.emit("finished",{});return}if(this.propValuesMap.props!==void 0&&this.updateValues(this.node,this.propValuesMap.props,a),this.propValuesMap.shaderProps!==void 0&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,a),this.dynPropValuesMap!==void 0){const o=Object.keys(this.dynPropValuesMap),n=o.length;if(n>0)for(let c=0;c<n;c++){const f=o[c];this.updateValues(this.node.shader.props[f],this.dynPropValuesMap[f],a)}}this.progress<1&&this.emit("tick",{progress:this.progress}),this.progress===1&&this.emit("finished",{})}}class ef extends it{constructor(e,s){super();h(this,"manager");h(this,"animation");h(this,"stoppedPromise");h(this,"stoppedResolve",null);h(this,"state");this.manager=e,this.animation=s,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this),this.onTick=this.onTick.bind(this)}start(){return this.state!=="running"&&this.state!=="scheduled"&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="scheduled"),this}stop(){return this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.animation.on("tick",this.onTick),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating),this.animation.off("tick",this.onTick)}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(e=>{this.stoppedResolve=e}))}onFinished(){O(this.stoppedResolve);const{loop:e,stopMethod:s}=this.animation.settings;if(s==="reverse"){this.animation.once("finished",this.onFinished),this.animation.reverse();return}e||(this.unregisterAnimation(),this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this),this.state="stopped")}onAnimating(){this.state="running",this.emit("animating",this)}onTick(e,s){this.emit("tick",s)}}var oe;(function(i){i[i.Init=0]="Init",i[i.OutOfBounds=2]="OutOfBounds",i[i.InBounds=4]="InBounds",i[i.InViewport=8]="InViewport"})(oe||(oe={}));const Ai=new Map;Ai.set(oe.Init,"init");Ai.set(oe.OutOfBounds,"outOfBounds");Ai.set(oe.InBounds,"inBounds");Ai.set(oe.InViewport,"inViewport");var R;(function(i){i[i.Children=1]="Children",i[i.ScaleRotate=2]="ScaleRotate",i[i.Local=4]="Local",i[i.Global=8]="Global",i[i.Clipping=16]="Clipping",i[i.CalculatedZIndex=32]="CalculatedZIndex",i[i.ZIndexSortedChildren=64]="ZIndexSortedChildren",i[i.PremultipliedColors=128]="PremultipliedColors",i[i.WorldAlpha=256]="WorldAlpha",i[i.RenderState=512]="RenderState",i[i.IsRenderable=1024]="IsRenderable",i[i.RenderTexture=2048]="RenderTexture",i[i.ParentRenderTexture=4096]="ParentRenderTexture",i[i.RenderBounds=8192]="RenderBounds",i[i.None=0]="None",i[i.All=14335]="All"})(R||(R={}));class Go extends it{constructor(e,s){super();h(this,"stage");h(this,"children",[]);h(this,"_id",zl());h(this,"props");h(this,"updateType",R.All);h(this,"childUpdateType",R.None);h(this,"globalTransform");h(this,"scaleRotateTransform");h(this,"localTransform");h(this,"sceneGlobalTransform");h(this,"renderCoords");h(this,"sceneRenderCoords");h(this,"renderBound");h(this,"strictBound");h(this,"preloadBound");h(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});h(this,"isRenderable",!1);h(this,"renderState",oe.Init);h(this,"worldAlpha",1);h(this,"premultipliedColorTl",0);h(this,"premultipliedColorTr",0);h(this,"premultipliedColorBl",0);h(this,"premultipliedColorBr",0);h(this,"calcZIndex",0);h(this,"hasRTTupdates",!1);h(this,"parentHasRenderTexture",!1);h(this,"rttParent",null);h(this,"onTextureLoaded",(e,s)=>{var r,a;this.autosizeNode(s),this.setUpdateType(R.IsRenderable),this.stage.requestRender(),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),s.width>1&&s.height>1&&this.emit("loaded",{type:"texture",dimensions:s}),((a=(r=this.props.textureOptions)==null?void 0:r.resizeMode)==null?void 0:a.type)==="contain"&&this.setUpdateType(R.Local)});h(this,"onTextureFailed",(e,s)=>{this.setUpdateType(R.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),this.emit("failed",{type:"texture",error:s})});h(this,"onTextureFreed",()=>{this.setUpdateType(R.IsRenderable),this.parentHasRenderTexture&&this.notifyParentRTTOfUpdate(),this.emit("freed",{type:"texture"})});this.stage=e,this.props={...s,parent:null,texture:null,src:null,rtt:!1},this.parent=s.parent,this.texture=s.texture,this.src=s.src,this.rtt=s.rtt,s.boundsMargin&&(this.boundsMargin=Array.isArray(s.boundsMargin)?s.boundsMargin:[s.boundsMargin,s.boundsMargin,s.boundsMargin,s.boundsMargin]),this.setUpdateType(R.ScaleRotate|R.Local|R.RenderBounds|R.RenderState),ni()===!1&&s.preventCleanup===!0&&console.warn("CoreNode.preventCleanup: Is deprecated and will be removed in upcoming release, please use textureOptions.preventCleanup instead"),this.stage.defaultTexture&&this.stage.defaultTexture.state!=="loaded"&&this.stage.defaultTexture.once("loaded",()=>{this.setUpdateType(R.IsRenderable)})}loadTexture(){const{texture:e}=this.props;O(e),queueMicrotask(()=>{var s;if(this.textureOptions.preload===!0&&this.stage.txManager.loadTexture(e),e.preventCleanup=((s=this.props.textureOptions)==null?void 0:s.preventCleanup)??!1,e.on("loaded",this.onTextureLoaded),e.on("failed",this.onTextureFailed),e.on("freed",this.onTextureFreed),this.parentHasRenderTexture){this.notifyParentRTTOfUpdate();return}e.state==="loaded"?(O(e.dimensions),this.onTextureLoaded(e,e.dimensions)):e.state==="failed"?(O(e.error),this.onTextureFailed(e,e.error)):e.state==="freed"&&this.onTextureFreed(e)})}unloadTexture(){this.texture!==null&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this,!1))}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}setUpdateType(e){this.updateType|=e;const s=this.props.parent;s&&(s.updateType&R.Children)===0&&s.setUpdateType(R.Children)}sortChildren(){this.children.sort((e,s)=>e.calcZIndex-s.calcZIndex)}updateScaleRotateTransform(){const{rotation:e,scaleX:s,scaleY:r}=this.props;if(e===0&&s===1&&r===1){this.scaleRotateTransform=void 0;return}this.scaleRotateTransform=te.rotate(e,this.scaleRotateTransform).scale(s,r)}updateLocalTransform(){var n,c;const{x:e,y:s,width:r,height:a}=this.props,l=this.props.mountX*r,u=this.props.mountY*a;if(this.scaleRotateTransform){const f=this.props.pivotX*r,d=this.props.pivotY*a;this.localTransform=te.translate(e-l+f,s-u+d,this.localTransform).multiply(this.scaleRotateTransform).translate(-f,-d)}else this.localTransform=te.translate(e-l,s-u,this.localTransform);const o=this.props.texture;if(o&&o.dimensions&&((c=(n=this.props.textureOptions)==null?void 0:n.resizeMode)==null?void 0:c.type)==="contain"){let f=1,d=1,p=0,m=0;const{width:y,height:b}=o.dimensions,w=y/b,S=r/a;if(w>S){const _=r/y,x=b*_;m=(a-x)/2,d=x/a}else{const _=a/b,x=y*_;p=(r-x)/2,f=x/r}this.localTransform.translate(p,m).scale(f,d)}this.setUpdateType(R.Global)}update(e,s){this.updateType&R.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(R.Local)),this.updateType&R.Local&&(this.updateLocalTransform(),this.setUpdateType(R.Global));const r=this.props.parent;let a=null;if(this.updateType&R.RenderTexture&&this.rtt&&(this.hasRTTupdates=!0),this.updateType&R.Global&&(O(this.localTransform),this.parentHasRenderTexture===!0&&(r==null?void 0:r.rtt)===!0?(this.globalTransform=te.identity(),this.sceneGlobalTransform=te.copy((r==null?void 0:r.globalTransform)||te.identity()).multiply(this.localTransform)):this.parentHasRenderTexture===!0&&(r==null?void 0:r.rtt)===!1?(this.sceneGlobalTransform=te.copy((r==null?void 0:r.sceneGlobalTransform)||this.localTransform).multiply(this.localTransform),this.globalTransform=te.copy((r==null?void 0:r.globalTransform)||this.localTransform,this.globalTransform)):this.globalTransform=te.copy((r==null?void 0:r.globalTransform)||this.localTransform,this.globalTransform),r!==null&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(R.RenderState|R.Children),this.childUpdateType|=R.Global,this.clipping===!0&&(this.setUpdateType(R.Clipping|R.RenderBounds),this.childUpdateType|=R.RenderBounds)),this.updateType&R.RenderBounds&&(this.createRenderBounds(),this.setUpdateType(R.RenderState),this.setUpdateType(R.Children),this.childUpdateType|=R.RenderBounds),this.updateType&R.RenderState&&(a=this.checkRenderBounds(),this.setUpdateType(R.IsRenderable),a!==oe.OutOfBounds&&this.updateRenderState(a)),this.updateType&R.WorldAlpha&&(r?this.worldAlpha=r.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(R.Children|R.PremultipliedColors|R.IsRenderable),this.childUpdateType|=R.WorldAlpha),this.updateType&R.IsRenderable&&this.updateIsRenderable(),this.updateType&R.Clipping&&(this.calculateClippingRect(s),this.setUpdateType(R.Children),this.childUpdateType|=R.Clipping,this.childUpdateType|=R.RenderBounds),this.updateType&R.PremultipliedColors&&(this.premultipliedColorTl=Hr(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=Hr(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=Hr(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=Hr(this.props.colorBr,this.worldAlpha,!0))),r!==null&&this.updateType&R.CalculatedZIndex&&(this.calculateZIndex(),r.setUpdateType(R.ZIndexSortedChildren)),this.props.strictBounds===!0&&this.renderState===oe.OutOfBounds){this.updateType&=~R.RenderBounds;return}if(this.updateType&R.Children&&this.children.length>0)for(let l=0,u=this.children.length;l<u;l++){const o=this.children[l];if(o.setUpdateType(this.childUpdateType),o.updateType===0)continue;let n=this.clippingRect;this.rtt===!0&&(n={x:0,y:0,width:0,height:0,valid:!1}),o.update(e,n)}this.parentHasRenderTexture&&this.updateType>0&&this.notifyParentRTTOfUpdate(),this.updateType&R.ZIndexSortedChildren&&this.sortChildren(),a===oe.OutOfBounds&&(this.updateRenderState(a),this.updateIsRenderable(),this.rtt===!0&&a===oe.OutOfBounds&&this.notifyChildrenRTTOfUpdate(a)),this.updateType=0,this.childUpdateType=0}findParentRTTNode(){let e=this.parent;for(;e&&!e.rtt;)e=e.parent;return e}getRTTParentRenderState(){const e=this.rttParent||this.findParentRTTNode();return e?e.renderState:null}notifyChildrenRTTOfUpdate(e){for(const s of this.children)s.updateRenderState(e),s.updateIsRenderable(),s.notifyChildrenRTTOfUpdate(e)}notifyParentRTTOfUpdate(){if(this.parent===null)return;const e=this.rttParent||this.findParentRTTNode();e&&(e.hasRTTupdates=!0,e.setUpdateType(R.RenderTexture),e.parentHasRenderTexture===!0&&e.notifyParentRTTOfUpdate())}checkRenderBounds(){return O(this.renderBound),O(this.strictBound),O(this.preloadBound),Lo(this.renderBound,this.strictBound)?oe.InViewport:Lo(this.renderBound,this.preloadBound)?oe.InBounds:Gl(this.renderBound,this.strictBound)?oe.InViewport:this.parent!==null&&(this.props.width===0||this.props.height===0)?this.parent.renderState:oe.OutOfBounds}updateBoundingRect(){const e=this.sceneGlobalTransform||this.globalTransform,s=this.sceneRenderCoords||this.renderCoords;O(e),O(s);const{tb:r,tc:a}=e,{x1:l,y1:u,x3:o,y3:n}=s;if(r===0||a===0)this.renderBound=qs(l,u,o,n,this.renderBound);else{const{x2:c,x4:f,y2:d,y4:p}=s;this.renderBound=qs(Math.min(l,c,o,f),Math.min(u,d,n,p),Math.max(l,c,o,f),Math.max(u,d,n,p),this.renderBound)}}createRenderBounds(){if(O(this.stage),this.parent!==null&&this.parent.strictBound!==void 0){const c=this.parent.strictBound;this.strictBound=qs(c.x1,c.y1,c.x2,c.y2),this.preloadBound=Xo(this.strictBound,this.boundsMargin)}else this.strictBound=this.stage.strictBound,this.preloadBound=this.stage.preloadBound;if(this.props.clipping===!1||this.renderBound===void 0||Lo(this.renderBound,this.strictBound)===!1)return;const{x:e,y:s,width:r,height:a}=this.props,{tx:l,ty:u}=this.sceneGlobalTransform||this.globalTransform||{},o=l??e,n=u??s;this.strictBound=qs(o,n,o+r,n+a,this.strictBound),this.preloadBound=Xo(this.strictBound,this.boundsMargin)}updateRenderState(e){if(e===this.renderState)return;const s=this.renderState;this.renderState=e;const r=Ai.get(e);O(r),this.emit(r,{previous:s,current:e})}updateIsRenderable(){let e=!1,s=!1;if(this.checkBasicRenderability()===!1){this.updateTextureOwnership(!1),this.setRenderable(!1);return}this.texture!==null?(s=!0,e=this.texture.state==="loaded"):(this.hasShader()||this.hasColorProperties()===!0)&&this.hasDimensions()===!0&&this.stage.defaultTexture&&this.stage.defaultTexture.state==="loaded"&&(e=!0),this.updateTextureOwnership(s),this.setRenderable(e)}checkBasicRenderability(){return!(this.worldAlpha===0||this.isOutOfBounds()===!0)}setRenderable(e){this.isRenderable=e}updateTextureOwnership(e){var s;(s=this.texture)==null||s.setRenderableOwner(this,e)}isOutOfBounds(){return this.renderState<=oe.OutOfBounds}hasDimensions(){return this.props.width!==0&&this.props.height!==0}hasColorProperties(){return this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0}hasShader(){return this.props.shader!==null}calculateRenderCoords(){const{width:e,height:s}=this,{tx:r,ty:a,ta:l,tb:u,tc:o,td:n}=this.globalTransform;if(u===0&&o===0){const b=r,w=r+e*l,S=a,_=a+s*n;this.renderCoords=Qs.translate(b,S,w,S,w,_,b,_,this.renderCoords)}else this.renderCoords=Qs.translate(r,a,r+e*l,a+e*o,r+e*l+s*u,a+e*o+s*n,r+s*u,a+s*n,this.renderCoords);if(this.sceneGlobalTransform===void 0)return;const{tx:c,ty:f,ta:d,tb:p,tc:m,td:y}=this.sceneGlobalTransform;if(p===0&&m===0){const b=c,w=c+e*d,S=f,_=f+s*y;this.sceneRenderCoords=Qs.translate(b,S,w,S,w,_,b,_,this.sceneRenderCoords)}else this.sceneRenderCoords=Qs.translate(c,f,c+e*d,f+e*m,c+e*d+s*p,f+e*m+s*y,c+s*p,f+s*y,this.sceneRenderCoords)}calculateClippingRect(e){O(this.globalTransform);const{clippingRect:s,props:r,globalTransform:a}=this,{clipping:l}=r,u=a.tb!==0||a.tc!==0;l===!0&&u===!1?(s.x=a.tx,s.y=a.ty,s.width=this.width*a.ta,s.height=this.height*a.td,s.valid=!0):s.valid=!1,e.valid===!0&&s.valid===!0?ta(e,s,s):e.valid===!0&&(sa(e,s),s.valid=!0)}calculateZIndex(){var l,u;const e=this.props,s=e.zIndex||0,r=((l=e.parent)==null?void 0:l.zIndex)||0;let a=s;(u=e.parent)!=null&&u.zIndexLocked&&(a=s<r?s:r),this.calcZIndex=a}destroy(){var e;for(this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,this.renderCoords=void 0,this.renderBound=void 0,this.strictBound=void 0,this.preloadBound=void 0,this.globalTransform=void 0,this.scaleRotateTransform=void 0,this.localTransform=void 0,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;this.children.length>0;)(e=this.children[0])==null||e.destroy();this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}renderQuads(e){this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode)||(O(this.globalTransform),O(this.renderCoords),e.addQuad({width:this.props.width,height:this.props.height,colorTl:this.premultipliedColorTl,colorTr:this.premultipliedColorTr,colorBl:this.premultipliedColorBl,colorBr:this.premultipliedColorBr,texture:this.texture||this.stage.defaultTexture,textureOptions:this.textureOptions,zIndex:this.zIndex,shader:this.shader.shader,shaderProps:this.shader.getResolvedProps(),alpha:this.worldAlpha,clippingRect:this.clippingRect,tx:this.globalTransform.tx,ty:this.globalTransform.ty,ta:this.globalTransform.ta,tb:this.globalTransform.tb,tc:this.globalTransform.tc,td:this.globalTransform.td,renderCoords:this.renderCoords,rtt:this.rtt,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions}))}get id(){return this._id}get data(){return this.props.data}set data(e){this.props.data=e}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(R.Local))}get absX(){var e,s,r;return this.props.x+-this.props.width*this.props.mountX+(((e=this.props.parent)==null?void 0:e.absX)||((r=(s=this.props.parent)==null?void 0:s.globalTransform)==null?void 0:r.tx)||0)}get absY(){var e;return this.props.y+-this.props.height*this.props.mountY+(((e=this.props.parent)==null?void 0:e.absY)??0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(R.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(R.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(R.RenderTexture)))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(R.Local),this.props.rtt&&(this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.setUpdateType(R.RenderTexture)))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(R.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(R.ScaleRotate))}get mount(){return this.props.mount}set mount(e){(this.props.mountX!==e||this.props.mountY!==e)&&(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(R.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(R.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(R.Local))}get pivot(){return this.props.pivot}set pivot(e){(this.props.pivotX!==e||this.props.pivotY!==e)&&(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(R.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(R.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(R.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(R.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(R.PremultipliedColors|R.WorldAlpha|R.Children|R.IsRenderable),this.childUpdateType|=R.WorldAlpha}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get boundsMargin(){var e;return this.props.boundsMargin??((e=this.parent)==null?void 0:e.boundsMargin)??this.stage.boundsMargin}set boundsMargin(e){if(e!==this.props.boundsMargin){if(e===null)this.props.boundsMargin=e;else{const s=Array.isArray(e)?e:[e,e,e,e];this.props.boundsMargin=s}this.setUpdateType(R.RenderBounds)}}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(R.Clipping|R.RenderBounds|R.Children),this.childUpdateType|=R.Global|R.Clipping}get color(){return this.props.color}set color(e){this.colorTop=e,this.colorBottom=e,this.colorLeft=e,this.colorRight=e,this.props.color=e,this.setUpdateType(R.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){(this.props.colorTl!==e||this.props.colorTr!==e)&&(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(R.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){(this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(R.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){(this.props.colorTl!==e||this.props.colorBl!==e)&&(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(R.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){(this.props.colorTr!==e||this.props.colorBr!==e)&&(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(R.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(R.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(R.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(R.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(R.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(R.CalculatedZIndex|R.Children);for(let s=0,r=this.children.length;s<r;s++)this.children[s].setUpdateType(R.CalculatedZIndex)}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(R.CalculatedZIndex|R.Children);for(let s=0,r=this.children.length;s<r;s++)this.children[s].setUpdateType(R.CalculatedZIndex)}get parent(){return this.props.parent}set parent(e){const s=this.props.parent;if(s!==e){if(this.props.parent=e,s){const r=s.children.indexOf(this);O(r!==-1,"CoreNode.parent: Node not found in old parent's children!"),s.children.splice(r,1),s.setUpdateType(R.Children|R.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(R.All),e.setUpdateType(R.Children|R.ZIndexSortedChildren),(e.rtt||e.parentHasRenderTexture)&&this.applyRTTInheritance(e)),this.updateScaleRotateTransform(),this.setUpdateType(R.RenderBounds|R.Children)}}get preventCleanup(){return this.props.textureOptions.preventCleanup||!1}set preventCleanup(e){ni()===!1&&console.warn("CoreNode.preventCleanup: Is deprecated and will be removed in upcoming release, please use textureOptions.preventCleanup instead"),this.props.textureOptions.preventCleanup=e}get rtt(){return this.props.rtt}set rtt(e){this.props.rtt!==e&&(this.props.rtt=e,e===!0?(this.initRenderTexture(),this.markChildrenWithRTT()):this.cleanupRenderTexture(),this.setUpdateType(R.RenderTexture),this.parentHasRenderTexture===!0&&this.notifyParentRTTOfUpdate())}initRenderTexture(){this.texture=this.stage.txManager.createTexture("RenderTexture",{width:this.width,height:this.height}),this.stage.renderer.renderToTexture(this)}cleanupRenderTexture(){this.unloadTexture(),this.clearRTTInheritance(),this.hasRTTupdates=!1,this.texture=null}markChildrenWithRTT(e=null){const s=e||this;for(const r of s.children)r.setUpdateType(R.All),r.parentHasRenderTexture=!0,r.markChildrenWithRTT()}applyRTTInheritance(e){e.rtt&&e.setUpdateType(R.RenderTexture),this.markChildrenWithRTT(e)}clearRTTInheritance(){if(!this.rtt)for(const e of this.children)e.parentHasRenderTexture=!1,e.rttParent=null,e.setUpdateType(R.All),e.clearRTTInheritance()}get shader(){return this.props.shader}set shader(e){this.props.shader!==e&&(this.props.shader=e,this.setUpdateType(R.IsRenderable))}get src(){return this.props.src}set src(e){if(this.props.src!==e){if(this.props.src=e,!e){this.texture=null;return}this.texture=this.stage.txManager.createTexture("ImageTexture",{src:e,width:this.props.width,height:this.props.height,type:this.props.imageType,sx:this.props.srcX,sy:this.props.srcY,sw:this.props.srcWidth,sh:this.props.srcHeight})}}set imageType(e){this.props.imageType!==e&&(this.props.imageType=e)}get imageType(){return this.props.imageType||null}get srcHeight(){return this.props.srcHeight}set srcHeight(e){this.props.srcHeight=e}get srcWidth(){return this.props.srcWidth}set srcWidth(e){this.props.srcWidth=e}get srcX(){return this.props.srcX}set srcX(e){this.props.srcX=e}get srcY(){return this.props.srcY}set srcY(e){this.props.srcY=e}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let e=this.parent;for(;e;){if(e.rtt)return e;e=e.parent}return null}get texture(){return this.props.texture}set texture(e){if(this.props.texture===e)return;const s=this.props.texture;s&&(s.setRenderableOwner(this,!1),this.unloadTexture()),this.props.texture=e,e!==null&&(e.setRenderableOwner(this,this.isRenderable),this.loadTexture()),this.setUpdateType(R.IsRenderable)}set textureOptions(e){this.props.textureOptions=e}get textureOptions(){return this.props.textureOptions}get strictBounds(){return this.props.strictBounds}set strictBounds(e){e!==this.props.strictBounds&&(this.props.strictBounds=e,this.setUpdateType(R.RenderBounds|R.Children),this.childUpdateType|=R.RenderBounds|R.Children)}animate(e,s){const r=new Jl(this,e,s);return new ef(this.stage.animationManager,r)}flush(){}}const tf=i=>{let t=!1;const e=()=>{if(i.updateFrameTime(),i.updateAnimations(),!i.hasSceneUpdates()){i.calculateFps(),setTimeout(e,16.666666666666668),t||(i.eventBus.emit("idle"),t=!0),i.txMemManager.checkCleanup()===!0&&i.txMemManager.cleanup(!1),i.flushFrameEvents();return}t=!1,i.drawFrame(),i.flushFrameEvents(),requestAnimationFrame(e)};requestAnimationFrame(e)},Ms=()=>performance?performance.now():Date.now();class sf{constructor(){h(this,"activeAnimations",new Set)}registerAnimation(t){this.activeAnimations.add(t)}unregisterAnimation(t){this.activeAnimations.delete(t)}update(t){this.activeAnimations.forEach(e=>{e.update(t)})}}function rf(){function i(e){return e.indexOf("image/png")!==-1}function t(e,s,r,a,l,u,o){return new Promise(function(n,c){var f=new XMLHttpRequest;f.open("GET",e,!0),f.responseType="blob",f.onload=function(){if(f.status!==200&&f.status!==0)return c(new Error("Failed to load image: "+f.statusText));var d=f.response;s!==void 0||i(d.type),createImageBitmap(d).then(function(p){n({data:p,premultiplyAlpha:s})}).catch(function(p){c(p)})},f.onerror=function(){c(new Error("Network error occurred while trying to fetch the image."))},f.send()})}self.onmessage=e=>{var s=e.data.src,r=e.data.id,a=e.data.premultiplyAlpha;e.data.sx,e.data.sy,e.data.sw,e.data.sh,t(s,a).then(function(l){self.postMessage({id:r,src:s,data:l},[l.data])}).catch(function(l){self.postMessage({id:r,src:s,error:l.message})})}}class of{constructor(t,e){h(this,"imageWorkersEnabled",!0);h(this,"messageManager",{});h(this,"workers",[]);h(this,"workerIndex",0);h(this,"nextId",0);this.workers=this.createWorkers(t,e),this.workers.forEach(s=>{s.onmessage=this.handleMessage.bind(this)})}handleMessage(t){const{id:e,data:s,error:r}=t.data,a=this.messageManager[e];if(a){const[l,u]=a;delete this.messageManager[e],r?u(new Error(r)):l(s)}}createWorkers(t=1,e){let s=`(${rf.toString()})()`;e.options===!0&&(s=s.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;")),e.full===!0&&(s=s.replace("var supportsOptionsCreateImageBitmap = false;","var supportsOptionsCreateImageBitmap = true;"),s=s.replace("var supportsFullCreateImageBitmap = false;","var supportsFullCreateImageBitmap = true;")),s=s.replace('"use strict";',"");const r=new Blob([s],{type:"application/javascript"}),a=(self.URL?URL:webkitURL).createObjectURL(r),l=[];for(let u=0;u<t;u++)l.push(new Worker(a));return l}getNextWorker(){const t=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,t}getImage(t,e,s,r,a,l){return new Promise((u,o)=>{try{if(this.workers){const n=this.nextId++;this.messageManager[n]=[u,o];const c=this.getNextWorker();c&&c.postMessage({id:n,src:t,premultiplyAlpha:e,sx:s,sy:r,sw:a,sh:l})}}catch(n){o(n)}})}}const xi=class xi extends _i{constructor(e,s){super(e);h(this,"type",Q.color);h(this,"props");this.props=xi.resolveDefaults(s||{})}get color(){return this.props.color}set color(e){this.props.color=e}async getTextureSource(){const e=new Uint8Array(4);return this.color===4294967295?(e[0]=255,e[1]=255,e[2]=255,e[3]=255):(e[0]=this.color>>16&255,e[1]=this.color>>8&255,e[2]=this.color&255,e[3]=this.color>>>24&255),this.setState("fetched",{width:1,height:1}),{data:e,premultiplyAlpha:!0}}static makeCacheKey(e){return`ColorTexture,${xi.resolveDefaults(e).color}`}static resolveDefaults(e){return{color:e.color||4294967295}}};h(xi,"z$__type__Props");let yo=xi;function nf(i){return/\.(ktx|pvr)$/.test(i)}const Sn=async i=>{const e=await(await fetch(i)).arrayBuffer();return i.indexOf(".ktx")!==-1?af(e):lf(e)},af=async i=>{const t=new DataView(i),e=t.getUint32(12)===16909060,s=[],r={glInternalFormat:t.getUint32(28,e),pixelWidth:t.getUint32(36,e),pixelHeight:t.getUint32(40,e),numberOfMipmapLevels:t.getUint32(56,e),bytesOfKeyValueData:t.getUint32(60,e)};let a=64;a+=r.bytesOfKeyValueData;for(let l=0;l<r.numberOfMipmapLevels;l++){const u=t.getUint32(a);a+=4,s.push(t.buffer.slice(a,u)),a+=u}return{data:{glInternalFormat:r.glInternalFormat,mipmaps:s,width:r.pixelWidth||0,height:r.pixelHeight||0,type:"ktx"},premultiplyAlpha:!1}},lf=async i=>{const u=i,o=new Int32Array(u,0,13),n=o[12]+52,c=new Uint8Array(u,n),f=[],d={pixelWidth:o[7],pixelHeight:o[6],numberOfMipmapLevels:o[11]||0};let p=0,m=d.pixelWidth||0,y=d.pixelHeight||0;for(let b=0;b<d.numberOfMipmapLevels;b++){const w=(m+3>>2)*(y+3>>2)*8,S=new Uint8Array(u,c.byteOffset+p,w);f.push(S),p+=w,m=m>>1,y=y>>1}return{data:{glInternalFormat:36196,mipmaps:f,width:d.pixelWidth||0,height:d.pixelHeight||0,type:"pvr"},premultiplyAlpha:!1}};function ff(i){return/\.(svg)(\?.*)?$/.test(i)}const Cn=(i,t,e,s,r,a,l)=>new Promise((u,o)=>{const n=document.createElement("canvas"),c=n.getContext("2d");O(c),c.imageSmoothingEnabled=!0;const f=new Image;f.onload=()=>{const d=s??0,p=r??0,m=t||f.width,y=e||f.height;n.width=m,n.height=y,c.drawImage(f,0,0,m,y),u({data:c.getImageData(d,p,a??m,l??y),premultiplyAlpha:!1})},f.onerror=d=>{o(d)},f.src=i});function ra(i,t=""){return new Promise((e,s)=>{const r=new XMLHttpRequest;r.responseType=t,r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(r.status===0||r.status===200?e(r.response):s(r.statusText))},r.open("GET",i,!0),r.send(null)})}const Ti=class Ti extends _i{constructor(e,s){super(e);h(this,"props");h(this,"type",Q.image);this.props=Ti.resolveDefaults(s)}hasAlphaChannel(e){return e.indexOf("image/png")!==-1}async loadImageFallback(e,s){const r=new Image;return typeof e=="string"&&Po(e)===!1&&(r.crossOrigin="anonymous"),new Promise(a=>{r.onload=()=>{a({data:r,premultiplyAlpha:s})},r.onerror=()=>{console.warn("Image loading failed, returning fallback object."),a({data:r,premultiplyAlpha:s})},e instanceof Blob?r.src=URL.createObjectURL(e):r.src=e})}async createImageBitmap(e,s,r,a,l,u){const o=s??e.type.includes("image/png"),n=this.txManager.imageBitmapSupported;return n.full===!0&&l!==null&&u!==null?{data:await createImageBitmap(e,r||0,a||0,l,u,{premultiplyAlpha:o?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:o}:n.basic===!0?{data:await createImageBitmap(e),premultiplyAlpha:o}:{data:await createImageBitmap(e,{premultiplyAlpha:o?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:o}}async loadImage(e){const{premultiplyAlpha:s,sx:r,sy:a,sw:l,sh:u}=this.props;if(this.txManager.hasCreateImageBitmap===!0){if(Po(e)===!1&&this.txManager.hasWorker===!0&&this.txManager.imageWorkerManager!==null)return this.txManager.imageWorkerManager.getImage(e,s,r,a,l,u);let o;return Po(e)===!0?o=Kl(e):o=await ra(e,"blob").then(n=>n),this.createImageBitmap(o,s,r,a,l,u)}return this.loadImageFallback(e,s??!0)}async getTextureSource(){var a,l;let e;try{e=await this.determineImageTypeAndLoadImage()}catch(u){return this.setState("failed",u),{data:null}}if(e.data===null)return this.setState("failed",Error("ImageTexture: No image data")),{data:null};let s,r;return e.data instanceof Uint8Array?(s=this.props.width??0,r=this.props.height??0):(s=((a=e.data)==null?void 0:a.width)??(this.props.width||0),r=((l=e.data)==null?void 0:l.height)??(this.props.height||0)),this.setState("fetched",{width:s,height:r}),{data:e.data,premultiplyAlpha:this.props.premultiplyAlpha??!0}}determineImageTypeAndLoadImage(){const{src:e,premultiplyAlpha:s,type:r}=this.props;if(e===null)return{data:null};if(typeof e!="string"){if(e instanceof Blob)if(this.txManager.hasCreateImageBitmap===!0){const{sx:l,sy:u,sw:o,sh:n}=this.props;return this.createImageBitmap(e,s,l,u,o,n)}else return this.loadImageFallback(e,s??!0);return e instanceof ImageData?{data:e,premultiplyAlpha:s}:{data:e(),premultiplyAlpha:s}}const a=Yl(e);return r==="regular"?this.loadImage(a):r==="svg"?Cn(a,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):ff(e)===!0?Cn(a,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):r==="compressed"||nf(e)===!0?Sn(a):this.loadImage(a)}static makeCacheKey(e){const s=Ti.resolveDefaults(e),r=s.key||s.src;if(typeof r!="string")return!1;let a="";return s.sh!==null&&s.sw!==null&&(a+=",",a+=s.sx??"",a+=s.sy??"",a+=s.sw||"",a+=s.sh||""),`ImageTexture,${r},${s.premultiplyAlpha??"true"}${a}`}static resolveDefaults(e){return{src:e.src??"",premultiplyAlpha:e.premultiplyAlpha??!0,key:e.key??null,type:e.type??null,width:e.width??null,height:e.height??null,sx:e.sx??null,sy:e.sy??null,sw:e.sw??null,sh:e.sh??null}}};h(Ti,"z$__type__Props");let Si=Ti;const bi=class bi extends _i{constructor(e,s){super(e);h(this,"props");h(this,"type",Q.noise);this.props=bi.resolveDefaults(s)}async getTextureSource(){const{width:e,height:s}=this.props,r=e*s*4,a=new Uint8ClampedArray(r);for(let l=0;l<r;l+=4){const u=Math.floor(Math.random()*256);a[l]=u,a[l+1]=u,a[l+2]=u,a[l+3]=255}return this.setState("fetched"),{data:new ImageData(a,e,s)}}static makeCacheKey(e){if(e.cacheId===void 0)return!1;const s=bi.resolveDefaults(e);return`NoiseTexture,${s.width},${s.height},${s.cacheId}`}static resolveDefaults(e){return{width:e.width??128,height:e.height??128,cacheId:e.cacheId??0}}};h(bi,"z$__type__Props");let Ho=bi;const wo=class wo extends _i{constructor(e,s){super(e);h(this,"props");h(this,"parentTexture");h(this,"type",Q.subTexture);h(this,"onParentTxLoaded",()=>{this.forwardParentTxState("loaded",{width:this.props.width,height:this.props.height})});h(this,"onParentTxFailed",(e,s)=>{this.forwardParentTxState("failed",s)});h(this,"onParentTxFetched",()=>{this.forwardParentTxState("fetched",{width:this.props.width,height:this.props.height})});h(this,"onParentTxFetching",()=>{this.forwardParentTxState("fetching")});h(this,"onParentTxLoading",()=>{this.forwardParentTxState("loading")});h(this,"onParentTxFreed",()=>{this.forwardParentTxState("freed")});this.props=wo.resolveDefaults(s||{}),O(this.props.texture,"SubTexture requires a parent texture"),O(this.props.texture instanceof Si,"SubTexture requires an ImageTexture parent"),this.parentTexture=e.resolveParentTexture(this.props.texture),this.renderableOwners.size>0&&this.parentTexture.setRenderableOwner(this,!0),queueMicrotask(()=>{const r=this.parentTexture;r.state==="loaded"?this.onParentTxLoaded(r,r.dimensions):r.state==="fetching"?this.onParentTxFetching():r.state==="fetched"?this.onParentTxFetched():r.state==="loading"?this.onParentTxLoading():r.state==="failed"?this.onParentTxFailed(r,r.error):r.state==="freed"&&this.onParentTxFreed(),r.on("fetched",this.onParentTxFetched),r.on("loading",this.onParentTxLoading),r.on("fetching",this.onParentTxFetching),r.on("loaded",this.onParentTxLoaded),r.on("failed",this.onParentTxFailed),r.on("freed",this.onParentTxFreed)})}forwardParentTxState(e,s){this.setState(e,s)}onChangeIsRenderable(e){this.parentTexture.setRenderableOwner(this,e)}async getTextureSource(){return new Promise((e,s)=>{this.setState("fetched"),e({data:this.props})})}static makeCacheKey(e){return!1}static resolveDefaults(e){return{texture:e.texture,x:e.x||0,y:e.y||0,width:e.width||0,height:e.height||0}}};h(wo,"z$__type__Props");let Ci=wo;const So=class So extends _i{constructor(e,s){super(e);h(this,"props");h(this,"type",Q.renderToTexture);this.props=So.resolveDefaults(s||{})}get width(){return this.props.width}set width(e){this.props.width=e}get height(){return this.props.height}set height(e){this.props.height=e}async getTextureSource(){return this.setState("fetched"),{data:null,premultiplyAlpha:null}}static resolveDefaults(e){return{width:e.width||256,height:e.height||256}}};h(So,"z$__type__Props");let xo=So;async function uf(){var r,a,l;const i=new Uint8Array([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,1,0,0,0,1,1,3,0,0,0,37,219,86,202,0,0,0,3,80,76,84,69,0,0,0,167,122,61,218,0,0,0,1,116,82,78,83,0,64,230,216,102,0,0,0,10,73,68,65,84,8,215,99,96,0,0,0,2,0,1,226,33,188,51,0,0,0,0,73,69,78,68,174,66,96,130]),t={basic:!1,options:!1,full:!1},e=new Blob([i],{type:"image/png"}),s=await createImageBitmap(e);(r=s.close)==null||r.call(s),t.basic=!0;try{const u={premultiplyAlpha:"none"},o=await createImageBitmap(e,u);(a=o.close)==null||a.call(o),t.options=!0}catch{}try{const u=await createImageBitmap(e,0,0,1,1,{premultiplyAlpha:"none"});(l=u.close)==null||l.call(u),t.full=!0}catch{}return t}class cf extends it{constructor(e,s){super();h(this,"keyCache",new Map);h(this,"inverseKeyCache",new WeakMap);h(this,"txConstructors",{});h(this,"downloadTextureSourceQueue",[]);h(this,"priorityQueue",[]);h(this,"uploadTextureQueue",[]);h(this,"initialized",!1);h(this,"stage");h(this,"numImageWorkers");h(this,"imageWorkerManager",null);h(this,"hasCreateImageBitmap",!!self.createImageBitmap);h(this,"imageBitmapSupported",{basic:!1,options:!1,full:!1});h(this,"hasWorker",!!self.Worker);h(this,"renderer");h(this,"frameTime",0);const{numImageWorkers:r,createImageBitmapSupport:a}=s;this.stage=e,this.numImageWorkers=r,a==="auto"?uf().then(l=>{this.initialize(l)}).catch(l=>{console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.initialized=!0,this.emit("initialized")}):this.initialize({basic:a==="basic",options:a==="options",full:a==="full"}),this.registerTextureType("ImageTexture",Si),this.registerTextureType("ColorTexture",yo),this.registerTextureType("NoiseTexture",Ho),this.registerTextureType("SubTexture",Ci),this.registerTextureType("RenderTexture",xo)}registerTextureType(e,s){this.txConstructors[e]=s}initialize(e){this.hasCreateImageBitmap=e.basic||e.options||e.full,this.imageBitmapSupported=e,this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.hasCreateImageBitmap&&this.hasWorker&&this.numImageWorkers>0?this.imageWorkerManager=new of(this.numImageWorkers,e):console.warn("[Lightning] Imageworker is 0 or not supported on this browser. Image loading will be slower."),this.initialized=!0,this.emit("initialized")}enqueueDownloadTextureSource(e){this.downloadTextureSourceQueue.includes(e)||this.downloadTextureSourceQueue.push(e)}enqueueUploadTexture(e){this.uploadTextureQueue.includes(e)===!1&&this.uploadTextureQueue.push(e)}createTexture(e,s){let r;const a=this.txConstructors[e];if(!a)throw new Error(`Texture type "${e}" is not registered`);const l=a.makeCacheKey(s);return l&&this.keyCache.has(l)?r=this.keyCache.get(l):(r=new a(this,s),l&&this.initTextureToCache(r,l)),r}orphanTexture(e){this.removeTextureFromQueue(e),e.type!==Q.subTexture&&this.stage.txMemManager.addToOrphanedTextures(e)}loadTexture(e,s){if(this.stage.txMemManager.removeFromOrphanedTextures(e),e.type!==Q.subTexture){if(e.ctxTexture!==void 0&&e.ctxTexture.state==="loaded"){e.setState("loaded");return}if(!(this.downloadTextureSourceQueue.includes(e)===!0||this.uploadTextureQueue.includes(e)===!0)){if(e.ctxTexture!==void 0&&e.ctxTexture.state==="loading"&&(e.textureData!==null&&this.enqueueUploadTexture(e),e.free()),this.initialized===!1){this.priorityQueue.push(e);return}if((e.type===Q.color||e.type===Q.renderToTexture)&&e.state!=="initial"){e.setState("fetched"),this.enqueueUploadTexture(e);return}e.setState("loading"),s===!0&&e.getTextureData().then(()=>{this.uploadTexture(e)}).catch(r=>{console.error(r)}),this.enqueueDownloadTextureSource(e)}}}uploadTexture(e){if(this.stage.txMemManager.doNotExceedCriticalThreshold===!0&&this.stage.txMemManager.criticalCleanupRequested===!0){this.enqueueUploadTexture(e);return}const s=e.loadCtxTexture();if(s!==null&&s.state==="loaded"){e.setState("loaded");return}s.load()}isProcessingTexture(e){return this.downloadTextureSourceQueue.includes(e)===!0||this.uploadTextureQueue.includes(e)===!0}processSome(e){if(this.initialized===!1)return;const s=Ms();for(;this.priorityQueue.length>0&&Ms()-s<e;){const r=this.priorityQueue.pop();r.getTextureData().then(()=>{this.uploadTexture(r)})}for(;this.uploadTextureQueue.length>0&&Ms()-s<e;)this.uploadTexture(this.uploadTextureQueue.pop());for(;this.downloadTextureSourceQueue.length>0&&Ms()-s<e;){const r=this.downloadTextureSourceQueue.shift();r.getTextureData().then(()=>{r.state==="fetched"&&this.enqueueUploadTexture(r)})}}hasUpdates(){return this.downloadTextureSourceQueue.length>0||this.uploadTextureQueue.length>0}initTextureToCache(e,s){const{keyCache:r,inverseKeyCache:a}=this;r.set(s,e),a.set(e,s)}getTextureFromCache(e){return this.keyCache.get(e)}removeTextureFromCache(e){const{inverseKeyCache:s,keyCache:r}=this,a=s.get(e);a&&r.delete(a)}removeTextureFromQueue(e){const s=this.downloadTextureSourceQueue.indexOf(e);s!==-1&&this.downloadTextureSourceQueue.splice(s,1);const r=this.uploadTextureQueue.indexOf(e);r!==-1&&this.uploadTextureQueue.splice(r,1)}resolveParentTexture(e){if(!(e!=null&&e.props))return e;const s=Si.makeCacheKey(e.props);return(s?this.getTextureFromCache(s):void 0)??e}}const hf={normal:400,bold:700,bolder:900,lighter:100},vn=i=>typeof i=="number"?i:hf[i]||400;function df(i,t,e,s,r){let a=vn(e);for(const l of i){const u=l[t];if(!u)continue;if(u.size===1)return console.warn(`TrFontManager: Only one font face found for family: '${t}' - will be used for all weights and styles`),u.values().next().value;const o=new Map;for(const c of u){const f=vn(c.descriptors.weight);if(f===a&&c.descriptors.style===s&&c.descriptors.stretch===r)return c;o.set(f,c)}const n=`TrFontManager: No exact match: '${t} Weight: ${a} Style: ${s} Stretch: ${r}'`;if(console.error(n),a===400&&o.has(500))return o.get(500);if(a===500&&o.has(400))return o.get(400);if(a<400){for(;a>0;){if(o.has(a))return o.get(a);a-=100}a=600}for(;a<1e3;){if(o.has(a))return o.get(a);a+=100}for(a=500;a>0;){if(o.has(a))return o.get(a);a-=100}}}class pf{constructor(t){h(this,"textRenderers");h(this,"fontCache",new Map);this.textRenderers=t}addFontFace(t){for(const e in this.textRenderers){const s=this.textRenderers[e];s&&s.isFontFaceSupported(t)&&s.addFontFace(t)}}resolveFontFace(t,e,s){const{fontFamily:r,fontWeight:a,fontStyle:l,fontStretch:u}=e,o=`${s}_${r}_${l}_${a}_${u}`;if(this.fontCache.has(o)===!0)return this.fontCache.get(o);const n=df(t,r,a,l,u);return n!==void 0&&this.fontCache.set(o,n),n}}class oa{static makeCacheKey(t){return!1}static resolveDefaults(t){return{}}}function Rn(i,t,e){const s=i.createShader(t);if(!s){const a=i.getError();throw new Error(`Unable to create the shader: ${t===i.VERTEX_SHADER?"VERTEX_SHADER":"FRAGMENT_SHADER"}.${a?` WebGlContext Error: ${a}`:""}`)}if(i.shaderSource(s,e),i.compileShader(s),!!i.getShaderParameter(s,i.COMPILE_STATUS))return s;console.error(i.getShaderInfoLog(s)),i.deleteShader(s)}function mf(i,t,e){const s=i.createProgram();if(!s)throw new Error("Unable to create program");if(i.attachShader(s,t),i.attachShader(s,e),i.linkProgram(s),!!i.getProgramParameter(s,i.LINK_STATUS))return s;console.warn(i.getProgramInfoLog(s)),i.deleteProgram(s)}class ks extends oa{constructor(e){super();h(this,"boundBufferCollection",null);h(this,"buffersBound",!1);h(this,"program");h(this,"vao");h(this,"renderer");h(this,"glw");h(this,"attributeBuffers");h(this,"attributeLocations");h(this,"attributeNames");h(this,"uniformLocations");h(this,"uniformTypes");h(this,"supportsIndexedTextures");const s=this.renderer=e.renderer,r=this.glw=this.renderer.glw;this.supportsIndexedTextures=e.supportsIndexedTextures||!1;const a=r.isWebGl2(),l=a&&e.webgl2Extensions||!a&&e.webgl1Extensions||[],u=a?"2.0":"1.0";l.forEach(y=>{if(!r.getExtension(y))throw new Error(`Shader "${this.constructor.name}" requires extension "${y}" for WebGL ${u} but wasn't found`)});const o=e.shaderSources||this.constructor.shaderSources;if(o)a&&(o!=null&&o.webGl2)&&(o.fragment=o.webGl2.fragment,o.vertex=o.webGl2.vertex,delete o.webGl2);else throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);const n=s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,c=o.vertex instanceof Function?o.vertex(n):o.vertex,f=o.fragment instanceof Function?o.fragment(n):o.fragment,d=Rn(r,r.VERTEX_SHADER,c),p=Rn(r,r.FRAGMENT_SHADER,f);if(!d||!p)throw new Error(`Unable to create the following shader(s): ${[!d&&"VERTEX_SHADER",!p&&"FRAGMENT_SHADER"].filter(Boolean).join(" and ")}`);const m=mf(r,d,p);if(!m)throw new Error("Unable to create program");this.program=m,this.attributeLocations={},this.attributeBuffers={},this.attributeNames=[],[...e.attributes].forEach(y=>{const b=r.getAttribLocation(this.program,y);if(b<0)throw new Error(`${this.constructor.name}: Vertex shader must have an attribute "${y}"!`);const w=r.createBuffer();if(!w)throw new Error(`${this.constructor.name}: Could not create buffer for attribute "${y}"`);this.attributeLocations[y]=b,this.attributeBuffers[y]=w,this.attributeNames.push(y)}),this.uniformLocations={},this.uniformTypes={},e.uniforms.forEach(y=>{const b=r.getUniformLocation(this.program,y.name);if(this.uniformTypes[y.name]=y.uniform,!b){console.warn(`Shader "${this.constructor.name}" could not get uniform location for "${y.name}"`);return}this.uniformLocations[y.name]=b})}bindBufferAttribute(e,s,r){const{glw:a}=this;a.enableVertexAttribArray(e),a.vertexAttribPointer(s,e,r.size,r.type,r.normalized,r.stride,r.offset)}disableAttribute(e){this.glw.disableVertexAttribArray(e)}disableAttributes(){for(const e in this.attributeLocations)this.disableAttribute(this.attributeLocations[e]);this.boundBufferCollection=null}canBatchShaderProps(e,s){return!1}bindRenderOp(e,s){this.bindBufferCollection(e.buffers),e.textures.length>0&&this.bindTextures(e.textures);const{glw:r,parentHasRenderTexture:a,renderToTexture:l}=e;if(!(l&&a)){if(a){const{width:u,height:o}=e.framebufferDimensions||{};r.uniform1f(this.getUniformLocation("u_pixelRatio"),1),r.uniform2f(this.getUniformLocation("u_resolution"),u??0,o??0)}else r.uniform1f(this.getUniformLocation("u_pixelRatio"),e.options.pixelRatio),r.uniform2f(this.getUniformLocation("u_resolution"),r.canvas.width,r.canvas.height);if(s){if(go(s,"$dimensions")){let u=s.$dimensions;u||(u=e.dimensions),r.uniform2f(this.getUniformLocation("u_dimensions"),u.width,u.height)}if(go(s,"$alpha")){let u=s.$alpha;u||(u=e.alpha),r.uniform1f(this.getUniformLocation("u_alpha"),u)}this.bindProps(s)}}}getUniformLocation(e){return this.uniformLocations[e]||null}bindBufferCollection(e){if(this.boundBufferCollection!==e){for(const s in this.attributeLocations){const r=e.getBuffer(s),a=e.getAttributeInfo(s);O(r,`Buffer for "${s}" not found`),O(a),this.bindBufferAttribute(this.attributeLocations[s],r,a)}this.boundBufferCollection=e}}bindProps(e){}bindTextures(e){}attach(){this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}h(ks,"shaderSources");class na extends ks{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}}h(na,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;


      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio;
        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);

        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);
        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
          vec4 color = texture2D(u_texture, v_textureCoordinate);
          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);
      }
    `});class aa extends ks{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});h(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:s,glw:r}=this;if(e.length>s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);e.forEach((l,u)=>{r.activeTexture(u),r.bindTexture(l.ctxTexture)});const a=Array.from(Array(e.length).keys());this.glw.uniform1iv(this.getUniformLocation("u_textures[0]"),a)}}h(aa,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_textureCoordinate;
      attribute vec2 a_position;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      void main(){
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;
        v_textureIndex = a_textureIndex;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:e=>`
      #define txUnits ${e}
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_image;
      uniform sampler2D u_textures[txUnits];

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      vec4 sampleFromTexture(sampler2D textures[${e}], int idx, vec2 uv) {
        ${Array.from(Array(e).keys()).map(s=>`
          ${s!==0?"else ":""}if (idx == ${s}) {
            return texture2D(textures[${s}], uv);
          }
        `).join("")}
        return texture2D(textures[0], uv);
      }

      void main(){
        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);
      }
    `});class ne{constructor(t){h(this,"priority",1);h(this,"name","");h(this,"ref");h(this,"target");h(this,"passParameters","");h(this,"declaredUniforms","");h(this,"uniformInfo",{});const{ref:e,target:s,props:r={}}=t;this.ref=e,this.target=s;const a={},l=[];let u="";const o=this.constructor.uniforms||{};for(const n in o){const c=o[n],f=c.type,d=`${e}_${n}`;let p="";c.size&&(p=`[${c.size(r)}]`),l.push(d),u+=`uniform ${f} ${d}${p};`,a[n]={name:d,uniform:o[n].method}}this.passParameters=l.join(","),this.declaredUniforms=u,this.uniformInfo=a}static getEffectKey(t){return""}static getMethodParameters(t,e){const s=[];for(const r in t){const a=t[r];let l="";a.size&&(l=`[${a.size(e)}]`),s.push(`${a.type} ${r}${l}`)}return s.join(",")}static resolveDefaults(t){return{}}static makeEffectKey(t){return!1}}h(ne,"uniforms",{}),h(ne,"methods"),h(ne,"onShaderMask"),h(ne,"onColorize"),h(ne,"onEffectMask");const Bo=new Map,gf=(i,t)=>{const e=JSON.stringify(i);if(Bo.has(e))return Bo.get(e);i=i??[];const s=[],r=i.length;let a=0;for(;a<r;a++){const{name:l,type:u,props:o}=i[a],n={name:l,type:u,props:{}},c=t[u],f=c.resolveDefaults(o),d=c.uniforms,p=Object.keys(d),m=p.length;let y=0;for(;y<m;y++){const b=p[y],w=d[b],S={value:f[b],programValue:void 0,method:w.method,updateOnBind:w.updateOnBind||!1,hasValidator:w.validator!==void 0,hasProgramValueUpdater:w.updateProgramValue!==void 0},_=S.hasValidator&&w.validator(f[b],f)||f[b];f[b]!==_&&(S.validatedValue=_),S.hasProgramValueUpdater&&w.updateProgramValue(S),S.programValue===void 0&&(S.programValue=S.value),n.props[b]=S}s.push(n)}return Bo.set(e,s),s},et=class et extends ks{constructor(e,s,r){const a=et.createShader(s,r);super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...a.uniforms],shaderSources:{vertex:a.vertex,fragment:a.fragment}});h(this,"effects",[]);this.effects=a.effects}bindTextures(e){const{glw:s}=this;s.activeTexture(0),s.bindTexture(e[0].ctxTexture)}bindUniformMethods(e){const s=this.glw,r=e.effects,a=r.length;for(let l=0;l<a;l++){const u=this.effects[l].uniformInfo,o=r[l],n=Object.keys(o.props),c=n.length;for(let f=0;f<c;f++){const d=n[f],p=o.props[d].method,m=this.getUniformLocation(u[d].name);if(p==="uniform2fv"||p==="uniform2iv"||p==="uniform3iv"||p==="uniform4fv"||p==="uniform4iv"||p==="uniformMatrix2fv"||p==="uniformMatrix3fv"||p==="uniformMatrix4fv"||p==="uniform1f"||p==="uniform1fv"||p==="uniform1i"||p==="uniform1iv"){o.props[d].setUniformValue=function(){s[p](m,this.programValue)};continue}if(p==="uniform2f"||p==="uniform2i"){o.props[d].setUniformValue=function(){s[p](m,this.programValue[0],this.programValue[1])};continue}if(p==="uniform3f"||p==="uniform3i"){o.props[d].setUniformValue=function(){s[p](m,this.programValue[0],this.programValue[1],this.programValue[2])};continue}if(p==="uniform4f"||p==="uniform4i"){o.props[d].setUniformValue=function(){s[p](m,this.programValue[0],this.programValue[1],this.programValue[2],this.programValue[3])};continue}}}}bindProps(e){var l;const s=e.effects,r=s.length;let a=0;for(;a<r;a++){const u=s[a],o=Object.keys(u.props),n=o.length;let c=0;for(;c<n;c++){const f=o[c],d=u.props[f];if(d.updateOnBind===!0){const p=(l=this.renderer.shManager.getRegisteredEffects()[u.type])==null?void 0:l.uniforms[f];p==null||p.updateProgramValue(u.props[f],e)}d.setUniformValue()}}}canBatchShaderProps(e,s){if(e.$alpha!==s.$alpha||e.$dimensions.width!==s.$dimensions.width||e.$dimensions.height!==s.$dimensions.height||e.effects.length!==s.effects.length)return!1;const r=e.effects.length;let a=0;for(;a<r;a++){const l=e.effects[a],u=s.effects[a];if(l.type!==u.type)return!1;for(const o in l.props)if(u.props&&!u.props[o]||l.props[o].value!==u.props[o].value)return!1}return!0}static createShader(e,s){const r={},a={};let l="";const u=[],o=[],n=e.effects.map(m=>{const y=s[m.type],b=y.getEffectKey(m.props||{});r[b]=r[b]?++r[b]:1;const w=r[b];w===1&&o.push({key:b,type:m.type,props:m.props});const S=new y({ref:`${b}${w===1?"":w}`,target:b,props:m.props});return l+=S.declaredUniforms,u.push(...Object.values(S.uniformInfo)),S});let c="";o==null||o.forEach(m=>{const y=s[m.type],b=y.resolveDefaults(m.props??{}),w=[];for(const P in y.methods){let L=P;const U=y.methods[P];a[P]&&a[P]!==U&&(L=et.resolveMethodDuplicate(P,U,a)),a[L]=U.replace("function",L),w.push({m:P,cm:L})}let S=y.onShaderMask instanceof Function?y.onShaderMask(b):y.onShaderMask,_=y.onColorize instanceof Function?y.onColorize(b):y.onColorize,x=y.onEffectMask instanceof Function?y.onEffectMask(b):y.onEffectMask;w.forEach(P=>{const{m:L,cm:U}=P,k=new RegExp(`\\$${L}`,"g");S&&(S=S.replace(k,U)),_&&(_=_.replace(k,U)),x&&(x=x.replace(k,U))});const $=y.getMethodParameters(y.uniforms,b),M=$.length>0?`, ${$}`:"";S&&(c+=`
        float fx_${m.key}_onShaderMask(float shaderMask ${M}) {
          ${S}
        }
        `),_&&(c+=`
          vec4 fx_${m.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${M}) {
            ${_}
          }
        `),x&&(c+=`
          vec4 fx_${m.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${M}) {
            ${x}
          }
        `)});let f="";for(const m in a)f+=a[m];let d="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",p=`

    `;for(let m=0;m<n.length;m++){const y=n[m],b=y.passParameters.length>0?`, ${y.passParameters}`:"",w=s[y.name];w.onShaderMask&&(p+=`
        shaderMask = fx_${y.target}_onShaderMask(shaderMask ${b});
        `),w.onColorize&&(p+=`
        maskColor = fx_${y.target}_onColorize(shaderMask, maskColor, shaderColor${b});
        `),w.onEffectMask&&(d=`fx_${y.target}_onEffectMask(shaderMask, maskColor, shaderColor${b})`);const S=n[m+1];(S===void 0||s[S.name].onEffectMask)&&(p+=`
          shaderColor = ${d};
        `)}return{effects:n,uniforms:u,fragment:et.fragment(l,f,c,p),vertex:et.vertex()}}static resolveMethodDuplicate(e,s,r,a=0){const l=e+(a>0?a:"");return r[l]&&r[l]!==s?this.resolveMethodDuplicate(e,s,r,++a):l}static resolveDefaults(e,s){return O(s),{effects:gf(e.effects??[],s),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,s){var a;let r="";return(a=e.effects)==null||a.forEach(l=>{const o=s[l.type].getEffectKey(l.props||{});r+=`,${o}`}),`DynamicShader${r}`}};h(et,"z$__type__Props"),h(et,"vertex",()=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    attribute vec2 a_textureCoordinate;
    attribute vec2 a_position;
    attribute vec4 a_color;
    attribute float a_textureIndex;

    uniform vec2 u_resolution;
    uniform float u_pixelRatio;

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;
    varying float v_textureIndex;

    void main(){
      vec2 normalized = a_position * u_pixelRatio / u_resolution;
      vec2 zero_two = normalized * 2.0;
      vec2 clip_space = zero_two - 1.0;

      // pass to fragment
      v_color = a_color;
      v_textureCoordinate = a_textureCoordinate;
      v_textureIndex = a_textureIndex;

      // flip y
      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
    }
  `),h(et,"fragment",(e,s,r,a)=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    #define PI 3.14159265359

    uniform vec2 u_resolution;
    uniform vec2 u_dimensions;
    uniform float u_alpha;
    uniform float u_radius;
    uniform sampler2D u_texture;
    uniform float u_pixelRatio;

    ${e}

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;

    ${s}

    ${r}

    void main() {
      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;
      vec2 d = abs(p) - (u_dimensions) * 0.5;
      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));

      vec4 shaderColor = vec4(0.0);
      float shaderMask = lng_DefaultMask;

      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;

      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));

      ${a}

      gl_FragColor = shaderColor * u_alpha;
    }
  `);let Zs=et;class Yo extends ks{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(t){return{radius:t.radius||10,$dimensions:{width:0,height:0}}}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=Math.min(t.$dimensions.width,t.$dimensions.height)/(2*t.radius);this.glw.uniform1f(this.getUniformLocation("u_radius"),t.radius*Math.min(e,1))}canBatchShaderProps(t,e){return t.radius===e.radius&&t.$dimensions.width===e.$dimensions.width&&t.$dimensions.height===e.$dimensions.height}}h(Yo,"z$__type__Props"),h(Yo,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform vec2 u_dimensions;
      uniform float u_radius;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      float boxDist(vec2 p, vec2 size, float radius){
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }

      float fillMask(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }

      void main() {
        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;
        vec2 halfDimensions = u_dimensions * 0.5;

        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);
        gl_FragColor = mix(vec4(0.0), color, fillMask(d));
      }
    `});const yf=new Float32Array([1,0,0,0,1,0,0,0,1]),wi=class wi extends ks{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=wi.resolveDefaults(t);for(const s in e)if(s==="transform")this.glw.uniformMatrix3fv(this.getUniformLocation("u_transform"),e[s]);else if(s==="scrollY")this.glw.uniform1f(this.getUniformLocation("u_scrollY"),e[s]);else if(s==="color"){const r=Ei(e.color);this.glw.uniform4fv(this.getUniformLocation("u_color"),r)}else s==="size"?this.glw.uniform1f(this.getUniformLocation("u_size"),e[s]):s==="distanceRange"?this.glw.uniform1f(this.getUniformLocation("u_distanceRange"),e[s]):s==="debug"&&this.glw.uniform1i(this.getUniformLocation("u_debug"),e[s]?1:0)}static resolveDefaults(t={}){return{transform:t.transform??yf,scrollY:t.scrollY??0,color:t.color??4294967295,size:t.size??16,distanceRange:t.distanceRange??1,debug:t.debug??!1}}};h(wi,"z$__type__Props"),h(wi,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      // an attribute is an input (in) to a vertex shader.
      // It will receive data from a buffer
      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;

      uniform vec2 u_resolution;
      uniform mat3 u_transform;
      uniform float u_scrollY;
      uniform float u_pixelRatio;
      uniform float u_size;

      varying vec2 v_texcoord;

      void main() {
        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);
        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;

        // Calculate screen space with pixel ratio
        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);

        gl_Position = vec4(screenSpace, 0.0, 1.0);
        v_texcoord = a_textureCoordinate;

      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      uniform vec4 u_color;
      uniform sampler2D u_texture;
      uniform float u_distanceRange;
      uniform float u_pixelRatio;
      uniform int u_debug;

      varying vec2 v_texcoord;

      float median(float r, float g, float b) {
          return max(min(r, g), min(max(r, g), b));
      }

      void main() {
          vec3 sample = texture2D(u_texture, v_texcoord).rgb;
          if (u_debug == 1) {
            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);
            return;
          }
          float scaledDistRange = u_distanceRange * u_pixelRatio;
          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);
          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;

          // Build the final color.
          // IMPORTANT: We must premultiply the color by the alpha value before returning it.
          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);
      }
    `});let Ko=wi;const ai=i=>{i.programValue===void 0&&(i.programValue=new Float32Array(4));const t=i.value,e=i.programValue;e[0]=(t>>>24)/255,e[1]=(t>>>16&255)/255,e[2]=(t>>>8&255)/255,e[3]=(t&255)/255},xf=i=>{const t=i.validatedValue||i.value;if(i.programValue instanceof Float32Array){const e=i.programValue;e[0]=t[0],e[1]=t[1]}else i.programValue=new Float32Array(t)},Tf=i=>{const t=i.validatedValue||i.value;if(i.programValue instanceof Float32Array){const e=i.programValue;e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]}else i.programValue=new Float32Array(t)},la=i=>{const t=i.validatedValue||i.value;if(i.programValue instanceof Float32Array){const e=t.length,s=i.programValue;for(let r=0;r<e;r++)s[r]=t[r]}else i.programValue=new Float32Array(t)},ln=i=>{const t=Array.isArray(i);if(t){if(t&&i.length===4)return i;if(t&&i.length===2)return[i[0],i[1],i[0],i[1]];if(t&&i.length===3)return[i[0],i[1],i[2],i[0]]}else return[i,i,i,i];return[i[0],i[0],i[0],i[0]]},fa=(i,t)=>{i.programValue===void 0&&(i.programValue=new Float32Array(4));const e=i.programValue,s=i.validatedValue||i.value;if(t===void 0&&i.$dimensions===void 0){e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3];return}let r=i.$dimensions;if(t!==void 0){const{$dimensions:d}=t;if(r!==void 0&&(r.width===d.width||r.height===d.height))return;r===void 0&&(r={width:d==null?void 0:d.width,height:d==null?void 0:d.height},i.$dimensions=r)}const{width:a,height:l}=r,[u,o,n,c]=s,f=Math.min(Math.min(Math.min(a/Math.max(a,u+o),a/Math.max(a,n+c)),Math.min(l/Math.max(l,u+n),l/Math.max(l,o+c))),1);e[0]=u*f,e[1]=o*f,e[2]=n*f,e[3]=c*f};class zs extends ne{constructor(){super(...arguments);h(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){return{radius:e.radius??10}}}h(zs,"z$__type__Props"),h(zs,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:ln,updateProgramValue:fa}}),h(zs,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),h(zs,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);
  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);
  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);
  `),h(zs,"onEffectMask",`
  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));
  `);class di extends ne{constructor(){super(...arguments);h(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}h(di,"z$__type__Props"),h(di,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ai,method:"uniform4fv",type:"vec4"}}),h(di,"onEffectMask",`
  float intR = shaderMask + 1.0;
  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);
  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);
  `),h(di,"onColorize",`
    return color;
  `);const at=class at extends ne{constructor(){super(...arguments);h(this,"name","linearGradient")}static getEffectKey(e){return e.colors.value?`linearGradient${e.colors.value.length}`:`linearGradient${e.colors.length}`}static resolveDefaults(e){const s=e.colors??[4278190080,4294967295];let r=e.stops||[];if(r.length===0||r.length!==s.length){const a=s.length;let l=0;const u=r;for(;l<a;l++)r[l]?(u[l]=r[l],r[l-1]===void 0&&u[l-2]!==void 0&&(u[l-1]=u[l-2]+(r[l]-u[l-2])/2)):u[l]=l*(1/(s.length-1));r=u}return{colors:s,stops:r,angle:e.angle??0}}};h(at,"z$__type__Props"),h(at,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.reduce((s,r)=>s.concat(Ei(r)),[]),updateProgramValue:la,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),h(at,"methods",{fromLinear:`
      vec4 function(vec4 linearRGB) {
        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);
        vec4 lower = linearRGB * vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,toLinear:`
      vec4 function(vec4 sRGB) {
        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));
        vec4 lower = sRGB/vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,calcPoint:`
      vec2 function(float d, float angle) {
        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);
      }
    `}),h(at,"ColorLoop",e=>{let s="";for(let r=2;r<e;r++)s+=`colorOut = mix(colorOut, colors[${r}], clamp((dist - stops[${r-1}]) / (stops[${r}] - stops[${r-1}]), 0.0, 1.0));`;return s}),h(at,"onColorize",e=>{const s=e.colors.length||1;return`
      float a = angle - (PI / 180.0 * 90.0);
      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));
      vec2 f = $calcPoint(lineDist * 0.5, a);
      vec2 t = $calcPoint(lineDist * 0.5, a + PI);
      vec2 gradVec = t - f;
      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));
      ${at.ColorLoop(s)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let jo=at;class qo extends ne{constructor(){super(...arguments);h(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){return{amount:e.amount??1}}}h(qo,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),h(qo,"onColorize",`
    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;
    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);
  `);class Ws extends ne{constructor(){super(...arguments);h(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}h(Ws,"z$__type__Props"),h(Ws,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ai,method:"uniform4fv",type:"vec4"}}),h(Ws,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),h(Ws,"onEffectMask",`
  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),h(Ws,"onColorize",`
    return color;
  `);class Vs extends ne{constructor(){super(...arguments);h(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}h(Vs,"z$__type__Props"),h(Vs,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ai,method:"uniform4fv",type:"vec4"}}),h(Vs,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),h(Vs,"onEffectMask",`
  vec2 pos = vec2(0.0, width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),h(Vs,"onColorize",`
    return color;
  `);class Xs extends ne{constructor(){super(...arguments);h(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}h(Xs,"z$__type__Props"),h(Xs,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ai,method:"uniform4fv",type:"vec4"}}),h(Xs,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),h(Xs,"onEffectMask",`
  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),h(Xs,"onColorize",`
    return color;
  `);class Gs extends ne{constructor(){super(...arguments);h(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}h(Gs,"z$__type__Props"),h(Gs,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ai,method:"uniform4fv",type:"vec4"}}),h(Gs,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),h(Gs,"onEffectMask",`
  vec2 pos = vec2(width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),h(Gs,"onColorize",`
    return color;
  `);class pi extends ne{constructor(){super(...arguments);h(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){return{amplitude:e.amplitude??.2,narrowness:e.narrowness??4,blockiness:e.blockiness??2,minimizer:e.minimizer??8,time:e.time??Date.now()}}}h(pi,"z$__type__Props"),h(pi,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:e=>{const s=e.value=(Date.now()-e.value)%1e3;e.programValue=s},type:"float"}}),h(pi,"methods",{rand:`
      float function(vec2 p, float time) {
        float t = floor(time * 20.) / 10.;
        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);
      }
    `,noise:`
      float function(vec2 uv, float blockiness, float time) {
        vec2 lv = fract(uv);
        vec2 id = floor(uv);

        float n1 = rand(id, time);
        float n2 = rand(id+vec2(1,0), time);
        float n3 = rand(id+vec2(0,1), time);
        float n4 = rand(id+vec2(1,1), time);
        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);
        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);
      }
    `,fbm:`
      float function(vec2 uv, int count, float blockiness, float complexity, float time) {
        float val = 0.0;
        float amp = 0.5;
        const int MAX_ITERATIONS = 10;

        for(int i = 0; i < MAX_ITERATIONS; i++) {
          if(i >= count) {break;}
          val += amp * noise(uv, blockiness, time);
          amp *= 0.5;
          uv *= complexity;
        }
        return val;
      }
    `}),h(pi,"onColorize",`
    vec2 uv = v_textureCoordinate.xy;
    float aspect = u_dimensions.x / u_dimensions.y;
    vec2 a = vec2(uv.x * aspect , uv.y);
    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));

    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);
    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);
    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);
    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);

    vec3 f = vec3(colR, colG, colB);
    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);
  `);class lo extends ne{constructor(){super(...arguments);h(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){return{fade:e.fade??10}}}h(lo,"z$__type__Props"),h(lo,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:ln,updateProgramValue:Tf}}),h(lo,"onColorize",`
  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;
  vec2 pos1;
  vec2 pos2;
  vec2 d;
  float c;
  vec4 result = maskColor;


  if(fade[0] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x, point.y + fade[0]);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[1] > 0.0) {
    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);
    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[2] > 0.0) {
    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);
    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[3] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x + fade[3], point.y);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  return result;
  `);const As=class As extends ne{constructor(){super(...arguments);h(this,"name","radialGradient")}static getEffectKey(e){return e.colors.value?`radialGradient${e.colors.value.length}`:`radialGradient${e.colors.length}`}static resolveDefaults(e){const s=e.colors??[4278190080,4294967295];let r=e.stops||[];if(r.length===0||r.length!==s.length){const a=s.length;let l=0;const u=r;for(;l<a;l++)r[l]?(u[l]=r[l],r[l-1]===void 0&&u[l-2]!==void 0&&(u[l-1]=u[l-2]+(r[l]-u[l-2])/2)):u[l]=l*(1/(s.length-1));r=u}return{colors:s,stops:r,width:e.width??0,height:e.height??e.width??0,pivot:e.pivot??[.5,.5]}}};h(As,"z$__type__Props"),h(As,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:xf,method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.reduce((s,r)=>s.concat(Ei(r)),[]),updateProgramValue:la,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),h(As,"ColorLoop",e=>{let s="";for(let r=2;r<e;r++)s+=`colorOut = mix(colorOut, colors[${r}], clamp((dist - stops[${r-1}]) / (stops[${r}] - stops[${r-1}]), 0.0, 1.0));`;return s}),h(As,"onColorize",e=>{const s=e.colors.length||1;return`
      vec2 point = v_textureCoordinate.xy * u_dimensions;
      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);

      float dist = length((point - projection) / vec2(width, height));

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = mix(colors[0], colors[1], stopCalc);
      ${As.ColorLoop(s)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let Qo=As;class Hs extends ne{constructor(){super(...arguments);h(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){return{width:e.width??10,progress:e.progress??.5,offset:e.offset??0,range:e.range??Math.PI*2,rounded:e.rounded??!1,radius:e.radius??1,color:e.color??4294967295}}}h(Hs,"z$__type__Props"),h(Hs,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:ai,method:"uniform4fv",type:"vec4"}}),h(Hs,"methods",{rotateUV:`
    vec2 function(vec2 uv, float d) {
      float s = sin(d);
      float c = cos(d);
      mat2 rotMatrix = mat2(c, -s, s, c);
      return uv * rotMatrix;
    }
    `,drawDot:`
    float function(vec2 uv, vec2 p, float r) {
      uv += p;
      float circle = length(uv) - r;
      return clamp(-circle, 0.0, 1.0);
    }
    `}),h(Hs,"onEffectMask",`
    float outerRadius = radius * u_dimensions.y * 0.5;

    float endAngle = range * progress - 0.0005;

    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;

    uv = $rotateUV(uv, -(offset));
    float linewidth = width * u_pixelRatio;
    float circle = length(uv) - (outerRadius - linewidth) ;
    circle = abs(circle) - linewidth;
    circle = clamp(-circle, 0.0, 1.0);

    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);
    float p = endAngle / (PI * 2.);

    circle *= step(fract(angle), fract(p));

    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));
    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));

    return mix(shaderColor, maskColor, circle);
  `),h(Hs,"onColorize",`
    return color;
  `);class Ys extends ne{constructor(){super(...arguments);h(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:e.radius??0}}}h(Ys,"z$__type__Props"),h(Ys,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:ln,updateProgramValue:fa}}),h(Ys,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),h(Ys,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  vec2 size = vec2(width, height) * 0.5;
  vec2 basePos = v_textureCoordinate.xy * u_dimensions.xy - vec2(x, y);
  vec2 pos = basePos - size;
  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);
  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);
  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);
  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);
  return $boxDist(pos, size, r);
  `),h(Ys,"onEffectMask",`
  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));
  `);const bf="RoundedRectangle";class vo extends oa{constructor(e){super();h(this,"shType");this.shType=e}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class wf{constructor(t,e,s,r){h(this,"type");h(this,"shader");h(this,"resolvedProps");h(this,"props");this.type=t,this.shader=e,this.resolvedProps=s;const a=Object.keys(s),l=a.length,u={};for(let o=0;o<l;o++){const n=a[o];Object.defineProperty(u,n,{get:()=>this.resolvedProps[n],set:c=>{this.resolvedProps[n]=c,r.requestRender()}})}this.props=u}getResolvedProps(){return this.resolvedProps}}class Sf{constructor(t,e,s){h(this,"shader");h(this,"resolvedProps");h(this,"props");h(this,"type");this.shader=t,this.type="DynamicShader",this.resolvedProps=e;const r=s.getRegisteredEffects(),a={},l=e.effects,u=l.length;for(let o=0;o<u;o++){const{name:n,props:c,type:f}=l[o];if(n===void 0)continue;const d={},p=Object.keys(c),m=p.length;for(let y=0;y<m;y++){const b=p[y];Object.defineProperty(d,b,{get:()=>this.resolvedProps.effects[o].props[b].value,set:w=>{var _,x;const S=this.resolvedProps.effects[o].props[b];S.value=w,S.hasValidator&&(w=S.validatedValue=(_=r[f].uniforms[b])==null?void 0:_.validator(w,c)),S.hasProgramValueUpdater?(x=r[f].uniforms[b])==null||x.updateProgramValue(S):S.programValue=w,s.renderer.stage.requestRender()}})}Object.defineProperty(a,n,{get:()=>d})}this.props=a}getResolvedProps(){return this.resolvedProps}}class Cf{constructor(){h(this,"shCache",new Map);h(this,"shConstructors",{});h(this,"attachedShader",null);h(this,"effectConstructors",{});h(this,"renderer");this.registerShaderType("DefaultShader",na),this.registerShaderType("DefaultShaderBatched",aa),this.registerShaderType("RoundedRectangle",Yo),this.registerShaderType("DynamicShader",Zs),this.registerShaderType("SdfShader",Ko),this.registerEffectType("border",di),this.registerEffectType("borderBottom",Xs),this.registerEffectType("borderLeft",Gs),this.registerEffectType("borderRight",Ws),this.registerEffectType("borderTop",Vs),this.registerEffectType("fadeOut",lo),this.registerEffectType("linearGradient",jo),this.registerEffectType("radialGradient",Qo),this.registerEffectType("grayscale",qo),this.registerEffectType("glitch",pi),this.registerEffectType("radius",zs),this.registerEffectType("radialProgress",Hs),this.registerEffectType("holePunch",Ys)}registerShaderType(t,e){this.shConstructors[t]=e}registerEffectType(t,e){this.effectConstructors[t]=e}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(t,e){if(!this.renderer)throw new Error("Renderer is not been defined");const s=this.shConstructors[t];if(!s)throw new Error(`Shader type "${t}" is not registered`);if(this.renderer.mode==="canvas"&&s.prototype instanceof ks)return this._createShaderCtr(t,new vo(t),e);if(t==="DynamicShader")return this.loadDynamicShader(e);const r=s.resolveDefaults(e),a=s.makeCacheKey(r)||s.name;if(a&&this.shCache.has(a))return this._createShaderCtr(t,this.shCache.get(a),r);const l=new s(this.renderer,e);return a&&this.shCache.set(a,l),this._createShaderCtr(t,l,r)}loadDynamicShader(t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=Zs.resolveDefaults(t,this.effectConstructors),s=Zs.makeCacheKey(e,this.effectConstructors);if(s&&this.shCache.has(s))return this._createDynShaderCtr(this.shCache.get(s),e);const r=new Zs(this.renderer,t,this.effectConstructors);return s&&this.shCache.set(s,r),this._createDynShaderCtr(r,e)}_createShaderCtr(t,e,s){return new wf(t,e,s,this.renderer.stage)}_createDynShaderCtr(t,e){return t.bindUniformMethods(e),new Sf(t,e,this)}useShader(t){this.attachedShader!==t&&(this.attachedShader&&this.attachedShader.detach(),t.attach(),this.attachedShader=t)}}const vf={x:(i,t)=>{i.props.x=t},y:(i,t)=>{i.props.y=t},width:(i,t)=>{i.props.width=t},height:(i,t)=>{i.props.height=t},color:(i,t)=>{i.props.color=t},zIndex:(i,t)=>{i.props.zIndex=t},fontFamily:(i,t)=>{i.props.fontFamily=t},fontWeight:(i,t)=>{i.props.fontWeight=t},fontStyle:(i,t)=>{i.props.fontStyle=t},fontStretch:(i,t)=>{i.props.fontStretch=t},fontSize:(i,t)=>{i.props.fontSize=t},text:(i,t)=>{i.props.text=t},textAlign:(i,t)=>{i.props.textAlign=t},contain:(i,t)=>{i.props.contain=t},offsetY:(i,t)=>{i.props.offsetY=t},scrollable:(i,t)=>{i.props.scrollable=t},scrollY:(i,t)=>{i.props.scrollY=t},letterSpacing:(i,t)=>{i.props.letterSpacing=t},lineHeight:(i,t)=>{i.props.lineHeight=t},maxLines:(i,t)=>{i.props.maxLines=t},textBaseline:(i,t)=>{i.props.textBaseline=t},verticalAlign:(i,t)=>{i.props.verticalAlign=t},overflowSuffix:(i,t)=>{i.props.overflowSuffix=t},debug:(i,t)=>{i.props.debug=t}};class fn{constructor(t){h(this,"stage");h(this,"set");this.stage=t;const e={...vf,...this.getPropertySetters()},s={};Object.keys(e).forEach(r=>{Object.defineProperty(s,r,{value:(a,l)=>{a.props[r]!==l&&(e[r](a,l),this.stage.requestRender())},writable:!1,configurable:!1})}),this.set=s}setStatus(t,e,s){t.status!==e&&(t.status=e,t.emitter.emit(e,s))}setIsRenderable(t,e){t.isRenderable=e}destroyState(t){this.setStatus(t,"destroyed"),t.emitter.removeAllListeners()}scheduleUpdateState(t){t.updateScheduled||(t.updateScheduled=!0,queueMicrotask(()=>{t.status!=="destroyed"&&(t.updateScheduled=!1,this.updateState(t))}))}}class Rf{constructor(){h(this,"data",{})}reset(){this.data={}}increment(t){this.data[t]||(this.data[t]=0),this.data[t]++}getData(){return{...this.data}}}class _f{constructor(t,e){h(this,"stage");h(this,"memUsed",0);h(this,"loadedTextures",new Map);h(this,"orphanedTextures",[]);h(this,"criticalThreshold");h(this,"targetThreshold");h(this,"cleanupInterval");h(this,"debugLogging");h(this,"lastCleanupTime",0);h(this,"baselineMemoryAllocation");h(this,"criticalCleanupRequested",!1);h(this,"doNotExceedCriticalThreshold");h(this,"frameTime",0);this.stage=t;const{criticalThreshold:s,doNotExceedCriticalThreshold:r}=e;this.doNotExceedCriticalThreshold=r||!1,this.criticalThreshold=Math.round(s);const a=Math.max(0,Math.min(1,e.targetThresholdLevel));if(this.cleanupInterval=e.cleanupInterval,this.debugLogging=e.debugLogging,this.baselineMemoryAllocation=Math.round(e.baselineMemoryAllocation),this.targetThreshold=Math.max(Math.round(s*a),this.baselineMemoryAllocation),this.memUsed=Math.round(e.baselineMemoryAllocation),e.debugLogging){let l=0;setInterval(()=>{l!==this.memUsed&&(l=this.memUsed,console.log(`[TextureMemoryManager] Memory used: ${wn(this.memUsed)} mb / ${wn(this.criticalThreshold)} mb (${(this.memUsed/this.criticalThreshold*100).toFixed(1)}%)`))},1e3)}s===0&&(this.setTextureMemUse=()=>{})}addToOrphanedTextures(t){this.orphanedTextures.includes(t)&&this.removeFromOrphanedTextures(t),t.preventCleanup===!1&&this.orphanedTextures.push(t)}removeFromOrphanedTextures(t){const e=this.orphanedTextures.indexOf(t);e!==-1&&this.orphanedTextures.splice(e,1)}setTextureMemUse(t,e){if(this.loadedTextures.has(t)&&(this.memUsed-=this.loadedTextures.get(t)),e===0){this.loadedTextures.delete(t);return}else this.memUsed+=e,this.loadedTextures.set(t,e);this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}checkCriticalCleanup(){return this.memUsed>this.criticalThreshold}cleanupQuick(t){const e=this.targetThreshold,s=this.stage.txManager,r=Ms();for(;this.memUsed>=e&&this.orphanedTextures.length>0&&(t||Ms()-r<10);){const a=this.orphanedTextures.shift();a!==void 0&&a.renderable!==!0&&(a.free(),s.removeTextureFromCache(a))}}cleanupDeep(t){const e=t?this.criticalThreshold:this.targetThreshold,s=this.stage.txManager,r=[],a=[...this.loadedTextures.keys()];for(let l=0;l<a.length;l++){const u=a[l];u!==void 0&&(u.type===Q.image||u.type===Q.noise||u.type===Q.renderToTexture)&&(u.renderable===!0?r.push(u):r.unshift(u))}for(;this.memUsed>=e&&r.length>0;){const l=r.shift();if(l!==void 0&&l.preventCleanup!==!0){if(l.renderable===!0)break;l.free(),this.removeFromOrphanedTextures(l),s.removeTextureFromCache(l),s.removeTextureFromQueue(l)}}}cleanup(t=!1){const e=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,e===!0&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.debugLogging===!0&&console.log(`[TextureMemoryManager] Cleaning up textures. Critical: ${e}. Aggressive: ${t}`),this.cleanupQuick(e),t===!0&&this.memUsed>=this.criticalThreshold&&this.cleanupDeep(e),this.memUsed>=this.criticalThreshold?(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),(this.debugLogging===!0||ni()===!1)&&console.warn(`[TextureMemoryManager] Memory usage above critical threshold after cleanup: ${this.memUsed}`)):this.criticalCleanupRequested=!1}getMemoryInfo(){let t=0;const e=[...this.loadedTextures.keys()].reduce((s,r)=>(t+=r.renderable?1:0,s+(r.renderable?this.loadedTextures.get(r):0)),this.baselineMemoryAllocation);return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:e,memUsed:this.memUsed,renderableTexturesLoaded:t,loadedTextures:this.loadedTextures.size,baselineMemoryAllocation:this.baselineMemoryAllocation}}}class ua{constructor(t,e){h(this,"textureSource");h(this,"memManager");h(this,"state","freed");this.memManager=t,this.textureSource=e}setTextureMemUse(t){this.memManager.setTextureMemUse(this.textureSource,t)}get renderable(){return this.textureSource.renderable}}class ca{constructor(t){h(this,"options");h(this,"mode");h(this,"stage");h(this,"txManager");h(this,"txMemManager");h(this,"shManager");h(this,"rttNodes",[]);this.options=t,this.stage=t.stage,this.txManager=t.txManager,this.txMemManager=t.txMemManager,this.shManager=t.shManager}}class Ef extends Go{constructor(e,s,r){super(e,s);h(this,"textRenderer");h(this,"trState");h(this,"_textRendererOverride",null);h(this,"onTextLoaded",()=>{const{contain:e}=this,s=this.trState.props.width,r=this.trState.props.height,a=this.trState.textW||0,l=this.trState.textH||0;e==="both"?(this.props.width=s,this.props.height=r):e==="width"?(this.props.width=s,this.props.height=l):e==="none"&&(this.props.width=a,this.props.height=l),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});h(this,"onTextFailed",(e,s)=>{this.emit("failed",{type:"text",error:s})});this._textRendererOverride=s.textRendererOverride,this.textRenderer=r;const a=this.createState({x:this.absX,y:this.absY,width:s.width,height:s.height,textAlign:s.textAlign,color:s.color,zIndex:s.zIndex,contain:s.contain,scrollable:s.scrollable,scrollY:s.scrollY,offsetY:s.offsetY,letterSpacing:s.letterSpacing,debug:s.debug,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStretch:s.fontStretch,fontStyle:s.fontStyle,fontWeight:s.fontWeight,text:s.text,lineHeight:s.lineHeight,maxLines:s.maxLines,textBaseline:s.textBaseline,verticalAlign:s.verticalAlign,overflowSuffix:s.overflowSuffix});this.trState=a}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),this.contain==="none"&&this.setUpdateType(R.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),this.contain!=="both"&&this.setUpdateType(R.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);const s=this.stage.resolveTextRenderer(this.trState.props,this._textRendererOverride);if(!s){console.warn("Text Renderer not found for font",this.trState.props.fontFamily);return}this.textRenderer=s,this.trState=this.createState(this.trState.props)}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,s){super.update(e,s),O(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkBasicRenderability(){return this.worldAlpha===0||this.isOutOfBounds()===!0?!1:!!(this.trState&&this.trState.props.text!=="")}setRenderable(e){super.setRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){var s;if(O(this.globalTransform),!this.textRenderer.renderQuads){super.renderQuads(e);return}this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode)||(this.parentHasRenderTexture&&((s=this.props.parent)!=null&&s.rtt)&&(this.globalTransform=te.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),O(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions))}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}createState(e){const s=this.textRenderer.createState(e,this);return s.emitter.on("loaded",this.onTextLoaded),s.emitter.on("failed",this.onTextFailed),this.textRenderer.scheduleUpdateState(s),s}}function Af(i){const t={boolean:!0,string:!0,number:!0,undefined:!0},e=Object.keys(i);for(let s=0;s<e.length;s++){const r=e[s];if(!r)continue;const a=i[r],l=typeof a;l==="string"&&a.length>2048&&(console.warn(`Custom Data value for ${r} is too long, it will be truncated to 2048 characters`),i[r]=a.substring(0,2048)),t[l]||(console.warn(`Custom Data value for ${r} is not a boolean, string, or number, it will be ignored`),delete i[r])}return i}const Mf=2e6;class kf{constructor(t){h(this,"options");h(this,"animationManager");h(this,"txManager");h(this,"txMemManager");h(this,"fontManager");h(this,"textRenderers");h(this,"shManager");h(this,"renderer");h(this,"root");h(this,"boundsMargin");h(this,"defShaderCtr");h(this,"strictBound");h(this,"preloadBound");h(this,"strictBounds");h(this,"defaultTexture",null);h(this,"eventBus");h(this,"deltaTime",0);h(this,"lastFrameTime",0);h(this,"currentFrameTime",0);h(this,"fpsNumFrames",0);h(this,"fpsElapsedTime",0);h(this,"numQuadsRendered",0);h(this,"renderRequested",!1);h(this,"frameEventQueue",[]);h(this,"fontResolveMap",{});h(this,"contextSpy",null);this.options=t;const{canvas:e,clearColor:s,appWidth:r,appHeight:a,boundsMargin:l,enableContextSpy:u,forceWebGL2:o,numImageWorkers:n,textureMemory:c,renderEngine:f,fontEngines:d,createImageBitmapSupport:p}=t;this.eventBus=t.eventBus,this.txManager=new cf(this,{numImageWorkers:n,createImageBitmapSupport:p}),this.txManager.on("initialized",()=>{this.requestRender()}),this.txMemManager=new _f(this,c),this.shManager=new Cf,this.animationManager=new sf,this.contextSpy=u?new Rf:null,this.strictBounds=t.strictBounds;let m=[0,0,0,0];l&&(m=Array.isArray(l)?l:[l,l,l,l]),this.boundsMargin=m,this.strictBound=qs(0,0,r,a),this.preloadBound=Xo(this.strictBound,m);const y={stage:this,canvas:e,pixelRatio:t.devicePhysicalPixelRatio*t.deviceLogicalPixelRatio,clearColor:s??4278190080,bufferMemory:Mf,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy,forceWebGL2:o};this.renderer=new f(y);const b=this.renderer.mode||"webgl";this.createDefaultTexture(),this.defShaderCtr=this.renderer.getDefShaderCtr(),Dl(b),this.txManager.renderer=this.renderer,this.textRenderers={},d.forEach(S=>{const _=new S(this),x=_.type;if(x==="sdf"&&b==="canvas"){console.warn("SdfTextRenderer is not compatible with Canvas renderer. Skipping...");return}_ instanceof fn&&(x==="canvas"?this.textRenderers.canvas=_:x==="sdf"&&(this.textRenderers.sdf=_))}),Object.keys(this.textRenderers).length===0&&console.warn("No text renderers available. Your text will not render."),this.fontManager=new pf(this.textRenderers);const w=new Go(this,{x:0,y:0,width:r,height:a,alpha:1,autosize:!1,boundsMargin:null,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1,preventCleanup:!1,strictBounds:this.strictBounds});this.root=w,tf(this)}setClearColor(t){this.renderer.updateClearColor(t),this.renderRequested=!0}updateFrameTime(){const t=Ms();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=t,this.deltaTime=this.lastFrameTime?t-this.lastFrameTime:100/6,this.txManager.frameTime=t,this.txMemManager.frameTime=t,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}createDefaultTexture(){console.log("Creating default texture"),this.defaultTexture=this.txManager.createTexture("ColorTexture",{color:4294967295}),O(this.defaultTexture instanceof yo),this.txManager.loadTexture(this.defaultTexture,!0),this.defaultTexture.setRenderableOwner(this,!0),this.defaultTexture.once("loaded",()=>{this.requestRender()})}updateAnimations(){const{animationManager:t}=this;this.root&&t.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested||this.txManager.hasUpdates()}drawFrame(){const{renderer:t,renderRequested:e}=this;O(t),this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),this.txManager.processSome(this.options.textureProcessingTimeLimit),t.reset(),this.txMemManager.criticalCleanupRequested===!0&&(this.txMemManager.cleanup(!1),this.txMemManager.criticalCleanupRequested===!0&&this.txMemManager.cleanup(!0)),t.rttNodes.length>0&&t.renderRTTNodes(),this.addQuads(this.root),t==null||t.render(),this.calculateFps(),this.calculateQuads(),e&&(this.renderRequested=!1)}queueFrameEvent(t,e){this.frameEventQueue.push([t,e])}flushFrameEvents(){for(const[t,e]of this.frameEventQueue)this.eventBus.emit(t,e);this.frameEventQueue=[]}calculateFps(){var e,s;const{fpsUpdateInterval:t}=this.options;if(t&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=t)){const r=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:r,contextSpyData:((e=this.contextSpy)==null?void 0:e.getData())??null}),(s=this.contextSpy)==null||s.reset()}}calculateQuads(){const t=this.renderer.getQuadCount();t&&t!==this.numQuadsRendered&&(this.numQuadsRendered=t,this.queueFrameEvent("quadsUpdate",{quads:t}))}addQuads(t){O(this.renderer),t.isRenderable===!0&&t.renderQuads(this.renderer);for(let e=0;e<t.children.length;e++){const s=t.children[e];s!==void 0&&(s.worldAlpha===0||s.strictBounds===!0&&s.renderState===oe.OutOfBounds||this.addQuads(s))}}requestRender(){this.renderRequested=!0}resolveTextRenderer(t,e=null){const s=`${t.fontFamily}${t.fontStyle}${t.fontWeight}${t.fontStretch}${e||""}`;if(this.fontResolveMap[s]!==void 0)return this.fontResolveMap[s];let r=e,a=!1;if(r){const u=this.textRenderers[r];u?u.canRenderFont(t)||(console.warn(`Cannot use override text renderer '${r}' for font`,t),r=null,a=!0):(console.warn(`Text renderer override '${r}' not found.`),r=null,a=!0)}if(!r){for(const[u,o]of Object.entries(this.textRenderers))if(o.canRenderFont(t)){r=u;break}!r&&this.textRenderers.canvas!==void 0&&(r="canvas")}if(a&&console.warn(`Falling back to text renderer ${String(r)}`),!r)return null;const l=this.textRenderers[r];return O(l,"resolvedTextRenderer undefined"),this.fontResolveMap[s]=l,l}createShaderCtr(t,e){return this.shManager.loadShader(t,e)}createNode(t){const e=this.resolveNodeDefaults(t);return new Go(this,e)}createTextNode(t){const e=t.fontSize??16,s={...this.resolveNodeDefaults(t),text:t.text??"",textRendererOverride:t.textRendererOverride??null,fontSize:e,fontFamily:t.fontFamily??"sans-serif",fontStyle:t.fontStyle??"normal",fontWeight:t.fontWeight??"normal",fontStretch:t.fontStretch??"normal",textAlign:t.textAlign??"left",contain:t.contain??"none",scrollable:t.scrollable??!1,scrollY:t.scrollY??0,offsetY:t.offsetY??0,letterSpacing:t.letterSpacing??0,lineHeight:t.lineHeight,maxLines:t.maxLines??0,textBaseline:t.textBaseline??"alphabetic",verticalAlign:t.verticalAlign??"middle",overflowSuffix:t.overflowSuffix??"...",debug:t.debug??{},shaderProps:null},r=this.resolveTextRenderer(s,t.textRendererOverride);if(!r)throw new Error(`No compatible text renderer found for ${s.fontFamily}`);return new Ef(this,s,r)}setBoundsMargin(t){this.boundsMargin=Array.isArray(t)?t:[t,t,t,t],this.root.setUpdateType(R.RenderBounds)}resolveNodeDefaults(t){const e=t.color??4294967295,s=t.colorTl??t.colorTop??t.colorLeft??e,r=t.colorTr??t.colorTop??t.colorRight??e,a=t.colorBl??t.colorBottom??t.colorLeft??e,l=t.colorBr??t.colorBottom??t.colorRight??e;let u={};return this.options.inspector===!0&&(u=Af(t.data??{})),{x:t.x??0,y:t.y??0,width:t.width??0,height:t.height??0,alpha:t.alpha??1,autosize:t.autosize??!1,boundsMargin:t.boundsMargin??null,clipping:t.clipping??!1,color:e,colorTop:t.colorTop??e,colorBottom:t.colorBottom??e,colorLeft:t.colorLeft??e,colorRight:t.colorRight??e,colorBl:a,colorBr:l,colorTl:s,colorTr:r,zIndex:t.zIndex??0,zIndexLocked:t.zIndexLocked??0,parent:t.parent??null,texture:t.texture??null,textureOptions:t.textureOptions??{},shader:t.shader??this.defShaderCtr,src:t.src??null,srcHeight:t.srcHeight,srcWidth:t.srcWidth,srcX:t.srcX,srcY:t.srcY,scale:t.scale??null,scaleX:t.scaleX??t.scale??1,scaleY:t.scaleY??t.scale??1,mount:t.mount??0,mountX:t.mountX??t.mount??0,mountY:t.mountY??t.mount??0,pivot:t.pivot??.5,pivotX:t.pivotX??t.pivot??.5,pivotY:t.pivotY??t.pivot??.5,rotation:t.rotation??0,rtt:t.rtt??!1,data:u,preventCleanup:t.preventCleanup??!1,imageType:t.imageType,strictBounds:t.strictBounds??this.strictBounds}}cleanup(t){this.txMemManager.cleanup(t)}}class If extends it{constructor(e,s){var y,b,w,S,_,x;super();h(this,"root");h(this,"canvas");h(this,"settings");h(this,"stage");h(this,"inspector",null);const r={criticalThreshold:((y=e.textureMemory)==null?void 0:y.criticalThreshold)||124e6,targetThresholdLevel:((b=e.textureMemory)==null?void 0:b.targetThresholdLevel)||.5,cleanupInterval:((w=e.textureMemory)==null?void 0:w.cleanupInterval)||5e3,debugLogging:((S=e.textureMemory)==null?void 0:S.debugLogging)||!1,baselineMemoryAllocation:((_=e.textureMemory)==null?void 0:_.baselineMemoryAllocation)||26e6,doNotExceedCriticalThreshold:((x=e.textureMemory)==null?void 0:x.doNotExceedCriticalThreshold)||!1},a={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,textureMemory:r,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:e.clearColor??0,fpsUpdateInterval:e.fpsUpdateInterval||0,numImageWorkers:e.numImageWorkers!==void 0?e.numImageWorkers:2,enableContextSpy:e.enableContextSpy??!1,forceWebGL2:e.forceWebGL2??!1,inspector:e.inspector??!1,renderEngine:e.renderEngine,quadBufferSize:e.quadBufferSize??4*1024*1024,fontEngines:e.fontEngines,strictBounds:e.strictBounds??!0,textureProcessingTimeLimit:e.textureProcessingTimeLimit||10,canvas:e.canvas||document.createElement("canvas"),createImageBitmapSupport:e.createImageBitmapSupport||"full"};this.settings=a;const{appWidth:l,appHeight:u,deviceLogicalPixelRatio:o,devicePhysicalPixelRatio:n,inspector:c,canvas:f}=a,d=l*o,p=u*o;this.canvas=f,f.width=d*n,f.height=p*n,f.style.width=`${d}px`,f.style.height=`${p}px`,this.stage=new kf({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,forceWebGL2:this.settings.forceWebGL2,fpsUpdateInterval:this.settings.fpsUpdateInterval,numImageWorkers:this.settings.numImageWorkers,renderEngine:this.settings.renderEngine,textureMemory:r,eventBus:this,quadBufferSize:this.settings.quadBufferSize,fontEngines:this.settings.fontEngines,inspector:this.settings.inspector!==null,strictBounds:this.settings.strictBounds,textureProcessingTimeLimit:this.settings.textureProcessingTimeLimit,createImageBitmapSupport:this.settings.createImageBitmapSupport}),this.root=this.stage.root;let m;if(typeof s=="string"?m=document.getElementById(s):m=s,!m)throw new Error("Could not find target element");m.appendChild(f),c&&!ni()&&(this.inspector=new c(f,a))}createNode(e){const s=this.stage.createNode(e);return this.inspector?this.inspector.createNode(s):s}createTextNode(e){const s=this.stage.createTextNode(e);return this.inspector?this.inspector.createTextNode(s):s}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e.id),e.destroy()}createTexture(e,s){return this.stage.txManager.createTexture(e,s)}createShader(e,s){return this.stage.shManager.loadShader(e,s)}createDynamicShader(e){return this.stage.shManager.loadDynamicShader({effects:e})}createEffect(e,s,r){return{name:r,type:e,props:s}}getNodeById(e){var a;const s=(a=this.stage)==null?void 0:a.root;if(!s)return null;const r=l=>{if(l.id===e)return l;for(const u of l.children){const o=r(u);if(o)return o}return null};return r(s)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){this.stage.requestRender()}cleanup(e=!1){this.stage.cleanup(e)}setClearColor(e){this.stage.setClearColor(e)}}class ha extends it{constructor(e){super();h(this,"fontFamily");h(this,"descriptors");h(this,"loaded",!1);h(this,"metrics",null);const{fontFamily:s,descriptors:r,metrics:a}=e;a&&(this.metrics={ascender:a.ascender/a.unitsPerEm,descender:a.descender/a.unitsPerEm,lineGap:a.lineGap/a.unitsPerEm}),this.fontFamily=s,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...r}}static convertToCssFontFaceDescriptors(e){return{style:e.style,weight:typeof e.weight=="number"?`${e.weight}`:e.weight,stretch:e.stretch,unicodeRange:e.unicodeRange,featureSettings:e.featureSettings,display:e.display}}}class fo extends ha{constructor(e){super(e);h(this,"fontFace");h(this,"fontUrl");const{fontFamily:s,fontUrl:r}=e,a=r.replace(/\(|\)/g,""),l=this.descriptors;let u={style:l.style,weight:typeof l.weight=="number"?`${l.weight}`:l.weight,stretch:l.stretch,unicodeRange:l.unicodeRange,featureSettings:l.featureSettings,display:l.display};for(const n in u){const c=n;u[c]===void 0&&delete u[c]}const o=new FontFace(s,`url(${a})`,u);a.length>0?o.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error):(this.loaded=!0,this.emit("loaded")),this.fontFace=o,this.fontUrl=r}}class Lf{}class da extends Lf{constructor(e,s,r,a,l,u,o,n,c,f,d,p,m){super();h(this,"glw");h(this,"options");h(this,"buffers");h(this,"shader");h(this,"shaderProps");h(this,"alpha");h(this,"clippingRect");h(this,"dimensions");h(this,"bufferIdx");h(this,"zIndex");h(this,"renderToTexture");h(this,"parentHasRenderTexture");h(this,"framebufferDimensions");h(this,"length",0);h(this,"numQuads",0);h(this,"textures",[]);h(this,"maxTextures");this.glw=e,this.options=s,this.buffers=r,this.shader=a,this.shaderProps=l,this.alpha=u,this.clippingRect=o,this.dimensions=n,this.bufferIdx=c,this.zIndex=f,this.renderToTexture=d,this.parentHasRenderTexture=p,this.framebufferDimensions=m,this.maxTextures=a.supportsIndexedTextures?e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(e){const{textures:s,maxTextures:r}=this;let a=-1;const l=s.length;for(let u=0;u<l;u++)if(s[u]===e){a=u;break}return a!==-1?a:l>=r?4294967295:(this.textures.push(e),l)}draw(){const{glw:e,shader:s,shaderProps:r,options:a}=this,{shManager:l}=a;l.useShader(s),s.bindRenderOp(this,r);const u=this.bufferIdx/24*6*2;if(this.clippingRect.valid){const{x:o,y:n,width:c,height:f}=this.clippingRect,d=this.parentHasRenderTexture?1:a.pixelRatio,p=a.canvas.height,m=Math.round(o*d),y=Math.round(c*d),b=Math.round(f*d);let w=Math.round(p-b-n*d);this.parentHasRenderTexture&&(w=this.framebufferDimensions?this.framebufferDimensions.height-this.dimensions.height:0),e.setScissorTest(!0),e.scissor(m,w,y,b)}else e.setScissorTest(!1);e.drawElements(e.TRIANGLES,6*this.numQuads,e.UNSIGNED_SHORT,u)}}function Pf(i){const t={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(t).forEach(s=>{t[s]=i.getParameter(i[s])}),t}function Bf(i){const t={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(t).forEach(s=>{t[s]=i.getExtension(s)}),t}function Ff(i,t){const e=~~(t/80),s=new Uint16Array(e*6);for(let a=0,l=0;a<e;a+=6,l+=4)s[a]=l,s[a+1]=l+1,s[a+2]=l+2,s[a+3]=l+2,s[a+4]=l+1,s[a+5]=l+3;const r=i.createBuffer();i.elementArrayBufferData(r,s,i.STATIC_DRAW)}function Of(i){return i!==null&&(typeof i=="object"&&i.constructor&&i.constructor.name==="HTMLImageElement"||typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement)}const Fo=new Uint8Array([0,0,0,0]);class To extends ua{constructor(e,s,r){super(s,r);h(this,"glw");h(this,"_nativeCtxTexture",null);h(this,"_w",0);h(this,"_h",0);this.glw=e}get ctxTexture(){return this.state==="freed"?(this.load(),null):(O(this._nativeCtxTexture),this._nativeCtxTexture)}get w(){return this._w}get h(){return this._h}load(){if(!(this.state==="loading"||this.state==="loaded")){if(this.state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this._nativeCtxTexture===null){this.state="failed",this.textureSource.setState("failed",new Error("Could not create WebGL Texture")),console.error("Could not create WebGL Texture");return}this.onLoadRequest().then(({width:e,height:s})=>{this.state!=="freed"&&(this.state="loaded",this._w=e,this._h=s,this.textureSource.setState("loaded",{width:e,height:s}),this.textureSource.freeTextureData())}).catch(e=>{this.state!=="freed"&&(this.state="failed",this.textureSource.setState("failed",e),this.textureSource.freeTextureData(),console.error(e))})}}async onLoadRequest(){const{glw:e}=this,s=this.textureSource.textureData;if(s===null||this._nativeCtxTexture===null)throw new Error("Texture data or native texture is null "+this.textureSource.type);e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(Fo.byteLength);let r=0,a=0;e.activeTexture(0);const l=s.data,u=e.RGBA,o=4,n=1.1;if(typeof ImageBitmap<"u"&&l instanceof ImageBitmap||l instanceof ImageData||Of(l))r=l.width,a=l.height,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!s.premultiplyAlpha),e.texImage2D(0,u,u,e.UNSIGNED_BYTE,l),this.setTextureMemUse(a*r*o*n);else if(l===null)r=0,a=0,e.bindTexture(this._nativeCtxTexture),e.texImage2D(0,u,1,1,0,u,e.UNSIGNED_BYTE,Fo),this.setTextureMemUse(Fo.byteLength);else if("mipmaps"in l&&l.mipmaps){const{mipmaps:c,width:f=0,height:d=0,type:p,glInternalFormat:m}=l,y=p==="ktx"?new DataView(c[0]??new ArrayBuffer(0)):c[0];e.bindTexture(this._nativeCtxTexture),e.compressedTexImage2D(0,m,f,d,0,y),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),this.setTextureMemUse(y.byteLength)}else l&&l instanceof Uint8Array?(r=1,a=1,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!s.premultiplyAlpha),e.texImage2D(0,u,r,a,0,u,e.UNSIGNED_BYTE,l),this.setTextureMemUse(r*a*o)):console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",s);return{width:r,height:a}}free(){this.state!=="freed"&&(this.state="freed",this.textureSource.setState("freed"),this._w=0,this._h=0,this._nativeCtxTexture!==null&&(this.glw.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null),this.textureSource.freeTextureData())}createNativeCtxTexture(){const{glw:e}=this,s=e.createTexture();return s?(e.activeTexture(0),e.bindTexture(s),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),s):null}}class Uf extends To{constructor(t,e,s){super(t,e,s)}async onLoadRequest(){var e,s;const t=this.textureSource.textureData;return O(t,"SubTexture must have texture data"),t.data instanceof Uint8Array?{width:1,height:1}:{width:((e=t.data)==null?void 0:e.width)||0,height:((s=t.data)==null?void 0:s.height)||0}}}class pa{constructor(t){h(this,"config");this.config=t}getBuffer(t){var e;return(e=this.config.find(s=>s.attributes[t]))==null?void 0:e.buffer}getAttributeInfo(t){var e;return(e=this.config.find(s=>s.attributes[t]))==null?void 0:e.attributes[t]}}function $f(i){return self.WebGL2RenderingContext&&i instanceof self.WebGL2RenderingContext}class Df{constructor(t){h(this,"gl");h(this,"activeTextureUnit",0);h(this,"texture2dUnits");h(this,"texture2dParams",new WeakMap);h(this,"scissorEnabled");h(this,"scissorX");h(this,"scissorY");h(this,"scissorWidth");h(this,"scissorHeight");h(this,"blendEnabled");h(this,"blendSrcRgb");h(this,"blendDstRgb");h(this,"blendSrcAlpha");h(this,"blendDstAlpha");h(this,"boundArrayBuffer");h(this,"boundElementArrayBuffer");h(this,"curProgram");h(this,"canvas");h(this,"MAX_RENDERBUFFER_SIZE");h(this,"MAX_TEXTURE_SIZE");h(this,"MAX_VIEWPORT_DIMS");h(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");h(this,"MAX_TEXTURE_IMAGE_UNITS");h(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");h(this,"MAX_VERTEX_ATTRIBS");h(this,"MAX_VARYING_VECTORS");h(this,"MAX_VERTEX_UNIFORM_VECTORS");h(this,"MAX_FRAGMENT_UNIFORM_VECTORS");h(this,"TEXTURE_MAG_FILTER");h(this,"TEXTURE_MIN_FILTER");h(this,"TEXTURE_WRAP_S");h(this,"TEXTURE_WRAP_T");h(this,"LINEAR");h(this,"CLAMP_TO_EDGE");h(this,"RGB");h(this,"RGBA");h(this,"UNSIGNED_BYTE");h(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");h(this,"UNPACK_FLIP_Y_WEBGL");h(this,"FLOAT");h(this,"TRIANGLES");h(this,"UNSIGNED_SHORT");h(this,"ONE");h(this,"ONE_MINUS_SRC_ALPHA");h(this,"VERTEX_SHADER");h(this,"FRAGMENT_SHADER");h(this,"STATIC_DRAW");h(this,"COMPILE_STATUS");h(this,"LINK_STATUS");h(this,"DYNAMIC_DRAW");h(this,"COLOR_ATTACHMENT0");h(this,"INVALID_ENUM");h(this,"INVALID_OPERATION");this.gl=t,this.activeTextureUnit=t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0;const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(e).fill(void 0).map((r,a)=>(this.activeTexture(a),t.getParameter(t.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=t.isEnabled(t.SCISSOR_TEST);const s=t.getParameter(t.SCISSOR_BOX);this.scissorX=s[0],this.scissorY=s[1],this.scissorWidth=s[2],this.scissorHeight=s[3],this.blendEnabled=t.isEnabled(t.BLEND),this.blendSrcRgb=t.getParameter(t.BLEND_SRC_RGB),this.blendDstRgb=t.getParameter(t.BLEND_DST_RGB),this.blendSrcAlpha=t.getParameter(t.BLEND_SRC_ALPHA),this.blendDstAlpha=t.getParameter(t.BLEND_DST_ALPHA),this.boundArrayBuffer=t.getParameter(t.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=t.getParameter(t.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=t.getParameter(t.CURRENT_PROGRAM),this.canvas=t.canvas,this.MAX_RENDERBUFFER_SIZE=t.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=t.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=t.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=t.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=t.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=t.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=t.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=t.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=t.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=t.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=t.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=t.TEXTURE_WRAP_T,this.LINEAR=t.LINEAR,this.CLAMP_TO_EDGE=t.CLAMP_TO_EDGE,this.RGB=t.RGB,this.RGBA=t.RGBA,this.UNSIGNED_BYTE=t.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=t.UNPACK_FLIP_Y_WEBGL,this.FLOAT=t.FLOAT,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.ONE=t.ONE,this.ONE_MINUS_SRC_ALPHA=t.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.VERTEX_SHADER=t.VERTEX_SHADER,this.FRAGMENT_SHADER=t.FRAGMENT_SHADER,this.STATIC_DRAW=t.STATIC_DRAW,this.COMPILE_STATUS=t.COMPILE_STATUS,this.LINK_STATUS=t.LINK_STATUS,this.DYNAMIC_DRAW=t.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=t.COLOR_ATTACHMENT0,this.INVALID_ENUM=t.INVALID_ENUM,this.INVALID_OPERATION=t.INVALID_OPERATION}isWebGl2(){return $f(this.gl)}activeTexture(t){const{gl:e}=this;this.activeTextureUnit!==t&&(e.activeTexture(t+e.TEXTURE0),this.activeTextureUnit=t)}bindTexture(t){const{gl:e,activeTextureUnit:s,texture2dUnits:r}=this;r[s]!==t&&(r[s]=t,e.bindTexture(this.gl.TEXTURE_2D,t))}_getActiveTexture(){const{activeTextureUnit:t,texture2dUnits:e}=this;return e[t]}texParameteri(t,e){const{gl:s,texture2dParams:r}=this,a=this._getActiveTexture();if(!a)throw new Error("No active texture");let l=r.get(a);l||(l={},r.set(a,l)),l[t]!==e&&(l[t]=e,s.texParameteri(s.TEXTURE_2D,t,e))}texImage2D(t,e,s,r,a,l,u,o){const{gl:n}=this;l?n.texImage2D(n.TEXTURE_2D,t,e,s,r,a,l,u,o):n.texImage2D(n.TEXTURE_2D,t,e,s,r,a)}compressedTexImage2D(t,e,s,r,a,l){const{gl:u}=this;u.compressedTexImage2D(u.TEXTURE_2D,t,e,s,r,a,l)}pixelStorei(t,e){const{gl:s}=this;s.pixelStorei(t,e)}generateMipmap(){const{gl:t}=this;t.generateMipmap(t.TEXTURE_2D)}createTexture(){const{gl:t}=this;return t.createTexture()}deleteTexture(t){const{gl:e}=this;t&&this.texture2dParams.delete(t),e.deleteTexture(t)}deleteFramebuffer(t){this.gl.deleteFramebuffer(t)}viewport(t,e,s,r){const{gl:a}=this;a.viewport(t,e,s,r)}clearColor(t,e,s,r){const{gl:a}=this;a.clearColor(t,e,s,r)}setScissorTest(t){const{gl:e,scissorEnabled:s}=this;t!==s&&(t?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),this.scissorEnabled=t)}scissor(t,e,s,r){const{gl:a,scissorX:l,scissorY:u,scissorWidth:o,scissorHeight:n}=this;(t!==l||e!==u||s!==o||r!==n)&&(a.scissor(t,e,s,r),this.scissorX=t,this.scissorY=e,this.scissorWidth=s,this.scissorHeight=r)}setBlend(t){const{gl:e,blendEnabled:s}=this;t!==s&&(t?e.enable(e.BLEND):e.disable(e.BLEND),this.blendEnabled=t)}blendFunc(t,e){const{gl:s,blendSrcRgb:r,blendDstRgb:a,blendSrcAlpha:l,blendDstAlpha:u}=this;(t!==r||e!==a||t!==l||e!==u)&&(s.blendFunc(t,e),this.blendSrcRgb=t,this.blendDstRgb=e,this.blendSrcAlpha=t,this.blendDstAlpha=e)}createBuffer(){const{gl:t}=this;return t.createBuffer()}createFramebuffer(){const{gl:t}=this;return t.createFramebuffer()}bindFramebuffer(t){const{gl:e}=this;e.bindFramebuffer(e.FRAMEBUFFER,t)}framebufferTexture2D(t,e,s){const{gl:r}=this;r.framebufferTexture2D(r.FRAMEBUFFER,t,r.TEXTURE_2D,e,s)}clear(){const{gl:t}=this;t.clear(t.COLOR_BUFFER_BIT)}arrayBufferData(t,e,s){const{gl:r,boundArrayBuffer:a}=this;a!==t&&(r.bindBuffer(r.ARRAY_BUFFER,t),this.boundArrayBuffer=t),r.bufferData(r.ARRAY_BUFFER,e,s)}elementArrayBufferData(t,e,s){const{gl:r,boundElementArrayBuffer:a}=this;a!==t&&(r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.boundElementArrayBuffer=t),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,s)}vertexAttribPointer(t,e,s,r,a,l,u){const{gl:o,boundArrayBuffer:n}=this;n!==t&&(o.bindBuffer(o.ARRAY_BUFFER,t),this.boundArrayBuffer=t),o.vertexAttribPointer(e,s,r,a,l,u)}useProgram(t){const{gl:e,curProgram:s}=this;s!==t&&(e.useProgram(t),this.curProgram=t)}uniform1f(t,e){const{gl:s}=this;s.uniform1f(t,e)}uniform1fv(t,e){const{gl:s}=this;s.uniform1fv(t,e)}uniform1i(t,e){const{gl:s}=this;s.uniform1i(t,e)}uniform1iv(t,e){const{gl:s}=this;s.uniform1iv(t,e)}uniform2f(t,e,s){const{gl:r}=this;r.uniform2f(t,e,s)}uniform2fv(t,e){const{gl:s}=this;s.uniform2fv(t,e)}uniform2i(t,e,s){const{gl:r}=this;r.uniform2i(t,e,s)}uniform2iv(t,e){const{gl:s}=this;s.uniform2iv(t,e)}uniform3f(t,e,s,r){const{gl:a}=this;a.uniform3f(t,e,s,r)}uniform3fv(t,e){const{gl:s}=this;s.uniform3fv(t,e)}uniform3i(t,e,s,r){const{gl:a}=this;a.uniform3i(t,e,s,r)}uniform3iv(t,e){const{gl:s}=this;s.uniform3iv(t,e)}uniform4f(t,e,s,r,a){const{gl:l}=this;l.uniform4f(t,e,s,r,a)}uniform4fv(t,e){const{gl:s}=this;s.uniform4fv(t,e)}uniform4i(t,e,s,r,a){const{gl:l}=this;l.uniform4i(t,e,s,r,a)}uniform4iv(t,e){const{gl:s}=this;s.uniform4iv(t,e)}uniformMatrix2fv(t,e){const{gl:s}=this;s.uniformMatrix2fv(t,!1,e)}uniformMatrix3fv(t,e){const{gl:s}=this;s.uniformMatrix3fv(t,!1,e)}uniformMatrix4fv(t,e){const{gl:s}=this;s.uniformMatrix4fv(t,!1,e)}getParameter(t){const{gl:e}=this;return e.getParameter(t)}drawElements(t,e,s,r){const{gl:a}=this;a.drawElements(t,e,s,r)}getExtension(t){const{gl:e}=this;return e.getExtension(t)}getError(){const{gl:t}=this;return t.getError()}createVertexArray(){const{gl:t}=this;return O(t instanceof WebGL2RenderingContext),t.createVertexArray()}bindVertexArray(t){const{gl:e}=this;O(e instanceof WebGL2RenderingContext),e.bindVertexArray(t)}getAttribLocation(t,e){const{gl:s}=this;return s.getAttribLocation(t,e)}getUniformLocation(t,e){const{gl:s}=this;return s.getUniformLocation(t,e)}enableVertexAttribArray(t){const{gl:e}=this;e.enableVertexAttribArray(t)}disableVertexAttribArray(t){const{gl:e}=this;e.disableVertexAttribArray(t)}createShader(t){const{gl:e}=this;return e.createShader(t)}compileShader(t){const{gl:e}=this;e.compileShader(t)}attachShader(t,e){const{gl:s}=this;s.attachShader(t,e)}linkProgram(t){const{gl:e}=this;e.linkProgram(t)}deleteProgram(t){const{gl:e}=this;e.deleteProgram(t)}getShaderParameter(t,e){const{gl:s}=this;return s.getShaderParameter(t,e)}getShaderInfoLog(t){const{gl:e}=this;return e.getShaderInfoLog(t)}createProgram(){const{gl:t}=this;return t.createProgram()}getProgramParameter(t,e){const{gl:s}=this;return s.getProgramParameter(t,e)}getProgramInfoLog(t){const{gl:e}=this;return e.getProgramInfoLog(t)}shaderSource(t,e){const{gl:s}=this;s.shaderSource(t,e)}deleteShader(t){const{gl:e}=this;e.deleteShader(t)}}class _n extends To{constructor(e,s,r){super(e,s,r);h(this,"framebuffer",null)}async onLoadRequest(){const{glw:e}=this,s=this._nativeCtxTexture=this.createNativeCtxTexture(),{width:r,height:a}=this.textureSource;return this.framebuffer=e.createFramebuffer(),e.texImage2D(0,e.RGBA,r,a,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(r*a*4),e.bindFramebuffer(this.framebuffer),e.framebufferTexture2D(e.COLOR_ATTACHMENT0,s,0),e.bindFramebuffer(null),{width:r,height:a}}free(){super.free(),this.glw.deleteFramebuffer(this.framebuffer),this.framebuffer=null}}const Nf=24;class un extends ca{constructor(e){super(e);h(this,"glw");h(this,"system");h(this,"quadBuffer");h(this,"fQuadBuffer");h(this,"uiQuadBuffer");h(this,"renderOps",[]);h(this,"curBufferIdx",0);h(this,"curRenderOp",null);h(this,"rttNodes",[]);h(this,"activeRttNode",null);h(this,"defShaderCtrl");h(this,"defaultShader");h(this,"quadBufferCollection");h(this,"clearColor",{raw:0,normalized:[0,0,0,0]});h(this,"quadBufferUsage",0);h(this,"numQuadsRendered",0);h(this,"renderToTextureActive",!1);this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";const{canvas:s,clearColor:r,bufferMemory:a}=e,l=Ul(s,e.forceWebGL2,e.contextSpy),u=this.glw=new Df(l);u.viewport(0,0,s.width,s.height),this.updateClearColor(r),u.setBlend(!0),u.blendFunc(u.ONE,u.ONE_MINUS_SRC_ALPHA),Ff(u,a),this.system={parameters:Pf(this.glw),extensions:Bf(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const o=u.createBuffer();O(o);const n=6*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new pa([{buffer:o,attributes:{a_position:{name:"a_position",size:2,type:u.FLOAT,normalized:!1,stride:n,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:u.FLOAT,normalized:!1,stride:n,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:u.UNSIGNED_BYTE,normalized:!0,stride:n,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:u.FLOAT,normalized:!1,stride:n,offset:5*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:e}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,e.setScissorTest(!1),e.clear()}getShaderManager(){return this.shManager}createCtxTexture(e){return e instanceof Ci?new Uf(this.glw,this.txMemManager,e):e instanceof xo?new _n(this.glw,this.txMemManager,e):new To(this.glw,this.txMemManager,e)}addQuad(e){const{fQuadBuffer:s,uiQuadBuffer:r}=this;let a=e.texture;if(O(a!==null,"Texture is required"),e.shaderProps!==null){if(go(e.shaderProps,"$dimensions")==!0){const w=e.shaderProps.$dimensions;w.width=e.width,w.height=e.height}go(e.shaderProps,"$alpha")===!0&&(e.shaderProps.$alpha=e.alpha)}let{curBufferIdx:l,curRenderOp:u}=this;const o={width:-1,height:-1};o.width=e.width,o.height=e.height;const n=e.shader||this.defaultShader;O(n.getUniformLocation!==void 0,"Invalid WebGL shader"),this.reuseRenderOp(e)===!1&&(this.newRenderOp(n,e.shaderProps,e.alpha,o,e.clippingRect,l,e.rtt,e.parentHasRenderTexture,e.framebufferDimensions),u=this.curRenderOp,O(u));let c=0,f=0,d=1,p=1;if(a.type===Q.subTexture){const{x:w,y:S,width:_,height:x}=a.props,{width:$=0,height:M=0}=a.parentTexture.dimensions||{width:0,height:0};c=w/$,d=c+_/$,f=S/M,p=f+x/M,a=a.parentTexture}if(a.type===Q.image&&e.textureOptions!==null&&e.textureOptions.resizeMode!==void 0&&a.dimensions!==null){const w=e.textureOptions.resizeMode,{width:S,height:_}=a.dimensions;if(w.type==="cover"){const x=e.width/S,$=e.height/_,M=Math.max(x,$),P=1/M;if(M&&x&&x<M){const L=P*e.width;c=(1-L/S)*(w.clipX??.5),d=c+L/S}if(M&&$&&$<M){const L=P*e.height;f=(1-L/_)*(w.clipY??.5),p=f+L/_}}}let m=0;e.textureOptions!==null&&(e.textureOptions.flipX===!0&&([c,d]=[d,c]),m=+(e.textureOptions.flipY||!1)),m^+(a.type===Q.renderToTexture)&&([f,p]=[p,f]);const y=a.ctxTexture;O(y instanceof To);const b=this.addTexture(y,l);if(O(this.curRenderOp!==null),e.renderCoords)s[l++]=e.renderCoords.x1,s[l++]=e.renderCoords.y1,s[l++]=c,s[l++]=f,r[l++]=e.colorTl,s[l++]=b,s[l++]=e.renderCoords.x2,s[l++]=e.renderCoords.y2,s[l++]=d,s[l++]=f,r[l++]=e.colorTr,s[l++]=b,s[l++]=e.renderCoords.x4,s[l++]=e.renderCoords.y4,s[l++]=c,s[l++]=p,r[l++]=e.colorBl,s[l++]=b,s[l++]=e.renderCoords.x3,s[l++]=e.renderCoords.y3,s[l++]=d,s[l++]=p,r[l++]=e.colorBr,s[l++]=b;else if(e.tb!==0||e.tc!==0)s[l++]=e.tx,s[l++]=e.ty,s[l++]=c,s[l++]=f,r[l++]=e.colorTl,s[l++]=b,s[l++]=e.tx+e.width*e.ta,s[l++]=e.ty+e.width*e.tc,s[l++]=d,s[l++]=f,r[l++]=e.colorTr,s[l++]=b,s[l++]=e.tx+e.height*e.tb,s[l++]=e.ty+e.height*e.td,s[l++]=c,s[l++]=p,r[l++]=e.colorBl,s[l++]=b,s[l++]=e.tx+e.width*e.ta+e.height*e.tb,s[l++]=e.ty+e.width*e.tc+e.height*e.td,s[l++]=d,s[l++]=p,r[l++]=e.colorBr,s[l++]=b;else{const w=e.tx+e.width*e.ta,S=e.ty+e.height*e.td;s[l++]=e.tx,s[l++]=e.ty,s[l++]=c,s[l++]=f,r[l++]=e.colorTl,s[l++]=b,s[l++]=w,s[l++]=e.ty,s[l++]=d,s[l++]=f,r[l++]=e.colorTr,s[l++]=b,s[l++]=e.tx,s[l++]=S,s[l++]=c,s[l++]=p,r[l++]=e.colorBl,s[l++]=b,s[l++]=w,s[l++]=S,s[l++]=d,s[l++]=p,r[l++]=e.colorBr,s[l++]=b}this.curRenderOp.length+=Nf,this.curRenderOp.numQuads++,this.curBufferIdx=l}newRenderOp(e,s,r,a,l,u,o,n,c){const f=new da(this.glw,this.options,this.quadBufferCollection,e,s,r,l,a,u,0,o,n,c);this.curRenderOp=f,this.renderOps.push(f)}addTexture(e,s,r){const{curRenderOp:a}=this;O(a);const l=a.addTexture(e);if(l===4294967295){if(r)throw new Error("Unable to add texture to render op");return this.newRenderOp(a.shader,a.shaderProps,a.alpha,a.dimensions,a.clippingRect,s),this.addTexture(e,s,!0)}return l}reuseRenderOp(e){var n;const{shader:s,shaderProps:r,parentHasRenderTexture:a,rtt:l,clippingRect:u}=e,o=s||this.defaultShader;return!(((n=this.curRenderOp)==null?void 0:n.shader)!==o||Xl(this.curRenderOp.clippingRect,u)===!1||a!==void 0||l!==void 0||this.curRenderOp.shader!==this.defaultShader&&(r===null||this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,r)===!1))}addRenderOp(e){this.renderOps.push(e),this.curRenderOp=null}render(e="screen"){const{glw:s,quadBuffer:r}=this,a=new Float32Array(r,0,this.curBufferIdx),l=this.quadBufferCollection.getBuffer("a_position")||null;s.arrayBufferData(l,a,s.STATIC_DRAW);for(let o=0,n=this.renderOps.length;o<n;o++)this.renderOps[o].draw();this.quadBufferUsage=this.curBufferIdx*a.BYTES_PER_ELEMENT;const u=4*(6*a.BYTES_PER_ELEMENT);this.numQuadsRendered=this.quadBufferUsage/u}getQuadCount(){return this.numQuadsRendered}renderToTexture(e){for(let s=0;s<this.rttNodes.length;s++)if(this.rttNodes[s]===e)return;this.insertRTTNodeInOrder(e)}insertRTTNodeInOrder(e){let s=this.rttNodes.length,r=e;for(;r&&r.parent;){const l=this.rttNodes.indexOf(r.parent);if(l!==-1){s=l;break}r=r.parent}const a=this.findMaxChildRTTIndex(e);a!==-1&&(s=Math.max(s,a+1)),this.rttNodes.splice(s,0,e)}findMaxChildRTTIndex(e){let s=-1;const r=a=>{const l=this.rttNodes.indexOf(a);l!==-1&&(s=Math.max(s,l));for(const u of a.children)r(u)};return r(e),s}renderRTTNodes(){const{glw:e}=this,{txManager:s}=this.stage;for(let a=0;a<this.rttNodes.length;a++){const l=this.rttNodes[a];if(l===void 0||l.hasRTTupdates===!1||l.worldAlpha===0||l.strictBounds===!0&&l.renderState===oe.OutOfBounds||l.texture===null||l.texture.state!=="loaded")continue;this.activeRttNode=l,O(l.texture,"RTT node missing texture");const u=l.texture.ctxTexture;O(u instanceof _n),this.renderToTextureActive=!0,e.bindFramebuffer(u.framebuffer),e.viewport(0,0,u.w,u.h),e.clearColor(0,0,0,0),e.clear();for(let o=0;o<l.children.length;o++){const n=l.children[o];n!==void 0&&(this.stage.addQuads(n),n.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,l.hasRTTupdates=!1}const r=this.clearColor.normalized;e.clearColor(r[0],r[1],r[2],r[3]),e.bindFramebuffer(null),e.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(e){const s=this.rttNodes.indexOf(e);s!==-1&&this.rttNodes.splice(s,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}updateClearColor(e){if(this.clearColor.raw===e)return;const s=this.glw,r=Ei(e);s.clearColor(r[0],r[1],r[2],r[3]),this.clearColor={raw:e,normalized:r},s.clear()}}const zf={LINE_FEED:10};class Wf{}class Vf extends Wf{constructor(e,s){super();h(this,"data");h(this,"glyphMap");h(this,"kernings");this.data=e,this.glyphMap=s;const r=this.kernings={};e.kernings.forEach(a=>{const l=a.second,u=r[l]=r[l]||{};u[a.first]=a.amount}),this.kernings=r}*shapeText(e,s){var l;let r,a;for(;(r=s.peek())&&!r.done;){const u=r.value,o=this.glyphMap.get(u);if(s.next(),o!==void 0){const n=a!==void 0?(((l=this.kernings[o.id])==null?void 0:l[a])||0)+e.letterSpacing:0;a=o.id,yield{mapped:!0,glyphId:o.id,codepoint:u,cluster:s.lastIndex,xAdvance:o.xadvance+n,yAdvance:0,xOffset:o.xoffset+n,yOffset:o.yoffset,xBearing:0,yBearing:0,width:o.width,height:o.height}}else u===zf.LINE_FEED&&(a=void 0),yield{mapped:!1,codepoint:u,cluster:s.lastIndex}}}}class Zo extends ha{constructor(e,s){super(s);h(this,"type");h(this,"texture");h(this,"maxCharHeight",0);h(this,"shaper");h(this,"glyphMap",new Map);h(this,"data");const{atlasUrl:r,atlasDataUrl:a,stage:l}=s;this.type=e;const u=l.renderer;O(u instanceof un,"SDF Font Faces can only be used with the WebGL Renderer"),this.texture=l.txManager.createTexture("ImageTexture",{src:r,premultiplyAlpha:!1}),l.txManager.loadTexture(this.texture,!0),this.texture.preventCleanup=!0,this.texture.on("loaded",()=>{this.checkLoaded(),l.requestRender()}),ra(a).then(o=>{var c;this.data=JSON.parse(o),O(this.data);let n=0;if(this.data.chars.forEach(f=>{this.glyphMap.set(f.id,f);const d=f.yoffset+f.height;d>n&&(n=d)}),this.maxCharHeight=n,this.shaper=new Vf(this.data,this.glyphMap),!this.metrics)if((c=this.data)!=null&&c.lightningMetrics){const{ascender:f,descender:d,lineGap:p,unitsPerEm:m}=this.data.lightningMetrics;this.metrics={ascender:f/m,descender:d/m,lineGap:p/m}}else throw new Error(`Font metrics not found in ${this.type} font ${this.fontFamily}. Make sure you are using the latest version of the Lightning 3 \`msdf-generator\` tool to generate your SDF fonts.`);this.checkLoaded()}).catch(console.error)}getAtlasEntry(e){const s=this.glyphMap.get(e);if(s===void 0)throw new Error(`Glyph ${e} not found in font ${this.fontFamily}`);return{x:s.x,y:s.y,width:s.width,height:s.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}const Xf=24;function Gf(i,t,e,s,r,a,l,u,o){const n=Math.min(Math.max(l.firstLineIdx,0),u.length),c=0,{metrics:f}=e;O(f,"Font metrics not loaded"),O(e.data,"Font data not loaded");const d=(f.ascender-f.descender)*i;let p=0;s==="middle"?p=(t-d)/2:s==="bottom"&&(p=t-d);const m=r/a,y=e.data.common.base,w=f.ascender*i-y,S=m+w+n*t+p;if(!(o&&S>=o/a))return{sdfX:c,sdfY:S,lineIndex:n}}class mi{constructor(t,e=0){h(this,"iterator");h(this,"peekBuffer",[]);h(this,"_lastIndex");this.iterator=t,this.iterator=t,this._lastIndex=e-1,this.peekBuffer=[]}next(){const t=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return t.done?this._lastIndex=-1:this._lastIndex++,t}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const t=this.iterator.next();return this.peekBuffer.push(t),t}get lastIndex(){return this._lastIndex}}function*gi(i,t=0){let e=t;for(;e<i.length;){const s=i.codePointAt(e);if(s===void 0)throw new Error("Invalid Unicode code point");yield s,e+=s<=65535?1:2}}function Hf(i,t,e){const s=e.shapeText(t,new mi(gi(i,0),0));let r=0;for(const a of s)a.mapped&&a.codepoint!==8203&&(r+=a.xAdvance);return r}function Yf(i,t,e,s,r,a,l,u,o,n,c,f,d,p,m,y,b,w,S){O(m,"Font face must be loaded"),O(m.loaded,"Font face must be loaded"),O(m.data,"Font face must be loaded"),O(m.shaper,"Font face must be loaded");const _=u/m.data.info.size,x=o/_,$=a/_,M=n/_,P=d[i],L=(P==null?void 0:P.codepointIndex)||0,U=(P==null?void 0:P.maxX)||0,k=(P==null?void 0:P.maxY)||0;let F=U,B=k,E=t,C=e,I=0;const v={codepointIndex:-1,bufferOffset:-1,xStart:-1},A=m.shaper,D={letterSpacing:M};s.endsWith(" ")&&(s+=" ");let z=A.shapeText(D,new mi(gi(s,L),L)),X,G=-1;const W=[],j=l/_,Y=Hf(w,D,A);let ae=!0;for(;ae;){const K=(S===0||i+1<S)&&(f!=="both"||b||C+x+m.maxCharHeight<=j),J=K?$:$-Y;let Z=0;const se=C+m.maxCharHeight>=p.y1,le=C<=p.y2,ee=se&&le;for(;(X=z.next())&&!X.done;){const H=X.value;if(i===d.length)d.push({codepointIndex:H.cluster,maxY:B,maxX:F});else if(i>d.length)throw new Error("Unexpected lineCache length");if(H.codepoint===32||H.codepoint===10||H.codepoint===8203?v.codepointIndex!==-1&&(v.codepointIndex=-1,Z=E):v.codepointIndex===-1&&(v.codepointIndex=H.cluster,v.bufferOffset=I,v.xStart=Z),H.mapped){const Ue=E+H.xOffset+H.width;if(f!=="none"&&Ue>=J&&v.codepointIndex!==-1&&v.xStart>0)if(K){z=A.shapeText(D,new mi(gi(s,v.codepointIndex),v.codepointIndex)),I=v.bufferOffset;break}else z=A.shapeText(D,new mi(gi(w,0),0)),E=v.xStart,I=v.bufferOffset,f="none";else{const ie=E+H.xOffset,fe=C+H.yOffset;if(ee){G===-1&&(G=I);const we=m.getAtlasEntry(H.glyphId),re=we.x/m.data.common.scaleW,Se=we.y/m.data.common.scaleH,be=we.width/m.data.common.scaleW,ve=we.height/m.data.common.scaleH;c[I++]=ie,c[I++]=fe,c[I++]=re,c[I++]=Se,c[I++]=ie+H.width,c[I++]=fe,c[I++]=re+be,c[I++]=Se,c[I++]=ie,c[I++]=fe+H.height,c[I++]=re,c[I++]=Se+ve,c[I++]=ie+H.width,c[I++]=fe+H.height,c[I++]=re+be,c[I++]=Se+ve}B=Math.max(B,fe+H.height),F=Math.max(F,ie+H.width),E+=H.xAdvance}}else if(H.codepoint===10){if(K)break;z=A.shapeText(D,new mi(gi(w,0),0)),f="none"}}G!==-1&&(W.push({bufferStart:G,bufferEnd:I}),G=-1),E=0,C+=x,i++,v.codepointIndex=-1,Z=0,!y&&f==="both"&&C>p.y2||X&&X.done?ae=!1:K||(ae=!1)}if(r==="center"){const K=f==="none"?F:$;for(let J=0;J<W.length;J++){const Z=W[J],se=c[Z.bufferEnd-4]-c[Z.bufferStart],le=(K-se)/2;for(let ee=Z.bufferStart;ee<Z.bufferEnd;ee+=4)c[ee]+=le}}else if(r==="right"){const K=f==="none"?F:$;for(let J=0;J<W.length;J++){const Z=W[J],se=Z.bufferEnd===Z.bufferStart?0:c[Z.bufferEnd-4]-c[Z.bufferStart],le=K-se;for(let ee=Z.bufferStart;ee<Z.bufferEnd;ee+=4)c[ee]+=le}}return O(X),{bufferNumFloats:I,bufferNumQuads:I/16,layoutNumCharacters:X.done?s.length-L:X.value.cluster-L+1,fullyProcessed:!!X.done,maxX:F,maxY:B,numLines:d.length}}function Kf(i,t){return Math.ceil(i/t)*t}function jf(i,t){return Math.floor(i/t)*t}function qf(i,t,e,s,r,a,l,u){const{screen:o,sdf:n}=i;if(!Hl(l))o.x1=0,o.y1=0,o.x2=0,o.y2=0,n.x1=0,n.y1=0,n.x2=0,n.y2=0,i.numLines=0,i.firstLineIdx=0;else{const c=l.x1-t,f=c+(l.x2-l.x1),d=l.y1-e+s,p=jf(d-a,r||1),m=Kf(d+(l.y2-l.y1)+a,r||1);o.x1=c,o.y1=p,o.x2=f,o.y2=m,n.x1=c/u,n.y1=p/u,n.x2=f/u,n.y2=m/u,i.numLines=Math.ceil((m-p)/r),i.firstLineIdx=r?Math.floor(p/r):0}i.valid=!0}function ma(i,t){return t*(i.ascender-i.descender+i.lineGap)}const Qf={x:0,y:0,width:0,height:0};class Zf extends fn{constructor(e){super(e);h(this,"ssdfFontFamilies",{});h(this,"msdfFontFamilies",{});h(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);h(this,"sdfShader");h(this,"rendererBounds");h(this,"type","sdf");this.sdfShader=this.stage.shManager.loadShader("SdfShader",{transform:new Float32Array,color:0,size:0,scrollY:0,distanceRange:0,debug:!1}).shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,s)=>{e.props.fontFamily=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,s)=>{e.props.fontWeight=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,s)=>{e.props.fontStyle=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,s)=>{e.props.fontStretch=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,s)=>{e.props.fontSize=s,this.invalidateLayoutCache(e)},text:(e,s)=>{e.props.text=s,this.invalidateLayoutCache(e)},textAlign:(e,s)=>{e.props.textAlign=s,this.invalidateLayoutCache(e)},color:(e,s)=>{e.props.color=s},x:(e,s)=>{e.props.x=s,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&Io(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,s)=>{e.props.y=s,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&Io(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,s)=>{e.props.contain=s,this.invalidateLayoutCache(e)},width:(e,s)=>{e.props.width=s,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,s)=>{e.props.height=s,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,s)=>{e.props.offsetY=s,this.invalidateLayoutCache(e)},scrollable:(e,s)=>{e.props.scrollable=s,this.invalidateLayoutCache(e)},scrollY:(e,s)=>{e.props.scrollY=s,this.scheduleUpdateState(e)},letterSpacing:(e,s)=>{e.props.letterSpacing=s,this.invalidateLayoutCache(e)},lineHeight:(e,s)=>{e.props.lineHeight=s,e.resLineHeight=void 0,this.invalidateLayoutCache(e)},maxLines:(e,s)=>{e.props.maxLines=s,this.invalidateLayoutCache(e)},textBaseline:(e,s)=>{e.props.textBaseline=s,this.invalidateLayoutCache(e)},verticalAlign:(e,s)=>{e.props.verticalAlign=s,this.invalidateLayoutCache(e)},overflowSuffix:(e,s)=>{e.props.overflowSuffix=s,this.invalidateLayoutCache(e)},debug:(e,s)=>{e.props.debug=s}}}canRenderFont(e){const{fontFamily:s}=e;return s in this.ssdfFontFamilies||s in this.msdfFontFamilies||s==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(e){return e instanceof Zo}addFontFace(e){O(e instanceof Zo);const s=e.fontFamily,r=e.type==="ssdf"?this.ssdfFontFamilies:e.type==="msdf"?this.msdfFontFamilies:void 0;if(!r){console.warn(`Invalid font face type: ${e.type}`);return}let a=r[s];a||(a=new Set,r[s]=a),a.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new it,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:s}=e;const{textH:r,lineCache:a,debugData:l,forceFullLayoutCalc:u}=e;if(l.updateCount++,e.status==="initialState"&&this.setStatus(e,"loading"),s===void 0){if(s=this.resolveFontFace(e.props),e.trFontFace=s,s===void 0){const A=`SdfTextRenderer: Could not resolve font face for family: '${e.props.fontFamily}'`;console.error(A),this.setStatus(e,"failed",new Error(A));return}s.texture.setRenderableOwner(e,!0)}if(s.loaded===!1){s.once("loaded",()=>{this.scheduleUpdateState(e)});return}O(s.data,"Font face data should be loaded"),O(s.metrics,"Font face metrics should be loaded");const{text:o,fontSize:n,x:c,y:f,contain:d,width:p,height:m,verticalAlign:y,scrollable:b,overflowSuffix:w,maxLines:S}=e.props,_=d==="both"&&b?e.props.scrollY:0,{renderWindow:x}=e,$=s.data.info.size,M=n/$;let P=e.resLineHeight;if(P===void 0){const A=e.props.lineHeight;A===void 0?P=ma(s.metrics,n):P=A,e.resLineHeight=P}const L=P/M;e.distanceRange=M*s.data.distanceField.distanceRange;const U=o.length*Xf;let k=e.vertexBuffer;(!k||k.length<U)&&(k=new Float32Array(U*2));const F=e.elementBounds;if(F.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),F.valid=!0),!u&&x.valid){const A=x.screen;if(c+A.x1<=F.x1&&c+A.x2>=F.x2&&f-_+A.y1<=F.y1&&f-_+A.y2>=F.y2){this.setStatus(e,"loaded");return}x.valid=!1,this.setStatus(e,"loading")}const{offsetY:B,textAlign:E}=e.props;if(!x.valid){if(!Io(F,this.rendererBounds))return;qf(x,c,f,_,P,d==="both"?F.y2-F.y1:0,F,M)}const C=Gf($,L,s,y,B,M,x,a,r);if(!C){this.setStatus(e,"loaded");return}const{letterSpacing:I}=e.props,v=Yf(C.lineIndex,C.sdfX,C.sdfY,o,E,p,m,n,P,I,k,d,a,x.sdf,s,u,b,w,S);e.bufferUploaded=!1,e.bufferNumFloats=v.bufferNumFloats,e.bufferNumQuads=v.bufferNumQuads,e.vertexBuffer=k,e.renderWindow=x,l.lastLayoutNumCharacters=v.layoutNumCharacters,l.bufferSize=k.byteLength,v.fullyProcessed&&(e.textW=v.maxX*M,e.textH=v.numLines*L*M),this.setStatus(e,"loaded")}renderQuads(e,s,r,a,l,u){var F,B;if(!e.vertexBuffer)return;const o=this.stage.renderer;O(o instanceof un);const{fontSize:n,color:c,contain:f,scrollable:d,zIndex:p,debug:m}=e.props,y=f==="both"&&d?e.props.scrollY:0,{textW:b=0,textH:w=0,distanceRange:S,vertexBuffer:_,bufferUploaded:x,trFontFace:$,elementBounds:M}=e;let{webGlBuffers:P}=e;if(!P){const E=o.glw,C=4*Float32Array.BYTES_PER_ELEMENT,I=E.createBuffer();O(I),e.webGlBuffers=new pa([{buffer:I,attributes:{a_position:{name:"a_position",size:2,type:E.FLOAT,normalized:!1,stride:C,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:E.FLOAT,normalized:!1,stride:C,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,O(e.webGlBuffers),P=e.webGlBuffers}if(!x){const E=o.glw,C=(P==null?void 0:P.getBuffer("a_textureCoordinate"))??null;E.arrayBufferData(C,_,E.STATIC_DRAW),e.bufferUploaded=!0}if(O($),d&&f==="both"){O(M.valid);const E=Vl(M,Qf);r.valid?(e.clippingRect.valid=!0,r=ta(r,E,e.clippingRect)):(e.clippingRect.valid=!0,r=sa(E,e.clippingRect))}const L=new da(o.glw,o.options,P,this.sdfShader,{transform:s.getFloatArr(),color:$l(c,a),size:n/(((F=$.data)==null?void 0:F.info.size)||0),scrollY:y,distanceRange:S,debug:m.sdfShaderDebug},a,r,{height:w,width:b},0,p,!1,l,u),U=(B=e.trFontFace)==null?void 0:B.texture;O(U);const k=U.ctxTexture;L.addTexture(k),L.length=e.bufferNumFloats,L.numQuads=e.bufferNumQuads,o.addRenderOp(L)}setIsRenderable(e,s){var r;super.setIsRenderable(e,s),(r=e.trFontFace)==null||r.texture.setRenderableOwner(e,s)}destroyState(e){var s;super.destroyState(e),(s=e.trFontFace)==null||s.texture.setRenderableOwner(e,!1)}resolveFontFace(e){return this.stage.fontManager.resolveFontFace(this.fontFamilyArray,e,"sdf")}releaseFontFace(e){e.resLineHeight=void 0,e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){const{x:s,contain:r,width:a}=e.props,{elementBounds:l}=e;l.x1=s,l.x2=r!=="none"?s+a:1/0}setElementBoundsY(e){const{y:s,contain:r,height:a}=e.props,{elementBounds:l}=e;l.y1=s,l.y2=r==="both"?s+a:1/0}}function En(i){return i===""||i==="​"}function Jf(i,t,e){if(t.metrics)return t.metrics;const s=i.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz");console.warn(`Font metrics not provided for Canvas Web font ${t.fontFamily}. Using fallback values. It is HIGHLY recommended you use the latest version of the Lightning 3 \`msdf-generator\` tool to extract the default metrics for the font and provide them in the Canvas Web font definition.`);let r;return s.actualBoundingBoxDescent&&s.actualBoundingBoxAscent?r={ascender:s.actualBoundingBoxAscent/e,descender:-s.actualBoundingBoxDescent/e,lineGap:.2}:r={ascender:.8,descender:-.2,lineGap:.2},t.metrics=r,r}const An=2048;function Mn(i,t,e,s,r){const a=i!=="bottom"?.5*t:0;return e*(s-1)+a+Math.max(e,t)+(r||0)}class eu{constructor(t,e){h(this,"_canvas");h(this,"_context");h(this,"_settings");this._canvas=t,this._context=e,this._settings=this.mergeDefaults({})}set settings(t){this._settings=this.mergeDefaults(t)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const t=[this._settings.fontFamily],e=[];for(let s=0,r=t.length;s<r;s++)t[s]==="serif"||t[s]==="sans-serif"?e.push(t[s]):e.push(`"${t[s]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${e.join(",")}`}_load(){if(document.fonts){const t=this._getFontSetting();try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch{console.warn("[Lightning] Can't check font loading for "+t)}}}calculateRenderInfo(){const t={},e=this.getPrecision(),s=this._settings.paddingLeft*e,r=this._settings.paddingRight*e,a=this._settings.fontSize*e;let l=this._settings.offsetY===null?null:this._settings.offsetY*e;const u=this._settings.w*e,o=this._settings.h*e;let n=this._settings.wordWrapWidth*e;const c=this._settings.cutSx*e,f=this._settings.cutEx*e,d=this._settings.cutSy*e,p=this._settings.cutEy*e,m=(this._settings.letterSpacing||0)*e,y=this._settings.textIndent*e,b=this._settings.trFontFace;this.setFontProperties(),O(b);const w=Jf(this._context,b,a),S=ma(w,a)*e,_=this._settings.lineHeight!==null?this._settings.lineHeight*e:S,x=this._settings.maxHeight,$=x!==null&&_>0?Math.floor(x/_):0,M=this._settings.maxLines,P=$>0&&M>0?Math.min($,M):Math.max($,M);let L=u||2048/this.getPrecision(),U=L-s;if(U<10&&(L+=10-U,U=10),n||(n=U),this._settings.textOverflow&&!this._settings.wordWrap){let I;switch(this._settings.textOverflow){case"clip":I="";break;case"ellipsis":I=this._settings.overflowSuffix;break;default:I=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,n-y,I)}let k;if(this._settings.wordWrap)k=this.wrapText(this._settings.text,n,m,y);else{k={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const I=k.l.length;for(let v=0;v<I-1;v++)k.n.push(v)}let F=k.l;if(P&&F.length>P){const I=F.slice(0,P);let v=null;if(this._settings.overflowSuffix){const G=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,W=this.wrapText(I[I.length-1],n-G,m,y);I[I.length-1]=`${W.l[0]}${this._settings.overflowSuffix}`,v=[W.l.length>1?W.l[1]:""]}else v=[""];let A;const D=F.length;let z=0;const X=k.n.length;for(A=P;A<D;A++)v[z]+=`${v[z]?" ":""}${F[A]}`,A+1<X&&k.n[A+1]&&z++;t.remainingText=v.join(`
`),t.moreTextLines=!0,F=I}else t.moreTextLines=!1,t.remainingText="";let B=0;const E=[];for(let I=0;I<F.length;I++){const v=this.measureText(F[I],m)+(I===0?y:0);E.push(v),B=Math.max(B,v)}t.lineWidths=E,u||(L=B+s+r,U=B),this._settings.wordWrap&&u>B&&this._settings.textAlign==="left"&&F.length===1&&(L=B+s+r);let C;return o?C=o:C=Mn(this._settings.textBaseline,a,_,F.length,l),l===null&&(l=a),t.w=L,t.h=C,t.lines=F,t.precision=e,L||(L=1),C||(C=1),(c||f)&&(L=Math.min(L,f-c)),(d||p)&&(C=Math.min(C,p-d)),t.width=L,t.innerWidth=U,t.height=C,t.fontSize=a,t.cutSx=c,t.cutSy=d,t.cutEx=f,t.cutEy=p,t.lineHeight=_,t.defLineHeight=S,t.lineWidths=E,t.offsetY=l,t.paddingLeft=s,t.paddingRight=r,t.letterSpacing=m,t.textIndent=y,t.metrics=w,t}draw(t,e){const s=this.getPrecision(),r=(e==null?void 0:e.lines)||t.lines,a=(e==null?void 0:e.lineWidths)||t.lineWidths,l=e?Mn(this._settings.textBaseline,t.fontSize,t.lineHeight,e.lines.length,this._settings.offsetY===null?null:this._settings.offsetY*s):t.height;this._canvas.width=Math.min(Math.ceil(t.width+this._settings.textRenderIssueMargin),An),this._canvas.height=Math.min(Math.ceil(l),An),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);let u,o;const n=[],{metrics:c}=t,f=c?c.ascender*t.fontSize:t.fontSize,d=(c.ascender-c.descender)*t.fontSize;for(let m=0,y=r.length;m<y;m++)u=m===0?t.textIndent:0,o=m*t.lineHeight+f,this._settings.verticalAlign=="middle"?o+=(t.lineHeight-d)/2:this._settings.verticalAlign=="bottom"&&(o+=t.lineHeight-d),this._settings.textAlign==="right"?u+=t.innerWidth-a[m]:this._settings.textAlign==="center"&&(u+=(t.innerWidth-a[m])/2),u+=t.paddingLeft,n.push({text:r[m],x:u,y:o,w:a[m]});if(this._settings.highlight){const m=this._settings.highlightColor,y=this._settings.highlightHeight*s||t.fontSize*1.5,b=this._settings.highlightOffset*s,w=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*s:t.paddingLeft,S=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*s:t.paddingRight;this._context.fillStyle=ko(m);for(let _=0;_<n.length;_++){const x=n[_];this._context.fillRect(x.x-w,x.y-t.offsetY+b,x.w+S+w,y)}}let p=null;this._settings.shadow&&(p=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=ko(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*s,this._context.shadowOffsetY=this._settings.shadowOffsetY*s,this._context.shadowBlur=this._settings.shadowBlur*s),this._context.fillStyle=ko(this._settings.textColor);for(let m=0,y=n.length;m<y;m++){const b=n[m];if(t.letterSpacing===0)this._context.fillText(b.text,b.x,b.y);else{const w=b.text.split("");let S=b.x;for(let _=0,x=w.length;_<x;_++)this._context.fillText(w[_],S,b.y),S+=this.measureText(w[_],t.letterSpacing)}}p&&(this._context.shadowColor=p[0],this._context.shadowOffsetX=p[1],this._context.shadowOffsetY=p[2],this._context.shadowBlur=p[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy)}wrapWord(t,e,s){const r=this._context.measureText(s).width,a=t.length,l=this._context.measureText(t).width;if(l<=e)return t;let u=Math.floor(e*a/l),o=this._context.measureText(t.substring(0,u)).width+r;if(o>e)for(;u>0&&(o=this._context.measureText(t.substring(0,u)).width+r,o>e);)u-=1;else for(;u<a;)if(o=this._context.measureText(t.substring(0,u)).width+r,o<e)u+=1;else{u-=1;break}return t.substring(0,u)+(e>=r?s:"")}wrapText(t,e,s,r=0){const a=/ |\u200B/g,l=t.split(/\r?\n/g);let u=[];const o=[];for(let n=0;n<l.length;n++){const c=[];let f="",d=e-r;const p=l[n].split(a),m=l[n].match(a)||[];for(let y=0;y<p.length;y++){const b=m[y-1]||"",w=p[y],S=this.measureText(w,s),_=En(b)?S:S+this.measureText(b,s);y===0||_>d?(y>0&&(c.push(f),f=""),f+=w,d=e-S-(y===0?r:0)):(d-=_,f+=b+w)}c.push(f),f="",u=u.concat(c),n<l.length-1&&o.push(u.length)}return{l:u,n:o}}measureText(t,e=0){return e?t.split("").reduce((s,r)=>En(r)?s:s+this._context.measureText(r).width+e,0):this._context.measureText(t).width}mergeDefaults(t){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFamily:null,trFontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxHeight:null,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...t}}}const kn=typeof self>"u"?globalThis:self;var Kn;const In=((Kn=kn.document)==null?void 0:Kn.fonts)||kn.fonts;function tu(i){const{fontFamily:t,fontStyle:e,fontWeight:s,fontStretch:r,fontSize:a}=i;return[e,s,r,`${a}px`,t].join(" ")}class Ln extends fn{constructor(e){super(e);h(this,"canvas");h(this,"context");h(this,"fontFamilies",{});h(this,"fontFamilyArray",[this.fontFamilies]);h(this,"type","canvas");h(this,"loadFont",e=>{const s=tu(e.props),r=this.stage.fontManager.resolveFontFace(this.fontFamilyArray,e.props,"canvas");if(O(r,`Could not resolve font face for ${s}`),e.fontInfo={fontFace:r,cssString:s,loaded:!1},!e.fontInfo.loaded){In.load(s).then(this.onFontLoaded.bind(this,e,s)).catch(this.onFontLoadError.bind(this,e,s));return}});typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let s=this.canvas.getContext("2d",{willReadFrequently:!0});s||(this.canvas=document.createElement("canvas"),s=this.canvas.getContext("2d",{willReadFrequently:!0})),O(s),this.context=s,this.addFontFace(new fo({fontFamily:"sans-serif",descriptors:{},fontUrl:""}))}getPropertySetters(){return{fontFamily:(e,s)=>{e.props.fontFamily=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,s)=>{e.props.fontWeight=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,s)=>{e.props.fontStyle=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,s)=>{e.props.fontStretch=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,s)=>{e.props.fontSize=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,s)=>{e.props.text=s,this.invalidateLayoutCache(e)},textAlign:(e,s)=>{e.props.textAlign=s,this.invalidateLayoutCache(e)},color:(e,s)=>{e.props.color=s,this.invalidateLayoutCache(e)},x:(e,s)=>{e.props.x=s},y:(e,s)=>{e.props.y=s},contain:(e,s)=>{e.props.contain=s,this.invalidateLayoutCache(e)},width:(e,s)=>{e.props.width=s,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,s)=>{e.props.height=s,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,s)=>{e.props.offsetY=s,this.invalidateLayoutCache(e)},scrollY:(e,s)=>{e.props.scrollY=s},letterSpacing:(e,s)=>{e.props.letterSpacing=s,this.invalidateLayoutCache(e)},lineHeight:(e,s)=>{e.props.lineHeight=s,this.invalidateLayoutCache(e)},maxLines:(e,s)=>{e.props.maxLines=s,this.invalidateLayoutCache(e)},textBaseline:(e,s)=>{e.props.textBaseline=s,this.invalidateLayoutCache(e)},verticalAlign:(e,s)=>{e.props.verticalAlign=s,this.invalidateLayoutCache(e)},overflowSuffix:(e,s)=>{e.props.overflowSuffix=s,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof fo}addFontFace(e){O(e instanceof fo);const s=e.fontFamily;s!=="sans-serif"&&In.add(e.fontFace);let r=this.fontFamilies[s];r||(r=new Set,this.fontFamilies[s]=r),r.add(e)}createState(e,s){return{node:s,props:e,status:"initialState",updateScheduled:!1,emitter:new it,textureNode:void 0,lightning2TextRenderer:new eu(this.canvas,this.context),renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if(e.status==="initialState"&&this.setStatus(e,"loading"),e.status!=="loaded"){if(!e.fontInfo)return this.loadFont(e);e.fontInfo.loaded&&(e.renderInfo||(e.renderInfo=this.calculateRenderInfo(e),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,this.renderSingleCanvasPage(e)))}}renderSingleCanvasPage(e){O(e.renderInfo);const s=e.node,r=this.stage.txManager.createTexture("ImageTexture",{premultiplyAlpha:!0,src:(function(a,l){return O(l),a.draw(l,{lines:l.lines,lineWidths:l.lineWidths}),this.canvas.width===0||this.canvas.height===0?null:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}).bind(this,e.lightning2TextRenderer,e.renderInfo)});if(e.textureNode)e.textureNode.texture=r,e.textureNode.alpha=bn(e.props.color);else{const a=this.stage.createNode({parent:s,texture:r,autosize:!0,alpha:bn(e.props.color)});e.textureNode=a}this.setStatus(e,"loaded")}calculateRenderInfo(e){var s;return e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFamily:e.props.fontFamily,trFontFace:(s=e.fontInfo)==null?void 0:s.fontFace,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:Ei(e.props.color),offsetY:e.props.offsetY,wordWrap:e.props.contain!=="none",wordWrapWidth:e.props.contain==="none"?void 0:e.props.width,letterSpacing:e.props.letterSpacing,lineHeight:e.props.lineHeight??null,maxLines:e.props.maxLines,maxHeight:e.props.contain==="both"?e.props.height-e.props.offsetY:null,textBaseline:e.props.textBaseline,verticalAlign:e.props.verticalAlign,overflowSuffix:e.props.overflowSuffix,w:e.props.contain!=="none"?e.props.width:void 0},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.renderInfo}renderQuads(){}destroyState(e){e.status!=="destroyed"&&(super.destroyState(e),e.textureNode&&(e.textureNode.destroy(),delete e.textureNode),delete e.renderInfo)}invalidateLayoutCache(e){e.renderInfo=void 0,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,s){var r;s!==((r=e.fontInfo)==null?void 0:r.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,s,r){var a;s!==((a=e.fontInfo)==null?void 0:a.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${e.fontInfo.cssString}'`,r),this.scheduleUpdateState(e))}}const ga={isWhite:!0,a:1,r:255,g:255,b:255};function Oo(i){if(i===4294967295)return ga;const t=(i>>>24&255)/255,e=i>>>16&255&255,s=i>>>8&255&255,r=i&255&255;return{isWhite:!1,a:t,r,g:s,b:e}}function ya(i){if(i===4294967295)return ga;const t=i>>>24&255,e=i>>>16&255&255,s=i>>>8&255&255,r=(i&255&255)/255;return{isWhite:!1,r:t,g:e,b:s,a:r}}function Js({a:i,r:t,g:e,b:s}){return`rgba(${t},${e},${s},${i})`}class su extends ua{constructor(){super(...arguments);h(this,"image");h(this,"tintCache")}load(){this.textureSource.setState("loading"),this.onLoadRequest().then(e=>{this.textureSource.setState("loaded",e),this.textureSource.freeTextureData(),this.updateMemSize()}).catch(e=>{this.textureSource.setState("failed",e),this.textureSource.freeTextureData()})}free(){this.image=void 0,this.tintCache=void 0,this.textureSource.setState("freed"),this.setTextureMemUse(0),this.textureSource.freeTextureData()}updateMemSize(){const e=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:s,height:r}=this.textureSource.dimensions;this.setTextureMemUse(s*r*e)}}hasImage(){return this.image!==void 0}getImage(e){var l;const s=this.image;if(O(s,"Attempt to get unloaded image texture"),e.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),s;const r=Js(e);if(((l=this.tintCache)==null?void 0:l.key)===r)return this.tintCache.image;const a=this.tintTexture(s,r);return this.tintCache={key:r,image:a},this.updateMemSize(),a}tintTexture(e,s){const{width:r,height:a}=e,l=document.createElement("canvas");l.width=r,l.height=a;const u=l.getContext("2d");return u&&(u.fillStyle=s,u.globalCompositeOperation="copy",u.fillRect(0,0,r,a),u.globalCompositeOperation="multiply",u.drawImage(e,0,0,r,a,0,0,r,a),u.globalCompositeOperation="destination-in",u.drawImage(e,0,0,r,a,0,0,r,a)),l}async onLoadRequest(){var s,r;O((r=(s=this.textureSource)==null?void 0:s.textureData)==null?void 0:r.data,"Texture data is null");const{data:e}=this.textureSource.textureData;if(e instanceof ImageData){const a=document.createElement("canvas");a.width=e.width,a.height=e.height;const l=a.getContext("2d");return l&&l.putImageData(e,0,0),this.image=a,{width:e.width,height:e.height}}else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap||e instanceof HTMLImageElement)return this.image=e,{width:e.width,height:e.height};return{width:0,height:0}}}function iu(i){var t,e;if(i.shader instanceof vo){const s=i.shader.shType;if(s===bf)return((t=i.shaderProps)==null?void 0:t.radius)??0;if(s==="DynamicShader"){const r=(e=i.shaderProps)==null?void 0:e.effects;if(r){const a=r.find(l=>{var u;return l.type==="radius"&&((u=l==null?void 0:l.props)==null?void 0:u.radius)});return a&&a.type==="radius"&&a.props.radius||0}}}return 0}function ui(i,t=""){var e;if(i.shader instanceof vo&&i.shader.shType==="DynamicShader"){const r=(e=i.shaderProps)==null?void 0:e.effects;if(r&&r.length){const a=r.find(l=>l.type===`border${t}`&&l.props&&l.props.width);return a&&a.props}}}function Pn(i,t,e,s,r){if(Object.getPrototypeOf(this).roundRect)this.roundRect(i,t,e,s,r);else{const l=o=>{const n=Math.min(e/2,s/2),c=o.topLeft+o.topRight+o.bottomRight+o.bottomLeft;if(c>e||c>s){const f=n/Math.max(o.topLeft,o.topRight,o.bottomRight,o.bottomLeft);o.topLeft*=f,o.topRight*=f,o.bottomRight*=f,o.bottomLeft*=f}},u=typeof r=="number"?{topLeft:r,topRight:r,bottomRight:r,bottomLeft:r}:{topLeft:0,topRight:0,bottomRight:0,bottomLeft:0,...r};l(u),this.moveTo(i+u.topLeft,t),this.lineTo(i+e-u.topRight,t),this.ellipse(i+e-u.topRight,t+u.topRight,u.topRight,u.topRight,0,1.5*Math.PI,2*Math.PI),this.lineTo(i+e,t+s-u.bottomRight),this.ellipse(i+e-u.bottomRight,t+s-u.bottomRight,u.bottomRight,u.bottomRight,0,0,.5*Math.PI),this.lineTo(i+u.bottomLeft,t+s),this.ellipse(i+u.bottomLeft,t+s-u.bottomLeft,u.bottomLeft,u.bottomLeft,0,.5*Math.PI,Math.PI),this.lineTo(i,t+u.topLeft),this.ellipse(i+u.topLeft,t+u.topLeft,u.topLeft,u.topLeft,0,Math.PI,1.5*Math.PI)}}function to(i,t,e,s,r,a=0,l,u){if(!a)return;let o,n=0,c,f=0;switch(u){case"Top":o=t,n=e,c=s+t,f=e;break;case"Right":o=t+s,n=e,c=t+s,f=e+r;break;case"Bottom":o=t,n=e+r,c=t+s,f=e+r;break;case"Left":o=t,n=e,c=t,f=e+r;break}i.beginPath(),i.lineWidth=a,i.strokeStyle=Js(ya(l??0)),i.moveTo(o,n),i.lineTo(c,f),i.stroke()}class ru extends ca{constructor(e){super(e);h(this,"context");h(this,"canvas");h(this,"pixelRatio");h(this,"clearColor");h(this,"renderToTextureActive",!1);h(this,"activeRttNode",null);h(this,"defShaderCtr");this.mode="canvas",this.shManager.renderer=this;const{canvas:s,pixelRatio:r,clearColor:a}=e;this.canvas=s,this.context=s.getContext("2d"),this.pixelRatio=r,this.clearColor=a?Tn(a):void 0,this.defShaderCtr={type:"DefaultShader",props:{},shader:new vo("DefaultShader"),getResolvedProps:()=>()=>({})}}reset(){this.canvas.width=this.canvas.width;const e=this.context;if(this.clearColor){const[s,r,a,l]=this.clearColor;e.fillStyle=`rgba(${s}, ${r}, ${a}, ${l/255})`,e.fillRect(0,0,this.canvas.width,this.canvas.height)}e.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(e){const s=this.context,{tx:r,ty:a,width:l,height:u,alpha:o,colorTl:n,colorTr:c,colorBr:f,ta:d,tb:p,tc:m,td:y,clippingRect:b}=e;let w=e.texture,S,_;const x=w==null?void 0:w.type;if(O(x,"Texture type is not defined"),x!==Q.image&&x!==Q.color&&x!==Q.subTexture&&x!==Q.noise||w&&(w instanceof Ci&&(_=w.props,w=w.parentTexture),S=w.ctxTexture,w.state==="freed"||w.state!=="loaded"))return;const $=Oo(n),M=d!==1,P=b.width!==0&&b.height!==0,L=n!==c||n!==f,U=!!e.shader,k=U?iu(e):0,F=U?ui(e):void 0;if((M||P||k)&&s.save(),P){const B=new Path2D,{x:E,y:C,width:I,height:v}=b;B.rect(E,C,I,v),s.clip(B)}if(M){const B=this.pixelRatio;s.setTransform(d,m,p,y,r*B,a*B),s.scale(B,B),s.translate(-r,-a)}if(k){const B=new Path2D;Pn.call(B,r,a,l,u,k),s.clip(B)}if((x===Q.image||x===Q.subTexture||x===Q.noise)&&S){const B=S.getImage($);if(s.globalAlpha=$.a??o,_)s.drawImage(B,_.x,_.y,_.width,_.height,r,a,l,u);else try{s.drawImage(B,r,a,l,u)}catch{}s.globalAlpha=1}else if(x===Q.color&&L){let B=r,E=a,C;n===c?(B=r,E=a+u,C=Oo(f)):(B=r+l,E=a,C=Oo(c));const I=s.createLinearGradient(r,a,B,E);I.addColorStop(0,Js($)),I.addColorStop(1,Js(C)),s.fillStyle=I,s.fillRect(r,a,l,u)}else x===Q.color&&(s.fillStyle=Js($),s.fillRect(r,a,l,u));if(F&&F.width){const B=F.width,E=F.width/2,C=Js(ya(F.color??0));s.beginPath(),s.lineWidth=B,s.strokeStyle=C,s.globalAlpha=o,k?(Pn.call(s,r+E,a+E,l-B,u-B,k),s.stroke()):s.strokeRect(r+E,a+E,l-B,u-B),s.globalAlpha=1}else if(U){const B=ui(e,"Top"),E=ui(e,"Right"),C=ui(e,"Bottom"),I=ui(e,"Left");B&&to(s,r,a,l,u,B.width,B.color,"Top"),E&&to(s,r,a,l,u,E.width,E.color,"Right"),C&&to(s,r,a,l,u,C.width,C.color,"Bottom"),I&&to(s,r,a,l,u,I.width,I.color,"Left")}(M||P||k)&&s.restore()}createCtxTexture(e){return new su(this.txMemManager,e)}getShaderManager(){return this.shManager}getDefShaderCtr(){return this.defShaderCtr}renderRTTNodes(){}removeRTTNode(e){}renderToTexture(e){}getBufferInfo(){return null}getQuadCount(){return null}updateClearColor(e){this.clearColor=e?Tn(e):void 0}}const yi={alpha:i=>i===1?null:{prop:"opacity",value:`${i}`},x:i=>({prop:"left",value:`${i}px`}),y:i=>({prop:"top",value:`${i}px`}),width:i=>i===0?null:{prop:"width",value:`${i}px`},height:i=>i===0?null:{prop:"height",value:`${i}px`},fontSize:i=>i===0?null:{prop:"font-size",value:`${i}px`},lineHeight:i=>i===0?null:{prop:"line-height",value:`${i}px`},zIndex:()=>"z-index",fontFamily:()=>"font-family",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:i=>i===!1?null:{prop:"overflow",value:i?"hidden":"visible"},rotation:i=>i===0?null:{prop:"transform",value:`rotate(${i}rad)`},scale:i=>i===1?null:{prop:"transform",value:`scale(${i})`},scaleX:i=>i===1?null:{prop:"transform",value:`scaleX(${i})`},scaleY:i=>i===1?null:{prop:"transform",value:`scaleY(${i})`},color:i=>i===0?null:{prop:"color",value:xa(i)}},xa=i=>{const t=(i&255)/255,e=i>>8&255,s=i>>16&255;return`rgba(${i>>24&255},${s},${e},${t})`},Jo={id:"test-id"},ou=new Set([...Object.keys(yi),...Object.keys(Jo),"src","parent","data"]);class nu{constructor(t,e){h(this,"root",null);h(this,"canvas",null);h(this,"height",1080);h(this,"width",1920);h(this,"scaleX",1);h(this,"scaleY",1);if(ni())return;if(!e)throw new Error("settings is required");this.height=Math.ceil(e.appHeight??1080/(e.deviceLogicalPixelRatio??1)),this.width=Math.ceil(e.appWidth??1920/(e.deviceLogicalPixelRatio??1)),this.scaleX=e.deviceLogicalPixelRatio??1,this.scaleY=e.deviceLogicalPixelRatio??1,this.canvas=t,this.root=document.createElement("div"),this.setRootPosition(),document.body.appendChild(this.root),new MutationObserver(this.setRootPosition.bind(this)).observe(t,{attributes:!0,childList:!1,subtree:!1}),new ResizeObserver(this.setRootPosition.bind(this)).observe(t),window.addEventListener("resize",this.setRootPosition.bind(this)),console.warn("Inspector is enabled, this will impact performance")}setRootPosition(){if(this.root===null||this.canvas===null)return;const t=this.canvas.getBoundingClientRect(),e=document.documentElement.scrollTop+t.top,s=document.documentElement.scrollLeft+t.left;this.root.id="root",this.root.style.left=`${s}px`,this.root.style.top=`${e}px`,this.root.style.width=`${this.width}px`,this.root.style.height=`${this.height}px`,this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform=`scale(${this.scaleX}, ${this.scaleY})`,this.root.style.overflow="hidden",this.root.style.zIndex="65534"}createDiv(t,e){const s=document.createElement("div");s.style.position="absolute",s.id=t.toString();for(const r in e)this.updateNodeProperty(s,r,e[r],e);return s}createNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,t.on("inViewport",()=>e.setAttribute("state","inViewport")),t.on("inBounds",()=>e.setAttribute("state","inBounds")),t.on("outOfBounds",()=>e.setAttribute("state","outOfBounds")),this.createProxy(t,e)}createTextNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,this.createProxy(t,e)}createProxy(t,e){ou.forEach(a=>{let l=Object.getOwnPropertyDescriptor(t,a);if(l===void 0){const u=Object.getPrototypeOf(t);l=Object.getOwnPropertyDescriptor(u,a)}l!==void 0&&Object.defineProperty(t,a,{get(){var u;return(u=l==null?void 0:l.get)==null?void 0:u.call(t)},set:u=>{var o;(o=l==null?void 0:l.set)==null||o.call(t,u),this.updateNodeProperty(e,a,u,t.props)},configurable:!0,enumerable:!0})});const s=t.destroy;Object.defineProperty(t,"destroy",{value:()=>{this.destroyNode(t.id),s.call(t)}});const r=t.animate;return Object.defineProperty(t,"animate",{value:(a,l)=>{const u=r.call(t,a,l),o=u.start.bind(u);return u.start=()=>(this.animateNode(e,a,l),o()),u}}),t}destroyNode(t){const e=document.getElementById(t.toString());e==null||e.remove()}updateNodeProperty(t,e,s,r){var a;if(!(this.root===null||s===void 0||s===null)){if(e==="parent"){const l=s.id;if(l===1){this.root.appendChild(t);return}const u=document.getElementById(l.toString());u==null||u.appendChild(t);return}if(e==="text"){t.innerHTML=String(s),t.style.visibility="hidden";return}if(e==="src"&&s){t.setAttribute("data-src",String(s));return}if(e==="rtt"&&s){t.setAttribute("data-rtt",String(s));return}if(yi[e]){const l=(a=yi[e])==null?void 0:a.call(yi,s);if(l===null)return;if(typeof l=="string"){t.style.setProperty(l,String(s));return}if(typeof l=="object"){let u=l.value;if(e==="x"){const o=r.mountX,n=r.width;o&&(u=`${parseInt(u)-n*o}px`)}else if(e==="y"){const o=r.mountY,n=r.height;o&&(u=`${parseInt(u)-n*o}px`)}t.style.setProperty(l.prop,u)}return}if(Jo[e]){const l=Jo[e];if(!l)return;t.setAttribute(String(l),String(s));return}if(e==="data"){for(const l in s){const u=s[l];u===void 0?t.removeAttribute(`data-${l}`):t.setAttribute(`data-${l}`,String(u))}return}}}animateNode(t,e,s){const{duration:r=1e3,delay:a=0}=s,{x:l,y:u,width:o,height:n,alpha:c=1,rotation:f=0,scale:d=1,color:p,mountX:m,mountY:y}=e;function b(){setTimeout(()=>{t.style.top=`${u-n*y}px`,t.style.left=`${l-o*m}px`,t.style.width=`${o}px`,t.style.height=`${n}px`,t.style.opacity=`${c}`,t.style.rotate=`${f}rad`,t.style.scale=`${d}`,t.style.color=xa(p)},r)}setTimeout(b,a)}}const Ta=50,Bn={hd:.66666667,"720p":.66666667,720:.66666667,fhd:1,fullhd:1,"1080p":1,1080:1,"4k":2,"2160p":2,2160:2},au={low:.66666667,medium:.85,high:1,retina:2},lu=()=>{const i=Oe.stage;Ne.get("fonts",[]).forEach(t=>{t.type==="sdf"||t.type==="msdf"?(!t.png&&t.file&&(t.png=t.file.replace(/\.[^.]+$/,`.${t.type}.png`)),!t.json&&t.file&&(t.json=t.file.replace(/\.[^.]+$/,`.${t.type}.json`)),i.fontManager.addFontFace(new Zo(t.type,{fontFamily:t.family,descriptors:{},atlasUrl:t.png,atlasDataUrl:t.json,stage:i,metrics:t.metrics}))):t.type==="web"&&i.fontManager.addFontFace(new fo({fontFamily:t.family,fontUrl:t.file,descriptors:{},metrics:t.metrics}))})},fu=()=>{const i=Oe.stage;Ne.get("shaders",[]).forEach(t=>{i.shManager.registerShaderType(t.name,t.type)}),Ne.get("effects",[]).forEach(t=>{i.shManager.registerShaderType(t.name,t.type)})};let Oe={};const uu=i=>{const t="renderMode"in i?i.renderMode:"webgl";if(t==="webgl")return un;if(t==="canvas")return ru},cu=i=>{const t="renderMode"in i?i.renderMode:"webgl";if(t==="webgl")return[Zf,Ln];if(t==="canvas")return[Ln]},hu=i=>{const t={max:200,target:.8,cleanupInterval:5e3,baseline:25,strict:!1,..."gpuMemory"in i?i.gpuMemory:{}};return{criticalThreshold:t.max*1024*1024,targetThresholdLevel:t.target,cleanupInterval:t.cleanupInterval,baselineMemoryAllocation:t.baseline*1024*1024,doNotExceedCriticalThreshold:t.strict}},du=(i,t,e={})=>{Oe=new If({appWidth:e.w||1920,appHeight:e.h||1080,fpsUpdateInterval:e.fpsInterval||1e3,devicePhysicalPixelRatio:au[e.renderQuality]||e.renderQuality||1,deviceLogicalPixelRatio:e.pixelRatio||Bn[e.screenResolution]||Bn[window.innerHeight]||1,numImageWorkers:"webWorkersLimit"in e?e.webWorkersLimit:window.navigator.hardwareConcurrency||2,clearColor:e.canvasColor&&ti.normalize(e.canvasColor)||0,inspector:e.inspector===!0?nu:void 0,boundsMargin:e.viewportMargin||0,renderEngine:uu(e),fontEngines:cu(e),canvas:e.canvas,textureProcessingTimeLimit:e.textureProcessingTimeLimit,textureMemory:hu(e),createImageBitmapSupport:"auto",...e.advanced||{}},t);const s=()=>{let r=i();r.quit=()=>{q.info("Closing App"),r.destroy(),r=null,Oe=null}};return fu(),lu(),s(),Oe};let pu=0;const mu=(i,t)=>{if(i===void 0)return{start:0,end:0,oppositeStart:0,oppositeEnd:0};if(typeof i=="number")return{start:i,end:i,oppositeStart:i,oppositeEnd:i};if(ot(i)===!0&&(i=nt(i)),typeof i=="object"){const{top:e=void 0,right:s=void 0,bottom:r=void 0,left:a=void 0,x:l=0,y:u=0}=i;return t==="vertical"?{start:e!==void 0?e:u,end:r!==void 0?r:u,oppositeStart:a!==void 0?a:l,oppositeEnd:s!==void 0?s:l}:{start:a!==void 0?a:l,end:s!==void 0?s:l,oppositeStart:e!==void 0?e:u,oppositeEnd:r!==void 0?r:u}}return{start:0,end:0,oppositeStart:0,oppositeEnd:0}},gu=function(i){const t=i.direction==="vertical"?"y":"x",e=i.direction==="vertical"?"x":"y",s=i.direction==="vertical"?"mountX":"mountY",r=i.direction==="vertical"?"height":"width",a=i.direction==="vertical"?"width":"height",l=mu(i.padding,i.direction);let u=l.start;const o=this.node.children,n=o.length;let c=0;const f=i.gap||0;for(let p=0;p<n;p++){const m=o[p];m[t]=u,m[e]=l.oppositeStart,r==="width"?u+=m.width+(m.width!==("text"in m?1:0)?f:0):u+="text"in m?m.width>1?m.height+f:0:m.height!==0?m.height+f:0,c=Math.max(c,m[a]+l.oppositeStart+l.oppositeEnd)}this.node[r]=u-f+l.end,this.node[a]=c;const d={start:0,end:1,center:.5}[i["align-items"]||"start"];if(d!==0)for(let p=0;p<n;p++){const m=o[p];m[e]=c*d,m[s]=d}i["@updated"]!==void 0&&i["@updated"]({w:this.node.width,h:this.node.height},this)},Fn=i=>i!==null&&typeof i=="object"&&"transition"in i,ot=i=>typeof i=="string"&&i.startsWith("{")&&i.endsWith("}"),nt=i=>JSON.parse(i.replace(/'/g,'"').replace(/([\w-_]+)\s*:/g,'"$1":')),Ds=function(i,t){return typeof i!="string"?i:i.indexOf("%")===i.length-1?this.element.config.parent&&(this.element.config.parent.node[t]||0)*(parseFloat(i)/100)||0:i},en=i=>{if(typeof i!="object"||i===null)return i;if(i.constructor===Object){if("value"in i)return i.value;if("transition"in i)return en(i.transition)}return i},yu={top:"colorTop",bottom:"colorBottom",left:"colorLeft",right:"colorRight"};let tn=null;const xu={set parent(i){this.props.parent=i==="root"?Oe.root:i.node},set rotation(i){this.props.rotation=i*(Math.PI/180)},set w(i){this.props.width=Ds.call(this,i,"width")},set width(i){this.props.width=Ds.call(this,i,"width")},set h(i){this.props.height=Ds.call(this,i,"height")},set height(i){this.props.height=Ds.call(this,i,"height")},set x(i){this.props.x=Ds.call(this,i,"width")},set y(i){this.props.y=Ds.call(this,i,"height")},set z(i){this.props.zIndex=i},set zIndex(i){this.props.zIndex=i},set color(i){typeof i=="string"&&i.startsWith("{")===!1?this.props.color=ti.normalize(i):(typeof i=="object"||ot(i)===!0&&(i=nt(i)))&&(this.props.color=0,Object.entries(i).forEach(t=>{this.props[yu[t[0]]]=ti.normalize(t[1])}))},set src(i){this.props.src=i,this.raw.color===void 0&&(this.props.color=this.props.src?4294967295:0),!("w"in this.raw)&&!("w"in this.raw)&&!("h"in this.raw)&&!("height"in this.raw)&&(this.props.autosize=!0)},set texture(i){this.props.texture=i,this.raw.color===void 0&&i==null?this.props.color=0:this.raw.color===void 0&&(this.props.color=4294967295)},set fit(i){const t={};if(i==="cover"||i==="contain"){this.props.textureOptions={resizeMode:{type:i}};return}(typeof i=="object"||ot(i)===!0&&(i=nt(i)))&&(t.type=i.type||"cover",typeof i.position=="number"&&(t.clipY=t.clipX=i.position),typeof i.position=="object"&&(t.clipX="x"in i.position?i.position.x:null,t.clipY="y"in i.position?i.position.y:null),this.props.textureOptions={resizeMode:t})},set rtt(i){this.props.rtt=i,this.raw.color===void 0&&(this.props.color=i===!0?4294967295:0)},set mount(i){typeof i=="object"||ot(i)===!0&&(i=nt(i))?("x"in i&&(this.props.mountX=i.x),"y"in i&&(this.props.mountY=i.y)):(this.props.mountX=i,this.props.mountY=i)},set pivot(i){typeof i=="object"||ot(i)===!0&&(i=nt(i))?("x"in i&&(this.props.pivotX=i.x),"y"in i&&(this.props.pivotY=i.y)):(this.props.pivotX=i,this.props.pivotY=i)},set scale(i){typeof i=="object"||ot(i)===!0&&(i=nt(i))?("x"in i&&(this.props.scaleX=i.x),"y"in i&&(this.props.scaleY=i.y)):this.props.scale=i},set show(i){i?(this.props.alpha=this.raw.alpha!==void 0?this.raw.alpha:1,this.props.width=this.raw.w||this.raw.width||0,this.props.height=this.raw.h||this.raw.height||0):(this.props.alpha=0,this.props.width=0,this.props.height=0)},set alpha(i){(this.raw.show===void 0||this.raw.show==!0)&&(this.props.alpha=i)},set shader(i){i!==null?this.props.shader=Oe.createShader(i.type,i.props):this.props.shader=Oe.createShader("DefaultShader")},set effects(i){for(let t=0;t<i.length;t++)i[t].props&&i[t].props.color&&(i[t].props.color=ti.normalize(i[t].props.color));if(this.element.node===void 0)this.props.shader=Oe.createShader("DynamicShader",{effects:i.map(t=>Oe.createEffect(t.type,t.props,t.type+this.element.counter))});else for(let t=0;t<i.length;t++){const e=this.element.node.shader.props[i[t].type+this.element.counter],s=Object.keys(i[t].props);if(e!=null)for(let r=0;r<s.length;r++)e[s[r]]=i[t].props[s[r]]}},set clipping(i){this.props.clipping=i},set overflow(i){this.props.clipping=!i},set font(i){this.props.fontFamily=i},set size(i){this.props.fontSize=i},set wordwrap(i){q.warn("The wordwrap attribute is deprecated, use maxwidth instead"),this.props.width=i,this.props.contain="width"},set maxwidth(i){this.props.width=i,this.props.contain="width"},set maxheight(i){this.props.height=i,this.props.contain="both"},set contain(i){this.props.contain=i},set maxlines(i){this.props.maxLines=i},set textoverflow(i){this.props.overflowSuffix=i===!1?" ":i===!0?void 0:i},set letterspacing(i){this.props.letterSpacing=i||1},set lineheight(i){this.props.lineHeight=i},set align(i){this.props.textAlign=i},set content(i){this.props.text=""+i},set placement(i){let t,e;typeof i=="object"||ot(i)===!0&&(i=nt(i))?("x"in i&&(t=i.x),"y"in i&&(e=i.y)):i==="center"||i==="right"?t=i:e=i,t==="center"?(this.x="50%",this.props.mountX=.5):t==="right"&&(this.x="100%",this.props.mountX=1),e==="middle"?(this.y="50%",this.props.mountY=.5):e==="bottom"&&(this.y="100%",this.props.mountY=1)},set"inspector-data"(i){(typeof i=="object"||ot(i)===!0&&(i=nt(i)))&&(this.props.data=i)}},Tu={populate(i){const t=i;t.node=this.config.node,t[g.isSlot]===!0&&(this[g.isSlot]=!0),this.props.element=this,this.props.parent=t.parent||this.config.parent,delete t.parent,this.props.raw=i;const e=Object.keys(t),s=e.length;for(let r=0;r<s;r++){const a=e[r],l=t[a];l!==void 0&&(this.props[a]=en(l))}this.props.props.color===void 0&&!("__textnode"in t)&&(this.props.props.color=0),this.node=t.__textnode?Oe.createTextNode({...tn,...this.props.props}):Oe.createNode(this.props.props),t["@loaded"]!==void 0&&typeof t["@loaded"]=="function"&&this.node.on("loaded",(r,{type:a,dimensions:l})=>{t["@loaded"]({w:l.width,h:l.height,type:a},this)}),t["@error"]!==void 0&&typeof t["@error"]=="function"&&this.node.on("failed",(r,a)=>{t["@error"](a,this)}),t.__layout===!0&&(this.triggerLayout=gu.bind(this)),this.config.parent.props!==void 0&&this.config.parent.props.__layout===!0&&(this.config.parent.triggerLayout(this.config.parent.props),this.node.on("loaded",()=>{this.config.parent.triggerLayout(this.config.parent.props)}))},set(i,t){if(t===void 0||this.props.raw[i]===t)return;this.props.raw[i]=t,this.props.props={},this.props[i]=en(t);const e=Object.keys(this.props.props);if(e.length===1){if(Fn(t)===!0)return this.animate(e[0],this.props.props[e[0]],t.transition);this.node[e[0]]=this.props.props[e[0]]}else for(let s=0;s<e.length;s++){if(Fn(t)===!0)return this.animate(e[s],this.props.props[e[s]],t.transition);this.node[e[s]]=this.props.props[e[s]]}this.config.parent.props&&this.config.parent.props.__layout===!0&&this.config.parent.triggerLayout(this.config.parent.props)},animate(i,t,e){if(this.scheduledTransitions[i]!==void 0&&this.scheduledTransitions[i].f.state==="scheduled"&&this.scheduledTransitions[i].f.stop(),this.node[i]===t)return;const s={};s[i]=t;const r=this.node.animate(s,{duration:typeof e=="object"&&"duration"in e?e.duration:300,easing:typeof e=="object"&&"easing"in e?e.easing:"ease",delay:typeof e=="object"&&"delay"in e?e.delay:0}),a=this.node[i];if(this.scheduledTransitions[i]={v:s[i],f:r},e.start!==void 0&&typeof e.start=="function"&&r.once("animating",()=>{e.start.call(this.component,this,i,a)}),this.config.parent.props&&this.config.parent.props.__layout===!0&&r.on("tick",()=>{this.config.parent.triggerLayout(this.config.parent.props)}),e.progress!==void 0&&typeof e.progress=="function"){let l=0;r.on("tick",(u,{progress:o})=>{e.progress.call(this.component,this,i,o,l),l=o})}r.once("stopped",()=>{this.scheduledTransitions[i]!==void 0&&this.scheduledTransitions[i].canceled===!0||(e.end&&typeof e.end=="function"&&e.end.call(this.component,this,i,this.node[i]),delete this.scheduledTransitions[i])}),r.start()},destroy(){q.debug("Deleting  Node",this.nodeId),this.node.destroy();const i=Object.keys(this.scheduledTransitions);for(let t=0;t<i.length;t++){const e=this.scheduledTransitions[i[t]];e!==void 0&&(e.canceled=!0,e.f!==void 0&&e.f.stop())}},get nodeId(){return this.node&&this.node.id},get ref(){return this.props.ref||null},get parent(){return this.node&&this.node.parent},get children(){return this.component[g.getChildren]().filter(i=>i.parent===(this[g.isSlot]?this.node.children[0]:this.node))}},bu=(i,t)=>(tn===null&&(tn={fontSize:32,fontFamily:Ne.get("defaultFont","sans-serif")}),Object.assign(Object.create(Tu),{props:Object.assign(Object.create(xu),{props:{}}),scheduledTransitions:{},config:i,component:t,counter:pu++})),On={Element:bu,Launch:du},wu="1.23.2",Su={"@lightningjs/renderer":"^2.13.2"},Un={version:wu,dependencies:Su};let vi={};const cn={},Cu=(i,t,e)=>{Ne.set(e),ml(),q.info("Blits Version ",Un.version),q.info("Renderer Version ",Un.dependencies["@lightningjs/renderer"]),cn.element=On.Element,vi=On.Launch(i,t,e)},vu={before:{prop:"alpha",value:0},in:{prop:"alpha",value:1,duration:200},out:{prop:"alpha",value:0,duration:100}},lt=window.speechSynthesis,Ru=()=>(window.navigator||{}).userAgent||"",$n=()=>/android/i.test(Ru());let ba=!1,bo=null;const hn=()=>bo&&clearTimeout(bo),sn=i=>{if(!i||bo)return hn();lt.pause(),lt.resume(),bo=setTimeout(()=>{sn(i)},5e3)},Ks={lang:"en-US",pitch:1,rate:1,voice:null,volume:1},_u=()=>{Ks.voice=lt.getVoices()[0],ba=!0},Eu=(i,t)=>{const e=new SpeechSynthesisUtterance(t.value);e.lang=t.lang||Ks.lang,e.pitch=t.pitch||Ks.pitch,e.rate=t.rate||Ks.rate,e.voice=t.voice||Ks.voice,e.volume=t.volume||Ks.volume,e.onstart=()=>{$n()||sn(e),i.onstart()},e.onresume=()=>{$n()||sn(e),i.onresume()},e.onpause=()=>{i.onpause()},e.onend=()=>{i.onend()},e.onerror=()=>{hn(),i.onerror()},lt.speak(e)},uo={speak(i){ba||_u(),this.cancel(),Eu(this,i)},resume(){lt.resume()},pause(){lt.pause()},cancel(){lt.cancel(),hn()},getVoices(){return lt.getVoices()},onend(){},onerror(){},onstart(){},onresume(){},onpause(){}};let Dn;const dn=(i,t="off")=>{clearTimeout(Dn),uo.cancel(),t==="assertive"?uo.speak({value:i}):Dn=setTimeout(()=>{uo.speak({value:i})},400)},Au=i=>dn(i,"polite"),Mu=i=>dn(i,"assertive"),ku=()=>{uo.cancel()},wa={speak:dn,polite:Au,assertive:Mu,stop:ku};let st;const tt=Vo({path:"",navigating:!1,data:null,params:null,hash:""}),rn=new Map,Sa=[];let Ca={},va={},ri=!1,Ra;const Iu=()=>{const i=(document.location.hash||"/").replace(/^#/,"").split("?");return{path:i[0],queryParams:new URLSearchParams(i[1]),hash:document.location.hash}},Nn=i=>i.replace(/^\/+|\/+$/g,"").toLowerCase(),zn=i=>typeof i=="object"&&i!==null,Wn=i=>typeof i=="string",_a=(i,t=[])=>{const e=i;i=Nn(i);let s=!1,r=0;for(;!s&&r<t.length;){const a=t[r];if(a.path=Nn(a.path),a.path===i)a.params={},s=a;else if(a.path.indexOf(":")>-1){const l=[...a.path.matchAll(/:([^\s/]+)/gi)];let u=a.path;l.reverse().forEach(n=>{u=u.substring(0,n.index)+"([^\\s/]+)"+u.substring(n.index+n[0].length)});const o=e.match(new RegExp(`${u}`,"i"));o&&(a.params=l.reverse().reduce((n,c,f)=>(n[c[1]]=o[f+1],n),{}),s=a)}else if(a.path.endsWith("*")){const l=new RegExp(a.path.replace(/\/?\*/,"/?([^\\s]*)"),"i"),u=i.match(l);u&&(u[1]&&(a.params={path:u[1]}),s=a)}r++}return s&&(s.options={...s.options,...Ca},s.data||(s.data={})),s},Lu=async function(){if(tt.navigating=!0,this.parent[g.routes]){let i=st?Object.assign({},st):void 0;const{hash:t,path:e,queryParams:s}=Iu();let r=_a(e,this.parent[g.routes]);if(t!==null&&(r.hash=t),st=r,r){let a;if(this.parent[g.routerHooks]){const d=this.parent[g.routerHooks];if(d.beforeAll&&(a=await d.beforeAll(r,i),Wn(a))){Ri(a);return}}r=zn(a)?a:r;let l;if(r.hooks&&r.hooks.before&&(l=await r.hooks.before.call(this.parent,r,i),Wn(l))){st=i,Ri(l);return}r=zn(l)?l:r,ri===!1&&i&&i.options.inHistory===!0&&Sa.push(i),"transition"in r||(r.transition=vu),typeof r.transition=="function"&&(r.transition=r.transition(i,r));let u,o,{view:n,focus:c}=rn.get(r.hash)||{};if(n){u=n[g.holder];let d=!1;if(r.transition.before)if(Array.isArray(r.transition.before)){for(let p=0;p<r.transition.before.length;p++)if(r.transition.before[p].prop==="alpha"){d=!0;break}}else r.transition.before.prop==="alpha"&&(d=!0);d===!1&&u.set("alpha",1)}else{u=cn.element({parent:this[g.children][0]}),u.populate({}),u.set("w","100%"),u.set("h","100%");const d={},p=[...s.entries()];for(let y=0;y<p.length;y++)d[p[y][0]]=p[y][1];o={...va,...r.data,...d};const m={...this[g.props],...r.params,...o};n=await r.component({props:m},u,this),n[Symbol.toStringTag]==="Module"&&(n.default&&typeof n.default=="function"?n=n.default({props:m},u,this):q.error("Dynamic import doesn't have a default export or default is not a function")),typeof n=="function"&&(n=n({props:m},u,this))}if(this[g.children].push(n),Ra=ei.get(),c?c.$focus():n.$focus(),r.transition.before)if(Array.isArray(r.transition.before))for(let d=0;d<r.transition.before.length;d++)u.set(r.transition.before[d].prop,r.transition.before[d].value);else u.set(r.transition.before.prop,r.transition.before.value);let f=!1;if(i){f=!0;const d=this[g.children].splice(1,1).pop();d&&Pu(i,d,r.transition.out),i=void 0}if(tt.path=r.path,tt.params=r.params,tt.hash=t,tt.data=o,r.transition.in)if(Array.isArray(r.transition.in))for(let d=0;d<r.transition.in.length;d++)d===r.transition.length-1?await oi(u,r.transition.in[d],f):oi(u,r.transition.in[d],f);else await oi(u,r.transition.in,f);r.announce&&(typeof r.announce=="string"&&(r.announce={message:r.announce}),wa.speak(r.announce.message,r.announce.politeness)),this.activeView=this[g.children][this[g.children].length-1]}else q.error(`Route ${t} not found`)}ri=!1,tt.navigating=!1},Pu=async(i,t,e)=>{if(e)if(Array.isArray(e))for(let s=0;s<e.length;s++)s===e.length-1?await oi(t[g.holder],e[s]):oi(t[g.holder],e[s]);else await oi(t[g.holder],e);ri===!1&&i.options&&i.options.keepAlive===!0?rn.set(i.hash,{view:t,focus:Ra}):ri===!0&&rn.delete(i.hash),i.options&&(i.options.keepAlive!==!0||ri===!0)&&(t.destroy(),t=null)},oi=(i,t,e=!0)=>new Promise(s=>{if(e){const r=t.end;t.end=r?(...a)=>{r(...a),s()}:s,i.set(t.prop,{transition:t})}else i.set(t.prop,t.value),s()}),Ri=(i,t={},e={})=>{va=t,Ca=e,window.location.hash=i},Ea=function(){const i=Sa.pop();if(i&&st!==i)return ri=!0,Ri(i.hash,i.data,i.options),!0;const t=st&&st.options.backtrack||!1;if(t===!1)return!1;const e=/(\/:?[\w%\s-]+)$/;let s=st.path,r=s.split("/").length;if(r<=1)return!1;for(;r--;){if(!e.test(s))return!1;s=s.replace(e,"");const a=_a(s,this.parent[g.routes]);if(a&&t)return Ri(a.path),!0}return!1},Uo={navigate:Lu,back:Ea};let Ze=null,so=[],Vn;const on=new Map,ei={_hold:!1,set hold(i){this._hold=i},get hold(){return this._hold},get(){return Ze},set(i,t){i!==Ze&&(clearTimeout(Vn),Ze&&Ze!==i.parent&&Ze.unfocus(),so.reverse().forEach(e=>e.unfocus()),i!==Ze&&(Vn=setTimeout(()=>{Ze=i,Ze.lifecycle.state="focus",t instanceof KeyboardEvent?document.dispatchEvent(new KeyboardEvent("keydown",t)):so=[]},this.hold?Ne.get("holdTimeout",Ta):0)))},input(i,t){if(tt.navigating===!0)return;so=Aa([Ze],i);const e=so.shift();if(e){let s;e[g.inputEvents][i]?s=e[g.inputEvents][i].call(e,t):e[g.inputEvents].any&&(s=e[g.inputEvents].any.call(e,t)),s!==void 0&&on.set(t.code,s)}}},Aa=(i,t)=>i[0][g.inputEvents]&&(typeof i[0][g.inputEvents][t]=="function"||typeof i[0][g.inputEvents].any=="function")?i:i[0].parent?(i.unshift(i[0].parent),Aa(i,t)):[],Rs=new Map,Ns=new Map,co={registerListener(i,t,e,s=0){let r=Rs.get(t);r===void 0&&(r=new Map,Rs.set(t,r));let a=r.get(i);a===void 0&&(a=new Set,r.set(i,a)),a.add({cb:e,priority:s}),Ns.delete(t)},deregisterListener(i,t){let e=Rs.get(t);e!==void 0&&e.has(i)&&(e.delete(i),Rs.set(t,e),Ns.delete(t))},executeListeners(i,t){const e=Rs.get(i);if(e===void 0||e.size===0)return!0;if(Ns.has(i)===!1){const r=[];for(const[a,l]of e)for(const u of l)r.push({...u,component:a});r.sort((a,l)=>l.priority-a.priority),Ns.set(i,r)}const s=Ns.get(i);for(let r=0;r<s.length;r++){const{cb:a,component:l}=s[r];if(a.call(l,t)===!1)return!1}return!0},removeListeners(i){for(const[t,e]of Rs)e.has(i)&&(e.delete(i),Ns.delete(t),e.size===0&&Rs.delete(t))}},Bu={focus:{value:function(i){return q.warn("this.focus is deprecated, use this.$focus instead"),this.$focus(i)},writable:!1,enumerable:!0,configurable:!1},$focus:{value:function(i){this[g.state].hasFocus=!0,ei.set(this,i)},writable:!1,enumerable:!0,configurable:!1},unfocus:{value:function(){this[g.state].hasFocus=!1,this.lifecycle.state="unfocus"},writable:!1,enumerable:!0,configurable:!1},destroy:{value:function(){this.lifecycle.state="destroy",this.$clearTimeouts(),this.$clearIntervals(),co.removeListeners(this),Ma(this[g.children]),gn(this[g.effects]),q.debug(`Destroyed component ${this.componentId}`)},writable:!1,enumerable:!0,configurable:!1},[g.removeGlobalEffects]:{value:function(i=[]){gn(i)},writable:!1,enumerable:!1,configurable:!1},select:{value:function(i){return q.warn("this.select is deprecated, use this.$select instead"),this.$select(i)},writable:!1,enumerable:!0,configurable:!1},$select:{value:function(i){let t=null;return this[g.children].forEach(e=>{Array.isArray(e)?e.forEach(s=>{s.ref===i&&(t=s)}):Object.getPrototypeOf(e)===Object.prototype?Object.keys(e).forEach(s=>{e[s].ref===i&&(t=e[s])}):e.ref===i&&(t=e)}),t},writable:!1,enumerable:!0,configurable:!1},trigger:{value:function(i){return q.warn("this.trigger is deprecated, use this.$trigger instead"),this.$trigger(i)},writable:!1,enumerable:!0,configurable:!1},$trigger:{value:function(i){let t=this[g.originalState];if(i.indexOf(".")>-1){const e=i.split(".");i=e.pop(e);for(let s=0;s<e.length;s++)t=t[e[s]]}ii(t,i,!0)},writable:!1,enumerable:!0,configurable:!1},shader:{value:function(i,t){return{type:i,props:t}},writable:!1,enumerable:!0,configurable:!1}},Ma=function(i){for(let t=0;t<i.length;t++){if(!i[t])return;i[t].destroy&&typeof i[t].destroy=="function"?i[t].destroy():Object.getPrototypeOf(i[t])===Object.prototype&&Ma(Object.values(i[t])),i[t]=null}i.length=0},Fu={$setTimeout:{value:function(i,t,...e){const s=setTimeout(()=>{this[g.timeouts]=this[g.timeouts].filter(r=>r!==s),i.apply(null,e)},t,e);return this[g.timeouts].push(s),s},writable:!1,enumerable:!0,configurable:!1},$clearTimeout:{value:function(i){this[g.timeouts].indexOf(i)>-1&&(this[g.timeouts]=this[g.timeouts].filter(t=>t!==i),clearTimeout(i))},writable:!1,enumerable:!0,configurable:!1},$clearTimeouts:{value:function(){for(let i=0;i<this[g.timeouts].length;i++)clearTimeout(this[g.timeouts][i]);this[g.timeouts]=[]},writable:!1,enumerable:!0,configurable:!1},$setInterval:{value:function(i,t,...e){const s=setInterval(()=>i.apply(null,e),t,e);return this[g.intervals].push(s),s},writable:!1,enumerable:!0,configurable:!1},$clearInterval:{value:function(i){this[g.intervals].indexOf(i)>-1&&(this[g.intervals]=this[g.intervals].filter(t=>t!==i),clearInterval(i))},writable:!1,enumerable:!0,configurable:!1},$clearIntervals:{value:function(){for(let i=0;i<this[g.intervals].length;i++)clearInterval(this[g.intervals][i]);this[g.intervals]=[]},writable:!1,enumerable:!0,configurable:!1}},Ou={$emit:{value:function(i,t){return co.executeListeners(i,t)},writable:!1,enumerable:!0,configurable:!1},$listen:{value:function(i,t,e=0){co.registerListener(this,i,t,e)},writable:!1,enumerable:!0,configurable:!1},$unlisten:{value:function(i){co.deregisterListener(this,i)},writable:!1,enumerable:!0,configurable:!1}},Uu={$router:{value:{to:Ri,back:Ea,get currentRoute(){return st},get routes(){return this[g.routes]},get navigating(){return tt.navigating},state:tt},writable:!1,enumerable:!0,configurable:!1}},$u={$announcer:{value:wa,writable:!1,enumerable:!0,configurable:!1}},Du={$size:{value:function(i={w:0,h:0}){this[g.holder].set("w",i.w||0),this[g.holder].set("h",i.h||0)},writable:!1,enumerable:!0,configurable:!1},[g.renderer]:{value:()=>vi,writable:!1,enumerable:!0,configurable:!1},[g.getChildren]:{value(){const i=this.rootParent||this.parent;return(this[g.children]||[]).concat(i&&i[g.getChildren]().map(t=>Object.getPrototypeOf(t)===Object.prototype?Object.values(t).map(e=>(e.forComponent=e.config&&e.config.parent.component,e)):t).flat().filter(t=>{if(t&&t.component)return t.component&&t.component.componentId===this.componentId||t.forComponent&&t.forComponent.componentId===this.componentId})||[])},writable:!1,enumerable:!0,configurable:!1}},ka={...Ou,...Uu,...$u},_s=Object.defineProperties({[g.launched]:!1},{...Bu,...Fu,...ka,...Du}),Nu={cast:i=>i,required:!1},zu=(i,t=[])=>{t.indexOf("ref")===-1&&t.push("ref"),i[g.propKeys]=[];const e=t.length;for(let s=0;s<e;s++){const r={...Nu,...typeof t[s]=="object"?t[s]:{key:t[s]}};i[g.propKeys].push(r.key),Object.defineProperty(i,r.key,{get(){const a=r.cast(this[g.props]!==void 0&&r.key in this[g.props]?this[g.props][r.key]:"default"in r?r.default:void 0);return r.required===!0&&a===void 0&&q.warn(`${r.key} is required`),a},set(a){q.warn(`Warning! Avoid mutating props directly (${r.key})`),this[g.props][r.key]=a}})}},Wu=(i,t)=>{i[g.methodKeys]=[];for(let e in t)i[g.propKeys]&&i[g.propKeys].indexOf(e)>-1?q.error(`${e} already exists as a prop`):(typeof t[e]!="function"&&q.warn(`${e} is not a function`),i[g.methodKeys].push(e),i[e]=t[e])},Vu=(i,t=()=>{})=>{Object.defineProperty(i,g.stateKeys,{value:[],enumerable:!1,configurable:!1,writable:!1});const e=Object.keys(t.apply(i)||{});e.push(["hasFocus"]);const s=e.length;for(let r=0;r<s;r++){const a=e[r];i[g.propKeys]!==void 0&&i[g.propKeys].indexOf(a)>-1&&q.error(`State ${a} already exists as a prop`),i[g.methodKeys]!==void 0&&i[g.methodKeys].indexOf(a)>-1&&q.error(`State ${a} already exists as a method`),i[g.stateKeys].push(a),Object.defineProperty(i,a,{get(){return this[g.state][a]},set(l){this[g.state][a]=l}})}},Xu=(i,t)=>{i[g.computedKeys]=[];for(let e in t)i[g.stateKeys]&&i[g.stateKeys].indexOf(e)>-1?q.error(`${e} already exists as a state variable`):i[g.propKeys]&&i[g.propKeys].indexOf(e)>-1?q.error(`${e} already exists as a prop`):i[g.methodKeys]&&i[g.methodKeys].indexOf(e)>-1?q.error(`${e} already exists as a method`):(typeof t[e]!="function"&&q.warn(`${e} is not a function`),i[g.computedKeys].push(e),Object.defineProperty(i,e,{get(){return t[e].apply(this)}}))},Gu=(i,t)=>{i[g.inputEvents]=[],Object.keys(t).forEach(e=>{typeof t[e]!="function"&&q.warn(`${t[e]} is not a function`),i[g.inputEvents][e]=t[e]})},Hu=(i,t)=>{let e=t;Array.isArray(t)===!1&&(i[g.routerHooks]=t.hooks,e=t.routes),i[g.routes]=[],Object.keys(e).forEach(s=>{i[g.routes][s]={...e[s],options:{inHistory:!0,...e[s].options}}})},Yu=(i,t)=>{i[g.watchKeys]=[],i[g.watchers]={};for(let e in t)typeof t[e]!="function"&&console.warn(`${e} is not a function`),i[g.watchKeys].push(e),i[g.watchers][e]=function(s,r){t[e].call(this,s,r)}};let Ku=0;function ju(i,t){i[g.identifier]=++Ku,i[g.effects]=[],kl(t.hooks,i[g.identifier]),zu(i,t.props),t.methods&&Wu(i,t.methods),Vu(i,t.state),t.computed&&Xu(i,t.computed),t.watch&&Yu(i,t.watch);const e=t.router!==void 0?t.router:t.routes;return e!==void 0&&Hu(i,e),t.input&&Gu(i,t.input),i}const qu=()=>li("Circle",{code:{render:function(t,e,s,r,a,l,u){const o=[],n={};return o[0]=this.element({parent:t||"root"},e),n.color=e.color,n.w=e.size,n.h=e.size,n.effects=[e.shader("radius",{radius:e.radius})],o[0].populate(n),o},effects:[function(t,e,s,r,a,l){e[0].set("color",t.color)},function(t,e,s,r,a,l){e[0].set("w",t.size)},function(t,e,s,r,a,l){e[0].set("h",t.size)},function(t,e,s,r,a,l){e[0].set("effects",[t.shader("radius",{radius:t.radius})])}],context:{}},props:[{key:"size",default:40},"color"],computed:{radius(){return this.size/2}}});let $o=null;const Qu=()=>li("RouterView",{code:{render:function(t,e,s,r,a,l,u){const o=[],n={};return o[0]=this.element({parent:t||"root"},e),n.w=t.node.width*(100/100),n.height=t.node.height*(100/100),o[0].populate(n),o},effects:[],context:{}},state(){return{activeView:null}},hooks:{ready(){$o=()=>Uo.navigate.apply(this),Uo.navigate.apply(this),window.addEventListener("hashchange",$o)},destroy(){window.removeEventListener("hashchange",$o,!1)},focus(){this.activeView&&this.activeView.$focus()}},input:{back(i){Uo.back.call(this)===!1&&this.parent.$focus(i)}}}),Zu=()=>li("Sprite",{code:{render:function(t,e,s,r,a,l,u){const o=[],n={};return o[0]=this.element({parent:t||"root"},e),n.w=t.node.width*(100/100),n.h=t.node.height*(100/100),n.texture=e.texture,n.color=e.color,o[0].populate(n),o},effects:[function(t,e,s,r,a,l){e[0].set("texture",t.texture)},function(t,e,s,r,a,l){e[0].set("color",t.color)}],context:{}},props:["image","map","frame","color"],state(){return{spriteTexture:null}},computed:{texture(){const i="frames"in this.map?Object.assign({},this.map.defaults||{},this.map.frames[this.frame]):this.map[this.frame];if(this.spriteTexture!==null&&i)return this[g.renderer]().createTexture("SubTexture",{texture:this.spriteTexture,x:i.x,y:i.y,width:i.w,height:i.h})}},hooks:{ready(){this.spriteTexture=this[g.renderer]().createTexture("ImageTexture",{src:this.image})}}}),Ju="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaMAAAAbCAYAAADRe+BYAAAAAXNSR0IArs4c6QAAGn9JREFUeF7tXQ1UVdWePxcWFg7ZA0sym5n0Tmk1z4+0YeVU4yo1h1jvPVBo1ETU8QvTdJlhsmKpi0he5jyXX0CKIWkpl3OlME3RGcdJixVEas+nJtq0sMwXN/kIgbxn1m+791n/ezifF0hr7lmrVV3O2Wfv/977//v//h/7uKTQFZJASAIhCYQkEJLADZaAy+j9iqIMkCRpliRJGeSeWkmSClwuV25X9VtRlOGSJI3m7wq6bd5Osqa/6OZSSZJKXC4X+h7UpSgKZABZQCbiKuHt4t+dvri8z5GG3E77rChKtCRJ9TY647ht0aaiKJAx5LCK/4Y5m23jneotiqJgvg84eCaYd6Cf4h/xqgo+ZwUO3h1wK5cx1oIYP/5eJUlSrsvl6tRakGUZbYr9tjQpKanL9lmw4w09F5LAzyUBXTDiih3KAspN76pwuVxjgu2koijYzGibbmg0tzQYoOPt5Zv0xydJ0hiXywWlYfviAAE5UBDSPu9YUep1QFEUvAdKWlyOAYPP26c2BhhM25ivXZo+4lWOxx8EGEHRw6iwdXHjQbu26LMwTlJsNUZusrEeHMuC9kGWZRgSYs/VJiUluZ32MXR/SAK/VAkYgREsdKaAKysr58fFxd0Di23Xrl1ScjKMTUl69913906cODHe6cDNFAVvcyAUHCxNO21rGIVv7969ufHx8djQGatWrZIyMq4bmj6frz4mJuYRSZJsMyQNQJS43e4/19bWThk+fPiA/Px8afhwkDpJKikpKUhJSXHEDujY9MDU7XZLtbWsq1BItvrMWQsAQxozZoxUUQEiYHrZapuzAYCcAOWSnJycv2RmZjZThiRJklMZGDIkyHfWLNgskkRkgXVh+g4N0NUuWLCgYN26dcMHDBiQjPUr5qyoqOjttLS0KVYC0syTui/q6+tX9O7duyU6OnoV2h09+rodEexakGUZG4vNnbiWL18uHT9+HCBsay84Gcv/13s9Hs/osLAwlZW7XK6KxMRES8Pa6/Ue4GuLic7v94+ZMGGC5Qb7OeXcXWMrLS3Nd7lcs+zKKtgxdwAjupnPnDlTNHDgwN9RhlRfXy9FR0dDuUsxMTGYDMuJ1GxooAO0eNWgQYNaX3jhhcfnzp2bhHuWLl0q5eayfWd7AyqKoro2uIJ5jr7vwIEDqqKIi4trqKysfJK7VUxlRl1ebW1tX99yyy3tlCFB+aBtroCklJQUS0Wp90L+Hii5ABYaJBhBtowRjBgxQqqqsiSCdsEISpJZIZcuXVp01113PaPHkKyAQmf8umCE9XXu3Dm2zgCoAFZ+YXGYMiS6HjZt2iSnp6eztYVLZ87gVrPFkCjQX758+d0+ffr8k1gP6Oenn34qDRgwgBkQbrfb8VqQZVnIGCyerYX9+/dLeXl5MERuSoYky7JiU/GoLE+r1A2eh4cEIKG7gD0ez4CwsDCsxwD2qygKmGlFUlKSobtUq7A5sLgnTJhgaPDx91EX+i8CjLpqbHSeXS7XCKN5sbkWDG/TAyNVuSckJHyzZ8+evvxpbNoSRVHgDmMmK1d4toFD0wumOGH9wgruBBip7q2YmBgGkiBCXDGiv6qCnj17tlRQUGBrc5PYgJSZmTk1JyfnAd5/LPTZBESowoTV7igeoSiKUEK1ly5dCo+Njf17vKezYERkAU0etAVHjZPm5uaiqKioxylD4uMNun0DgFbnbNq0aXveeustgB8TixVLpOuTsEPMeYqiKFgXTKkQkLM1ZxTkNPuCrf8rV678qVevXi+QfWGrXdxfXl4e3dbWxmJ933zzzbHz588/OnLkSKmpqUlKT0/Hv9U51CjGDq482hZk1aNHjxEJCQlsU3D2JYxB/MRiXTQG6Pf7TRUzna9uBCPxmg5xM1mW1bVhovxKkpKSdI0MPTAqLi6WvF6voWGt907OWtGFTu2vzipw+nx3jU0wo6+++qpu0aJF/bg+cURC7IxTD4xUK5goRNUipco9JSUFbgks9Bg7L9MBo+EbN24M7wwzIm3S4K+qCKgSIcpphB12xNumSQEqkFElDTYHVgewtmtp42ZqbX/99dfTzp07VzBq1KiIToCRaii4XOrUOhlrh2mk8nv66acr9u/fL+JatpWtk7VBmaLf778QHh5+O2cKtli4jvGB17O+0jkrKCiQYJzYnTMKcnpuQ+pqdWL0cJBQFeybb7557Nq1a4/OmTOHiS0vLw8MKYBpERYlaS1VjbsvNykpiS1MCyWOdc1csMGCUVKSSkDNprvW6/XWCncXUejqM2PHjpXE2PFjdXX10uzsbOYu0Shb39mzZ7MyMjL+BkYt5mTKlCnS4MGDWVunTp0qy8zM/IO2M3oKGyx8yZIlbNvpGTuyLMNFfd0nz69fChh18dgoE+6UXtFbJHpgpDINsulU9DfY7EF3jG7iYNx0ZFA0AQDg6KOK7erVqy2RkZGR/H4nihRgdD14cZ1xCaUGxT/A7/dfue+++27n8R1bCpMDEdoVcRgE1OH2SxaxhyCZEZMBxrpt27ZIEXPhfQdQMjeGQ3BgG7G9vb0pPj4+Cm2KuCFvJ6ikE6M+0PWgcbPZskDpnGNOYDBVVVWNURQFCheGFlMqRL625syAcdF9gTXCKD5Zx7b2hVB2iqL8MHXq1N+gjW3btjERcWWCdQdFyRiO1+udxfsjcateBSuakQcFi+fvvffeD9asWSPiu779+/e/lZeX9wRkAcUPABDX3Llz4Yo1VMx03igz6iowQvsUkI4fPy4tX76csU8Kwh6PZ/uOHTsm0/5ERUVJGzdulPBvXDNmzCjz+XwBgETBCOOMjY1l93JZdfDyeL3e4YqisKSgpqam+qioKGZ43+xg1E1jE8aurT3jRM/gXrtgpFoMBmDEXHhOX86Vst4mDtb1F9AFatVv3br18PTp0/+F32BLsdHGqDIiv1ekpqZuKy4uvq45rrs8bGV9kb75EhMTs3bv3r2OxreCBCM1wG4yFylOUpAVRWHWUEtLy9XIyMhbDdqtgoUezPxrn1EUhY0BivmOO+6Q6uvroZxtuVZFW8gqrKurK+vXrx9cCtqrdv369fnz588XSQG24jt03RNWRfeFyswJGFkaPVTZnT9//sTixYt/iw5v2LDhWN++fR8lilJti7riuLJWvRMiI6+xsVEFtldffbXsgQce+D3a2rdvn1xQUBBAY15//XUGzri6AIwMy0XQPo0ZGSl0Oj64KlNTU/FoCgdaxuBIP1WXPH7Pz88vvfPOO9n4Vq9eLR09ejRgT1Iw8nq9UmJiIhs3/ru4uBhuy4B1TMF93759344bN+4u3K/Xd85KA8oJYPwhlkXjWBp21sHVKsuyuo9RNpGYmGjL9d9dY6P9SUpKYvNL3cUYn6IoyHjNQKID2XCOyhO6CowsN52RoupCZhTwCtruTz/9VBMREYFYDNhIUG5FPTACW5gxY0ZzcXExzCu0i4VsmflG3UU8KwtZXQOqq6svDRs2jJlqQYIR3D0Zp0+fDp88eXKvqqoq9KkkIyNjFjILcTU3N7c9+eSTz1ZWVu62Ag9t7RMSItLT05EEMn7o0KGLNm/eHC+y04LNrqR9oG7L3bt3y4mJiUJpOlpfkK/f738zLCzsXu0YwWRnzpz5fWFhocgMtIxDoQ1togkHHGbUUKMH9zph+FTZbdiwofbgwYPol2/Lli0ro6Oj/8NIUVKWAGXd1NQ0AgpVWPFQnAUFBVCcPlmWsSYZI+T34j9VJU4B4mYAI3ROh3VV8PExNzF3XzKQ0jGEsc9pUhDzlHAlqmbTgVUOGTKEufbAJDB2vofVxAkB7j/88EPF+++/PxquQD0wEnEVkz0VoJg196t/o6wX4zKKfem9h4JRV47NCox4yAPrtkMpEIBq/PjxtrJsf5VgpEnv9Y0cOXLXsWPHhEA6y7ryR48ezZS7UMRz5sw5kZ+fD3eAJRBxxSYsHzAKUF6AiK+xsfHPUVFR/xwsGJEF2oEh0VRpriwt2SwFI7i8kLDiu54hwhYdssfgBsLFs8g6WJZWgKcBI9XVOnDgwK/PnDnzt1yJqC4qq/ZorVVTU9Op+Ph46ciRIw+gr5CBcIOmpqZeKi4uRualbbclBUudfqhxFx4zYrhklZYtlJ3f729IS0vrBSYAJVReXj5bJDUQdqC6/ajS4gxgqSzLeJZZHcJFB9esLMvMWqVsScTRONipacs3AxhRpUpiHj6v17tUuCcJIBkZE2r8lAKWVmE3NzerMSrOdlQmRe997733Prxy5crTemDk9XrB5JmLFvt50aJF2y9cuBDvdruTX3zxRdUVuGrVqvmVlZXrcR/YX0tLy/+Gh4dHYX7nzZt34Z133nm4ra1NgKjv+eefb7p48SL2AC5Lg6w7xob9oQEj1hmPx+MOCwtTMwyPHj0qFRYWFtXX168cMWLE6wsWLEgS7tL09PQV33777XKrvfurAyNt4eeMGTNyCgsLl3FBdEpZ8jbYIqeK+LPPPrv28MMPT7TjqqTunldeeSU9Ozt7I28XGw1WH7P8gmFGZLIZQ+LgiEVcpRO8D4hD6C0UCkaaFGvIkbXb0tJy4tZbb/1HPM8z+CwVsMG71DTv48ePVwwZMkQkSjhqj9aGpaamphYXF2MTMBZEU8YvXLjg79+//7/ZmTPa39OnT//hiy++2JmYmNgDv6N+LTo6+mVaxE3S6k37TpMNvvzyy7+89NJLg/i7mKFA2Y/W5URdWTwFvMrr9SJOOhqxjdTUVJFUBPcWq186ffp0w8svv9yLv0NlC13BjEwUTYAbyspNx2WCPcYMHsKAmK7XnFIhtbe3/xgREbHS7/eXmKVni/5pXVlgW1u2bGmJiIiI1KbSE/biS01NdT333HO/EfE16qaTZRl9ZWtsyZIlQ8+dO4d1xS64AQWA8bGoa4IaFHh3ZGTk3scff/xf8dwnn3wi5+bmCs+ArcSo7hibHTAirBJ6gTEkjFm4QPnatXSH282m040Z8Ww6W6httFi70k2nPTli/fr1GSQ2YNuNZoXg4u/Nzc0Xe/bsyVLfefaaKdtwcFyP2oUDBw6kjh07tthun0zkjEXCLJmSkhIW2Ley3Gl/CRiBAcBCZ24PnSwzR/Ed0V/aTkpKSnVJScnD/G+23GikHRbjunr1al1kZKSIGang2djY+D8a9mnJEHVk2qFAVRSEX7lyBSAXxksMTK1ZCjZW8wvLc/Xq1QEuZvG8SAEXSQ8ffPDBic2bNyP2xO4XLi+iNALm6EaBkdWYz58/v3Px4sXP8vtUQ3LatGn5Dz744CwR5yLtwNNQYBZjoQqbg4/0xhtvnOjfv/9vCQNl7lfBWuvq6vbMnz//GZrsYRDvUuPfnHGneL3eZE2yCbqrrumdO3f+V0REhIhls6EoinJh/PjxIovUtt7qrrFZMSMetxTTwEpfOBtnLJ0YFKoBpDf3pnVGBGwoGKmp38QCtKSQ3Q1G3IpH1guzqD766KOcxx57TDAi/GQrs4koNXFmHn4S7rSAYYhgOwEjU+alc/6c1X5Ehp0tMOLMR6Sf4rimgIJBg7RmS2uFxyCG8yJn9Dcgk4YyEVLbZLrotIOmcvnuu++qY2NjBRBZ9k+nLQZGFy9ebOnXr5/InqTrV5stGhR4kvMUkylLPnLkSOUTTzyBgljTNaepB7JcB7iBx3tU8KTMCjECYYFnZGQ0nD17FgyIyY+mJvM2AuawK8DIRjYdk7PNotdcj8fTtmPHjudJHEKrY5DOnYF4Dyxw4RLie7EiIiIiRdRXUeHqKewJEyaUTZo0iSV4CCtelmXIiDHKDRs27Dl48OAz8+bNa33qqaduwW96YJSVlfV2bGxsXN++ff9Bb0J55iP+pI6FJrCIZwoLCzeXl5f/O/9/256B7hqbAzBS9xItJbCI76miMj2BwSBriJ2fxY/XUV0BTt0dROl3OptOe2bY559/vm7o0KGIB4iAWjDZc1Ds4py3DmfxUQV64sSJ1sGDB7NFqpehqLMwdQ80NcimE4+bjkETz+hwRhplHiTAbkn/deq0VEWmiSn91e1238E765TNqP7911577ciyZctQWIsrmHlTa0K4q5PWhqmB7aampvbbbruN1XTZKaY1QwsKyMOGDfugpqYGadSmblC6WQmT6fAa6u7gykydMw5oLMYAqx4KuaGhoTYtLU0kZwgLX83044ohAIApWHVBzMhIVB3ASK/OyOBhoyxVcTDycIASAFHUGV2+fPnU7NmzH9S2p6eweVwNbUULBsrBCL/5ONBG5+Tk1A4aNIjJloJReXl5VVtbG4ycgFok7bsJGAUADJU/Ya943JGh1B1js+OmI8xI1Q0GYGRKWozOplM3NGdH4vQFlRWtXbv2xMKFC1kaqlPWQSeps2467blptbW1f3S73TNNLCozvRLwN8p8uMWbybOnsOigQNniW7hw4V/Xrl0rFLFpait/geoyoy/sDBihHdpfnt32Co8XqUWVyACMjY2N4m4kS+ZBs8jwzMSJE5s+/PDD2zgQqXU7mZmZp8gpFbaZEW2fH7skArZB1TLQmByy/yZNmoREiL/j71EPevV4PHXJycnCjecIPMWcaU9z52vvJf53U9lSBUSSDTqsTQAqUq9xkWC+Kl+tq+/QoUOH169fD7eP6tKjabgALQDS0aNHWRvaLDAKRvw5duaV3llsBnVGwaR2G+1JgBDWgVWSifBiZGzatCla1A5lZWVVnjx5cpxwKeMlVGETJYokD8iLHWQJGWzatIn1iRfPMta0devW6ttvv52xdgpGpaWlySKlGQkMa9asOYWkGbBnWjOlB0Z6ZxISJuHIGOuOsd0MYIQiR/gyr1ePdbzAFLAAYGk6Qm9tU10ARnaOB1Ff6yJHE1ihEmJQ165dOxQeHi6Cvh0eqaury7/nnntEpl6nEiSohR1MAgP629TUtCcqKup6JV/Hy5eQkPCfe/bsEYFRWy4Aq1O2OyMDCh55eXmVc+fOFS6uzrh+aSZVBym0trYevvvuu4fwGiZHqf4mspjtcrlgSYvEC0OAo66Z77//vm7mzJkCFHXnQwe41Pu0yoy46ALYhCZl2HDpUzAqLS1V60b0UnS7EIwsla5mnIYpz+vWrSvv168fOz6KK/UAo8ZIYXu9XtTKME8IQEowrJUrV1bU1NRgTpHNJxKBAsBIlmVWAI9n09LSahoaGoYKAdsAI5H56vvxxx979ezZM1xk1zU2Nva30lH0790xthsORhggLN+cnJz/XrZsGS0cFN8zAhBdP77bRvqqmUBvZjDicohesWLFl1OmTIlBbIBcBTt27KiZPHnyDELPg1ag/F16p184strBANDfBQsWxCB7jFxLR40aFXP48GFhuVtm09GHy8rKhp09e/bo4sWLaeFrRWVlZVlcXFxaMDKgrKgzRa566ys7O/vtuLi4ySKVm99TVV9fX967d2+kzwvQsGSHtH0NGDGr3e12R+I0d3JmnynIUzZSWlpat337drHHdOOa1OUhMudEcSZ11RHmhC53UPBZWVlTwsLCtglFC5der169cIIGTnRg8jBiRgZFnurxMCRmFAwzsgQjTYzN16NHD7deTIjGpHj8B8NS5WqgsBlg0dgIHmpvbz/57LPPskxRpOhzI4LJSZNNB8Yd3dra2jpx4kThrkebSLfH/SyQr2VGdF5ramq2f/zxx5PFUUh8nh3pk+4Y200BRnwCADqm3zVyemq3CTDRTBRbFrumLUcMyWZsR7zCSg5ssdo9fcEMnPnf6NFGjsCIzBs2iNF3mNj3nRyczye6bPVRvM7IgM5fMPOvJ1ZThiQynqgbx8bcWMnCiQKhcUk7rJqekaYFLno2oxnbo/uMjYWewECKYum6o3KkRw/9bGCEflLlDeA9dOjQsb17947E3wBWra2tq4S7rKGhgdVt8clS58RCYQfokLKysi+LiopEMgKKilfpnKsHEINMmXFOAAdZjAEfYaRg5PF4SkidTu3UqVPDGhsb783Ly/P36dMnDG1xlovCbXHQrehfLXebBtQ1dsfYuhqMPB5PBf+EB3RTQCGw3fiG9rh2xpCsCvocbGzcejODEfonzqjTfvEVckBQ2cqv7UQcnQUj2l8sYEqR2Jdv7Rbo6nRa7wvAGLuQg5NxintpxbwjxmbjZVi7mDP64UIofsigM98JosAs4hqQAVMcNi+q5O0AMFWWWkZH+9PBKOBuLgT5MW7ci7ZGI74i4iN1dXUN8+fPFwqcghFtW2UxP6ebTshz+/btf4qMjGSno5tcvqysrLMnT54ULl81A9FMYWs/FUGAmRkKRjVSvL7LyGhXi6H5kUPo9lKv1ztaABs9oikhIWHz9OnTWSYdZ7oU/E2PCeqOsXU1GPFTNMSHUANq0OyAkc19FbotJIGQBG5GCXAlK8oe6NEzOARUTcQpKir6qqysjH3ChJ/EbwqsNwKM0LGHHnoo9/77739Jm9INpt/Y2Fg+depU1P6JM9ICYtpmChttC8DR1M4wQ8GsYBcyrqqqOvDII48wb0R7ezsKaVf06NGjQJykITLlZs2aJY8bN47FbTWuQFbD5/V6dwmg4myKsWDBDFHUvGTJkphLly7hfhgHjCF119gcpHZbZtNRZrRz5876nTt3IpGGyTcERjej9gj1KSSBLpQAXFjt7e2qgtNruqGh4d20tDRxcoAdlyFthn5awK5OoezfMmak02fqljSSlpk7Wsts6fd5tNmu2uxQo76bufNVhqRx6dO2qIuX9k87H/S4Lz23cHeMjZE14voX80xlpZcBS9k87Sv1hDGDwe7C6cKtEWoqJIGQBG6EBHJzc5+vr69/Iy4ujh1lxK+S6urqquzsbLgzRZ2Mk7gXmrkRYIT3QhGKWiPqirbjhjVT2GhbgISegjUDUvQJCph+dgZuU7jb2AcUSQYyVch6BgB9D3XjqrEjyozInHbX2LoSjCAnjI/FjkLM6EZohNA7QxK4cRKAwlZrrQy64Si78MYNJfTmX5sEQszo1zajofGEJGAtAfHNHVGegSeQ2CD+sW4hdEdIAl0sgRAYdbFAQ82FJBCSQEgCIQk4l0AIjJzLLPRESAIhCYQkEJJAF0vg/wBMng85iZWBHAAAAABJRU5ErkJggg==",ec=()=>li("FPScounter",{code:{render:function(t,e,s,r,a,l,u){const o=[];let n,c,f,d=!1,p=0;const m={};o[0]=this.element({parent:t||"root"},d===!0?f:e),o[0].populate(m),d===!0&&(p-=1),t=o[0];const y={};o[1]=this.element({parent:t||"root"},d===!0?f:e),y.y=15,y.x=20,o[1].populate(y),d===!0&&(p-=1),t=o[1];const b={};o[2]=this.element({parent:t||"root"},d===!0?f:e),o[2].populate(b),d===!0&&(p-=1);const w=s.components&&s.components.Sprite||r.Sprite;t=o[2];const S={};o[3]=this.element({parent:t||"root"},d===!0?f:e),S.image=e.image,S.w=43,S.h=25,S.map=e.sprite,S.frame="fps";const _=[];if(typeof w<"u")for(let N in w.config.props)delete S[w.config.props[N]],_.push(w.config.props[N]);o[3].populate(S),d===!0&&(p-=1),t=o[3];const x={};x.image=e.image,x.w=43,x.h=25,x.map=e.sprite,x.frame="fps",n=x.is||"Sprite";let $;if(typeof n=="string"){if($=s.components&&s.components[n]||r[n],!$)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&($=n);o[4]=$.call(null,{props:x},o[3],e),o[4][Symbol.for("slots")][0]?(t=o[4][Symbol.for("slots")][0],f=o[4],d=!0):t=o[4][Symbol.for("children")][0],d===!0&&p===0&&(d=!1),t=o[2];const M={};o[5]=this.element({parent:t||"root"},d===!0?f:e),M.x=58,M.y=2,o[5].populate(M),d===!0&&(p-=1);const P=s.components&&s.components.Sprite||r.Sprite;t=o[5];const L={};o[6]=this.element({parent:t||"root"},d===!0?f:e),L.image=e.image,L.x=0,L.h=20,L.w=20,L.map=e.sprite,L.frame=e.fps[0];const U=[];if(typeof P<"u")for(let N in P.config.props)delete L[P.config.props[N]],U.push(P.config.props[N]);o[6].populate(L),d===!0&&(p-=1),t=o[6];const k={};k.image=e.image,k.x=0,k.h=20,k.w=20,k.map=e.sprite,c=e.fps[0],Array.isArray(c)===!0&&(c=l(c).slice(0)),k.frame=c,n=k.is||"Sprite";let F;if(typeof n=="string"){if(F=s.components&&s.components[n]||r[n],!F)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(F=n);o[7]=F.call(null,{props:k},o[6],e),o[7][Symbol.for("slots")][0]?(t=o[7][Symbol.for("slots")][0],f=o[7],d=!0):t=o[7][Symbol.for("children")][0],d===!0&&p===0&&(d=!1);const B=s.components&&s.components.Sprite||r.Sprite;t=o[5];const E={};o[8]=this.element({parent:t||"root"},d===!0?f:e),E.image=e.image,E.x=18,E.h=20,E.w=20,E.map=e.sprite,E.frame=e.fps[1];const C=[];if(typeof B<"u")for(let N in B.config.props)delete E[B.config.props[N]],C.push(B.config.props[N]);o[8].populate(E),d===!0&&(p-=1),t=o[8];const I={};I.image=e.image,I.x=18,I.h=20,I.w=20,I.map=e.sprite,c=e.fps[1],Array.isArray(c)===!0&&(c=l(c).slice(0)),I.frame=c,n=I.is||"Sprite";let v;if(typeof n=="string"){if(v=s.components&&s.components[n]||r[n],!v)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(v=n);o[9]=v.call(null,{props:I},o[8],e),o[9][Symbol.for("slots")][0]?(t=o[9][Symbol.for("slots")][0],f=o[9],d=!0):t=o[9][Symbol.for("children")][0],d===!0&&p===0&&(d=!1);const A=s.components&&s.components.Sprite||r.Sprite;t=o[5];const D={};o[10]=this.element({parent:t||"root"},d===!0?f:e),D.image=e.image,D.x=36,D.h=20,D.w=20,D.map=e.sprite,D.frame=e.fps[2];const z=[];if(typeof A<"u")for(let N in A.config.props)delete D[A.config.props[N]],z.push(A.config.props[N]);o[10].populate(D),d===!0&&(p-=1),t=o[10];const X={};X.image=e.image,X.x=36,X.h=20,X.w=20,X.map=e.sprite,c=e.fps[2],Array.isArray(c)===!0&&(c=l(c).slice(0)),X.frame=c,n=X.is||"Sprite";let G;if(typeof n=="string"){if(G=s.components&&s.components[n]||r[n],!G)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(G=n);o[11]=G.call(null,{props:X},o[10],e),o[11][Symbol.for("slots")][0]?(t=o[11][Symbol.for("slots")][0],f=o[11],d=!0):t=o[11][Symbol.for("children")][0],d===!0&&p===0&&(d=!1),t=o[1];const W={};o[12]=this.element({parent:t||"root"},d===!0?f:e),W.x=150,o[12].populate(W),d===!0&&(p-=1);const j=s.components&&s.components.Sprite||r.Sprite;t=o[12];const Y={};o[13]=this.element({parent:t||"root"},d===!0?f:e),Y.image=e.image,Y.y=2,Y.w=48,Y.h=25,Y.map=e.sprite,Y.frame="avg";const ae=[];if(typeof j<"u")for(let N in j.config.props)delete Y[j.config.props[N]],ae.push(j.config.props[N]);o[13].populate(Y),d===!0&&(p-=1),t=o[13];const K={};K.image=e.image,K.y=2,K.w=48,K.h=25,K.map=e.sprite,K.frame="avg",n=K.is||"Sprite";let J;if(typeof n=="string"){if(J=s.components&&s.components[n]||r[n],!J)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(J=n);o[14]=J.call(null,{props:K},o[13],e),o[14][Symbol.for("slots")][0]?(t=o[14][Symbol.for("slots")][0],f=o[14],d=!0):t=o[14][Symbol.for("children")][0],d===!0&&p===0&&(d=!1),t=o[12];const Z={};o[15]=this.element({parent:t||"root"},d===!0?f:e),Z.x=63,Z.y=2,o[15].populate(Z),d===!0&&(p-=1);const se=s.components&&s.components.Sprite||r.Sprite;t=o[15];const le={};o[16]=this.element({parent:t||"root"},d===!0?f:e),le.image=e.image,le.x=0,le.h=20,le.w=20,le.map=e.sprite,le.frame=e.avgFps[0];const ee=[];if(typeof se<"u")for(let N in se.config.props)delete le[se.config.props[N]],ee.push(se.config.props[N]);o[16].populate(le),d===!0&&(p-=1),t=o[16];const H={};H.image=e.image,H.x=0,H.h=20,H.w=20,H.map=e.sprite,c=e.avgFps[0],Array.isArray(c)===!0&&(c=l(c).slice(0)),H.frame=c,n=H.is||"Sprite";let Ue;if(typeof n=="string"){if(Ue=s.components&&s.components[n]||r[n],!Ue)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ue=n);o[17]=Ue.call(null,{props:H},o[16],e),o[17][Symbol.for("slots")][0]?(t=o[17][Symbol.for("slots")][0],f=o[17],d=!0):t=o[17][Symbol.for("children")][0],d===!0&&p===0&&(d=!1);const ie=s.components&&s.components.Sprite||r.Sprite;t=o[15];const fe={};o[18]=this.element({parent:t||"root"},d===!0?f:e),fe.image=e.image,fe.x=18,fe.h=20,fe.w=20,fe.map=e.sprite,fe.frame=e.avgFps[1];const we=[];if(typeof ie<"u")for(let N in ie.config.props)delete fe[ie.config.props[N]],we.push(ie.config.props[N]);o[18].populate(fe),d===!0&&(p-=1),t=o[18];const re={};re.image=e.image,re.x=18,re.h=20,re.w=20,re.map=e.sprite,c=e.avgFps[1],Array.isArray(c)===!0&&(c=l(c).slice(0)),re.frame=c,n=re.is||"Sprite";let Se;if(typeof n=="string"){if(Se=s.components&&s.components[n]||r[n],!Se)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Se=n);o[19]=Se.call(null,{props:re},o[18],e),o[19][Symbol.for("slots")][0]?(t=o[19][Symbol.for("slots")][0],f=o[19],d=!0):t=o[19][Symbol.for("children")][0],d===!0&&p===0&&(d=!1);const be=s.components&&s.components.Sprite||r.Sprite;t=o[15];const ve={};o[20]=this.element({parent:t||"root"},d===!0?f:e),ve.image=e.image,ve.x=36,ve.h=20,ve.w=20,ve.map=e.sprite,ve.frame=e.avgFps[2];const ze=[];if(typeof be<"u")for(let N in be.config.props)delete ve[be.config.props[N]],ze.push(be.config.props[N]);o[20].populate(ve),d===!0&&(p-=1),t=o[20];const Re={};Re.image=e.image,Re.x=36,Re.h=20,Re.w=20,Re.map=e.sprite,c=e.avgFps[2],Array.isArray(c)===!0&&(c=l(c).slice(0)),Re.frame=c,n=Re.is||"Sprite";let We;if(typeof n=="string"){if(We=s.components&&s.components[n]||r[n],!We)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(We=n);o[21]=We.call(null,{props:Re},o[20],e),o[21][Symbol.for("slots")][0]?(t=o[21][Symbol.for("slots")][0],f=o[21],d=!0):t=o[21][Symbol.for("children")][0],d===!0&&p===0&&(d=!1),t=o[1];const $e={};o[22]=this.element({parent:t||"root"},d===!0?f:e),$e.x=0,$e.y=40,o[22].populate($e),d===!0&&(p-=1);const Is=s.components&&s.components.Sprite||r.Sprite;t=o[22];const ue={};o[23]=this.element({parent:t||"root"},d===!0?f:e),ue.image=e.image,ue.x=-2,ue.w=47,ue.h=25,ue.map=e.sprite,ue.frame="min";const Ls=[];if(typeof Is<"u")for(let N in Is.config.props)delete ue[Is.config.props[N]],Ls.push(Is.config.props[N]);o[23].populate(ue),d===!0&&(p-=1),t=o[23];const _e={};_e.image=e.image,_e.x=-2,_e.w=47,_e.h=25,_e.map=e.sprite,_e.frame="min",n=_e.is||"Sprite";let ke;if(typeof n=="string"){if(ke=s.components&&s.components[n]||r[n],!ke)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ke=n);o[24]=ke.call(null,{props:_e},o[23],e),o[24][Symbol.for("slots")][0]?(t=o[24][Symbol.for("slots")][0],f=o[24],d=!0):t=o[24][Symbol.for("children")][0],d===!0&&p===0&&(d=!1),t=o[22];const fi={};o[25]=this.element({parent:t||"root"},d===!0?f:e),fi.x=58,fi.y=2,o[25].populate(fi),d===!0&&(p-=1);const Ie=s.components&&s.components.Sprite||r.Sprite;t=o[25];const Ee={};o[26]=this.element({parent:t||"root"},d===!0?f:e),Ee.image=e.image,Ee.x=0,Ee.h=20,Ee.w=20,Ee.map=e.sprite,Ee.frame=e.minFps[0];const Ps=[];if(typeof Ie<"u")for(let N in Ie.config.props)delete Ee[Ie.config.props[N]],Ps.push(Ie.config.props[N]);o[26].populate(Ee),d===!0&&(p-=1),t=o[26];const ce={};ce.image=e.image,ce.x=0,ce.h=20,ce.w=20,ce.map=e.sprite,c=e.minFps[0],Array.isArray(c)===!0&&(c=l(c).slice(0)),ce.frame=c,n=ce.is||"Sprite";let Bs;if(typeof n=="string"){if(Bs=s.components&&s.components[n]||r[n],!Bs)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Bs=n);o[27]=Bs.call(null,{props:ce},o[26],e),o[27][Symbol.for("slots")][0]?(t=o[27][Symbol.for("slots")][0],f=o[27],d=!0):t=o[27][Symbol.for("children")][0],d===!0&&p===0&&(d=!1);const Le=s.components&&s.components.Sprite||r.Sprite;t=o[25];const Ae={};o[28]=this.element({parent:t||"root"},d===!0?f:e),Ae.image=e.image,Ae.x=18,Ae.h=20,Ae.w=20,Ae.map=e.sprite,Ae.frame=e.minFps[1];const Fs=[];if(typeof Le<"u")for(let N in Le.config.props)delete Ae[Le.config.props[N]],Fs.push(Le.config.props[N]);o[28].populate(Ae),d===!0&&(p-=1),t=o[28];const he={};he.image=e.image,he.x=18,he.h=20,he.w=20,he.map=e.sprite,c=e.minFps[1],Array.isArray(c)===!0&&(c=l(c).slice(0)),he.frame=c,n=he.is||"Sprite";let Os;if(typeof n=="string"){if(Os=s.components&&s.components[n]||r[n],!Os)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Os=n);o[29]=Os.call(null,{props:he},o[28],e),o[29][Symbol.for("slots")][0]?(t=o[29][Symbol.for("slots")][0],f=o[29],d=!0):t=o[29][Symbol.for("children")][0],d===!0&&p===0&&(d=!1);const Pe=s.components&&s.components.Sprite||r.Sprite;t=o[25];const Me={};o[30]=this.element({parent:t||"root"},d===!0?f:e),Me.image=e.image,Me.x=36,Me.h=20,Me.w=20,Me.map=e.sprite,Me.frame=e.minFps[2];const Us=[];if(typeof Pe<"u")for(let N in Pe.config.props)delete Me[Pe.config.props[N]],Us.push(Pe.config.props[N]);o[30].populate(Me),d===!0&&(p-=1),t=o[30];const de={};de.image=e.image,de.x=36,de.h=20,de.w=20,de.map=e.sprite,c=e.minFps[2],Array.isArray(c)===!0&&(c=l(c).slice(0)),de.frame=c,n=de.is||"Sprite";let $s;if(typeof n=="string"){if($s=s.components&&s.components[n]||r[n],!$s)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&($s=n);o[31]=$s.call(null,{props:de},o[30],e),o[31][Symbol.for("slots")][0]?(t=o[31][Symbol.for("slots")][0],f=o[31],d=!0):t=o[31][Symbol.for("children")][0],d===!0&&p===0&&(d=!1),t=o[1];const De={};o[32]=this.element({parent:t||"root"},d===!0?f:e),De.x=150,De.y=40,o[32].populate(De),d===!0&&(p-=1);const Ve=s.components&&s.components.Sprite||r.Sprite;t=o[32];const Be={};o[33]=this.element({parent:t||"root"},d===!0?f:e),Be.image=e.image,Be.w=53,Be.h=25,Be.map=e.sprite,Be.frame="max";const Xe=[];if(typeof Ve<"u")for(let N in Ve.config.props)delete Be[Ve.config.props[N]],Xe.push(Ve.config.props[N]);o[33].populate(Be),d===!0&&(p-=1),t=o[33];const Ge={};Ge.image=e.image,Ge.w=53,Ge.h=25,Ge.map=e.sprite,Ge.frame="max",n=Ge.is||"Sprite";let Fe;if(typeof n=="string"){if(Fe=s.components&&s.components[n]||r[n],!Fe)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Fe=n);o[34]=Fe.call(null,{props:Ge},o[33],e),o[34][Symbol.for("slots")][0]?(t=o[34][Symbol.for("slots")][0],f=o[34],d=!0):t=o[34][Symbol.for("children")][0],d===!0&&p===0&&(d=!1),t=o[32];const rt={};o[35]=this.element({parent:t||"root"},d===!0?f:e),rt.x=63,rt.y=2,o[35].populate(rt),d===!0&&(p-=1);const He=s.components&&s.components.Sprite||r.Sprite;t=o[35];const pe={};o[36]=this.element({parent:t||"root"},d===!0?f:e),pe.image=e.image,pe.x=0,pe.h=20,pe.w=20,pe.map=e.sprite,pe.frame=e.maxFps[0];const Ro=[];if(typeof He<"u")for(let N in He.config.props)delete pe[He.config.props[N]],Ro.push(He.config.props[N]);o[36].populate(pe),d===!0&&(p-=1),t=o[36];const me={};me.image=e.image,me.x=0,me.h=20,me.w=20,me.map=e.sprite,c=e.maxFps[0],Array.isArray(c)===!0&&(c=l(c).slice(0)),me.frame=c,n=me.is||"Sprite";let Ye;if(typeof n=="string"){if(Ye=s.components&&s.components[n]||r[n],!Ye)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ye=n);o[37]=Ye.call(null,{props:me},o[36],e),o[37][Symbol.for("slots")][0]?(t=o[37][Symbol.for("slots")][0],f=o[37],d=!0):t=o[37][Symbol.for("children")][0],d===!0&&p===0&&(d=!1);const Ke=s.components&&s.components.Sprite||r.Sprite;t=o[35];const ge={};o[38]=this.element({parent:t||"root"},d===!0?f:e),ge.image=e.image,ge.x=18,ge.h=20,ge.w=20,ge.map=e.sprite,ge.frame=e.maxFps[1];const _o=[];if(typeof Ke<"u")for(let N in Ke.config.props)delete ge[Ke.config.props[N]],_o.push(Ke.config.props[N]);o[38].populate(ge),d===!0&&(p-=1),t=o[38];const ye={};ye.image=e.image,ye.x=18,ye.h=20,ye.w=20,ye.map=e.sprite,c=e.maxFps[1],Array.isArray(c)===!0&&(c=l(c).slice(0)),ye.frame=c,n=ye.is||"Sprite";let je;if(typeof n=="string"){if(je=s.components&&s.components[n]||r[n],!je)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(je=n);o[39]=je.call(null,{props:ye},o[38],e),o[39][Symbol.for("slots")][0]?(t=o[39][Symbol.for("slots")][0],f=o[39],d=!0):t=o[39][Symbol.for("children")][0],d===!0&&p===0&&(d=!1);const qe=s.components&&s.components.Sprite||r.Sprite;t=o[35];const xe={};o[40]=this.element({parent:t||"root"},d===!0?f:e),xe.image=e.image,xe.x=36,xe.h=20,xe.w=20,xe.map=e.sprite,xe.frame=e.maxFps[2];const Eo=[];if(typeof qe<"u")for(let N in qe.config.props)delete xe[qe.config.props[N]],Eo.push(qe.config.props[N]);o[40].populate(xe),d===!0&&(p-=1),t=o[40];const Te={};Te.image=e.image,Te.x=36,Te.h=20,Te.w=20,Te.map=e.sprite,c=e.maxFps[2],Array.isArray(c)===!0&&(c=l(c).slice(0)),Te.frame=c,n=Te.is||"Sprite";let Qe;if(typeof n=="string"){if(Qe=s.components&&s.components[n]||r[n],!Qe)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Qe=n);return o[41]=Qe.call(null,{props:Te},o[40],e),o[41][Symbol.for("slots")][0]?(t=o[41][Symbol.for("slots")][0],f=o[41],d=!0):t=o[41][Symbol.for("children")][0],d===!0&&p===0&&(d=!1),o},effects:[function(t,e,s,r,a,l){(typeof skip6>"u"||skip6.indexOf("frame")===-1)&&e[6].set("frame",t.fps[0])},function(t,e,s,r,a,l){e[7][Symbol.for("props")].frame=t.fps[0]},function(t,e,s,r,a,l){(typeof skip8>"u"||skip8.indexOf("frame")===-1)&&e[8].set("frame",t.fps[1])},function(t,e,s,r,a,l){e[9][Symbol.for("props")].frame=t.fps[1]},function(t,e,s,r,a,l){(typeof skip10>"u"||skip10.indexOf("frame")===-1)&&e[10].set("frame",t.fps[2])},function(t,e,s,r,a,l){e[11][Symbol.for("props")].frame=t.fps[2]},function(t,e,s,r,a,l){(typeof skip16>"u"||skip16.indexOf("frame")===-1)&&e[16].set("frame",t.avgFps[0])},function(t,e,s,r,a,l){e[17][Symbol.for("props")].frame=t.avgFps[0]},function(t,e,s,r,a,l){(typeof skip18>"u"||skip18.indexOf("frame")===-1)&&e[18].set("frame",t.avgFps[1])},function(t,e,s,r,a,l){e[19][Symbol.for("props")].frame=t.avgFps[1]},function(t,e,s,r,a,l){(typeof skip20>"u"||skip20.indexOf("frame")===-1)&&e[20].set("frame",t.avgFps[2])},function(t,e,s,r,a,l){e[21][Symbol.for("props")].frame=t.avgFps[2]},function(t,e,s,r,a,l){(typeof skip26>"u"||skip26.indexOf("frame")===-1)&&e[26].set("frame",t.minFps[0])},function(t,e,s,r,a,l){e[27][Symbol.for("props")].frame=t.minFps[0]},function(t,e,s,r,a,l){(typeof skip28>"u"||skip28.indexOf("frame")===-1)&&e[28].set("frame",t.minFps[1])},function(t,e,s,r,a,l){e[29][Symbol.for("props")].frame=t.minFps[1]},function(t,e,s,r,a,l){(typeof skip30>"u"||skip30.indexOf("frame")===-1)&&e[30].set("frame",t.minFps[2])},function(t,e,s,r,a,l){e[31][Symbol.for("props")].frame=t.minFps[2]},function(t,e,s,r,a,l){(typeof skip36>"u"||skip36.indexOf("frame")===-1)&&e[36].set("frame",t.maxFps[0])},function(t,e,s,r,a,l){e[37][Symbol.for("props")].frame=t.maxFps[0]},function(t,e,s,r,a,l){(typeof skip38>"u"||skip38.indexOf("frame")===-1)&&e[38].set("frame",t.maxFps[1])},function(t,e,s,r,a,l){e[39][Symbol.for("props")].frame=t.maxFps[1]},function(t,e,s,r,a,l){(typeof skip40>"u"||skip40.indexOf("frame")===-1)&&e[40].set("frame",t.maxFps[2])},function(t,e,s,r,a,l){e[41][Symbol.for("props")].frame=t.maxFps[2]}],context:{}},state(){return{image:Ju,sprite:{defaults:{y:1,w:20,h:20},frames:{"-":{x:-1e3},0:{x:1},1:{x:23},2:{x:45},3:{x:67},4:{x:89},5:{x:111},6:{x:133},7:{x:155},8:{x:177},9:{x:199},avg:{x:221,w:48,h:25},fps:{x:271,w:43,h:25},max:{x:316,w:53,h:25},min:{x:371,w:47,h:25}}},fps:"---",avgFps:"---",minFps:"---",maxFps:"---"}},hooks:{ready(){let i=1e4,t=0,e=0,s=0,r=0;vi.on("fpsUpdate",(a,{fps:l})=>{i=Math.min(l,i),t=Math.max(l,t),s+=l,r++,e=Math.round(s/r),this.fps=l.toString().padStart(3,"0"),this.avgFps=e.toString().padStart(3,"0"),this.minFps=i.toString().padStart(3,"0"),this.maxFps=t.toString().padStart(3,"0")})}}}),tc=()=>({Circle:qu(),RouterView:Qu(),Sprite:Zu(),FPScounter:ec()}),sc={name:"log",plugin(){return jn("App")}},nn={log:sc},Ia=(i,t="",e={})=>{let s;if(typeof t=="object"?e=t:s=t,typeof i=="function"){if(s===void 0)throw Error("Error registering plugin: name is required for plugin");nn[s]={plugin:i,options:e}}else i.plugin&&Ia(i.plugin,s||i.name,e)};let Do;const Xn=i=>{throw new Error(`Parameter ${i} is required`)},li=(i=Xn("name"),t=Xn("config"))=>{let e;const s=function(a,l,u,o){this.componentId=El(i),this.lifecycle=Object.assign(Object.create(Fl),{component:this,previous:null,current:null}),this.parent=u,this.rootParent=o,this[g.holder]=l,this[g.id]=Al(),this[g.props]=Vo(a.props||{},Ne.get("reactivityMode")),this[g.timeouts]=[],this[g.intervals]=[],this[g.originalState]=t.state&&typeof t.state=="function"&&t.state.apply(this)||{},this[g.originalState].hasFocus=!1,this[g.state]=Vo(this[g.originalState],Ne.get("reactivityMode")),this.lifecycle.state="init",this[g.children]=t.code.render.apply(cn,[l,this,t,Do,Gr,Es,q])||[],this[g.wrapper]=this[g.children][0],this[g.slots]=this[g.children].filter(c=>c[g.isSlot]),t.hooks&&(t.hooks.frameTick&&vi.on("frameTick",(c,f)=>No("frameTick",this[g.identifier],this,[f])),t.hooks.idle&&vi.on("idle",()=>{No("idle",this[g.identifier],this)}),t.hooks.attach&&this[g.wrapper].node.on("inBounds",()=>{this.lifecycle.state="attach"}),t.hooks.detach&&this[g.wrapper].node.on("outOfBounds",(c,{previous:f})=>{f>0&&(this.lifecycle.state="detach")}),t.hooks.enter&&this[g.wrapper].node.on("inViewport",()=>{this.lifecycle.state="enter"}),t.hooks.exit&&this[g.wrapper].node.on("outOfViewport",()=>{this.lifecycle.state="exit"}));const n=t.code.effects;for(let c=0;c<n.length;c++){const f=()=>{n[c](this,this[g.children],t,Do,o,Gr)};this[g.effects].push(f),Gr(f)}if(this[g.watchers]){const c=Object.keys(this[g.watchers]),f=c.length;for(let d=0;d<f;d++){let p=this,m=c[d];const y=m;if(m.indexOf(".")>-1){const w=m.split(".");m=w.pop();for(let S=0;S<w.length;S++)p=p[w[S]]}let b=this[m];Gr((w=!1)=>{const S=p[m];(b!==S||w===!0)&&(this[g.watchers][y].apply(this,[S,b]),b=S)})}}return setTimeout(()=>this.lifecycle.state="ready"),this},r=(a={},l,u,o)=>{if(_s[g.launched]===!1){const n=Object.keys(nn),c=n.length,f={};for(let d=0;d<c;d++){const p=n[d],m=`$${p}`;m in _s&&q.warn(`"${p}" (this.${m}) already exists as a property or plugin on the Base Component. You may be overwriting built-in functionality. Proceed with care!`);const y=nn[p];f[m]={value:Object.defineProperties(y.plugin(y.options),ka),writable:!1,enumerable:!0,configurable:!0}}Object.defineProperties(_s,f);for(const d in f)Object.defineProperties(_s[d],f),delete _s[d][d];Do=tc(),_s[g.launched]=!0}return e===void 0&&(q.debug(`Setting up ${i} component`),e=ju(Object.create(_s),t)),t.code===void 0&&(q.debug(`Generating code for ${i} component`),t.code=bl.call(t,Tl(t.template))),s.call(Object.create(e),a,l,u,o)};return r.config=t,r[g.isComponent]=!0,r},ic=i=>{const t={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Enter:"enter"," ":"space",Backspace:"back",Escape:"escape",37:"left",39:"right",38:"up",40:"down",13:"enter",32:"space",8:"back",27:"escape"};i.hooks=i.hooks||{};let e,s,r;return i.hooks[g.destroy]=function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",s)},i.hooks[g.init]=function(){const a={...t,...Ne.get("keymap",{})};e=async l=>{const u=a[l.key]||a[l.keyCode]||l.key||l.keyCode;this[g.inputEvents]!==void 0&&this[g.inputEvents].intercept!==void 0&&(l=await this[g.inputEvents].intercept.call(this,l),!(l instanceof KeyboardEvent))||(ei.input(u,l),clearTimeout(r),r=setTimeout(()=>{ei.hold=!0},Ne.get("holdTimeout",Ta)))},s=l=>{const u=on.get(l.code);u!==void 0&&typeof u=="function"&&(on.delete(l.code),u()),clearTimeout(r),ei.hold=!1},document.addEventListener("keydown",e),document.addEventListener("keyup",s),setTimeout(()=>ei.set(this))},li("App",i)},ut={Component:li,Application:ic,Launch:Cu,Plugin:Ia},Gn=()=>"0x"+Math.floor(Math.random()*16777215).toString(16)+"FF";function Je(i,t){return Math.floor(Math.random()*(t-i+1))+i}const Hn=600,Yn=800,rc=ut.Component("Home",{code:{render:function(t,e,s,r,a,l,u){const o=[],n={};o[0]=this.element({parent:t||"root"},e),n.w=1920,n.h=1080,n.color="0xf0f0f0ff",o[0].populate(n),t=o[0];const c=[];let f,d;const p=(y=[],b,w)=>{const S=l(y),_=new Set;let x=S.length;const $={};for(f=$.from||0,d=("to"in $)?$.to:S.length;x--;){const U=S[x];x<d&&x>=f&&_.add(""+U.key)}let M=w.length;for(;M--;)if(_.has(w[M])===!1){const U=w[M];b[1][U]&&b[1][U].destroy(),delete b[1][U]}w.length=0;const P=S.length,L=[];for(let U=0;U<P;U++){if(U<f||U>=d)continue;const k=Object.create(e);t=b[0],k.item=S[U],k.undefined=U,k.key=""+k.item.key,w.push(k.key),t=b[0],b[1]===void 0&&(b[1]={});const F={};b[1][k.key]===void 0&&(b[1][k.key]=this.element({parent:t||"root"},e)),F.w=k.item.width,F.h=k.item.height,F.x=k.item.x,F.y=k.item.y,F.color=k.item.color,F.effects=[{type:"radius",props:{radius:k.item.radius}}],b[1][k.key].nodeId===void 0&&b[1][k.key].populate(F);let B=()=>{b[1][k.key].set("w",k.item.width)};a(B,null),L.push(B);let E=()=>{b[1][k.key].set("h",k.item.height)};a(E,null),L.push(E);let C=()=>{b[1][k.key].set("x",k.item.x)};a(C,null),L.push(C);let I=()=>{b[1][k.key].set("y",k.item.y)};a(I,null),L.push(I);let v=()=>{b[1][k.key].set("color",k.item.color)};a(v,null),L.push(v);let A=()=>{b[1][k.key].set("effects",[{type:"radius",props:{radius:k.item.radius}}])};a(A,null),L.push(A)}return L};let m;return a(()=>{e[Symbol.for("removeGlobalEffects")](m),m=null,m=p(e.items,o,c)},["items"]),o},effects:[],context:{}},state(){return{items:new Array}},hooks:{init(){const i=[];for(let t=0;t<1e3;t++)i.push({key:t,width:Je(50,100),height:Je(50,100),x:Je(0,Yn),y:Je(0,Hn),radius:5,color:Gn()});this.items=i,setInterval(()=>{const t=[];for(let e=0;e<1e3;e++)t.push({key:e,width:Je(50,100),height:Je(50,100),x:Je(0,Yn),y:Je(0,Hn),radius:Je(0,50),color:Gn()});this.items=t},2e3)}}}),La=ut.Component("Tile",{code:{render:function(t,e,s,r,a,l,u){const o=[],n={};return o[0]=this.element({parent:t||"root"},e),n.y=e.y,n.x=e.x,n.w=e.w,n.h=e.h,n.color=e.color,n.effects=[{type:"radius",props:{radius:e.radius}}],o[0].populate(n),o},effects:[function(t,e,s,r,a,l){e[0].set("y",t.y)},function(t,e,s,r,a,l){e[0].set("x",t.x)},function(t,e,s,r,a,l){e[0].set("w",t.w)},function(t,e,s,r,a,l){e[0].set("h",t.h)},function(t,e,s,r,a,l){e[0].set("color",t.color)},function(t,e,s,r,a,l){e[0].set("effects",[{type:"radius",props:{radius:t.radius}}])}],context:{}},props:["x","y","w","h","radius","color"]}),oc=()=>"0x"+Math.floor(Math.random()*16777215).toString(16)+"FF";function ci(i,t){return Math.floor(Math.random()*(t-i+1))+i}const nc=600,ac=800,lc=ut.Component("TilePage",{components:{Tile:La},code:{render:function(t,e,s,r,a,l,u){const o=[];let n,c,f,d=!1;const p={};o[0]=this.element({parent:t||"root"},d===!0?f:e),p.w=1920,p.h=1080,p.color="0xf0f0f0ff",o[0].populate(p),t=o[0];const m=[];let y,b;const w=(_=[],x,$)=>{const M=l(_),P=new Set;let L=M.length;const U={};for(y=U.from||0,b=("to"in U)?U.to:M.length;L--;){const E=M[L];L<b&&L>=y&&P.add(""+E.key)}let k=$.length;for(;k--;)if(P.has($[k])===!1){const E=$[k];x[1][E]&&x[1][E].destroy(),delete x[1][E],x[2][E]&&x[2][E].destroy(),delete x[2][E]}$.length=0;const F=M.length,B=[];for(let E=0;E<F;E++){if(E<y||E>=b)continue;const C=Object.create(e);t=x[0],C.item=M[E],C.undefined=E,C.key=""+C.item.key,$.push(C.key);const I=s.components&&s.components.Tile||r.Tile;x[1]===void 0&&(x[1]={});const v={};x[1][C.key]===void 0&&(x[1][C.key]=this.element({parent:t||"root"},d===!0?f:e)),v.w=C.item.width,v.h=C.item.height,v.x=C.item.x,v.y=C.item.y,v.radius=C.item.radius;const A=[];if(typeof I<"u")for(let Y in I.config.props)delete v[I.config.props[Y]],A.push(I.config.props[Y]);x[1][C.key].nodeId===void 0&&x[1][C.key].populate(v),x[2]===void 0&&(x[2]={}),t=x[1][C.key];const D={};if(x[2][C.key]===void 0){c=C.item.width,Array.isArray(c)===!0&&(c=l(c).slice(0)),D.w=c,c=C.item.height,Array.isArray(c)===!0&&(c=l(c).slice(0)),D.h=c,c=C.item.x,Array.isArray(c)===!0&&(c=l(c).slice(0)),D.x=c,c=C.item.y,Array.isArray(c)===!0&&(c=l(c).slice(0)),D.y=c,c=C.item.color,Array.isArray(c)===!0&&(c=l(c).slice(0)),D.color=c,c=C.item.radius,Array.isArray(c)===!0&&(c=l(c).slice(0)),D.radius=c,n=D.is||"Tile";let Y;if(typeof n=="string"){if(Y=s.components&&s.components[n]||r[n],!Y)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Y=n);x[2][C.key]=Y.call(null,{props:D},x[1][C.key],e),x[2][C.key][Symbol.for("slots")][0]?(t=x[2][C.key][Symbol.for("slots")][0],f=x[2][C.key],d=!0):t=x[2][C.key][Symbol.for("children")][0]}let z=()=>{(typeof A>"u"||A.indexOf("w")===-1)&&x[1][C.key].set("w",C.item.width)};a(z,null),B.push(z);let X=()=>{(typeof A>"u"||A.indexOf("h")===-1)&&x[1][C.key].set("h",C.item.height)};a(X,null),B.push(X);let G=()=>{(typeof A>"u"||A.indexOf("x")===-1)&&x[1][C.key].set("x",C.item.x)};a(G,null),B.push(G);let W=()=>{(typeof A>"u"||A.indexOf("y")===-1)&&x[1][C.key].set("y",C.item.y)};a(W,null),B.push(W);let j=()=>{(typeof A>"u"||A.indexOf("radius")===-1)&&x[1][C.key].set("radius",C.item.radius)};a(j,null),B.push(j),x[2][C.key][Symbol.for("props")].w=C.item.width,x[2][C.key][Symbol.for("props")].h=C.item.height,x[2][C.key][Symbol.for("props")].x=C.item.x,x[2][C.key][Symbol.for("props")].y=C.item.y,x[2][C.key][Symbol.for("props")].color=C.item.color,x[2][C.key][Symbol.for("props")].radius=C.item.radius}return B};let S;return a(()=>{e[Symbol.for("removeGlobalEffects")](S),S=null,S=w(e.items,o,m)},["items"]),o},effects:[],context:{}},state(){return{items:new Array}},hooks:{init(){setInterval(()=>{const i=[];for(let t=0;t<1e3;t++)i.push({key:t,width:ci(50,100),height:ci(50,100),x:ci(0,ac),y:ci(0,nc),radius:ci(0,50),color:oc()});this.items=i},2e3)}}}),fc=ut.Component("TileOne",{code:{render:function(t,e,s,r,a,l,u){const o=[],n={};return o[0]=this.element({parent:t||"root"},e),n.y=e.item.y,n.x=e.item.x,n.w=e.item.width,n.h=e.item.height,n.color=e.item.color,n.effects=[{type:"radius",props:{radius:e.item.radius}}],o[0].populate(n),o},effects:[function(t,e,s,r,a,l){e[0].set("y",t.item.y)},function(t,e,s,r,a,l){e[0].set("x",t.item.x)},function(t,e,s,r,a,l){e[0].set("w",t.item.width)},function(t,e,s,r,a,l){e[0].set("h",t.item.height)},function(t,e,s,r,a,l){e[0].set("color",t.item.color)},function(t,e,s,r,a,l){e[0].set("effects",[{type:"radius",props:{radius:t.item.radius}}])}],context:{}},props:["item"]}),uc=()=>"0x"+Math.floor(Math.random()*16777215).toString(16)+"FF";function hi(i,t){return Math.floor(Math.random()*(t-i+1))+i}const cc=600,hc=800,dc=ut.Component("TileOnePage",{components:{TileOne:fc},code:{render:function(t,e,s,r,a,l,u){const o=[];let n,c,f,d=!1;const p={};o[0]=this.element({parent:t||"root"},d===!0?f:e),p.w=1920,p.h=1080,p.color="0xf0f0f0ff",o[0].populate(p),t=o[0];const m=[];let y,b;const w=(_=[],x,$)=>{const M=l(_),P=new Set;let L=M.length;const U={};for(y=U.from||0,b=("to"in U)?U.to:M.length;L--;){const E=M[L];L<b&&L>=y&&P.add(""+E.key)}let k=$.length;for(;k--;)if(P.has($[k])===!1){const E=$[k];x[1][E]&&x[1][E].destroy(),delete x[1][E],x[2][E]&&x[2][E].destroy(),delete x[2][E]}$.length=0;const F=M.length,B=[];for(let E=0;E<F;E++){if(E<y||E>=b)continue;const C=Object.create(e);t=x[0],C.item=M[E],C.undefined=E,C.key=""+C.item.key,$.push(C.key);const I=s.components&&s.components.TileOne||r.TileOne;x[1]===void 0&&(x[1]={});const v={};x[1][C.key]===void 0&&(x[1][C.key]=this.element({parent:t||"root"},d===!0?f:e)),v.item=C.item;const A=[];if(typeof I<"u")for(let z in I.config.props)delete v[I.config.props[z]],A.push(I.config.props[z]);x[1][C.key].nodeId===void 0&&x[1][C.key].populate(v),x[2]===void 0&&(x[2]={}),t=x[1][C.key];const D={};if(x[2][C.key]===void 0){c=C.item,Array.isArray(c)===!0&&(c=l(c).slice(0)),D.item=c,n=D.is||"TileOne";let z;if(typeof n=="string"){if(z=s.components&&s.components[n]||r[n],!z)throw new Error('Component "TileOne" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(z=n);x[2][C.key]=z.call(null,{props:D},x[1][C.key],e),x[2][C.key][Symbol.for("slots")][0]?(t=x[2][C.key][Symbol.for("slots")][0],f=x[2][C.key],d=!0):t=x[2][C.key][Symbol.for("children")][0]}}return B};let S;return a(()=>{e[Symbol.for("removeGlobalEffects")](S),S=null,S=w(e.items,o,m)},["items"]),a(()=>{e.item;for(let _=0;_<e.items.length;_++){if(_<y||_>=b)continue;const x={};x.undefined=_,x.item=e.items[_],x.key=x.item.key,(typeof skip1>"u"||skip1.indexOf("item")===-1)&&o[1][x.key].set("item",x.item)}}),a(()=>{e.item;for(let _=0;_<e.items.length;_++){if(_<y||_>=b)continue;const x={};x.undefined=_,x.item=e.items[_],x.key=x.item.key,o[2][x.key][Symbol.for("props")].item=x.item}}),o},effects:[],context:{}},state(){return{items:new Array}},hooks:{init(){setInterval(()=>{const i=[];for(let t=0;t<1e3;t++)i.push({key:t,width:hi(50,100),height:hi(50,100),x:hi(0,hc),y:hi(0,cc),radius:hi(0,50),color:uc()});this.items=i},2e3)}}}),pc=ut.Application({code:{render:function(t,e,s,r,a,l,u){const o=[];let n,c,f=!1,d=0;const p={};o[0]=this.element({parent:t||"root"},f===!0?c:e),p.w=1920,p.h=1080,p.color="0x797777ff",o[0].populate(p),f===!0&&(d-=1);const m=s.components&&s.components.Tile||r.Tile;t=o[0];const y={};o[1]=this.element({parent:t||"root"},f===!0?c:e),y.width=35,y.height=26,y.x=475,y.y=78,y.radius=62;const b=[];if(typeof m<"u")for(let T in m.config.props)delete y[m.config.props[T]],b.push(m.config.props[T]);o[1].populate(y),f===!0&&(d-=1),t=o[1];const w={};w.width=35,w.height=26,w.x=475,w.y=78,w.radius=62,n=w.is||"Tile";let S;if(typeof n=="string"){if(S=s.components&&s.components[n]||r[n],!S)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(S=n);o[2]=S.call(null,{props:w},o[1],e),o[2][Symbol.for("slots")][0]?(t=o[2][Symbol.for("slots")][0],c=o[2],f=!0):t=o[2][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const _=s.components&&s.components.Tile||r.Tile;t=o[0];const x={};o[3]=this.element({parent:t||"root"},f===!0?c:e),x.width=28,x.height=57,x.x=547,x.y=277,x.radius=66;const $=[];if(typeof _<"u")for(let T in _.config.props)delete x[_.config.props[T]],$.push(_.config.props[T]);o[3].populate(x),f===!0&&(d-=1),t=o[3];const M={};M.width=28,M.height=57,M.x=547,M.y=277,M.radius=66,n=M.is||"Tile";let P;if(typeof n=="string"){if(P=s.components&&s.components[n]||r[n],!P)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(P=n);o[4]=P.call(null,{props:M},o[3],e),o[4][Symbol.for("slots")][0]?(t=o[4][Symbol.for("slots")][0],c=o[4],f=!0):t=o[4][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const L=s.components&&s.components.Tile||r.Tile;t=o[0];const U={};o[5]=this.element({parent:t||"root"},f===!0?c:e),U.width=41,U.height=41,U.x=768,U.y=869,U.radius=51;const k=[];if(typeof L<"u")for(let T in L.config.props)delete U[L.config.props[T]],k.push(L.config.props[T]);o[5].populate(U),f===!0&&(d-=1),t=o[5];const F={};F.width=41,F.height=41,F.x=768,F.y=869,F.radius=51,n=F.is||"Tile";let B;if(typeof n=="string"){if(B=s.components&&s.components[n]||r[n],!B)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(B=n);o[6]=B.call(null,{props:F},o[5],e),o[6][Symbol.for("slots")][0]?(t=o[6][Symbol.for("slots")][0],c=o[6],f=!0):t=o[6][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const E=s.components&&s.components.Tile||r.Tile;t=o[0];const C={};o[7]=this.element({parent:t||"root"},f===!0?c:e),C.width=69,C.height=66,C.x=613,C.y=130,C.radius=25;const I=[];if(typeof E<"u")for(let T in E.config.props)delete C[E.config.props[T]],I.push(E.config.props[T]);o[7].populate(C),f===!0&&(d-=1),t=o[7];const v={};v.width=69,v.height=66,v.x=613,v.y=130,v.radius=25,n=v.is||"Tile";let A;if(typeof n=="string"){if(A=s.components&&s.components[n]||r[n],!A)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(A=n);o[8]=A.call(null,{props:v},o[7],e),o[8][Symbol.for("slots")][0]?(t=o[8][Symbol.for("slots")][0],c=o[8],f=!0):t=o[8][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const D=s.components&&s.components.Tile||r.Tile;t=o[0];const z={};o[9]=this.element({parent:t||"root"},f===!0?c:e),z.width=25,z.height=61,z.x=953,z.y=416,z.radius=52;const X=[];if(typeof D<"u")for(let T in D.config.props)delete z[D.config.props[T]],X.push(D.config.props[T]);o[9].populate(z),f===!0&&(d-=1),t=o[9];const G={};G.width=25,G.height=61,G.x=953,G.y=416,G.radius=52,n=G.is||"Tile";let W;if(typeof n=="string"){if(W=s.components&&s.components[n]||r[n],!W)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(W=n);o[10]=W.call(null,{props:G},o[9],e),o[10][Symbol.for("slots")][0]?(t=o[10][Symbol.for("slots")][0],c=o[10],f=!0):t=o[10][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const j=s.components&&s.components.Tile||r.Tile;t=o[0];const Y={};o[11]=this.element({parent:t||"root"},f===!0?c:e),Y.width=66,Y.height=40,Y.x=284,Y.y=55,Y.radius=36;const ae=[];if(typeof j<"u")for(let T in j.config.props)delete Y[j.config.props[T]],ae.push(j.config.props[T]);o[11].populate(Y),f===!0&&(d-=1),t=o[11];const K={};K.width=66,K.height=40,K.x=284,K.y=55,K.radius=36,n=K.is||"Tile";let J;if(typeof n=="string"){if(J=s.components&&s.components[n]||r[n],!J)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(J=n);o[12]=J.call(null,{props:K},o[11],e),o[12][Symbol.for("slots")][0]?(t=o[12][Symbol.for("slots")][0],c=o[12],f=!0):t=o[12][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Z=s.components&&s.components.Tile||r.Tile;t=o[0];const se={};o[13]=this.element({parent:t||"root"},f===!0?c:e),se.width=69,se.height=44,se.x=23,se.y=879,se.radius=66;const le=[];if(typeof Z<"u")for(let T in Z.config.props)delete se[Z.config.props[T]],le.push(Z.config.props[T]);o[13].populate(se),f===!0&&(d-=1),t=o[13];const ee={};ee.width=69,ee.height=44,ee.x=23,ee.y=879,ee.radius=66,n=ee.is||"Tile";let H;if(typeof n=="string"){if(H=s.components&&s.components[n]||r[n],!H)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(H=n);o[14]=H.call(null,{props:ee},o[13],e),o[14][Symbol.for("slots")][0]?(t=o[14][Symbol.for("slots")][0],c=o[14],f=!0):t=o[14][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Ue=s.components&&s.components.Tile||r.Tile;t=o[0];const ie={};o[15]=this.element({parent:t||"root"},f===!0?c:e),ie.width=56,ie.height=23,ie.x=484,ie.y=349,ie.radius=25;const fe=[];if(typeof Ue<"u")for(let T in Ue.config.props)delete ie[Ue.config.props[T]],fe.push(Ue.config.props[T]);o[15].populate(ie),f===!0&&(d-=1),t=o[15];const we={};we.width=56,we.height=23,we.x=484,we.y=349,we.radius=25,n=we.is||"Tile";let re;if(typeof n=="string"){if(re=s.components&&s.components[n]||r[n],!re)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(re=n);o[16]=re.call(null,{props:we},o[15],e),o[16][Symbol.for("slots")][0]?(t=o[16][Symbol.for("slots")][0],c=o[16],f=!0):t=o[16][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Se=s.components&&s.components.Tile||r.Tile;t=o[0];const be={};o[17]=this.element({parent:t||"root"},f===!0?c:e),be.width=23,be.height=33,be.x=441,be.y=601,be.radius=34;const ve=[];if(typeof Se<"u")for(let T in Se.config.props)delete be[Se.config.props[T]],ve.push(Se.config.props[T]);o[17].populate(be),f===!0&&(d-=1),t=o[17];const ze={};ze.width=23,ze.height=33,ze.x=441,ze.y=601,ze.radius=34,n=ze.is||"Tile";let Re;if(typeof n=="string"){if(Re=s.components&&s.components[n]||r[n],!Re)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Re=n);o[18]=Re.call(null,{props:ze},o[17],e),o[18][Symbol.for("slots")][0]?(t=o[18][Symbol.for("slots")][0],c=o[18],f=!0):t=o[18][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const We=s.components&&s.components.Tile||r.Tile;t=o[0];const $e={};o[19]=this.element({parent:t||"root"},f===!0?c:e),$e.width=42,$e.height=54,$e.x=853,$e.y=840,$e.radius=72;const Is=[];if(typeof We<"u")for(let T in We.config.props)delete $e[We.config.props[T]],Is.push(We.config.props[T]);o[19].populate($e),f===!0&&(d-=1),t=o[19];const ue={};ue.width=42,ue.height=54,ue.x=853,ue.y=840,ue.radius=72,n=ue.is||"Tile";let Ls;if(typeof n=="string"){if(Ls=s.components&&s.components[n]||r[n],!Ls)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ls=n);o[20]=Ls.call(null,{props:ue},o[19],e),o[20][Symbol.for("slots")][0]?(t=o[20][Symbol.for("slots")][0],c=o[20],f=!0):t=o[20][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const _e=s.components&&s.components.Tile||r.Tile;t=o[0];const ke={};o[21]=this.element({parent:t||"root"},f===!0?c:e),ke.width=25,ke.height=51,ke.x=132,ke.y=218,ke.radius=44;const fi=[];if(typeof _e<"u")for(let T in _e.config.props)delete ke[_e.config.props[T]],fi.push(_e.config.props[T]);o[21].populate(ke),f===!0&&(d-=1),t=o[21];const Ie={};Ie.width=25,Ie.height=51,Ie.x=132,Ie.y=218,Ie.radius=44,n=Ie.is||"Tile";let Ee;if(typeof n=="string"){if(Ee=s.components&&s.components[n]||r[n],!Ee)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ee=n);o[22]=Ee.call(null,{props:Ie},o[21],e),o[22][Symbol.for("slots")][0]?(t=o[22][Symbol.for("slots")][0],c=o[22],f=!0):t=o[22][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Ps=s.components&&s.components.Tile||r.Tile;t=o[0];const ce={};o[23]=this.element({parent:t||"root"},f===!0?c:e),ce.width=61,ce.height=22,ce.x=757,ce.y=43,ce.radius=54;const Bs=[];if(typeof Ps<"u")for(let T in Ps.config.props)delete ce[Ps.config.props[T]],Bs.push(Ps.config.props[T]);o[23].populate(ce),f===!0&&(d-=1),t=o[23];const Le={};Le.width=61,Le.height=22,Le.x=757,Le.y=43,Le.radius=54,n=Le.is||"Tile";let Ae;if(typeof n=="string"){if(Ae=s.components&&s.components[n]||r[n],!Ae)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ae=n);o[24]=Ae.call(null,{props:Le},o[23],e),o[24][Symbol.for("slots")][0]?(t=o[24][Symbol.for("slots")][0],c=o[24],f=!0):t=o[24][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Fs=s.components&&s.components.Tile||r.Tile;t=o[0];const he={};o[25]=this.element({parent:t||"root"},f===!0?c:e),he.width=49,he.height=60,he.x=506,he.y=476,he.radius=34;const Os=[];if(typeof Fs<"u")for(let T in Fs.config.props)delete he[Fs.config.props[T]],Os.push(Fs.config.props[T]);o[25].populate(he),f===!0&&(d-=1),t=o[25];const Pe={};Pe.width=49,Pe.height=60,Pe.x=506,Pe.y=476,Pe.radius=34,n=Pe.is||"Tile";let Me;if(typeof n=="string"){if(Me=s.components&&s.components[n]||r[n],!Me)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Me=n);o[26]=Me.call(null,{props:Pe},o[25],e),o[26][Symbol.for("slots")][0]?(t=o[26][Symbol.for("slots")][0],c=o[26],f=!0):t=o[26][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Us=s.components&&s.components.Tile||r.Tile;t=o[0];const de={};o[27]=this.element({parent:t||"root"},f===!0?c:e),de.width=30,de.height=67,de.x=35,de.y=646,de.radius=57;const $s=[];if(typeof Us<"u")for(let T in Us.config.props)delete de[Us.config.props[T]],$s.push(Us.config.props[T]);o[27].populate(de),f===!0&&(d-=1),t=o[27];const De={};De.width=30,De.height=67,De.x=35,De.y=646,De.radius=57,n=De.is||"Tile";let Ve;if(typeof n=="string"){if(Ve=s.components&&s.components[n]||r[n],!Ve)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ve=n);o[28]=Ve.call(null,{props:De},o[27],e),o[28][Symbol.for("slots")][0]?(t=o[28][Symbol.for("slots")][0],c=o[28],f=!0):t=o[28][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Be=s.components&&s.components.Tile||r.Tile;t=o[0];const Xe={};o[29]=this.element({parent:t||"root"},f===!0?c:e),Xe.width=44,Xe.height=54,Xe.x=779,Xe.y=677,Xe.radius=24;const Ge=[];if(typeof Be<"u")for(let T in Be.config.props)delete Xe[Be.config.props[T]],Ge.push(Be.config.props[T]);o[29].populate(Xe),f===!0&&(d-=1),t=o[29];const Fe={};Fe.width=44,Fe.height=54,Fe.x=779,Fe.y=677,Fe.radius=24,n=Fe.is||"Tile";let rt;if(typeof n=="string"){if(rt=s.components&&s.components[n]||r[n],!rt)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(rt=n);o[30]=rt.call(null,{props:Fe},o[29],e),o[30][Symbol.for("slots")][0]?(t=o[30][Symbol.for("slots")][0],c=o[30],f=!0):t=o[30][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const He=s.components&&s.components.Tile||r.Tile;t=o[0];const pe={};o[31]=this.element({parent:t||"root"},f===!0?c:e),pe.width=45,pe.height=36,pe.x=542,pe.y=288,pe.radius=53;const Ro=[];if(typeof He<"u")for(let T in He.config.props)delete pe[He.config.props[T]],Ro.push(He.config.props[T]);o[31].populate(pe),f===!0&&(d-=1),t=o[31];const me={};me.width=45,me.height=36,me.x=542,me.y=288,me.radius=53,n=me.is||"Tile";let Ye;if(typeof n=="string"){if(Ye=s.components&&s.components[n]||r[n],!Ye)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ye=n);o[32]=Ye.call(null,{props:me},o[31],e),o[32][Symbol.for("slots")][0]?(t=o[32][Symbol.for("slots")][0],c=o[32],f=!0):t=o[32][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Ke=s.components&&s.components.Tile||r.Tile;t=o[0];const ge={};o[33]=this.element({parent:t||"root"},f===!0?c:e),ge.width=61,ge.height=61,ge.x=846,ge.y=361,ge.radius=67;const _o=[];if(typeof Ke<"u")for(let T in Ke.config.props)delete ge[Ke.config.props[T]],_o.push(Ke.config.props[T]);o[33].populate(ge),f===!0&&(d-=1),t=o[33];const ye={};ye.width=61,ye.height=61,ye.x=846,ye.y=361,ye.radius=67,n=ye.is||"Tile";let je;if(typeof n=="string"){if(je=s.components&&s.components[n]||r[n],!je)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(je=n);o[34]=je.call(null,{props:ye},o[33],e),o[34][Symbol.for("slots")][0]?(t=o[34][Symbol.for("slots")][0],c=o[34],f=!0):t=o[34][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const qe=s.components&&s.components.Tile||r.Tile;t=o[0];const xe={};o[35]=this.element({parent:t||"root"},f===!0?c:e),xe.width=51,xe.height=44,xe.x=507,xe.y=607,xe.radius=66;const Eo=[];if(typeof qe<"u")for(let T in qe.config.props)delete xe[qe.config.props[T]],Eo.push(qe.config.props[T]);o[35].populate(xe),f===!0&&(d-=1),t=o[35];const Te={};Te.width=51,Te.height=44,Te.x=507,Te.y=607,Te.radius=66,n=Te.is||"Tile";let Qe;if(typeof n=="string"){if(Qe=s.components&&s.components[n]||r[n],!Qe)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Qe=n);o[36]=Qe.call(null,{props:Te},o[35],e),o[36][Symbol.for("slots")][0]?(t=o[36][Symbol.for("slots")][0],c=o[36],f=!0):t=o[36][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const N=s.components&&s.components.Tile||r.Tile;t=o[0];const ct={};o[37]=this.element({parent:t||"root"},f===!0?c:e),ct.width=36,ct.height=51,ct.x=52,ct.y=746,ct.radius=46;const Pa=[];if(typeof N<"u")for(let T in N.config.props)delete ct[N.config.props[T]],Pa.push(N.config.props[T]);o[37].populate(ct),f===!0&&(d-=1),t=o[37];const ht={};ht.width=36,ht.height=51,ht.x=52,ht.y=746,ht.radius=46,n=ht.is||"Tile";let Mi;if(typeof n=="string"){if(Mi=s.components&&s.components[n]||r[n],!Mi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Mi=n);o[38]=Mi.call(null,{props:ht},o[37],e),o[38][Symbol.for("slots")][0]?(t=o[38][Symbol.for("slots")][0],c=o[38],f=!0):t=o[38][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const ki=s.components&&s.components.Tile||r.Tile;t=o[0];const dt={};o[39]=this.element({parent:t||"root"},f===!0?c:e),dt.width=33,dt.height=39,dt.x=371,dt.y=69,dt.radius=25;const Ba=[];if(typeof ki<"u")for(let T in ki.config.props)delete dt[ki.config.props[T]],Ba.push(ki.config.props[T]);o[39].populate(dt),f===!0&&(d-=1),t=o[39];const pt={};pt.width=33,pt.height=39,pt.x=371,pt.y=69,pt.radius=25,n=pt.is||"Tile";let Ii;if(typeof n=="string"){if(Ii=s.components&&s.components[n]||r[n],!Ii)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ii=n);o[40]=Ii.call(null,{props:pt},o[39],e),o[40][Symbol.for("slots")][0]?(t=o[40][Symbol.for("slots")][0],c=o[40],f=!0):t=o[40][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Li=s.components&&s.components.Tile||r.Tile;t=o[0];const mt={};o[41]=this.element({parent:t||"root"},f===!0?c:e),mt.width=24,mt.height=63,mt.x=955,mt.y=655,mt.radius=53;const Fa=[];if(typeof Li<"u")for(let T in Li.config.props)delete mt[Li.config.props[T]],Fa.push(Li.config.props[T]);o[41].populate(mt),f===!0&&(d-=1),t=o[41];const gt={};gt.width=24,gt.height=63,gt.x=955,gt.y=655,gt.radius=53,n=gt.is||"Tile";let Pi;if(typeof n=="string"){if(Pi=s.components&&s.components[n]||r[n],!Pi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Pi=n);o[42]=Pi.call(null,{props:gt},o[41],e),o[42][Symbol.for("slots")][0]?(t=o[42][Symbol.for("slots")][0],c=o[42],f=!0):t=o[42][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Bi=s.components&&s.components.Tile||r.Tile;t=o[0];const yt={};o[43]=this.element({parent:t||"root"},f===!0?c:e),yt.width=39,yt.height=69,yt.x=271,yt.y=276,yt.radius=28;const Oa=[];if(typeof Bi<"u")for(let T in Bi.config.props)delete yt[Bi.config.props[T]],Oa.push(Bi.config.props[T]);o[43].populate(yt),f===!0&&(d-=1),t=o[43];const xt={};xt.width=39,xt.height=69,xt.x=271,xt.y=276,xt.radius=28,n=xt.is||"Tile";let Fi;if(typeof n=="string"){if(Fi=s.components&&s.components[n]||r[n],!Fi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Fi=n);o[44]=Fi.call(null,{props:xt},o[43],e),o[44][Symbol.for("slots")][0]?(t=o[44][Symbol.for("slots")][0],c=o[44],f=!0):t=o[44][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Oi=s.components&&s.components.Tile||r.Tile;t=o[0];const Tt={};o[45]=this.element({parent:t||"root"},f===!0?c:e),Tt.width=71,Tt.height=68,Tt.x=417,Tt.y=680,Tt.radius=60;const Ua=[];if(typeof Oi<"u")for(let T in Oi.config.props)delete Tt[Oi.config.props[T]],Ua.push(Oi.config.props[T]);o[45].populate(Tt),f===!0&&(d-=1),t=o[45];const bt={};bt.width=71,bt.height=68,bt.x=417,bt.y=680,bt.radius=60,n=bt.is||"Tile";let Ui;if(typeof n=="string"){if(Ui=s.components&&s.components[n]||r[n],!Ui)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ui=n);o[46]=Ui.call(null,{props:bt},o[45],e),o[46][Symbol.for("slots")][0]?(t=o[46][Symbol.for("slots")][0],c=o[46],f=!0):t=o[46][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const $i=s.components&&s.components.Tile||r.Tile;t=o[0];const wt={};o[47]=this.element({parent:t||"root"},f===!0?c:e),wt.width=42,wt.height=38,wt.x=439,wt.y=231,wt.radius=52;const $a=[];if(typeof $i<"u")for(let T in $i.config.props)delete wt[$i.config.props[T]],$a.push($i.config.props[T]);o[47].populate(wt),f===!0&&(d-=1),t=o[47];const St={};St.width=42,St.height=38,St.x=439,St.y=231,St.radius=52,n=St.is||"Tile";let Di;if(typeof n=="string"){if(Di=s.components&&s.components[n]||r[n],!Di)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Di=n);o[48]=Di.call(null,{props:St},o[47],e),o[48][Symbol.for("slots")][0]?(t=o[48][Symbol.for("slots")][0],c=o[48],f=!0):t=o[48][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Ni=s.components&&s.components.Tile||r.Tile;t=o[0];const Ct={};o[49]=this.element({parent:t||"root"},f===!0?c:e),Ct.width=27,Ct.height=39,Ct.x=866,Ct.y=568,Ct.radius=47;const Da=[];if(typeof Ni<"u")for(let T in Ni.config.props)delete Ct[Ni.config.props[T]],Da.push(Ni.config.props[T]);o[49].populate(Ct),f===!0&&(d-=1),t=o[49];const vt={};vt.width=27,vt.height=39,vt.x=866,vt.y=568,vt.radius=47,n=vt.is||"Tile";let zi;if(typeof n=="string"){if(zi=s.components&&s.components[n]||r[n],!zi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(zi=n);o[50]=zi.call(null,{props:vt},o[49],e),o[50][Symbol.for("slots")][0]?(t=o[50][Symbol.for("slots")][0],c=o[50],f=!0):t=o[50][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Wi=s.components&&s.components.Tile||r.Tile;t=o[0];const Rt={};o[51]=this.element({parent:t||"root"},f===!0?c:e),Rt.width=40,Rt.height=53,Rt.x=967,Rt.y=39,Rt.radius=21;const Na=[];if(typeof Wi<"u")for(let T in Wi.config.props)delete Rt[Wi.config.props[T]],Na.push(Wi.config.props[T]);o[51].populate(Rt),f===!0&&(d-=1),t=o[51];const _t={};_t.width=40,_t.height=53,_t.x=967,_t.y=39,_t.radius=21,n=_t.is||"Tile";let Vi;if(typeof n=="string"){if(Vi=s.components&&s.components[n]||r[n],!Vi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Vi=n);o[52]=Vi.call(null,{props:_t},o[51],e),o[52][Symbol.for("slots")][0]?(t=o[52][Symbol.for("slots")][0],c=o[52],f=!0):t=o[52][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Xi=s.components&&s.components.Tile||r.Tile;t=o[0];const Et={};o[53]=this.element({parent:t||"root"},f===!0?c:e),Et.width=24,Et.height=30,Et.x=777,Et.y=195,Et.radius=37;const za=[];if(typeof Xi<"u")for(let T in Xi.config.props)delete Et[Xi.config.props[T]],za.push(Xi.config.props[T]);o[53].populate(Et),f===!0&&(d-=1),t=o[53];const At={};At.width=24,At.height=30,At.x=777,At.y=195,At.radius=37,n=At.is||"Tile";let Gi;if(typeof n=="string"){if(Gi=s.components&&s.components[n]||r[n],!Gi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Gi=n);o[54]=Gi.call(null,{props:At},o[53],e),o[54][Symbol.for("slots")][0]?(t=o[54][Symbol.for("slots")][0],c=o[54],f=!0):t=o[54][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Hi=s.components&&s.components.Tile||r.Tile;t=o[0];const Mt={};o[55]=this.element({parent:t||"root"},f===!0?c:e),Mt.width=41,Mt.height=58,Mt.x=119,Mt.y=725,Mt.radius=71;const Wa=[];if(typeof Hi<"u")for(let T in Hi.config.props)delete Mt[Hi.config.props[T]],Wa.push(Hi.config.props[T]);o[55].populate(Mt),f===!0&&(d-=1),t=o[55];const kt={};kt.width=41,kt.height=58,kt.x=119,kt.y=725,kt.radius=71,n=kt.is||"Tile";let Yi;if(typeof n=="string"){if(Yi=s.components&&s.components[n]||r[n],!Yi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Yi=n);o[56]=Yi.call(null,{props:kt},o[55],e),o[56][Symbol.for("slots")][0]?(t=o[56][Symbol.for("slots")][0],c=o[56],f=!0):t=o[56][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Ki=s.components&&s.components.Tile||r.Tile;t=o[0];const It={};o[57]=this.element({parent:t||"root"},f===!0?c:e),It.width=24,It.height=53,It.x=215,It.y=937,It.radius=45;const Va=[];if(typeof Ki<"u")for(let T in Ki.config.props)delete It[Ki.config.props[T]],Va.push(Ki.config.props[T]);o[57].populate(It),f===!0&&(d-=1),t=o[57];const Lt={};Lt.width=24,Lt.height=53,Lt.x=215,Lt.y=937,Lt.radius=45,n=Lt.is||"Tile";let ji;if(typeof n=="string"){if(ji=s.components&&s.components[n]||r[n],!ji)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ji=n);o[58]=ji.call(null,{props:Lt},o[57],e),o[58][Symbol.for("slots")][0]?(t=o[58][Symbol.for("slots")][0],c=o[58],f=!0):t=o[58][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const qi=s.components&&s.components.Tile||r.Tile;t=o[0];const Pt={};o[59]=this.element({parent:t||"root"},f===!0?c:e),Pt.width=44,Pt.height=59,Pt.x=184,Pt.y=204,Pt.radius=61;const Xa=[];if(typeof qi<"u")for(let T in qi.config.props)delete Pt[qi.config.props[T]],Xa.push(qi.config.props[T]);o[59].populate(Pt),f===!0&&(d-=1),t=o[59];const Bt={};Bt.width=44,Bt.height=59,Bt.x=184,Bt.y=204,Bt.radius=61,n=Bt.is||"Tile";let Qi;if(typeof n=="string"){if(Qi=s.components&&s.components[n]||r[n],!Qi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Qi=n);o[60]=Qi.call(null,{props:Bt},o[59],e),o[60][Symbol.for("slots")][0]?(t=o[60][Symbol.for("slots")][0],c=o[60],f=!0):t=o[60][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Zi=s.components&&s.components.Tile||r.Tile;t=o[0];const Ft={};o[61]=this.element({parent:t||"root"},f===!0?c:e),Ft.width=66,Ft.height=67,Ft.x=399,Ft.y=191,Ft.radius=36;const Ga=[];if(typeof Zi<"u")for(let T in Zi.config.props)delete Ft[Zi.config.props[T]],Ga.push(Zi.config.props[T]);o[61].populate(Ft),f===!0&&(d-=1),t=o[61];const Ot={};Ot.width=66,Ot.height=67,Ot.x=399,Ot.y=191,Ot.radius=36,n=Ot.is||"Tile";let Ji;if(typeof n=="string"){if(Ji=s.components&&s.components[n]||r[n],!Ji)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ji=n);o[62]=Ji.call(null,{props:Ot},o[61],e),o[62][Symbol.for("slots")][0]?(t=o[62][Symbol.for("slots")][0],c=o[62],f=!0):t=o[62][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const er=s.components&&s.components.Tile||r.Tile;t=o[0];const Ut={};o[63]=this.element({parent:t||"root"},f===!0?c:e),Ut.width=25,Ut.height=25,Ut.x=268,Ut.y=451,Ut.radius=22;const Ha=[];if(typeof er<"u")for(let T in er.config.props)delete Ut[er.config.props[T]],Ha.push(er.config.props[T]);o[63].populate(Ut),f===!0&&(d-=1),t=o[63];const $t={};$t.width=25,$t.height=25,$t.x=268,$t.y=451,$t.radius=22,n=$t.is||"Tile";let tr;if(typeof n=="string"){if(tr=s.components&&s.components[n]||r[n],!tr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(tr=n);o[64]=tr.call(null,{props:$t},o[63],e),o[64][Symbol.for("slots")][0]?(t=o[64][Symbol.for("slots")][0],c=o[64],f=!0):t=o[64][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const sr=s.components&&s.components.Tile||r.Tile;t=o[0];const Dt={};o[65]=this.element({parent:t||"root"},f===!0?c:e),Dt.width=21,Dt.height=24,Dt.x=993,Dt.y=99,Dt.radius=45;const Ya=[];if(typeof sr<"u")for(let T in sr.config.props)delete Dt[sr.config.props[T]],Ya.push(sr.config.props[T]);o[65].populate(Dt),f===!0&&(d-=1),t=o[65];const Nt={};Nt.width=21,Nt.height=24,Nt.x=993,Nt.y=99,Nt.radius=45,n=Nt.is||"Tile";let ir;if(typeof n=="string"){if(ir=s.components&&s.components[n]||r[n],!ir)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ir=n);o[66]=ir.call(null,{props:Nt},o[65],e),o[66][Symbol.for("slots")][0]?(t=o[66][Symbol.for("slots")][0],c=o[66],f=!0):t=o[66][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const rr=s.components&&s.components.Tile||r.Tile;t=o[0];const zt={};o[67]=this.element({parent:t||"root"},f===!0?c:e),zt.width=67,zt.height=45,zt.x=922,zt.y=388,zt.radius=25;const Ka=[];if(typeof rr<"u")for(let T in rr.config.props)delete zt[rr.config.props[T]],Ka.push(rr.config.props[T]);o[67].populate(zt),f===!0&&(d-=1),t=o[67];const Wt={};Wt.width=67,Wt.height=45,Wt.x=922,Wt.y=388,Wt.radius=25,n=Wt.is||"Tile";let or;if(typeof n=="string"){if(or=s.components&&s.components[n]||r[n],!or)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(or=n);o[68]=or.call(null,{props:Wt},o[67],e),o[68][Symbol.for("slots")][0]?(t=o[68][Symbol.for("slots")][0],c=o[68],f=!0):t=o[68][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const nr=s.components&&s.components.Tile||r.Tile;t=o[0];const Vt={};o[69]=this.element({parent:t||"root"},f===!0?c:e),Vt.width=66,Vt.height=69,Vt.x=883,Vt.y=894,Vt.radius=21;const ja=[];if(typeof nr<"u")for(let T in nr.config.props)delete Vt[nr.config.props[T]],ja.push(nr.config.props[T]);o[69].populate(Vt),f===!0&&(d-=1),t=o[69];const Xt={};Xt.width=66,Xt.height=69,Xt.x=883,Xt.y=894,Xt.radius=21,n=Xt.is||"Tile";let ar;if(typeof n=="string"){if(ar=s.components&&s.components[n]||r[n],!ar)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ar=n);o[70]=ar.call(null,{props:Xt},o[69],e),o[70][Symbol.for("slots")][0]?(t=o[70][Symbol.for("slots")][0],c=o[70],f=!0):t=o[70][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const lr=s.components&&s.components.Tile||r.Tile;t=o[0];const Gt={};o[71]=this.element({parent:t||"root"},f===!0?c:e),Gt.width=59,Gt.height=57,Gt.x=155,Gt.y=268,Gt.radius=36;const qa=[];if(typeof lr<"u")for(let T in lr.config.props)delete Gt[lr.config.props[T]],qa.push(lr.config.props[T]);o[71].populate(Gt),f===!0&&(d-=1),t=o[71];const Ht={};Ht.width=59,Ht.height=57,Ht.x=155,Ht.y=268,Ht.radius=36,n=Ht.is||"Tile";let fr;if(typeof n=="string"){if(fr=s.components&&s.components[n]||r[n],!fr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(fr=n);o[72]=fr.call(null,{props:Ht},o[71],e),o[72][Symbol.for("slots")][0]?(t=o[72][Symbol.for("slots")][0],c=o[72],f=!0):t=o[72][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const ur=s.components&&s.components.Tile||r.Tile;t=o[0];const Yt={};o[73]=this.element({parent:t||"root"},f===!0?c:e),Yt.width=56,Yt.height=36,Yt.x=567,Yt.y=741,Yt.radius=43;const Qa=[];if(typeof ur<"u")for(let T in ur.config.props)delete Yt[ur.config.props[T]],Qa.push(ur.config.props[T]);o[73].populate(Yt),f===!0&&(d-=1),t=o[73];const Kt={};Kt.width=56,Kt.height=36,Kt.x=567,Kt.y=741,Kt.radius=43,n=Kt.is||"Tile";let cr;if(typeof n=="string"){if(cr=s.components&&s.components[n]||r[n],!cr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(cr=n);o[74]=cr.call(null,{props:Kt},o[73],e),o[74][Symbol.for("slots")][0]?(t=o[74][Symbol.for("slots")][0],c=o[74],f=!0):t=o[74][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const hr=s.components&&s.components.Tile||r.Tile;t=o[0];const jt={};o[75]=this.element({parent:t||"root"},f===!0?c:e),jt.width=24,jt.height=34,jt.x=866,jt.y=747,jt.radius=67;const Za=[];if(typeof hr<"u")for(let T in hr.config.props)delete jt[hr.config.props[T]],Za.push(hr.config.props[T]);o[75].populate(jt),f===!0&&(d-=1),t=o[75];const qt={};qt.width=24,qt.height=34,qt.x=866,qt.y=747,qt.radius=67,n=qt.is||"Tile";let dr;if(typeof n=="string"){if(dr=s.components&&s.components[n]||r[n],!dr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(dr=n);o[76]=dr.call(null,{props:qt},o[75],e),o[76][Symbol.for("slots")][0]?(t=o[76][Symbol.for("slots")][0],c=o[76],f=!0):t=o[76][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const pr=s.components&&s.components.Tile||r.Tile;t=o[0];const Qt={};o[77]=this.element({parent:t||"root"},f===!0?c:e),Qt.width=38,Qt.height=45,Qt.x=141,Qt.y=401,Qt.radius=34;const Ja=[];if(typeof pr<"u")for(let T in pr.config.props)delete Qt[pr.config.props[T]],Ja.push(pr.config.props[T]);o[77].populate(Qt),f===!0&&(d-=1),t=o[77];const Zt={};Zt.width=38,Zt.height=45,Zt.x=141,Zt.y=401,Zt.radius=34,n=Zt.is||"Tile";let mr;if(typeof n=="string"){if(mr=s.components&&s.components[n]||r[n],!mr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(mr=n);o[78]=mr.call(null,{props:Zt},o[77],e),o[78][Symbol.for("slots")][0]?(t=o[78][Symbol.for("slots")][0],c=o[78],f=!0):t=o[78][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const gr=s.components&&s.components.Tile||r.Tile;t=o[0];const Jt={};o[79]=this.element({parent:t||"root"},f===!0?c:e),Jt.width=38,Jt.height=62,Jt.x=381,Jt.y=777,Jt.radius=35;const el=[];if(typeof gr<"u")for(let T in gr.config.props)delete Jt[gr.config.props[T]],el.push(gr.config.props[T]);o[79].populate(Jt),f===!0&&(d-=1),t=o[79];const es={};es.width=38,es.height=62,es.x=381,es.y=777,es.radius=35,n=es.is||"Tile";let yr;if(typeof n=="string"){if(yr=s.components&&s.components[n]||r[n],!yr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(yr=n);o[80]=yr.call(null,{props:es},o[79],e),o[80][Symbol.for("slots")][0]?(t=o[80][Symbol.for("slots")][0],c=o[80],f=!0):t=o[80][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const xr=s.components&&s.components.Tile||r.Tile;t=o[0];const ts={};o[81]=this.element({parent:t||"root"},f===!0?c:e),ts.width=24,ts.height=67,ts.x=63,ts.y=222,ts.radius=54;const tl=[];if(typeof xr<"u")for(let T in xr.config.props)delete ts[xr.config.props[T]],tl.push(xr.config.props[T]);o[81].populate(ts),f===!0&&(d-=1),t=o[81];const ss={};ss.width=24,ss.height=67,ss.x=63,ss.y=222,ss.radius=54,n=ss.is||"Tile";let Tr;if(typeof n=="string"){if(Tr=s.components&&s.components[n]||r[n],!Tr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Tr=n);o[82]=Tr.call(null,{props:ss},o[81],e),o[82][Symbol.for("slots")][0]?(t=o[82][Symbol.for("slots")][0],c=o[82],f=!0):t=o[82][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const br=s.components&&s.components.Tile||r.Tile;t=o[0];const is={};o[83]=this.element({parent:t||"root"},f===!0?c:e),is.width=28,is.height=25,is.x=951,is.y=499,is.radius=24;const sl=[];if(typeof br<"u")for(let T in br.config.props)delete is[br.config.props[T]],sl.push(br.config.props[T]);o[83].populate(is),f===!0&&(d-=1),t=o[83];const rs={};rs.width=28,rs.height=25,rs.x=951,rs.y=499,rs.radius=24,n=rs.is||"Tile";let wr;if(typeof n=="string"){if(wr=s.components&&s.components[n]||r[n],!wr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(wr=n);o[84]=wr.call(null,{props:rs},o[83],e),o[84][Symbol.for("slots")][0]?(t=o[84][Symbol.for("slots")][0],c=o[84],f=!0):t=o[84][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Sr=s.components&&s.components.Tile||r.Tile;t=o[0];const os={};o[85]=this.element({parent:t||"root"},f===!0?c:e),os.width=69,os.height=70,os.x=813,os.y=738,os.radius=58;const il=[];if(typeof Sr<"u")for(let T in Sr.config.props)delete os[Sr.config.props[T]],il.push(Sr.config.props[T]);o[85].populate(os),f===!0&&(d-=1),t=o[85];const ns={};ns.width=69,ns.height=70,ns.x=813,ns.y=738,ns.radius=58,n=ns.is||"Tile";let Cr;if(typeof n=="string"){if(Cr=s.components&&s.components[n]||r[n],!Cr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Cr=n);o[86]=Cr.call(null,{props:ns},o[85],e),o[86][Symbol.for("slots")][0]?(t=o[86][Symbol.for("slots")][0],c=o[86],f=!0):t=o[86][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const vr=s.components&&s.components.Tile||r.Tile;t=o[0];const as={};o[87]=this.element({parent:t||"root"},f===!0?c:e),as.width=37,as.height=42,as.x=109,as.y=870,as.radius=49;const rl=[];if(typeof vr<"u")for(let T in vr.config.props)delete as[vr.config.props[T]],rl.push(vr.config.props[T]);o[87].populate(as),f===!0&&(d-=1),t=o[87];const ls={};ls.width=37,ls.height=42,ls.x=109,ls.y=870,ls.radius=49,n=ls.is||"Tile";let Rr;if(typeof n=="string"){if(Rr=s.components&&s.components[n]||r[n],!Rr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Rr=n);o[88]=Rr.call(null,{props:ls},o[87],e),o[88][Symbol.for("slots")][0]?(t=o[88][Symbol.for("slots")][0],c=o[88],f=!0):t=o[88][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const _r=s.components&&s.components.Tile||r.Tile;t=o[0];const fs={};o[89]=this.element({parent:t||"root"},f===!0?c:e),fs.width=66,fs.height=22,fs.x=330,fs.y=167,fs.radius=60;const ol=[];if(typeof _r<"u")for(let T in _r.config.props)delete fs[_r.config.props[T]],ol.push(_r.config.props[T]);o[89].populate(fs),f===!0&&(d-=1),t=o[89];const us={};us.width=66,us.height=22,us.x=330,us.y=167,us.radius=60,n=us.is||"Tile";let Er;if(typeof n=="string"){if(Er=s.components&&s.components[n]||r[n],!Er)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Er=n);o[90]=Er.call(null,{props:us},o[89],e),o[90][Symbol.for("slots")][0]?(t=o[90][Symbol.for("slots")][0],c=o[90],f=!0):t=o[90][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Ar=s.components&&s.components.Tile||r.Tile;t=o[0];const cs={};o[91]=this.element({parent:t||"root"},f===!0?c:e),cs.width=41,cs.height=51,cs.x=634,cs.y=888,cs.radius=51;const nl=[];if(typeof Ar<"u")for(let T in Ar.config.props)delete cs[Ar.config.props[T]],nl.push(Ar.config.props[T]);o[91].populate(cs),f===!0&&(d-=1),t=o[91];const hs={};hs.width=41,hs.height=51,hs.x=634,hs.y=888,hs.radius=51,n=hs.is||"Tile";let Mr;if(typeof n=="string"){if(Mr=s.components&&s.components[n]||r[n],!Mr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Mr=n);o[92]=Mr.call(null,{props:hs},o[91],e),o[92][Symbol.for("slots")][0]?(t=o[92][Symbol.for("slots")][0],c=o[92],f=!0):t=o[92][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const kr=s.components&&s.components.Tile||r.Tile;t=o[0];const ds={};o[93]=this.element({parent:t||"root"},f===!0?c:e),ds.width=60,ds.height=56,ds.x=429,ds.y=328,ds.radius=52;const al=[];if(typeof kr<"u")for(let T in kr.config.props)delete ds[kr.config.props[T]],al.push(kr.config.props[T]);o[93].populate(ds),f===!0&&(d-=1),t=o[93];const ps={};ps.width=60,ps.height=56,ps.x=429,ps.y=328,ps.radius=52,n=ps.is||"Tile";let Ir;if(typeof n=="string"){if(Ir=s.components&&s.components[n]||r[n],!Ir)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ir=n);o[94]=Ir.call(null,{props:ps},o[93],e),o[94][Symbol.for("slots")][0]?(t=o[94][Symbol.for("slots")][0],c=o[94],f=!0):t=o[94][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Lr=s.components&&s.components.Tile||r.Tile;t=o[0];const ms={};o[95]=this.element({parent:t||"root"},f===!0?c:e),ms.width=33,ms.height=31,ms.x=803,ms.y=586,ms.radius=69;const ll=[];if(typeof Lr<"u")for(let T in Lr.config.props)delete ms[Lr.config.props[T]],ll.push(Lr.config.props[T]);o[95].populate(ms),f===!0&&(d-=1),t=o[95];const gs={};gs.width=33,gs.height=31,gs.x=803,gs.y=586,gs.radius=69,n=gs.is||"Tile";let Pr;if(typeof n=="string"){if(Pr=s.components&&s.components[n]||r[n],!Pr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Pr=n);o[96]=Pr.call(null,{props:gs},o[95],e),o[96][Symbol.for("slots")][0]?(t=o[96][Symbol.for("slots")][0],c=o[96],f=!0):t=o[96][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Br=s.components&&s.components.Tile||r.Tile;t=o[0];const ys={};o[97]=this.element({parent:t||"root"},f===!0?c:e),ys.width=41,ys.height=35,ys.x=510,ys.y=812,ys.radius=53;const fl=[];if(typeof Br<"u")for(let T in Br.config.props)delete ys[Br.config.props[T]],fl.push(Br.config.props[T]);o[97].populate(ys),f===!0&&(d-=1),t=o[97];const xs={};xs.width=41,xs.height=35,xs.x=510,xs.y=812,xs.radius=53,n=xs.is||"Tile";let Fr;if(typeof n=="string"){if(Fr=s.components&&s.components[n]||r[n],!Fr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Fr=n);o[98]=Fr.call(null,{props:xs},o[97],e),o[98][Symbol.for("slots")][0]?(t=o[98][Symbol.for("slots")][0],c=o[98],f=!0):t=o[98][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Or=s.components&&s.components.Tile||r.Tile;t=o[0];const Ts={};o[99]=this.element({parent:t||"root"},f===!0?c:e),Ts.width=69,Ts.height=60,Ts.x=382,Ts.y=688,Ts.radius=57;const ul=[];if(typeof Or<"u")for(let T in Or.config.props)delete Ts[Or.config.props[T]],ul.push(Or.config.props[T]);o[99].populate(Ts),f===!0&&(d-=1),t=o[99];const bs={};bs.width=69,bs.height=60,bs.x=382,bs.y=688,bs.radius=57,n=bs.is||"Tile";let Ur;if(typeof n=="string"){if(Ur=s.components&&s.components[n]||r[n],!Ur)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ur=n);o[100]=Ur.call(null,{props:bs},o[99],e),o[100][Symbol.for("slots")][0]?(t=o[100][Symbol.for("slots")][0],c=o[100],f=!0):t=o[100][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const $r=s.components&&s.components.Tile||r.Tile;t=o[0];const ws={};o[101]=this.element({parent:t||"root"},f===!0?c:e),ws.width=26,ws.height=28,ws.x=358,ws.y=254,ws.radius=51;const cl=[];if(typeof $r<"u")for(let T in $r.config.props)delete ws[$r.config.props[T]],cl.push($r.config.props[T]);o[101].populate(ws),f===!0&&(d-=1),t=o[101];const Ss={};Ss.width=26,Ss.height=28,Ss.x=358,Ss.y=254,Ss.radius=51,n=Ss.is||"Tile";let Dr;if(typeof n=="string"){if(Dr=s.components&&s.components[n]||r[n],!Dr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Dr=n);o[102]=Dr.call(null,{props:Ss},o[101],e),o[102][Symbol.for("slots")][0]?(t=o[102][Symbol.for("slots")][0],c=o[102],f=!0):t=o[102][Symbol.for("children")][0],f===!0&&d===0&&(f=!1);const Nr=s.components&&s.components.Tile||r.Tile;t=o[0];const Cs={};o[103]=this.element({parent:t||"root"},f===!0?c:e),Cs.width=36,Cs.height=27,Cs.x=833,Cs.y=178,Cs.radius=36;const hl=[];if(typeof Nr<"u")for(let T in Nr.config.props)delete Cs[Nr.config.props[T]],hl.push(Nr.config.props[T]);o[103].populate(Cs),f===!0&&(d-=1),t=o[103];const vs={};vs.width=36,vs.height=27,vs.x=833,vs.y=178,vs.radius=36,n=vs.is||"Tile";let zr;if(typeof n=="string"){if(zr=s.components&&s.components[n]||r[n],!zr)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(zr=n);return o[104]=zr.call(null,{props:vs},o[103],e),o[104][Symbol.for("slots")][0]?(t=o[104][Symbol.for("slots")][0],c=o[104],f=!0):t=o[104][Symbol.for("children")][0],f===!0&&d===0&&(f=!1),o},effects:[],context:{}},components:{Tile:La},state(){return{items:[],active:!1}},hooks:{init(){setTimeout(()=>{this.active=!0},2e3)}}}),mc=ut.Application({code:{render:function(t,e,s,r,a,l,u){const o=[];let n,c,f=!1,d=0;const p={};o[0]=this.element({parent:t||"root"},f===!0?c:e),p.w=1920,p.h=1080,o[0].populate(p),f===!0&&(d-=1);const m=s.components&&s.components.RouterView||r.RouterView;t=o[0];const y={};o[1]=this.element({parent:t||"root"},f===!0?c:e),y.w=t.node.width*(100/100),y.h=t.node.height*(100/100);const b=[];if(typeof m<"u")for(let _ in m.config.props)delete y[m.config.props[_]],b.push(m.config.props[_]);o[1].populate(y),f===!0&&(d-=1),t=o[1];const w={};w.w=t.node.width*(100/100),w.h=t.node.height*(100/100),n=w.is||"RouterView";let S;if(typeof n=="string"){if(S=s.components&&s.components[n]||r[n],!S)throw new Error('Component "RouterView" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(S=n);return o[2]=S.call(null,{props:w},o[1],e),o[2][Symbol.for("slots")][0]?(t=o[2][Symbol.for("slots")][0],c=o[2],f=!0):t=o[2][Symbol.for("children")][0],f===!0&&d===0&&(f=!1),o},effects:[],context:{}},routes:[{path:"/",component:rc},{path:"/tile",component:lc},{path:"/tileone",component:dc},{path:"/static",component:pc}]});ut.Launch(mc,"app",{w:1920,h:1080,inspector:!1,multithreaded:!0,debugLevel:1,reactivityMode:"Proxy",fonts:[{family:"lato",type:"msdf",file:"fonts/Lato-Regular.ttf"},{family:"raleway",type:"msdf",file:"fonts/Raleway-ExtraBold.ttf"},{family:"opensans",type:"web",file:"fonts/OpenSans-Medium.ttf"}]});
