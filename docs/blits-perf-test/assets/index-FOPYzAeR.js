var Vl=Object.defineProperty;var Xl=(o,t,e)=>t in o?Vl(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var f=(o,t,e)=>Xl(o,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=e(r);fetch(r.href,l)}})();const g={currentView:Symbol("currentView"),cursorTagStart:Symbol("cursorTagStart"),computedKeys:Symbol("computedKeys"),destroy:Symbol("destroy"),getChildren:Symbol("getChildren"),holder:Symbol("holder"),id:Symbol("id"),identifier:Symbol("identifier"),index:Symbol("index"),init:Symbol("init"),inputEvents:Symbol("inputEvents"),intervals:Symbol("intervals"),launched:Symbol("launched"),level:Symbol("level"),methodKeys:Symbol("methodKeys"),originalState:Symbol("originalState"),propKeys:Symbol("propKeys"),raw:Symbol("raw"),ready:Symbol("ready"),renderer:Symbol("renderer"),routes:Symbol("routes"),settings:Symbol("settings"),state:Symbol("state"),stateKeys:Symbol("stateKeys"),textnode:Symbol("textnode"),timeouts:Symbol("timeouts"),type:Symbol("type"),watchers:Symbol("watchers"),watchKeys:Symbol("watchKeys"),wrapper:Symbol("wrapper"),children:Symbol.for("children"),components:Symbol.for("components"),isSlot:Symbol.for("isSlot"),props:Symbol.for("props"),slots:Symbol.for("slots"),componentType:Symbol.for("componentType"),isComponent:Symbol.for("isComponent"),effects:Symbol.for("effects")},$e={[g.settings]:{},get(o,t=null){return o in this[g.settings]?this[g.settings][o]:t},set(o,t){typeof o=="object"?Object.keys(o).forEach(e=>{this.set(e,o[e])}):this[g.settings][o]=t}},Ei=()=>{},mr=()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),Mn=o=>{const t=$e.get("debugLevel"),e={};return Object.defineProperty(e,"info",{get(){return(t>=1||Array.isArray(t)&&t.indexOf("info")>-1)&&console.info.bind(window.console,`%c ⚡️ ${o} %c ${mr()}`,"background-color: #0284c7; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Ei}}),Object.defineProperty(e,"warn",{get(){return(t>=1||Array.isArray(t)&&t.indexOf("warn")>-1)&&console.warn.bind(window.console,`%c ⚡️ ${o} %c ${mr()}`,"background-color: #fbbf24; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Ei}}),Object.defineProperty(e,"error",{get(){return(t>=1||Array.isArray(t)&&t.indexOf("error")>-1)&&console.error.bind(window.console,`%c ⚡️ ${o} %c ${mr()}`,"background-color: #dc2626; color: white; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Ei}}),Object.defineProperty(e,"debug",{get(){return(t>=2||Array.isArray(t)&&t.indexOf("debug")>-1)&&console.debug.bind(window.console,`%c ⚡️ ${o} %c (${new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})`,"background-color: #e2e8f0; color: #334155; padding: 3px 6px 3px 1px; border-radius: 3px","color: ##94a3b8;")||Ei}}),e};let Z;const Hl=()=>{Z=Mn("Blits")},Ai={aliceblue:"0xf0f8ffff",antiquewhite:"0xfaebd7ff",aqua:"0xffffff00",aquamarine:"0x7fffd4ff",azure:"0xf0ffffff",beige:"0xf5f5dcff",bisque:"0xffe4c4ff",black:"0x000000ff",blanchedalmond:"0xffebcdff",blue:"0x0000ffff",blueviolet:"0x8a2be2ff",brown:"0xa52a2aff",burlywood:"0xdeb887ff",cadetblue:"0x5f9ea0ff",chartreuse:"0x7fff00ff",chocolate:"0xd2691eff",coral:"0xff7f50ff",cornflowerblue:"0x6495edff",cornsilk:"0xfff8dcff",crimson:"0xdc143cff",cyan:"0x00ffffff",darkblue:"0x00008bff",darkcyan:"0x008b8bff",darkgoldenrod:"0xb8860bff",darkgray:"0xa9a9a9ff",darkgreen:"0x006400ff",darkgrey:"0xa9a9a9ff",darkkhaki:"0xbdb76bff",darkmagenta:"0x8b008bff",darkolivegreen:"0x556b2fff",darkorange:"0xff8c00ff",darkorchid:"0x9932ccff",darkred:"0x8b0000ff",darksalmon:"0xe9967aff",darkseagreen:"0x8fbc8fff",darkslateblue:"0x483d8bff",darkslategray:"0x2f4f4fff",darkslategrey:"0x2f4f4fff",darkturquoise:"0x00ced1ff",darkviolet:"0x9400d3ff",deeppink:"0xff1493ff",deepskyblue:"0x00bfffff",dimgray:"0x696969ff",dimgrey:"0x696969ff",dodgerblue:"0x1e90ffff",firebrick:"0xb22222ff",floralwhite:"0xfffaf0ff",forestgreen:"0x228b22ff",fuchsia:"0xff00ffff",gainsboro:"0xdcdcdcff",ghostwhite:"0xf8f8ffff",gold:"0xffd700ff",goldenrod:"0xdaa520ff",gray:"0x808080ff",green:"0x008000ff",greenyellow:"0xadff2fff",grey:"0x808080ff",honeydew:"0xf0fff0ff",hotpink:"0xff69b4ff",indianred:"0xcd5c5cff",indigo:"0x4b0082ff",ivory:"0xfffff0ff",khaki:"0xf0e68cff",lavender:"0xe6e6faff",lavenderblush:"0xfff0f5ff",lawngreen:"0x7cfc00ff",lemonchiffon:"0xfffacdff",lightblue:"0xadd8e6ff",lightcoral:"0xf08080ff",lightcyan:"0xe0ffffff",lightgoldenrodyellow:"0xfafad2ff",lightgray:"0xd3d3d3ff",lightgreen:"0x90ee90ff",lightgrey:"0xd3d3d3ff",lightpink:"0xffb6c1ff",lightsalmon:"0xffa07aff",lightseagreen:"0x20b2aaff",lightskyblue:"0x87cefaff",lightslategray:"0x778899ff",lightslategrey:"0x778899ff",lightsteelblue:"0xb0c4deff",lightyellow:"0xffffe0ff",lime:"0x00ff00ff",limegreen:"0x32cd32ff",linen:"0xfaf0e6ff",magenta:"0xff00ffff",maroon:"0x800000ff",mediumaquamarine:"0x66cdaaff",mediumblue:"0x0000cdff",mediumorchid:"0xba55d3ff",mediumpurple:"0x9370dbff",mediumseagreen:"0x3cb371ff",mediumslateblue:"0x7b68eeff",mediumspringgreen:"0x00fa9aff",mediumturquoise:"0x48d1ccff",mediumvioletred:"0xc71585ff",midnightblue:"0x191970ff",mintcream:"0xf5fffaff",mistyrose:"0xffe4e1ff",moccasin:"0xffe4b5ff",navajowhite:"0xffdeadff",navy:"0x000080ff",oldlace:"0xfdf5e6ff",olive:"0x808000ff",olivedrab:"0x6b8e23ff",orange:"0xffa500ff",orangered:"0xff4500ff",orchid:"0xda70d6ff",palegoldenrod:"0xeee8aaff",palegreen:"0x98fb98ff",paleturquoise:"0xafeeeeff",palevioletred:"0xdb7093ff",papayawhip:"0xffefd5ff",peachpuff:"0xffdab9ff",peru:"0xcd853fff",pink:"0xffc0cbff",plum:"0xdda0ddff",powderblue:"0xb0e0e6ff",purple:"0x800080ff",rebeccapurple:"0x663399ff",red:"0xff0000ff",rosybrown:"0xbc8f8fff",royalblue:"0x4169e1ff",saddlebrown:"0x8b4513ff",salmon:"0xfa8072ff",sandybrown:"0xf4a460ff",seagreen:"0x2e8b57ff",seashell:"0xfff5eeff",sienna:"0xa0522dff",silver:"0xc0c0c0ff",skyblue:"0x87ceebff",slateblue:"0x6a5acdff",slategray:"0x708090ff",slategrey:"0x708090ff",snow:"0xfffafaff",springgreen:"0x00ff7fff",steelblue:"0x4682b4ff",tan:"0xd2b48cff",teal:"0x008080ff",thistle:"0xd8bfd8ff",tomato:"0xff6347ff",transparent:"0x00000000",turquoise:"0x40e0d0ff",violet:"0xee82eeff",wheat:"0xf5deb3ff",white:"0xffffffff",whitesmoke:"0xf5f5f5ff",yellow:"0xffff00ff",yellowgreen:"0x9acd32ff"},Yl=/^#?([0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i,Kl=/^(rgba?)\((\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*),(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\s*)(,(\s*(-?\d+(?:\.\d+)?)\s*))?\)$/,jl=/^(hsla?)\((\s*(360|3[0-5][0-9]|[12]?[0-9]{1,2})\s*),(\s*(100|[1-9]?[0-9])\s*)%,(\s*(100|[1-9]?[0-9])\s*)%(,(\s*(1|0(?:\.\d+)?)\s*))?\)$/,gr={},Mi=o=>{if(gr[o]!==void 0)return gr[o];const t=parseInt(o).toString(16).padStart(2,"0");return gr[o]=t,t},Ds={normalize:(o="",t="0xffffffff")=>{if(o=o.toString(),o.startsWith("0x")&&o.length===10)return o;if(Ai[o]!==void 0)return Ai[o];if(Yl.test(o)){o=o.replace("#","").toLowerCase(),o.length===3&&(o=o.split("").map(r=>r+r).join(""));const s="0x"+o.padEnd(8,"f");return Ai[o]=s,s}const e=Kl.exec(o);if(e){const s=Mi(e[3]),r=Mi(e[5]),l=Mi(e[7]);let a="ff";if(e[10]&&e[1]==="rgba"){const n=Math.min(Math.max(Math.round(parseFloat(e[10])*255),0),255);a=Mi(n)}const i="0x"+s+r+l+a;return Ai[o]=i,i}return jl.test(o)?(console.warn("HSL(A) color format is not supported yet"),"0xffffffff"):t}},ql=(o="",t,e,s=null)=>{let r=0,l=0,a=[],i=null,n=0;const c=/^<\/?([a-zA-Z0-9_\-.]+)\s*/,h=/^\s*(\/?>)\s*/,d=/^([A-Za-z0-9:.\-_@$]+)=\s*(["'])/,m=/^<>\s*/,p=/^\s*(<\/>)\s*/,u=()=>{o=T(o);try{return x(v),A(a)}catch(_){throw(_.name=="TemplateParseError"||_.name=="TemplateStructureError")&&(_.message=`${_.message}
${_.context}`),_}},x=_=>{r>=o.length||_()},T=_=>_.replace(/<!--.*?-->/gms,"").replace(/\r?\n\s*\r\n/gm," ").replace(/\r?\n\s*(\S)/gm," $1").replace(/\r?\n/g,"").trim(),b=_=>{const k=o.slice(r).match(_);return k&&(l=r,r+=k[0].length),k},v=()=>{b(m)?(a.push({[Symbol.for("componentType")]:null,[g.type]:"opening",[g.level]:n,[g.cursorTagStart]:l}),n++,x(v)):x(R)},R=()=>{b(p)?(n--,a.push({[Symbol.for("componentType")]:null,[g.type]:"closing",[g.level]:n}),x(v)):x(w)},w=()=>{const _=b(c);if(_)i={[Symbol.for("componentType")]:_[1],[g.level]:n,[g.cursorTagStart]:l},_[0].startsWith("</")?(n--,i[g.type]="closing",i[g.level]=n):(i[g.type]="opening",n++),x(E);else throw N("InvalidTag")},E=()=>{const _=b(h);if(_){if(_[1]==="/>"){if(i[g.type]==="closing")throw N("InvalidClosingTag");i[g.type]="self-closing",n--}if(i[g.type]==="opening"){const k=o.slice(r,o.indexOf("<",r));k&&(i.content=k,r+=k.length)}a.push(i),x(v)}else x(S)},S=()=>{const _=b(d);if(_){if(i[g.type]==="closing")throw N("AttributesInClosingTag");const k=_[2],V=new RegExp(`^(.*?)${k}\\s*`),W=b(V);if(W){const D=M(_[1],W[1]);i[D.name]=D.value,x(E)}else throw N("MissingOrInvalidAttributeValue")}else throw N("InvalidAttribute")},M=(_,k)=>{if(_.includes(".")){const[V,W]=_.split(".");return{name:V,value:`{${W}: ${k}}`}}return["color",":color",":effects","effects"].includes(_)?I(_,k):{name:_,value:k}},I=(_,k)=>{let V=k,W=Ds.normalize(V,null);if(W===null){const D=/'([^']+)'/g;let Y,U=0,K="";for(;(Y=D.exec(k))!==null;){const me=Y[1],j=Y.index,q=Y[0].length;K+=k.slice(U,j),W=Ds.normalize(me,null),W===null?K+=k.slice(j,j+q):K+=`'${W}'`,U=j+q}K+=k.slice(U),V=K}else V=W;return{name:_,value:V}},A=_=>{let k=[],V=!1,W={children:[]},D=W;for(let Y=0;Y<_.length;Y++){let U=_[Y];if(U[g.level]===0&&U[g.type]!=="closing"){if(V)throw z("MultipleTopLevelTags",U);V=!0}if(U[g.type]==="opening")k.push({[g.level]:U[g.level],[g.type]:U[g.type],[g.cursorTagStart]:U[g.cursorTagStart],[Symbol.for("componentType")]:U[Symbol.for("componentType")],parent:D});else if(U[g.type]==="closing"){const me=k.length===0;let j=!1,q=!1;if(me||(j=k[k.length-1][g.level]!==U[g.level],q=k[k.length-1][Symbol.for("componentType")]!==U[Symbol.for("componentType")]),me||j||q)throw z("MismatchedClosingTag",U);D=k.pop().parent}const K={...U};delete K[g.type],delete K[g.level],delete K[g.cursorTagStart],U[g.type]==="opening"?(Y+1<_.length&&_[Y+1][g.type]!=="closing"&&(K.children=[]),D.children.push(K),D=K):U[g.type]==="self-closing"&&D.children.push(K)}if(k.length>0)throw z("UnclosedTags",k);return W},B=10,P=50,N=_=>{const k=F();_=`${_} in ${k}`;const V=new Error(_);V.name="TemplateParseError";const W=Math.max(0,l-B),D=Math.min(o.length,r+P),Y=o.slice(W,D),U=r-W;return V.context=$(U,Y),V},z=(_,k)=>{const V=F();_=`${_} in ${V}`;const W=new Error(_);W.name="TemplateStructureError",Array.isArray(k)?W.context=k.map(Y=>D(Y)).join(`
`):W.context=D(k);function D(Y){const U=Math.max(0,Y[g.cursorTagStart]-B),K=o.slice(U,U+P);return $(B,K)}return W},$=(_,k)=>{const V=" ".repeat(_)+"^";return`
${k}
${V}
`},F=()=>s||"Blits.Application";return u()};let G;function Zl(o={children:[]}){const t={renderCode:["const elms = []","let componentType","const rootComponent = component","let propData"],effectsCode:[],context:{props:[],components:this.components}};return G=-1,In.call(t,o),t.renderCode.push("return elms"),{render:new Function("parent","component","context","components","effect","getRaw",t.renderCode.join(`
`)),effects:t.effectsCode.map(e=>new Function("component","elms","context","components","rootComponent","effect",e)),context:t.context}}const qi=function(o,t=!1,e={key:!1,component:"component.",forceEffect:!1,forloop:!1}){const s=e.forceEffect?this.effectsCode:this.renderCode;t&&s.push(`parent = ${t}`),"key"in o&&(e.key=Ee(o.key,e.component));const r=e.key?`elms[${G}][${e.key}]`:`elms[${G}]`;e.key&&s.push(`
      if(elms[${G}] === undefined) {
        elms[${G}] = {}
      }
    `),s.push(`const elementConfig${G} = {}`),e.forloop&&s.push(`if(${r} === undefined) {`),s.push(`
    ${r} = this.element({parent: parent || 'root'}, component)
  `),e.forloop&&s.push("}");const l=o.children;delete o.children,o[Symbol.for("componentType")]==="Slot"&&s.push(`elementConfig${G}[Symbol.for('isSlot')] = true`),Object.keys(o).forEach(a=>{if(a==="slot"&&s.push(`
        elementConfig${G}['parent'] = component[Symbol.for('slots')].filter(slot => slot.ref === '${o.slot}').shift() || parent
      `),a!=="key")if(Ln(a)){if(e.holder&&a===":color")return;e.holder?this.effectsCode.push(`
        if(typeof skip${G} === 'undefined' ||
          skip${G}.indexOf('${a.substring(1)}') === -1)
          ${r}.set('${a.substring(1)}', ${Ee(o[a],e.component)})
        `):this.effectsCode.push(`
            ${r}.set('${a.substring(1)}', ${Ee(o[a],e.component)})
          `),s.push(`elementConfig${G}['${a.substring(1)}'] = ${Ee(o[a],e.component)}`)}else s.push(`elementConfig${G}['${a}'] = ${Hr(o[a],a,e.component)}`)}),e.holder===!0&&s.push(`
    const skip${G} = []
    if(typeof cmp${G} !== 'undefined') {
      for(let key in cmp${G}.config.props) {
        delete elementConfig${G}[cmp${G}.config.props[key]]
        skip${G}.push(cmp${G}.config.props[key])
      }
    }
    `),e.forloop&&s.push(`if(${r}.nodeId === undefined) {`),s.push(`${r}.populate(elementConfig${G})`),e.forloop&&s.push("}"),l&&In.call(this,{children:l},`${r}`,e)},kn=function(o,t=!1,e={key:!1,component:"component.",forceEffect:!1,holder:!1,forloop:!1}){const s=e.forceEffect?this.effectsCode:this.renderCode;s.push(`
    const cmp${G} =
      (context.components && context.components['${o[Symbol.for("componentType")]}']) || components['${o[Symbol.for("componentType")]}']
  `),"key"in o&&(e.key=Ee(o.key,e.component));const r=o.children;delete o.children,qi.call(this,o,t,{...e,holder:!0}),t=e.key?`elms[${G}][${e.key}]`:`elms[${G}]`,G++;const l=e.key?`elms[${G}][${e.key}]`:`elms[${G}]`;e.key&&s.push(`
      if(elms[${G}] === undefined) {
        elms[${G}] = {}
      }
    `),t&&s.push(`parent = ${t}`),s.push(`const props${G} = {}`),e.forloop&&s.push(`if(${l} === undefined) {`),Object.keys(o).forEach(a=>{Ln(a)?(this.effectsCode.push(`
        ${l}[Symbol.for('props')]['${a.substring(1)}'] = ${Ee(o[a],e.component)}`),s.push(`
        propData = ${Ee(o[a],e.component)}
        if (Array.isArray(propData) === true) {
          propData = getRaw(propData).slice(0)
        }
        props${G}['${a.substring(1)}'] = propData`)):s.push(`props${G}['${a}'] = ${Hr(o[a],a,e.component)}`)}),s.push(`
    componentType = props${G}['is'] || '${o[Symbol.for("componentType")]}'

    let component${G}
    if(typeof componentType === 'string') {
      component${G} = context.components && context.components[componentType] || components[componentType]
      if(!component${G}) {
        throw new Error('Component "${o[Symbol.for("componentType")]}" not found')
      }
    } else if(typeof componentType === 'function' && componentType[Symbol.for('isComponent')] === true) {
      component${G} = componentType
    }

    ${l} = component${G}.call(null, {props: props${G}}, ${t}, component)

    if (${l}[Symbol.for('slots')][0]) {
      parent = ${l}[Symbol.for('slots')][0]
      component = ${l}
    } else {
      parent = ${l}[Symbol.for('children')][0]
    }
  `),e.forloop&&s.push("}"),r&&(G++,qi.call(this,{children:r},!1,{...e}))},Ql=function(o,t){const e=o[":for"];delete o[":for"];const s=o.key,r=Ee(s,"scope."),l=!(o.$shallow&&o.$shallow.toLowerCase()==="false");delete o.$shallow,delete o.key;const i=/(.+)\s+in\s+(.+)/gi.exec(e),[n,c="index"]=i[1].replace("(","").replace(")","").split(/\s*,\s*/),h=new RegExp(`(scope\\.(?!${n}\\.|${c}|key)(\\w+))`,"gi"),d={renderCode:[],effectsCode:[],context:{props:[],components:this.components}};t&&d.renderCode.push(`parent = ${t}`);const p=new RegExp(`\\$${c}(?!['\\w])`).exec(s);Array.isArray(p)&&d.renderCode.push(`console.warn(" Using '${c}' in the key, like key=${s},  is not recommended")`);const u=G;d.renderCode.push(`
    const created${u} = []
    const forloop${u} = (collection = [], elms, created) => {
      const rawCollection = getRaw(collection)
      const keys = new Set()
      let l = rawCollection.length
      while(l--) {
        const ${n} = rawCollection[l]
        const ${c} = l
        keys.add('' +  ${Ee(s,"")||"l"})
      }
  `);const x=d.renderCode.length;d.renderCode.push(`
      created.length = 0
      const length = rawCollection.length
      for(let __index = 0; __index < length; __index++) {
        const scope = Object.create(component)
        parent = ${t}
        scope['${c}'] = __index
        scope['${n}'] = rawCollection[__index]
        scope['key'] = '' + ${r||"__index"}
  `),"ref"in o&&o.ref.indexOf("$")===-1&&(d.renderCode.push(`
        scope['__ref'] = '${o.ref}' + __index
    `),o.ref="$__ref"),d.renderCode.push(`
        created.push(scope.key)
  `),o[Symbol.for("componentType")]==="Element"||o[Symbol.for("componentType")]==="Slot"||o[Symbol.for("componentType")]==="Text"?(o[Symbol.for("componentType")]==="Text"&&(o.__textnode="true"),qi.call(d,o,t,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0})):kn.call(d,o,!1,{key:"scope.key",component:"scope.",forceEffect:!1,forloop:!0});const T=d.effectsCode.filter(w=>[...w.matchAll(h)].length===0),b=d.effectsCode.filter(w=>[...w.matchAll(h)].length!==0);l===!1&&d.renderCode.push(`
      scope['${n}'] = null
      scope['${n}'] = collection[__index]
  `),T.forEach((w,E)=>{const S=w.indexOf(`scope.${E}`)>-1?`'${Ee(i[2],"")}'`:null;w.indexOf("Symbol.for('props')")===-1?d.renderCode.push(`
        let eff${E} = () => {
          ${w}
        }
        effect(eff${E}, ${S})
        component[Symbol.for('effects')].push(eff${E})
      `):d.renderCode.push(`
        ${w}
      `)}),d.renderCode.push(`
    }
  }`);const v=[];v.push(`
      let i = created.length

      while (i--) {
        if (keys.has(created[i]) === false) {
          const key = created[i]
  `);const R=G;for(let w=u;w<=R;w++)v.push(`
          elms[${w}][key] && elms[${w}][key].destroy()
          delete elms[${w}][key]
      `);v.push(`
       }
    }
  `),d.renderCode.splice(x,0,...v),d.renderCode.push(`
    effect(() => {
      forloop${u}(${Hr(i[2],":for")}, elms, created${u})
    }, '${Ee(i[2],"")}')
  `),b.forEach(w=>{const E=[...w.matchAll(h)];let S=E.length;const M=[];for(;S--;){const I=E[S],A=`component.${I[2]}`;M.indexOf(A)===-1&&M.push(A),I[2]!==n&&(w=w.substring(0,I.index)+A+w.substring(I.index+I[1].length))}d.renderCode.push(`
      effect(() => {
        void ${M.join(", ")}
        for(let __index = 0; __index < ${Ee(i[2])}.length; __index++) {
          const scope = {}
          scope['${c}'] = __index
          scope['${n}'] = ${Ee(i[2])}[__index]
          scope['key'] = ${r||"__index"}
    `),d.renderCode.push(`
          ${w}
        }
      })
    `)}),this.renderCode.push(d.renderCode.join(`
`))},In=function(o,t=!1,e={}){o.children&&o.children.forEach(s=>{G++,Object.keys(s).indexOf(":for")>-1?Ql.call(this,s,t):s[Symbol.for("componentType")]==="Element"||s[Symbol.for("componentType")]==="Slot"||s[Symbol.for("componentType")]==="Text"||s[Symbol.for("componentType")]==="Layout"?(s[Symbol.for("componentType")]==="Text"&&(s.__textnode="true"),s[Symbol.for("componentType")]==="Layout"&&(s.__layout="true"),qi.call(this,s,t,e)):kn.call(this,s,t,e)})},Ee=(o,t="component.")=>{if(o===void 0)return o;const e=/('.*?')+/gi,s=/\$(\$(?=\$)|\$?)/g,r=o.matchAll(e),l=[];let a=0;for(const i of r)l.push(i[0]),o=o.replace(i[0],`[@@REPLACEMENT${a}@@]`),a++;return o=o.replace(s,(i,n)=>{if(n==="")return t;if(n==="$")return t+"$"}),l.forEach((i,n)=>{o=o.replace(`[@@REPLACEMENT${n}@@]`,i)}),o},Hr=(o="",t=!1,e="component.")=>{const s=/\$\w+/gi;let r;if(t==="content")if(o.startsWith("$"))r=`${e}${o.replace("$","")}`;else{const l=o.replace(/\\\\/g,"__DOUBLE_BACKSLASH__").replace(/(^|[^\\])'/g,"$1\\'").replace(/__DOUBLE_BACKSLASH__/g,"\\\\");r=`'${Jl(l,e)}'`}else if(t!=="color"&&!isNaN(parseFloat(o))){if(r=parseFloat(o),o.endsWith("%")){const a={w:"width",width:"width",x:"width",h:"height",height:"height",y:"height"}[t];a&&(r=`parent.node.${a} * (${r} / 100)`)}}else if(o.toLowerCase()==="true")r=!0;else if(o.toLowerCase()==="false")r=!1;else if(t.startsWith("@")&&o){const l=e.slice(0,-1);r=`${l}['${o.replace("$","")}'] && ${l}['${o.replace("$","")}'].bind(${l})`}else if(o.startsWith("$"))r=`${e}${o.replace("$","")}`;else if(s.exec(o)){const l=/\w+\s*:\s*(?:[^\s,}]+|".*?"|'.*?')/g,a=o.match(l);if(r={},a)for(let i=0;i<a.length;i++){const n=a[i].split(/\s*:\s*/);n&&ea(n[0],n[1],e,r)}return ta(r)}else r=`"${o}"`;return r},Ln=o=>o.startsWith(":"),Jl=(o,t)=>{const e=/\{\{\s*(\$\S+)\s*\}\}/g,s=[...o.matchAll(e)];if(s.length)for(let[r,l]of s)o=o.replace(r,`${l.replace("$",`'+${t}`)}+'`);return o},ea=(o,t,e,s)=>{t.startsWith("$")?s[o]=`${e}${t.replace("$","")}`:s[o]=t},ta=o=>{const t=[];return Object.keys(o).forEach(e=>{t.push(`${e}: ${o[e]}`)}),` { ${t.join(", ")} }`},sn={};let sa=0;const oa=o=>`BlitsComponent::${o}_${sn[o]=(sn[o]||0)+1}`,ia=()=>++sa,et={},Rr=(o,t,e,s=[])=>{et[t]&&et[t][o]&&et[t][o].apply(e,s)},ra=(o,t,e)=>{const s=g[o];et[t]&&et[t][s]&&et[t][s].apply(e)},na=(o={},t)=>{et[t]={},[...Object.keys(o),...Object.getOwnPropertySymbols(o)].forEach(s=>{typeof o[s]=="function"&&(et[t][s]=o[s])})},la={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function aa(o,t=!1,e){const s={alpha:!0,antialias:!1,depth:!1,stencil:!0,desynchronized:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!1},r=o.getContext(t?"webgl2":"webgl",s)||o.getContext("experimental-webgl",s);if(!r)throw new Error("Unable to create WebGL context");return e?new Proxy(r,{get(l,a){const i=l[a];return typeof i=="function"?(e.increment(String(a)),i.bind(l)):i}}):r}function L(o,t){if(Yr()!==!0&&!o)throw new Error(t||"Assertion failed")}function on(o,t,e){const s=Math.trunc(o>>>24),r=Math.trunc(o>>>16&255),l=Math.trunc(o>>>8&255),a=Math.trunc(o&255),i=Math.trunc(t>>>24),n=Math.trunc(t>>>16&255),c=Math.trunc(t>>>8&255),h=Math.trunc(t&255),d=Math.round(i*e+s*(1-e)),m=Math.round(n*e+r*(1-e)),p=Math.round(c*e+l*(1-e)),u=Math.round(h*e+a*(1-e));return(d<<24|m<<16|p<<8|u)>>>0}function fa(o,t){const e=o>>>24,s=o>>>16&255,r=o>>>8&255,l=Math.trunc((o&255)*t);return(e<<24|s<<16|r<<8|l)>>>0}let Pn=!0;function ca(o){Pn=o==="webgl"}function ki(o,t,e=!1){const s=(o&255)/255*t,r=Pn?s:1,l=Math.trunc((o>>>24)*r),a=Math.trunc((o>>>16&255)*r),i=Math.trunc((o>>>8&255)*r),n=Math.trunc(s*255);return e?(n<<24|i<<16|a<<8|l)>>>0:(l<<24|a<<16|i<<8|n)>>>0}function Zi(o,t){return Object.prototype.hasOwnProperty.call(o,t)}function Yr(){return la&&!0}let ha=1;function ua(){return ha++}class tt{constructor(){f(this,"eventListeners",{})}on(t,e){let s=this.eventListeners[t];s||(s=[]),s.push(e),this.eventListeners[t]=s}off(t,e){const s=this.eventListeners[t];if(!s)return;if(!e){delete this.eventListeners[t];return}const r=s.indexOf(e);r>=0&&s.splice(r,1)}once(t,e){const s=(r,l)=>{this.off(t,s),e(r,l)};this.on(t,s)}emit(t,e){const s=this.eventListeners[t];s&&[...s].forEach(r=>{r(this,e)})}removeAllListeners(){this.eventListeners={}}}const da=/^(data|ftps?|https?):/,Ws=o=>{const t=o>>>24,e=o>>>16&255,s=o>>>8&255,r=o&255;return[t/255,e/255,s/255,r/255]},pa=o=>{const t=o>>>24,e=o>>>16&255,s=o>>>8&255,r=o&255;return[t,e,s,r]};function ma(o){return(o&255)/255}function yr(o){const t=Math.floor(o[0]*255),e=Math.floor(o[1]*255),s=Math.floor(o[2]*255),r=Math.floor(o[3]*255);return`rgba(${t},${e},${s},${r.toFixed(4)})`}function Us(o,t,e,s,r){return r?(r.x1=o,r.y1=t,r.x2=e,r.y2=s,r):{x1:o,y1:t,x2:e,y2:s}}function xr(o,t){return o.x1<t.x2&&o.x2>t.x1&&o.y1<t.y2&&o.y2>t.y1}function ga(o,t){return t?(t.x=o.x1,t.y=o.y1,t.width=o.x2-o.x1,t.height=o.y2-o.y1,t):{x:o.x1,y:o.y1,width:o.x2-o.x1,height:o.y2-o.y1}}function Fn(o,t,e){const s=Math.max(o.x,t.x),r=Math.max(o.y,t.y),l=Math.min(o.x+o.width,t.x+t.width)-s,a=Math.min(o.y+o.height,t.y+t.height)-r;return l>0&&a>0?e?(e.x=s,e.y=r,e.width=l,e.height=a,e):{x:s,y:r,width:l,height:a}:e?(e.x=0,e.y=0,e.width=0,e.height=0,e):{x:0,y:0,width:0,height:0}}function Bn(o,t){return t?(t.x=o.x,t.y=o.y,t.width=o.width,t.height=o.height,t):{x:o.x,y:o.y,width:o.width,height:o.height}}function ya(o,t){return o===t?!0:o===null||t===null?!1:o.x===t.x&&o.y===t.y&&o.width===t.width&&o.height===t.height}function Tr(o,t){return o.x1<=t.x2&&o.y1<=t.y2&&o.x2>=t.x1&&o.y2>=t.y1}function xa(o,t){return o.x1<t.x1&&o.x2>t.x2&&o.y1<t.y1&&o.y2>t.y2}function Ta(o){return o.x1<o.x2&&o.y1<o.y2}function Er(o,t){return Us(o.x1-t[3],o.y1-t[0],o.x2+t[1],o.y2+t[2])}function ba(o){if(self.location.protocol==="file:"&&!da.test(o)){const e=self.location.pathname.split("/");e.pop();const s=e.join("/"),r=self.location.protocol+"//"+s;return o.charAt(0)==="."&&(o=o.slice(1)),o.charAt(0)==="/"&&(o=o.slice(1)),r+"/"+o}return new URL(o,self.location.href).href}class be{constructor(){f(this,"ta");f(this,"tb");f(this,"tx");f(this,"tc");f(this,"td");f(this,"ty");f(this,"_floatArr",null);f(this,"mutation");this.ta=0,this.tb=0,this.tx=0,this.tc=0,this.td=0,this.ty=0,this.mutation=!0}static get temp(){return Sa}static multiply(t,e,s){const r=t.ta*e.ta+t.tb*e.tc,l=t.ta*e.tb+t.tb*e.td,a=t.ta*e.tx+t.tb*e.ty+t.tx,i=t.tc*e.ta+t.td*e.tc,n=t.tc*e.tb+t.td*e.td,c=t.tc*e.tx+t.td*e.ty+t.ty;return s||(s=new be),s.ta=r,s.tb=l,s.tx=a,s.tc=i,s.td=n,s.ty=c,s.mutation=!0,s}static identity(t){return t||(t=new be),t.ta=1,t.tb=0,t.tx=0,t.tc=0,t.td=1,t.ty=0,t.mutation=!0,t}static translate(t,e,s){return s||(s=new be),s.ta=1,s.tb=0,s.tx=t,s.tc=0,s.td=1,s.ty=e,s.mutation=!0,s}static scale(t,e,s){return s||(s=new be),s.ta=t,s.tb=0,s.tx=0,s.tc=0,s.td=e,s.ty=0,s.mutation=!0,s}static rotate(t,e){const s=Math.cos(t),r=Math.sin(t);return e||(e=new be),e.ta=s,e.tb=-r,e.tx=0,e.tc=r,e.td=s,e.ty=0,e.mutation=!0,e}static copy(t,e){return e||(e=new be),e.ta=t.ta,e.tc=t.tc,e.tb=t.tb,e.td=t.td,e.tx=t.tx,e.ty=t.ty,e.mutation=!0,e}translate(t,e){return this.tx=this.ta*t+this.tb*e+this.tx,this.ty=this.tc*t+this.td*e+this.ty,this.mutation=!0,this}scale(t,e){return this.ta=this.ta*t,this.tb=this.tb*e,this.tc=this.tc*t,this.td=this.td*e,this.mutation=!0,this}rotate(t){if(t===0||!(t%Math.PI*2))return this;const e=Math.cos(t),s=Math.sin(t),r=this.ta*e+this.tb*s,l=this.tb*e-this.ta*s,a=this.tc*e+this.td*s,i=this.td*e-this.tc*s;return this.ta=r,this.tb=l,this.tc=a,this.td=i,this.mutation=!0,this}multiply(t){return be.multiply(this,t,this)}getFloatArr(){return this._floatArr||(this._floatArr=new Float32Array(9)),this.mutation&&(this._floatArr[0]=this.ta,this._floatArr[1]=this.tc,this._floatArr[2]=0,this._floatArr[3]=this.tb,this._floatArr[4]=this.td,this._floatArr[5]=0,this._floatArr[6]=this.tx,this._floatArr[7]=this.ty,this._floatArr[8]=1,this.mutation=!1),this._floatArr}}const Sa=new be,Ii=0,Li=2,Pi=4,Fi=6,Bi=1,Oi=3,Ui=5,$i=7;class Qi{constructor(t){f(this,"data");this.data=new Float32Array(8),t&&(this.data[Ii]=t[Ii],this.data[Li]=t[Li],this.data[Pi]=t[Pi],this.data[Fi]=t[Fi],this.data[Bi]=t[Bi],this.data[Oi]=t[Oi],this.data[Ui]=t[Ui],this.data[$i]=t[$i])}static translate(t,e,s,r,l,a,i,n,c){return c||(c=new Qi),c.data[Ii]=t,c.data[Li]=s,c.data[Pi]=l,c.data[Fi]=i,c.data[Bi]=e,c.data[Oi]=r,c.data[Ui]=a,c.data[$i]=n,c}get x1(){return this.data[Ii]}get x2(){return this.data[Li]}get x3(){return this.data[Pi]}get x4(){return this.data[Fi]}get y1(){return this.data[Bi]}get y2(){return this.data[Oi]}get y3(){return this.data[Ui]}get y4(){return this.data[$i]}}const rn=o=>o&&!(o&o-1),On=(o,t,e,s)=>{const r=3*o,l=3*(e-o)-r,a=1-r-l,i=3*t,n=3*(s-t)-i,c=1-i-n;return function(h){if(h>=1)return 1;if(h<=0)return 0;let d=.5,m,p,u;for(let b=0;b<20;b++){if(m=d*(d*(d*a+l)+r),u=h-m,u>-1e-8&&u<1e-8)return d*(d*(d*c+n)+i);if(p=d*(d*(3*a)+2*l)+r,p>1e-10&&p<1e-10)break;d+=u/p}let x=0,T=1;for(let b=0;b<20;b++){if(d=.5*(x+T),m=d*(d*(d*a+l)+r),u=h-m,u>-1e-8&&u<1e-8)return d*(d*(d*c+n)+i);u<0?T=d:x=d}}},Gi={},wa={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],"ease-in-sine":[.12,0,.39,0],"ease-out-sine":[.12,0,.39,0],"ease-in-out-sine":[.37,0,.63,1],"ease-in-cubic":[.32,0,.67,0],"ease-out-cubic":[.33,1,.68,1],"ease-in-out-cubic":[.65,0,.35,1],"ease-in-circ":[.55,0,1,.45],"ease-out-circ":[0,.55,.45,1],"ease-in-out-circ":[.85,0,.15,1],"ease-in-back":[.36,0,.66,-.56],"ease-out-back":[.34,1.56,.64,1],"ease-in-out-back":[.68,-.6,.32,1.6]},zi=o=>o,Ca=o=>{const t=/-?\d*\.?\d+/g,e=o.match(t);if(e){const[s,r,l,a]=e,i=parseFloat(s||"0.42"),n=parseFloat(r||"0"),c=parseFloat(l||"1"),h=parseFloat(a||"1"),d=On(i,n,c,h);return Gi[o]=d,d}return console.warn("Unknown cubic-bezier timing: "+o),zi},va=o=>{if(o==="linear")return zi;if(Gi[o]!==void 0)return Gi[o]||zi;if(o==="step-start")return()=>1;if(o==="step-end")return e=>e===1?1:0;const t=wa[o];if(t!==void 0){const[e,s,r,l]=t,a=On(e,s,r,l);return Gi[o]=a,a}return o.startsWith("cubic-bezier")?Ca(o):(console.warn("Unknown timing function: "+o),zi)};function nn(o){return(o/1024/1024).toFixed(2)}class _a extends tt{constructor(e,s,r){super();f(this,"node");f(this,"props");f(this,"settings");f(this,"progress",0);f(this,"delayFor",0);f(this,"delay",0);f(this,"timingFunction");f(this,"propValuesMap",{});f(this,"dynPropValuesMap");this.node=e,this.props=s;for(const i in s)if(i!=="shaderProps")this.propValuesMap.props===void 0&&(this.propValuesMap.props={}),this.propValuesMap.props[i]={start:e[i]||0,target:s[i]};else if(e.shader.type!=="DynamicShader"){this.propValuesMap.shaderProps={};for(const n in s.shaderProps)this.propValuesMap.shaderProps[n]={start:e.shader.props[n],target:s.shaderProps[n]}}else{const n=Object.keys(s.shaderProps),c=n.length;this.dynPropValuesMap={};for(let h=0;h<c;h++){const d=n[h],m=s.shaderProps[d];this.dynPropValuesMap[d]={};const p=Object.entries(m),u=p.length;for(let x=0;x<u;x++){const[T,b]=p[x];this.dynPropValuesMap[d][T]={start:e.shader.props[d][T],target:b}}}}const l=r.easing||"linear",a=r.delay??0;this.settings={duration:r.duration??0,delay:a,easing:l,loop:r.loop??!1,repeat:r.repeat??0,repeatDelay:r.repeatDelay??0,stopMethod:r.stopMethod??!1},this.timingFunction=va(l),this.delayFor=a,this.delay=a}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restoreValues(e,s){const r=Object.entries(s),l=r.length;for(let a=0;a<l;a++){const[i,n]=r[a];e[i]=n.start}}restore(){if(this.reset(),this.propValuesMap.props!==void 0&&this.restoreValues(this.node,this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.restoreValues(this.node.shader.props,this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),s=e.length;if(s>0)for(let r=0;r<s;r++){const l=e[r];this.restoreValues(this.node.shader.props[l],this.dynPropValuesMap[l])}}}reverseValues(e){const s=Object.entries(e),r=s.length;for(let l=0;l<r;l++){const[a,i]=s[l];e[a]={start:i.target,target:i.start}}}reverse(){if(this.progress=0,this.propValuesMap.props!==void 0&&this.reverseValues(this.propValuesMap.props),this.propValuesMap.shaderProps!==void 0&&this.reverseValues(this.propValuesMap.shaderProps),this.dynPropValuesMap!==void 0){const e=Object.keys(this.dynPropValuesMap),s=e.length;if(s>0)for(let r=0;r<s;r++){const l=e[r];this.reverseValues(this.dynPropValuesMap[l])}}this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,s,r){return(this.timingFunction(e)||e)*(r-s)+s}updateValue(e,s,r,l){if(this.progress===1)return s;if(this.progress===0)return r;const a=s;if(e.indexOf("color")!==-1){if(r===a)return r;if(l){const i=this.timingFunction(this.progress)||this.progress;return on(r,a,i)}return on(r,a,this.progress)}return l?this.applyEasing(this.progress,r,a):r+(a-r)*this.progress}updateValues(e,s,r){const l=Object.entries(s),a=l.length;for(let i=0;i<a;i++){const[n,c]=l[i];e[n]=this.updateValue(n,c.target,c.start,r)}}update(e){const{duration:s,loop:r,easing:l,stopMethod:a}=this.settings,{delayFor:i}=this;if(s===0&&i===0){this.emit("finished",{});return}if(this.delayFor>0){if(this.delayFor-=e,this.delayFor>=0)return;e=-this.delayFor,this.delayFor=0}if(s===0){this.emit("finished",{});return}if(this.progress===0&&this.emit("animating",{}),this.progress+=e/s,this.progress>1&&(this.progress=r?0:1,this.delayFor=this.delay,a)){this.emit("finished",{});return}if(this.propValuesMap.props!==void 0&&this.updateValues(this.node,this.propValuesMap.props,l),this.propValuesMap.shaderProps!==void 0&&this.updateValues(this.node.shader.props,this.propValuesMap.shaderProps,l),this.dynPropValuesMap!==void 0){const n=Object.keys(this.dynPropValuesMap),c=n.length;if(c>0)for(let h=0;h<c;h++){const d=n[h];this.updateValues(this.node.shader.props[d],this.dynPropValuesMap[d],l)}}this.progress<1&&this.emit("tick",{progress:this.progress}),this.progress===1&&this.emit("finished",{})}}class Ra extends tt{constructor(e,s){super();f(this,"manager");f(this,"animation");f(this,"stoppedPromise");f(this,"stoppedResolve",null);f(this,"state");this.manager=e,this.animation=s,this.state="stopped",this.stoppedPromise=Promise.resolve(),this.onAnimating=this.onAnimating.bind(this),this.onFinished=this.onFinished.bind(this),this.onTick=this.onTick.bind(this)}start(){return this.state!=="running"&&this.state!=="scheduled"&&(this.makeStoppedPromise(),this.registerAnimation(),this.state="scheduled"),this}stop(){return this.unregisterAnimation(),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this)),this.animation.reset(),this.state="stopped",this}pause(){return this.unregisterAnimation(),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){return this.stoppedPromise}registerAnimation(){this.animation.once("finished",this.onFinished),this.animation.on("animating",this.onAnimating),this.animation.on("tick",this.onTick),this.manager.registerAnimation(this.animation)}unregisterAnimation(){this.manager.unregisterAnimation(this.animation),this.animation.off("finished",this.onFinished),this.animation.off("animating",this.onAnimating),this.animation.off("tick",this.onTick)}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(e=>{this.stoppedResolve=e}))}onFinished(){L(this.stoppedResolve);const{loop:e,stopMethod:s}=this.animation.settings;if(s==="reverse"){this.animation.once("finished",this.onFinished),this.animation.reverse();return}e||(this.unregisterAnimation(),this.stoppedResolve(),this.stoppedResolve=null,this.emit("stopped",this),this.state="stopped")}onAnimating(){this.state="running",this.emit("animating",this)}onTick(e,s){this.emit("tick",s)}}var pe;(function(o){o[o.Init=0]="Init",o[o.OutOfBounds=2]="OutOfBounds",o[o.InBounds=4]="InBounds",o[o.InViewport=8]="InViewport"})(pe||(pe={}));const ho=new Map;ho.set(pe.Init,"init");ho.set(pe.OutOfBounds,"outOfBounds");ho.set(pe.InBounds,"inBounds");ho.set(pe.InViewport,"inViewport");var C;(function(o){o[o.Children=1]="Children",o[o.ScaleRotate=2]="ScaleRotate",o[o.Local=4]="Local",o[o.Global=8]="Global",o[o.Clipping=16]="Clipping",o[o.CalculatedZIndex=32]="CalculatedZIndex",o[o.ZIndexSortedChildren=64]="ZIndexSortedChildren",o[o.PremultipliedColors=128]="PremultipliedColors",o[o.WorldAlpha=256]="WorldAlpha",o[o.RenderState=512]="RenderState",o[o.IsRenderable=1024]="IsRenderable",o[o.RenderTexture=2048]="RenderTexture",o[o.ParentRenderTexture=4096]="ParentRenderTexture",o[o.RenderBounds=8192]="RenderBounds",o[o.None=0]="None",o[o.All=14335]="All"})(C||(C={}));class Ar extends tt{constructor(e,s){super();f(this,"stage");f(this,"children",[]);f(this,"_id",ua());f(this,"props");f(this,"updateType",C.All);f(this,"childUpdateType",C.None);f(this,"globalTransform");f(this,"scaleRotateTransform");f(this,"localTransform");f(this,"renderCoords");f(this,"renderBound");f(this,"strictBound");f(this,"preloadBound");f(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1});f(this,"isRenderable",!1);f(this,"renderState",pe.Init);f(this,"worldAlpha",1);f(this,"premultipliedColorTl",0);f(this,"premultipliedColorTr",0);f(this,"premultipliedColorBl",0);f(this,"premultipliedColorBr",0);f(this,"calcZIndex",0);f(this,"hasRTTupdates",!1);f(this,"parentHasRenderTexture",!1);f(this,"onTextureLoaded",(e,s)=>{var r,l;this.autosizeNode(s),this.stage.requestRender(),this.parentHasRenderTexture&&this.setRTTUpdates(1),this.emit("loaded",{type:"texture",dimensions:s}),((l=(r=this.props.textureOptions)==null?void 0:r.resizeMode)==null?void 0:l.type)==="contain"&&this.setUpdateType(C.Local)});f(this,"onTextureFailed",(e,s)=>{this.emit("failed",{type:"texture",error:s})});f(this,"onTextureFreed",()=>{this.emit("freed",{type:"texture"})});this.stage=e,this.props={...s,parent:null,texture:null,src:null,rtt:!1},this.parent=s.parent,this.texture=s.texture,this.src=s.src,this.rtt=s.rtt,this.setUpdateType(C.ScaleRotate|C.Local|C.RenderBounds|C.RenderState)}loadTexture(){const{texture:e}=this.props;L(e),queueMicrotask(()=>{e.preventCleanup=this.props.preventCleanup,this.textureOptions.preload&&e.ctxTexture.load(),e.state==="loaded"?(L(e.dimensions),this.onTextureLoaded(e,e.dimensions)):e.state==="failed"?(L(e.error),this.onTextureFailed(e,e.error)):e.state==="freed"&&this.onTextureFreed(e),e.on("loaded",this.onTextureLoaded),e.on("failed",this.onTextureFailed),e.on("freed",this.onTextureFreed)})}unloadTexture(){this.texture!==null&&(this.texture.off("loaded",this.onTextureLoaded),this.texture.off("failed",this.onTextureFailed),this.texture.off("freed",this.onTextureFreed),this.texture.setRenderableOwner(this,!1))}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}setUpdateType(e){this.updateType|=e;const s=this.props.parent;s&&(s.updateType&C.Children||s.setUpdateType(C.Children),this.parentHasRenderTexture!==!1&&(this.rtt===!1&&(s.updateType&C.RenderTexture||(this.setRTTUpdates(e),s.setUpdateType(C.RenderTexture))),this.hasRTTupdates&&this.setRTTUpdates(e)))}sortChildren(){this.children.sort((e,s)=>e.calcZIndex-s.calcZIndex)}updateScaleRotateTransform(){const{rotation:e,scaleX:s,scaleY:r}=this.props;if(e===0&&s===1&&r===1){this.scaleRotateTransform=void 0;return}this.scaleRotateTransform=be.rotate(e,this.scaleRotateTransform).scale(s,r)}updateLocalTransform(){var c,h;const{x:e,y:s,width:r,height:l}=this.props,a=this.props.mountX*r,i=this.props.mountY*l;if(this.scaleRotateTransform){const d=this.props.pivotX*r,m=this.props.pivotY*l;this.localTransform=be.translate(e-a+d,s-i+m,this.localTransform).multiply(this.scaleRotateTransform).translate(-d,-m)}else this.localTransform=be.translate(e-a,s-i,this.localTransform);const n=this.props.texture;if(n&&n.dimensions&&((h=(c=this.props.textureOptions)==null?void 0:c.resizeMode)==null?void 0:h.type)==="contain"){let d=1,m=1,p=0,u=0;const{width:x,height:T}=n.dimensions,b=x/T,v=r/l;if(b>v){const R=r/x,w=T*R;u=(l-w)/2,m=w/l}else{const R=l/T,w=x*R;p=(r-w)/2,d=w/r}this.localTransform.translate(p,u).scale(d,m)}this.setUpdateType(C.Global)}update(e,s){var a,i;this.updateType&C.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(C.Local)),this.updateType&C.Local&&(this.updateLocalTransform(),this.setUpdateType(C.Global));const r=this.props.parent;let l=null;if(this.updateType&C.ParentRenderTexture){let n=this.parent;for(;n;)n.rtt&&(this.parentHasRenderTexture=!0),n=n.parent}if(this.updateType^C.All&&this.updateType&C.RenderTexture)for(let n=0,c=this.children.length;n<c;n++)(a=this.children[n])==null||a.setUpdateType(C.All);if(this.updateType&C.Global&&(L(this.localTransform),this.globalTransform=be.copy((r==null?void 0:r.globalTransform)||this.localTransform,this.globalTransform),this.parentHasRenderTexture&&((i=this.props.parent)!=null&&i.rtt)&&(this.globalTransform=be.identity()),r&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(C.RenderState|C.Children),this.childUpdateType|=C.Global,this.clipping===!0&&(this.setUpdateType(C.Clipping|C.RenderBounds),this.childUpdateType|=C.RenderBounds)),this.updateType&C.RenderBounds&&(this.createRenderBounds(),this.setUpdateType(C.RenderState),this.setUpdateType(C.Children)),this.updateType&C.RenderState&&(l=this.checkRenderBounds(),this.setUpdateType(C.IsRenderable),l!==pe.OutOfBounds&&this.updateRenderState(l)),this.updateType&C.WorldAlpha&&(r?this.worldAlpha=r.worldAlpha*this.props.alpha:this.worldAlpha=this.props.alpha,this.setUpdateType(C.Children|C.PremultipliedColors|C.IsRenderable),this.childUpdateType|=C.WorldAlpha),this.updateType&C.IsRenderable&&this.updateIsRenderable(),this.updateType&C.Clipping&&(this.calculateClippingRect(s),this.setUpdateType(C.Children),this.childUpdateType|=C.Clipping,this.childUpdateType|=C.RenderBounds),this.updateType&C.PremultipliedColors&&(this.premultipliedColorTl=ki(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=ki(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=ki(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=ki(this.props.colorBr,this.worldAlpha,!0))),r!==null&&this.updateType&C.CalculatedZIndex&&(this.calculateZIndex(),r.setUpdateType(C.ZIndexSortedChildren)),!(this.props.strictBounds===!0&&this.renderState===pe.OutOfBounds)){if(this.updateType&C.Children&&this.children.length>0&&this.rtt===!1)for(let n=0,c=this.children.length;n<c;n++){const h=this.children[n];h.setUpdateType(this.childUpdateType),h.updateType!==0&&h.update(e,this.clippingRect)}this.updateType&C.ZIndexSortedChildren&&this.sortChildren(),l===pe.OutOfBounds&&(this.updateRenderState(l),this.updateIsRenderable()),this.updateType=0,this.childUpdateType=0}}hasRenderableProperties(){return this.props.texture?!0:!this.props.width||!this.props.height?!1:!!(this.props.shader!==this.stage.defShaderCtr||this.props.clipping||this.props.color!==0||this.props.colorTop!==0||this.props.colorBottom!==0||this.props.colorLeft!==0||this.props.colorRight!==0||this.props.colorTl!==0||this.props.colorTr!==0||this.props.colorBl!==0||this.props.colorBr!==0)}checkRenderBounds(){return L(this.renderBound),L(this.strictBound),L(this.preloadBound),Tr(this.renderBound,this.strictBound)?pe.InViewport:Tr(this.renderBound,this.preloadBound)?pe.InBounds:xa(this.renderBound,this.strictBound)?pe.InViewport:this.parent!==null&&(this.props.width===0||this.props.height===0)?this.parent.renderState:pe.OutOfBounds}updateBoundingRect(){const{renderCoords:e,globalTransform:s}=this;L(s),L(e);const{tb:r,tc:l}=s,{x1:a,y1:i,x3:n,y3:c}=e;if(r===0||l===0)this.renderBound=Us(a,i,n,c,this.renderBound);else{const{x2:h,x4:d,y2:m,y4:p}=e;this.renderBound=Us(Math.min(a,h,n,d),Math.min(i,m,c,p),Math.max(a,h,n,d),Math.max(i,m,c,p),this.renderBound)}}createRenderBounds(){if(L(this.stage),this.parent!==null&&this.parent.strictBound!==void 0){const h=this.parent.strictBound;this.strictBound=Us(h.x1,h.y1,h.x2,h.y2),this.preloadBound=Er(this.strictBound,this.stage.boundsMargin)}else this.strictBound=this.stage.strictBound,this.preloadBound=this.stage.preloadBound;if(this.props.clipping===!1||this.renderBound===void 0||Tr(this.renderBound,this.strictBound)===!1)return;const{x:e,y:s,width:r,height:l}=this.props,{tx:a,ty:i}=this.globalTransform||{},n=a??e,c=i??s;this.strictBound=Us(n,c,n+r,c+l,this.strictBound),this.preloadBound=Er(this.strictBound,this.stage.boundsMargin)}updateRenderState(e){if(e===this.renderState)return;const s=this.renderState;this.renderState=e;const r=ho.get(e);L(r),this.emit(r,{previous:s,current:e})}updateIsRenderable(){let e;this.worldAlpha===0||!this.hasRenderableProperties()?e=!1:e=this.renderState>pe.OutOfBounds,this.isRenderable!==e&&(this.isRenderable=e,this.onChangeIsRenderable(e))}onChangeIsRenderable(e){var s;(s=this.texture)==null||s.setRenderableOwner(this,e)}calculateRenderCoords(){const{width:e,height:s,globalTransform:r}=this;L(r);const{tx:l,ty:a,ta:i,tb:n,tc:c,td:h}=r;if(n===0&&c===0){const d=l,m=l+e*i,p=a,u=a+s*h;this.renderCoords=Qi.translate(d,p,m,p,m,u,d,u,this.renderCoords)}else this.renderCoords=Qi.translate(l,a,l+e*i,a+e*c,l+e*i+s*n,a+e*c+s*h,l+s*n,a+s*h,this.renderCoords)}calculateClippingRect(e){L(this.globalTransform);const{clippingRect:s,props:r,globalTransform:l}=this,{clipping:a}=r,i=l.tb!==0||l.tc!==0;a===!0&&i===!1?(s.x=l.tx,s.y=l.ty,s.width=this.width*l.ta,s.height=this.height*l.td,s.valid=!0):s.valid=!1,e.valid===!0&&s.valid===!0?Fn(e,s,s):e.valid===!0&&(Bn(e,s),s.valid=!0)}calculateZIndex(){var a,i;const e=this.props,s=e.zIndex||0,r=((a=e.parent)==null?void 0:a.zIndex)||0;let l=s;(i=e.parent)!=null&&i.zIndexLocked&&(l=s<r?s:r),this.calcZIndex=l}destroy(){var e;for(this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,this.renderCoords=void 0,this.renderBound=void 0,this.strictBound=void 0,this.preloadBound=void 0,this.globalTransform=void 0,this.scaleRotateTransform=void 0,this.localTransform=void 0,this.props.texture=null,this.props.shader=this.stage.defShaderCtr;this.children.length>0;)(e=this.children[0])==null||e.destroy();this.parent=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners()}renderQuads(e){this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode)||(L(this.globalTransform),L(this.renderCoords),e.addQuad({width:this.props.width,height:this.props.height,colorTl:this.premultipliedColorTl,colorTr:this.premultipliedColorTr,colorBl:this.premultipliedColorBl,colorBr:this.premultipliedColorBr,texture:this.texture,textureOptions:this.textureOptions,zIndex:this.zIndex,shader:this.shader.shader,shaderProps:this.shader.getResolvedProps(),alpha:this.worldAlpha,clippingRect:this.clippingRect,tx:this.globalTransform.tx,ty:this.globalTransform.ty,ta:this.globalTransform.ta,tb:this.globalTransform.tb,tc:this.globalTransform.tc,td:this.globalTransform.td,renderCoords:this.renderCoords,rtt:this.rtt,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions}))}get id(){return this._id}get data(){return this.props.data}set data(e){this.props.data=e}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(C.Local))}get absX(){var e,s,r;return this.props.x+-this.props.width*this.props.mountX+(((e=this.props.parent)==null?void 0:e.absX)||((r=(s=this.props.parent)==null?void 0:s.globalTransform)==null?void 0:r.tx)||0)}get absY(){var e;return this.props.y+-this.props.height*this.props.mountY+(((e=this.props.parent)==null?void 0:e.absY)??0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(C.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(C.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(C.RenderTexture)))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(C.Local),this.props.rtt&&(this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.setUpdateType(C.RenderTexture)))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(C.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(C.ScaleRotate))}get mount(){return this.props.mount}set mount(e){(this.props.mountX!==e||this.props.mountY!==e)&&(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(C.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(C.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(C.Local))}get pivot(){return this.props.pivot}set pivot(e){(this.props.pivotX!==e||this.props.pivotY!==e)&&(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(C.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(C.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(C.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(C.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(C.PremultipliedColors|C.WorldAlpha|C.Children|C.IsRenderable),this.childUpdateType|=C.WorldAlpha}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(C.Clipping|C.RenderBounds|C.Children),this.childUpdateType|=C.Global|C.Clipping}get color(){return this.props.color}set color(e){this.colorTop=e,this.colorBottom=e,this.colorLeft=e,this.colorRight=e,this.props.color=e,this.setUpdateType(C.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){(this.props.colorTl!==e||this.props.colorTr!==e)&&(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(C.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){(this.props.colorBl!==e||this.props.colorBr!==e)&&(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(C.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){(this.props.colorTl!==e||this.props.colorBl!==e)&&(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(C.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){(this.props.colorTr!==e||this.props.colorBr!==e)&&(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(C.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(C.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(C.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(C.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(C.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(C.CalculatedZIndex|C.Children);for(let s=0,r=this.children.length;s<r;s++)this.children[s].setUpdateType(C.CalculatedZIndex)}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(C.CalculatedZIndex|C.Children);for(let s=0,r=this.children.length;s<r;s++)this.children[s].setUpdateType(C.CalculatedZIndex)}get parent(){return this.props.parent}set parent(e){const s=this.props.parent;if(s!==e){if(this.props.parent=e,s){const r=s.children.indexOf(this);L(r!==-1,"CoreNode.parent: Node not found in old parent's children!"),s.children.splice(r,1),s.setUpdateType(C.Children|C.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(C.All),e.setUpdateType(C.Children|C.ZIndexSortedChildren),(e.rtt||e.parentHasRenderTexture)&&this.setRTTUpdates(C.All)),this.updateScaleRotateTransform(),this.setUpdateType(C.RenderBounds|C.Children)}}get preventCleanup(){return this.props.preventCleanup}set preventCleanup(e){this.props.preventCleanup=e}get rtt(){return this.props.rtt}set rtt(e){var s,r;if(this.props.rtt===!0&&(this.props.rtt=e,e===!1&&this.texture!==null)){this.unloadTexture(),this.setUpdateType(C.All);for(let l=0,a=this.children.length;l<a;l++)this.children[l].parentHasRenderTexture=!1;(s=this.stage.renderer)==null||s.removeRTTNode(this);return}if(e!==!1){this.texture=this.stage.txManager.loadTexture("RenderTexture",{width:this.width,height:this.height}),this.textureOptions.preload=!0,this.props.rtt=!0,this.hasRTTupdates=!0,this.setUpdateType(C.All);for(let l=0,a=this.children.length;l<a;l++)this.children[l].setUpdateType(C.All);(r=this.stage.renderer)==null||r.renderToTexture(this)}}get shader(){return this.props.shader}set shader(e){this.props.shader!==e&&(this.props.shader=e,this.setUpdateType(C.IsRenderable))}get src(){return this.props.src}set src(e){if(this.props.src!==e){if(this.props.src=e,!e){this.texture=null;return}this.texture=this.stage.txManager.loadTexture("ImageTexture",{src:e,width:this.props.width,height:this.props.height,type:this.props.imageType,sx:this.props.srcX,sy:this.props.srcY,sw:this.props.srcWidth,sh:this.props.srcHeight})}}set imageType(e){this.props.imageType!==e&&(this.props.imageType=e)}get imageType(){return this.props.imageType||null}get srcHeight(){return this.props.srcHeight}set srcHeight(e){this.props.srcHeight=e}get srcWidth(){return this.props.srcWidth}set srcWidth(e){this.props.srcWidth=e}get srcX(){return this.props.srcX}set srcX(e){this.props.srcX=e}get srcY(){return this.props.srcY}set srcY(e){this.props.srcY=e}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){let e=this.parent;for(;e;){if(e.rtt)return e;e=e.parent}return null}get texture(){return this.props.texture}set texture(e){if(this.props.texture===e)return;const s=this.props.texture;s&&(s.setRenderableOwner(this,!1),this.unloadTexture()),this.props.texture=e,e&&(e.setRenderableOwner(this,this.isRenderable),this.loadTexture()),this.setUpdateType(C.IsRenderable)}set textureOptions(e){this.props.textureOptions=e}get textureOptions(){return this.props.textureOptions}get strictBounds(){return this.props.strictBounds}set strictBounds(e){e!==this.props.strictBounds&&(this.props.strictBounds=e,this.setUpdateType(C.RenderBounds|C.Children),this.childUpdateType|=C.RenderBounds|C.Children)}setRTTUpdates(e){var s;this.hasRTTupdates!==!0&&(this.hasRTTupdates=!0,(s=this.parent)==null||s.setRTTUpdates(e))}animate(e,s){const r=new _a(this,e,s);return new Ra(this.stage.animationManager,r)}flush(){}}const Ea=o=>{let t=!1;const e=()=>{if(o.updateFrameTime(),o.updateAnimations(),!o.hasSceneUpdates()){o.calculateFps(),setTimeout(e,16.666666666666668),t||(o.txMemManager.checkCleanup()&&o.txMemManager.cleanup(),o.eventBus.emit("idle"),t=!0),o.flushFrameEvents();return}t=!1,o.drawFrame(),o.flushFrameEvents(),requestAnimationFrame(e)};requestAnimationFrame(e)},Aa=()=>performance?performance.now():Date.now();class Ma{constructor(){f(this,"activeAnimations",new Set)}registerAnimation(t){this.activeAnimations.add(t)}unregisterAnimation(t){this.activeAnimations.delete(t)}update(t){this.activeAnimations.forEach(e=>{e.update(t)})}}var Ue;(function(o){o[o.generic=0]="generic",o[o.color=1]="color",o[o.image=2]="image",o[o.noise=3]="noise",o[o.renderToTexture=4]="renderToTexture",o[o.subTexture=5]="subTexture"})(Ue||(Ue={}));class uo extends tt{constructor(e){super();f(this,"txManager");f(this,"dimensions",null);f(this,"error",null);f(this,"state","freed");f(this,"renderableOwners",new Set);f(this,"renderable",!1);f(this,"lastRenderableChangeTime",0);f(this,"type",Ue.generic);f(this,"preventCleanup",!1);this.txManager=e}setRenderableOwner(e,s){var l,a;const r=this.renderableOwners.size;if(s){this.renderableOwners.add(e);const i=this.renderableOwners.size;i>r&&i===1&&(this.renderable=!0,this.lastRenderableChangeTime=this.txManager.frameTime,(l=this.onChangeIsRenderable)==null||l.call(this,!0))}else{this.renderableOwners.delete(e);const i=this.renderableOwners.size;i<r&&i===0&&(this.renderable=!1,this.lastRenderableChangeTime=this.txManager.frameTime,(a=this.onChangeIsRenderable)==null||a.call(this,!1))}}get ctxTexture(){const e=this.txManager.renderer.createCtxTexture(this);return Object.defineProperty(this,"ctxTexture",{value:e}),e}setState(e,...s){if(this.state!==e){if(this.state=e,e==="loaded"){const r=s;this.dimensions=r[0]}else if(e==="failed"){const r=s;this.error=r[0]}this.emit(e,...s)}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{}}}function ka(){function o(e){return e.indexOf("image/png")!==-1}function t(e,s,r,l,a,i){return new Promise(function(n,c){var h=new XMLHttpRequest;h.open("GET",e,!0),h.responseType="blob",h.onload=function(){if(h.status!==200)return c(new Error("Failed to load image: "+h.statusText));var d=h.response,m=s!==void 0?s:o(d.type);if(a!==null&&i!==null){createImageBitmap(d,r||0,l||0,a,i,{premultiplyAlpha:m?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}).then(function(p){n({data:p,premultiplyAlpha:s})}).catch(function(p){c(p)});return}createImageBitmap(d,{premultiplyAlpha:m?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}).then(function(p){n({data:p,premultiplyAlpha:s})}).catch(function(p){c(p)})},h.onerror=function(){c(new Error("Network error occurred while trying to fetch the image."))},h.send()})}self.onmessage=e=>{var s=e.data.src,r=e.data.id,l=e.data.premultiplyAlpha,a=e.data.sx,i=e.data.sy,n=e.data.sw,c=e.data.sh;t(s,l,a,i,n,c).then(function(h){self.postMessage({id:r,src:s,data:h})}).catch(function(h){self.postMessage({id:r,src:s,error:h.message})})}}class Ia{constructor(t){f(this,"imageWorkersEnabled",!0);f(this,"messageManager",{});f(this,"workers",[]);f(this,"workerIndex",0);f(this,"nextId",0);this.workers=this.createWorkers(t),this.workers.forEach(e=>{e.onmessage=this.handleMessage.bind(this)})}handleMessage(t){const{id:e,data:s,error:r}=t.data,l=this.messageManager[e];if(l){const[a,i]=l;delete this.messageManager[e],r?i(new Error(r)):a(s)}}createWorkers(t=1){const e=`(${ka.toString()})()`,s=new Blob([e.replace('"use strict";',"")],{type:"application/javascript"}),r=(self.URL?URL:webkitURL).createObjectURL(s),l=[];for(let a=0;a<t;a++)l.push(new Worker(r));return l}getNextWorker(){const t=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,t}getImage(t,e,s,r,l,a){return new Promise((i,n)=>{try{if(this.workers){const c=this.nextId++;this.messageManager[c]=[i,n];const h=this.getNextWorker();h&&h.postMessage({id:c,src:t,premultiplyAlpha:e,sx:s,sy:r,sw:l,sh:a})}}catch(c){n(c)}})}}const no=class no extends uo{constructor(e,s){super(e);f(this,"type",Ue.color);f(this,"props");this.props=no.resolveDefaults(s||{})}get color(){return this.props.color}set color(e){this.props.color=e}async getTextureData(){const e=new Uint32Array([this.color]),s=new Uint8ClampedArray(e.buffer);return{data:new ImageData(s,1,1),premultiplyAlpha:!0}}static makeCacheKey(e){return`ColorTexture,${no.resolveDefaults(e).color}`}static resolveDefaults(e){return{color:e.color||4294967295}}};f(no,"z$__type__Props");let Ji=no;function La(o){return/\.(ktx|pvr)$/.test(o)}const ln=async o=>{const e=await(await fetch(o)).arrayBuffer();return o.indexOf(".ktx")!==-1?Pa(e):Fa(e)},Pa=async o=>{const t=new DataView(o),e=t.getUint32(12)===16909060,s=[],r={glInternalFormat:t.getUint32(28,e),pixelWidth:t.getUint32(36,e),pixelHeight:t.getUint32(40,e),numberOfMipmapLevels:t.getUint32(56,e),bytesOfKeyValueData:t.getUint32(60,e)};let l=64;l+=r.bytesOfKeyValueData;for(let a=0;a<r.numberOfMipmapLevels;a++){const i=t.getUint32(l);l+=4,s.push(t.buffer.slice(l,i)),l+=i}return{data:{glInternalFormat:r.glInternalFormat,mipmaps:s,width:r.pixelWidth||0,height:r.pixelHeight||0,type:"ktx"},premultiplyAlpha:!1}},Fa=async o=>{const i=o,n=new Int32Array(i,0,13),c=n[12]+52,h=new Uint8Array(i,c),d=[],m={pixelWidth:n[7],pixelHeight:n[6],numberOfMipmapLevels:n[11]||0};let p=0,u=m.pixelWidth||0,x=m.pixelHeight||0;for(let T=0;T<m.numberOfMipmapLevels;T++){const b=(u+3>>2)*(x+3>>2)*8,v=new Uint8Array(i,h.byteOffset+p,b);d.push(v),p+=b,u=u>>1,x=x>>1}return{data:{glInternalFormat:36196,mipmaps:d,width:m.pixelWidth||0,height:m.pixelHeight||0,type:"pvr"},premultiplyAlpha:!1}};function Ba(o){return/\.(svg)$/.test(o)}const an=(o,t,e,s,r,l,a)=>new Promise((i,n)=>{const c=document.createElement("canvas"),h=c.getContext("2d");L(h),h.imageSmoothingEnabled=!0;const d=new Image;d.onload=()=>{const m=s??0,p=r??0,u=t||d.width,x=e||d.height;c.width=u,c.height=x,h.drawImage(d,0,0,u,x),i({data:h.getImageData(m,p,l??u,a??x),premultiplyAlpha:!1})},d.onerror=m=>{n(m)},d.src=o}),lo=class lo extends uo{constructor(e,s){super(e);f(this,"props");f(this,"type",Ue.image);this.props=lo.resolveDefaults(s)}hasAlphaChannel(e){return e.indexOf("image/png")!==-1}async loadImage(e){const{premultiplyAlpha:s,sx:r,sy:l,sw:a,sh:i,width:n,height:c}=this.props;if(this.txManager.imageWorkerManager!==null)return await this.txManager.imageWorkerManager.getImage(e,s,r,l,a,i);if(this.txManager.hasCreateImageBitmap===!0){const d=await(await fetch(e)).blob(),m=s??this.hasAlphaChannel(d.type);return a!==null&&i!==null?{data:await createImageBitmap(d,r??0,l??0,a,i,{premultiplyAlpha:m?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:m}:{data:await createImageBitmap(d,{premultiplyAlpha:m?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"}),premultiplyAlpha:m}}else{const h=new Image;return e.startsWith("data:")||(h.crossOrigin="Anonymous"),h.src=e,await new Promise((d,m)=>{h.onload=()=>d(),h.onerror=()=>m(new Error("Failed to load image"))}).catch(d=>{console.error(d)}),{data:h,premultiplyAlpha:s??!0}}}async getTextureData(){const{src:e,premultiplyAlpha:s,type:r}=this.props;if(e===null)return{data:null};if(typeof e!="string")return e instanceof ImageData?{data:e,premultiplyAlpha:s}:{data:e(),premultiplyAlpha:s};const l=ba(e);return r==="regular"?this.loadImage(l):r==="svg"?an(l,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):Ba(e)===!0?an(l,this.props.width,this.props.height,this.props.sx,this.props.sy,this.props.sw,this.props.sh):r==="compressed"||La(e)===!0?ln(l):this.loadImage(l)}static makeCacheKey(e){const s=lo.resolveDefaults(e),r=s.key||s.src;if(typeof r!="string")return!1;let l="";return s.sh!==null&&s.sw!==null&&(l+=",",l+=s.sx??"",l+=s.sy??"",l+=s.sw||"",l+=s.sh||""),`ImageTexture,${r},${s.premultiplyAlpha??"true"}${l}`}static resolveDefaults(e){return{src:e.src??"",premultiplyAlpha:e.premultiplyAlpha??!0,key:e.key??null,type:e.type??null,width:e.width??null,height:e.height??null,sx:e.sx??null,sy:e.sy??null,sw:e.sw??null,sh:e.sh??null}}};f(lo,"z$__type__Props");let er=lo;const ao=class ao extends uo{constructor(e,s){super(e);f(this,"props");f(this,"type",Ue.noise);this.props=ao.resolveDefaults(s)}async getTextureData(){const{width:e,height:s}=this.props,r=e*s*4,l=new Uint8ClampedArray(r);for(let a=0;a<r;a+=4){const i=Math.floor(Math.random()*256);l[a]=i,l[a+1]=i,l[a+2]=i,l[a+3]=255}return{data:new ImageData(l,e,s)}}static makeCacheKey(e){if(e.cacheId===void 0)return!1;const s=ao.resolveDefaults(e);return`NoiseTexture,${s.width},${s.height},${s.cacheId}`}static resolveDefaults(e){return{width:e.width??128,height:e.height??128,cacheId:e.cacheId??0}}};f(ao,"z$__type__Props");let Mr=ao;const lr=class lr extends uo{constructor(e,s){super(e);f(this,"props");f(this,"parentTexture");f(this,"type",Ue.subTexture);f(this,"onParentTxLoaded",()=>{this.setState("loaded",{width:this.props.width,height:this.props.height})});f(this,"onParentTxFailed",(e,s)=>{this.setState("failed",s)});this.props=lr.resolveDefaults(s||{}),this.parentTexture=this.props.texture,queueMicrotask(()=>{const r=this.parentTexture;r.state==="loaded"?this.onParentTxLoaded(r,r.dimensions):r.state==="failed"&&this.onParentTxFailed(r,r.error),r.on("loaded",this.onParentTxLoaded),r.on("failed",this.onParentTxFailed)})}onChangeIsRenderable(e){this.parentTexture.setRenderableOwner(this,e)}async getTextureData(){return{data:this.props}}static makeCacheKey(e){return!1}static resolveDefaults(e){return{texture:e.texture,x:e.x||0,y:e.y||0,width:e.width||0,height:e.height||0}}};f(lr,"z$__type__Props");let fo=lr;const ar=class ar extends uo{constructor(e,s){super(e);f(this,"props");f(this,"type",Ue.renderToTexture);this.props=ar.resolveDefaults(s||{})}get width(){return this.props.width}set width(e){this.props.width=e}get height(){return this.props.height}set height(e){this.props.height=e}async getTextureData(){return{data:null,premultiplyAlpha:null}}static resolveDefaults(e){return{width:e.width||256,height:e.height||256}}};f(ar,"z$__type__Props");let tr=ar;class Oa{constructor(t){f(this,"keyCache",new Map);f(this,"inverseKeyCache",new WeakMap);f(this,"txConstructors",{});f(this,"imageWorkerManager",null);f(this,"hasCreateImageBitmap",!!self.createImageBitmap);f(this,"hasWorker",!!self.Worker);f(this,"renderer");f(this,"frameTime",0);this.hasCreateImageBitmap&&this.hasWorker&&t>0&&(this.imageWorkerManager=new Ia(t)),this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.registerTextureType("ImageTexture",er),this.registerTextureType("ColorTexture",Ji),this.registerTextureType("NoiseTexture",Mr),this.registerTextureType("SubTexture",fo),this.registerTextureType("RenderTexture",tr)}registerTextureType(t,e){this.txConstructors[t]=e}loadTexture(t,e){let s;const r=this.txConstructors[t];if(!r)throw new Error(`Texture type "${t}" is not registered`);if(!s){const l=r.makeCacheKey(e);l&&this.keyCache.has(l)?s=this.keyCache.get(l):(s=new r(this,e),l&&this.initTextureToCache(s,l))}return s}initTextureToCache(t,e){const{keyCache:s,inverseKeyCache:r}=this;s.set(e,t),r.set(t,e)}removeTextureFromCache(t){const{inverseKeyCache:e,keyCache:s}=this,r=e.get(t);r&&s.delete(r)}}const Ua={normal:400,bold:700,bolder:900,lighter:100},fn=o=>typeof o=="number"?o:Ua[o]||400;function $a(o,t,e,s,r){let l=fn(e);for(const a of o){const i=a[t];if(!i)continue;if(i.size===1)return console.warn(`TrFontManager: Only one font face found for family: '${t}' - will be used for all weights and styles`),i.values().next().value;const n=new Map;for(const h of i){const d=fn(h.descriptors.weight);if(d===l&&h.descriptors.style===s&&h.descriptors.stretch===r)return h;n.set(d,h)}const c=`TrFontManager: No exact match: '${t} Weight: ${l} Style: ${s} Stretch: ${r}'`;if(console.error(c),l===400&&n.has(500))return n.get(500);if(l===500&&n.has(400))return n.get(400);if(l<400){for(;l>0;){if(n.has(l))return n.get(l);l-=100}l=600}for(;l<1e3;){if(n.has(l))return n.get(l);l+=100}for(l=500;l>0;){if(n.has(l))return n.get(l);l-=100}}}class Da{constructor(t){f(this,"textRenderers");f(this,"fontCache",new Map);this.textRenderers=t}addFontFace(t){for(const e in this.textRenderers){const s=this.textRenderers[e];s&&s.isFontFaceSupported(t)&&s.addFontFace(t)}}resolveFontFace(t,e,s){const{fontFamily:r,fontWeight:l,fontStyle:a,fontStretch:i}=e,n=`${s}_${r}_${a}_${l}_${i}`;if(this.fontCache.has(n)===!0)return this.fontCache.get(n);const c=$a(t,r,l,a,i);return c!==void 0&&this.fontCache.set(n,c),c}}class Un{static makeCacheKey(t){return!1}static resolveDefaults(t){return{}}}function cn(o,t,e){const s=o.createShader(t);if(!s)throw new Error;if(o.shaderSource(s,e),o.compileShader(s),o.getShaderParameter(s,o.COMPILE_STATUS))return s;console.log(o.getShaderInfoLog(s)),o.deleteShader(s)}function Na(o,t,e){const s=o.createProgram();if(!s)throw new Error;if(o.attachShader(s,t),o.attachShader(s,e),o.linkProgram(s),o.getProgramParameter(s,o.LINK_STATUS))return s;console.log(o.getProgramInfoLog(s)),o.deleteProgram(s)}class Ts extends Un{constructor(e){super();f(this,"boundBufferCollection",null);f(this,"buffersBound",!1);f(this,"program");f(this,"vao");f(this,"renderer");f(this,"glw");f(this,"attributeBuffers");f(this,"attributeLocations");f(this,"attributeNames");f(this,"uniformLocations");f(this,"uniformTypes");f(this,"supportsIndexedTextures");const s=this.renderer=e.renderer,r=this.glw=this.renderer.glw;this.supportsIndexedTextures=e.supportsIndexedTextures||!1;const l=r.isWebGl2(),a=l&&e.webgl2Extensions||!l&&e.webgl1Extensions||[],i=l?"2.0":"1.0";a.forEach(x=>{if(!r.getExtension(x))throw new Error(`Shader "${this.constructor.name}" requires extension "${x}" for WebGL ${i} but wasn't found`)});const n=e.shaderSources||this.constructor.shaderSources;if(n)l&&(n!=null&&n.webGl2)&&(n.fragment=n.webGl2.fragment,n.vertex=n.webGl2.vertex,delete n.webGl2);else throw new Error(`Shader "${this.constructor.name}" is missing shaderSources.`);const c=s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS,h=n.vertex instanceof Function?n.vertex(c):n.vertex,d=n.fragment instanceof Function?n.fragment(c):n.fragment,m=cn(r,r.VERTEX_SHADER,h),p=cn(r,r.FRAGMENT_SHADER,d);if(!m||!p)throw new Error;const u=Na(r,m,p);if(!u)throw new Error;this.program=u,this.attributeLocations={},this.attributeBuffers={},this.attributeNames=[],[...e.attributes].forEach(x=>{const T=r.getAttribLocation(this.program,x);if(T<0)throw new Error(`${this.constructor.name}: Vertex shader must have an attribute "${x}"!`);const b=r.createBuffer();if(!b)throw new Error(`${this.constructor.name}: Could not create buffer for attribute "${x}"`);this.attributeLocations[x]=T,this.attributeBuffers[x]=b,this.attributeNames.push(x)}),this.uniformLocations={},this.uniformTypes={},e.uniforms.forEach(x=>{const T=r.getUniformLocation(this.program,x.name);if(this.uniformTypes[x.name]=x.uniform,!T){console.warn(`Shader "${this.constructor.name}" could not get uniform location for "${x.name}"`);return}this.uniformLocations[x.name]=T})}bindBufferAttribute(e,s,r){const{glw:l}=this;l.enableVertexAttribArray(e),l.vertexAttribPointer(s,e,r.size,r.type,r.normalized,r.stride,r.offset)}disableAttribute(e){this.glw.disableVertexAttribArray(e)}disableAttributes(){for(const e in this.attributeLocations)this.disableAttribute(this.attributeLocations[e]);this.boundBufferCollection=null}canBatchShaderProps(e,s){return!1}bindRenderOp(e,s){this.bindBufferCollection(e.buffers),e.textures.length>0&&this.bindTextures(e.textures);const{glw:r,parentHasRenderTexture:l,renderToTexture:a}=e;if(!(a&&l)){if(l){const{width:i,height:n}=e.framebufferDimensions||{};r.uniform1f(this.getUniformLocation("u_pixelRatio"),1),r.uniform2f(this.getUniformLocation("u_resolution"),i??0,n??0)}else r.uniform1f(this.getUniformLocation("u_pixelRatio"),e.options.pixelRatio),r.uniform2f(this.getUniformLocation("u_resolution"),r.canvas.width,r.canvas.height);if(s){if(Zi(s,"$dimensions")){let i=s.$dimensions;i||(i=e.dimensions),r.uniform2f(this.getUniformLocation("u_dimensions"),i.width,i.height)}if(Zi(s,"$alpha")){let i=s.$alpha;i||(i=e.alpha),r.uniform1f(this.getUniformLocation("u_alpha"),i)}this.bindProps(s)}}}getUniformLocation(e){return this.uniformLocations[e]||null}bindBufferCollection(e){if(this.boundBufferCollection!==e){for(const s in this.attributeLocations){const r=e.getBuffer(s),l=e.getAttributeInfo(s);L(r,`Buffer for "${s}" not found`),L(l),this.bindBufferAttribute(this.attributeLocations[s],r,l)}this.boundBufferCollection=e}}bindProps(e){}bindTextures(e){}attach(){this.glw.useProgram(this.program),this.glw.isWebGl2()&&this.vao&&this.glw.bindVertexArray(this.vao)}detach(){this.disableAttributes()}}f(Ts,"shaderSources");class $n extends Ts{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}}f($n,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;


      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio;
        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);

        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);
        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
          vec4 color = texture2D(u_texture, v_textureCoordinate);
          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);
      }
    `});class Dn extends Ts{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});f(this,"supportsIndexedTextures",!0)}bindTextures(e){const{renderer:s,glw:r}=this;if(e.length>s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${s.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);e.forEach((a,i)=>{r.activeTexture(i),r.bindTexture(a.ctxTexture)});const l=Array.from(Array(e.length).keys());this.glw.uniform1iv(this.getUniformLocation("u_textures[0]"),l)}}f(Dn,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_textureCoordinate;
      attribute vec2 a_position;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      void main(){
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;
        v_textureIndex = a_textureIndex;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:e=>`
      #define txUnits ${e}
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform sampler2D u_image;
      uniform sampler2D u_textures[txUnits];

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;
      varying float v_textureIndex;

      vec4 sampleFromTexture(sampler2D textures[${e}], int idx, vec2 uv) {
        ${Array.from(Array(e).keys()).map(s=>`
          ${s!==0?"else ":""}if (idx == ${s}) {
            return texture2D(textures[${s}], uv);
          }
        `).join("")}
        return texture2D(textures[0], uv);
      }

      void main(){
        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);
      }
    `});class oe{constructor(t){f(this,"priority",1);f(this,"name","");f(this,"ref");f(this,"target");f(this,"passParameters","");f(this,"declaredUniforms","");f(this,"uniformInfo",{});const{ref:e,target:s,props:r={}}=t;this.ref=e,this.target=s;const l={},a=[];let i="";const n=this.constructor.uniforms||{};for(const c in n){const h=n[c],d=h.type,m=`${e}_${c}`;let p="";h.size&&(p=`[${h.size(r)}]`),a.push(m),i+=`uniform ${d} ${m}${p};`,l[c]={name:m,uniform:n[c].method}}this.passParameters=a.join(","),this.declaredUniforms=i,this.uniformInfo=l}static getEffectKey(t){return""}static getMethodParameters(t,e){const s=[];for(const r in t){const l=t[r];let a="";l.size&&(a=`[${l.size(e)}]`),s.push(`${l.type} ${r}${a}`)}return s.join(",")}static resolveDefaults(t){return{}}static makeEffectKey(t){return!1}}f(oe,"uniforms",{}),f(oe,"methods"),f(oe,"onShaderMask"),f(oe,"onColorize"),f(oe,"onEffectMask");const br=new Map,Ga=(o,t)=>{const e=JSON.stringify(o);if(br.has(e))return br.get(e);o=o??[];const s=[],r=o.length;let l=0;for(;l<r;l++){const{name:a,type:i,props:n}=o[l],c={name:a,type:i,props:{}},h=t[i],d=h.resolveDefaults(n),m=h.uniforms,p=Object.keys(m),u=p.length;let x=0;for(;x<u;x++){const T=p[x],b=m[T],v={value:d[T],programValue:void 0,method:b.method,updateOnBind:b.updateOnBind||!1,hasValidator:b.validator!==void 0,hasProgramValueUpdater:b.updateProgramValue!==void 0},R=v.hasValidator&&b.validator(d[T],d)||d[T];d[T]!==R&&(v.validatedValue=R),v.hasProgramValueUpdater&&b.updateProgramValue(v),v.programValue===void 0&&(v.programValue=v.value),c.props[T]=v}s.push(c)}return br.set(e,s),s},Ke=class Ke extends Ts{constructor(e,s,r){const l=Ke.createShader(s,r);super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...l.uniforms],shaderSources:{vertex:l.vertex,fragment:l.fragment}});f(this,"effects",[]);this.effects=l.effects}bindTextures(e){const{glw:s}=this;s.activeTexture(0),s.bindTexture(e[0].ctxTexture)}bindUniformMethods(e){const s=this.glw,r=e.effects,l=r.length;for(let a=0;a<l;a++){const i=this.effects[a].uniformInfo,n=r[a],c=Object.keys(n.props),h=c.length;for(let d=0;d<h;d++){const m=c[d],p=n.props[m].method,u=this.getUniformLocation(i[m].name);if(p==="uniform2fv"||p==="uniform2iv"||p==="uniform3iv"||p==="uniform4fv"||p==="uniform4iv"||p==="uniformMatrix2fv"||p==="uniformMatrix3fv"||p==="uniformMatrix4fv"||p==="uniform1f"||p==="uniform1fv"||p==="uniform1i"||p==="uniform1iv"){n.props[m].setUniformValue=function(){s[p](u,this.programValue)};continue}if(p==="uniform2f"||p==="uniform2i"){n.props[m].setUniformValue=function(){s[p](u,this.programValue[0],this.programValue[1])};continue}if(p==="uniform3f"||p==="uniform3i"){n.props[m].setUniformValue=function(){s[p](u,this.programValue[0],this.programValue[1],this.programValue[2])};continue}if(p==="uniform4f"||p==="uniform4i"){n.props[m].setUniformValue=function(){s[p](u,this.programValue[0],this.programValue[1],this.programValue[2],this.programValue[3])};continue}}}}bindProps(e){var a;const s=e.effects,r=s.length;let l=0;for(;l<r;l++){const i=s[l],n=Object.keys(i.props),c=n.length;let h=0;for(;h<c;h++){const d=n[h],m=i.props[d];if(m.updateOnBind===!0){const p=(a=this.renderer.shManager.getRegisteredEffects()[i.type])==null?void 0:a.uniforms[d];p==null||p.updateProgramValue(i.props[d],e)}m.setUniformValue()}}}canBatchShaderProps(e,s){if(e.$alpha!==s.$alpha||e.$dimensions.width!==s.$dimensions.width||e.$dimensions.height!==s.$dimensions.height||e.effects.length!==s.effects.length)return!1;const r=e.effects.length;let l=0;for(;l<r;l++){const a=e.effects[l],i=s.effects[l];if(a.type!==i.type)return!1;for(const n in a.props)if(i.props&&!i.props[n]||a.props[n].value!==i.props[n].value)return!1}return!0}static createShader(e,s){const r={},l={};let a="";const i=[],n=[],c=e.effects.map(u=>{const x=s[u.type],T=x.getEffectKey(u.props||{});r[T]=r[T]?++r[T]:1;const b=r[T];b===1&&n.push({key:T,type:u.type,props:u.props});const v=new x({ref:`${T}${b===1?"":b}`,target:T,props:u.props});return a+=v.declaredUniforms,i.push(...Object.values(v.uniformInfo)),v});let h="";n==null||n.forEach(u=>{const x=s[u.type],T=x.resolveDefaults(u.props??{}),b=[];for(const M in x.methods){let I=M;const A=x.methods[M];l[M]&&l[M]!==A&&(I=Ke.resolveMethodDuplicate(M,A,l)),l[I]=A.replace("function",I),b.push({m:M,cm:I})}let v=x.onShaderMask instanceof Function?x.onShaderMask(T):x.onShaderMask,R=x.onColorize instanceof Function?x.onColorize(T):x.onColorize,w=x.onEffectMask instanceof Function?x.onEffectMask(T):x.onEffectMask;b.forEach(M=>{const{m:I,cm:A}=M,B=new RegExp(`\\$${I}`,"g");v&&(v=v.replace(B,A)),R&&(R=R.replace(B,A)),w&&(w=w.replace(B,A))});const E=x.getMethodParameters(x.uniforms,T),S=E.length>0?`, ${E}`:"";v&&(h+=`
        float fx_${u.key}_onShaderMask(float shaderMask ${S}) {
          ${v}
        }
        `),R&&(h+=`
          vec4 fx_${u.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${S}) {
            ${R}
          }
        `),w&&(h+=`
          vec4 fx_${u.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${S}) {
            ${w}
          }
        `)});let d="";for(const u in l)d+=l[u];let m="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",p=`

    `;for(let u=0;u<c.length;u++){const x=c[u],T=x.passParameters.length>0?`, ${x.passParameters}`:"",b=s[x.name];b.onShaderMask&&(p+=`
        shaderMask = fx_${x.target}_onShaderMask(shaderMask ${T});
        `),b.onColorize&&(p+=`
        maskColor = fx_${x.target}_onColorize(shaderMask, maskColor, shaderColor${T});
        `),b.onEffectMask&&(m=`fx_${x.target}_onEffectMask(shaderMask, maskColor, shaderColor${T})`);const v=c[u+1];(v===void 0||s[v.name].onEffectMask)&&(p+=`
          shaderColor = ${m};
        `)}return{effects:c,uniforms:i,fragment:Ke.fragment(a,d,h,p),vertex:Ke.vertex()}}static resolveMethodDuplicate(e,s,r,l=0){const a=e+(l>0?l:"");return r[a]&&r[a]!==s?this.resolveMethodDuplicate(e,s,r,++l):a}static resolveDefaults(e,s){return L(s),{effects:Ga(e.effects??[],s),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,s){var l;let r="";return(l=e.effects)==null||l.forEach(a=>{const n=s[a.type].getEffectKey(a.props||{});r+=`,${n}`}),`DynamicShader${r}`}};f(Ke,"z$__type__Props"),f(Ke,"vertex",()=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    attribute vec2 a_textureCoordinate;
    attribute vec2 a_position;
    attribute vec4 a_color;
    attribute float a_textureIndex;

    uniform vec2 u_resolution;
    uniform float u_pixelRatio;

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;
    varying float v_textureIndex;

    void main(){
      vec2 normalized = a_position * u_pixelRatio / u_resolution;
      vec2 zero_two = normalized * 2.0;
      vec2 clip_space = zero_two - 1.0;

      // pass to fragment
      v_color = a_color;
      v_textureCoordinate = a_textureCoordinate;
      v_textureIndex = a_textureIndex;

      // flip y
      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
    }
  `),f(Ke,"fragment",(e,s,r,l)=>`
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision mediump float;
    # endif

    #define PI 3.14159265359

    uniform vec2 u_resolution;
    uniform vec2 u_dimensions;
    uniform float u_alpha;
    uniform float u_radius;
    uniform sampler2D u_texture;
    uniform float u_pixelRatio;

    ${e}

    varying vec4 v_color;
    varying vec2 v_textureCoordinate;

    ${s}

    ${r}

    void main() {
      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;
      vec2 d = abs(p) - (u_dimensions) * 0.5;
      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));

      vec4 shaderColor = vec4(0.0);
      float shaderMask = lng_DefaultMask;

      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;

      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));

      ${l}

      gl_FragColor = shaderColor * u_alpha;
    }
  `);let $s=Ke;class kr extends Ts{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(t){return{radius:t.radius||10,$dimensions:{width:0,height:0}}}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=Math.min(t.$dimensions.width,t.$dimensions.height)/(2*t.radius);this.glw.uniform1f(this.getUniformLocation("u_radius"),t.radius*Math.min(e,1))}canBatchShaderProps(t,e){return t.radius===e.radius&&t.$dimensions.width===e.$dimensions.width&&t.$dimensions.height===e.$dimensions.height}}f(kr,"z$__type__Props"),f(kr,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;
      attribute vec4 a_color;
      attribute float a_textureIndex;
      attribute float a_depth;

      uniform vec2 u_resolution;
      uniform float u_pixelRatio;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      void main() {
        vec2 normalized = a_position * u_pixelRatio / u_resolution;
        vec2 zero_two = normalized * 2.0;
        vec2 clip_space = zero_two - 1.0;

        // pass to fragment
        v_color = a_color;
        v_textureCoordinate = a_textureCoordinate;

        // flip y
        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);
      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif

      uniform vec2 u_resolution;
      uniform vec2 u_dimensions;
      uniform float u_radius;
      uniform sampler2D u_texture;

      varying vec4 v_color;
      varying vec2 v_textureCoordinate;

      float boxDist(vec2 p, vec2 size, float radius){
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }

      float fillMask(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }

      void main() {
        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;
        vec2 halfDimensions = u_dimensions * 0.5;

        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);
        gl_FragColor = mix(vec4(0.0), color, fillMask(d));
      }
    `});const za=new Float32Array([1,0,0,0,1,0,0,0,1]),fr=class fr extends Ts{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(t){const{glw:e}=this;e.activeTexture(0),e.bindTexture(t[0].ctxTexture)}bindProps(t){const e=fr.resolveDefaults(t);for(const s in e)if(s==="transform")this.glw.uniformMatrix3fv(this.getUniformLocation("u_transform"),e[s]);else if(s==="scrollY")this.glw.uniform1f(this.getUniformLocation("u_scrollY"),e[s]);else if(s==="color"){const r=Ws(e.color);this.glw.uniform4fv(this.getUniformLocation("u_color"),r)}else s==="size"?this.glw.uniform1f(this.getUniformLocation("u_size"),e[s]):s==="distanceRange"?this.glw.uniform1f(this.getUniformLocation("u_distanceRange"),e[s]):s==="debug"&&this.glw.uniform1i(this.getUniformLocation("u_debug"),e[s]?1:0)}static resolveDefaults(t={}){return{transform:t.transform??za,scrollY:t.scrollY??0,color:t.color??4294967295,size:t.size??16,distanceRange:t.distanceRange??1,debug:t.debug??!1}}};f(fr,"shaderSources",{vertex:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      // an attribute is an input (in) to a vertex shader.
      // It will receive data from a buffer
      attribute vec2 a_position;
      attribute vec2 a_textureCoordinate;

      uniform vec2 u_resolution;
      uniform mat3 u_transform;
      uniform float u_scrollY;
      uniform float u_pixelRatio;
      uniform float u_size;

      varying vec2 v_texcoord;

      void main() {
        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);
        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;

        // Calculate screen space with pixel ratio
        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);

        gl_Position = vec4(screenSpace, 0.0, 1.0);
        v_texcoord = a_textureCoordinate;

      }
    `,fragment:`
      # ifdef GL_FRAGMENT_PRECISION_HIGH
      precision highp float;
      # else
      precision mediump float;
      # endif
      uniform vec4 u_color;
      uniform sampler2D u_texture;
      uniform float u_distanceRange;
      uniform float u_pixelRatio;
      uniform int u_debug;

      varying vec2 v_texcoord;

      float median(float r, float g, float b) {
          return max(min(r, g), min(max(r, g), b));
      }

      void main() {
          vec3 sample = texture2D(u_texture, v_texcoord).rgb;
          if (u_debug == 1) {
            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);
            return;
          }
          float scaledDistRange = u_distanceRange * u_pixelRatio;
          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);
          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;

          // Build the final color.
          // IMPORTANT: We must premultiply the color by the alpha value before returning it.
          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);
      }
    `});let Ir=fr;const Vs=o=>{o.programValue===void 0&&(o.programValue=new Float32Array(4));const t=o.value,e=o.programValue;e[0]=(t>>>24)/255,e[1]=(t>>>16&255)/255,e[2]=(t>>>8&255)/255,e[3]=(t&255)/255},Wa=o=>{const t=o.validatedValue||o.value;if(o.programValue instanceof Float32Array){const e=o.programValue;e[0]=t[0],e[1]=t[1]}else o.programValue=new Float32Array(t)},Va=o=>{const t=o.validatedValue||o.value;if(o.programValue instanceof Float32Array){const e=o.programValue;e[0]=t[0],e[1]=t[1],e[2]=t[1],e[3]=t[1]}else o.programValue=new Float32Array(t)},Nn=o=>{const t=o.validatedValue||o.value;if(o.programValue instanceof Float32Array){const e=t.length,s=o.programValue;for(let r=0;r<e;r++)s[r]=t[r]}else o.programValue=new Float32Array(t)},Kr=o=>{const t=Array.isArray(o);if(t){if(t&&o.length===4)return o;if(t&&o.length===2)return[o[0],o[1],o[0],o[1]];if(t&&o.length===3)return[o[0],o[1],o[2],o[0]]}else return[o,o,o,o];return[o[0],o[0],o[0],o[0]]},Gn=(o,t)=>{o.programValue===void 0&&(o.programValue=new Float32Array(4));const e=o.programValue,s=o.validatedValue||o.value;if(t===void 0&&o.$dimensions===void 0){e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3];return}let r=o.$dimensions;if(t!==void 0){const{$dimensions:m}=t;if(r!==void 0&&(r.width===m.width||r.height===m.height))return;r===void 0&&(r={width:m==null?void 0:m.width,height:m==null?void 0:m.height},o.$dimensions=r)}const{width:l,height:a}=r,[i,n,c,h]=s,d=Math.min(Math.min(Math.min(l/Math.max(l,i+n),l/Math.max(l,c+h)),Math.min(a/Math.max(a,i+c),a/Math.max(a,n+h))),1);e[0]=i*d,e[1]=n*d,e[2]=c*d,e[3]=h*d};class Ms extends oe{constructor(){super(...arguments);f(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){return{radius:e.radius??10}}}f(Ms,"z$__type__Props"),f(Ms,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:Kr,updateProgramValue:Gn}}),f(Ms,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),f(Ms,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);
  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);
  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);
  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);
  `),f(Ms,"onEffectMask",`
  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));
  `);class to extends oe{constructor(){super(...arguments);f(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}f(to,"z$__type__Props"),f(to,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Vs,method:"uniform4fv",type:"vec4"}}),f(to,"onEffectMask",`
  float intR = shaderMask + 1.0;
  float mask = clamp(intR + width, 0.0, 1.0) - clamp(intR, 0.0, 1.0);
  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);
  `),f(to,"onColorize",`
    return color;
  `);const Ze=class Ze extends oe{constructor(){super(...arguments);f(this,"name","linearGradient")}static getEffectKey(e){return e.colors.value?`linearGradient${e.colors.value.length}`:`linearGradient${e.colors.length}`}static resolveDefaults(e){const s=e.colors??[4278190080,4294967295];let r=e.stops||[];if(r.length===0||r.length!==s.length){const l=s.length;let a=0;const i=r;for(;a<l;a++)r[a]?(i[a]=r[a],r[a-1]===void 0&&i[a-2]!==void 0&&(i[a-1]=i[a-2]+(r[a]-i[a-2])/2)):i[a]=a*(1/(s.length-1));r=i}return{colors:s,stops:r,angle:e.angle??0}}};f(Ze,"z$__type__Props"),f(Ze,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.reduce((s,r)=>s.concat(Ws(r)),[]),updateProgramValue:Nn,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),f(Ze,"methods",{fromLinear:`
      vec4 function(vec4 linearRGB) {
        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);
        vec4 lower = linearRGB * vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,toLinear:`
      vec4 function(vec4 sRGB) {
        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));
        vec4 lower = sRGB/vec4(12.92);
        return mix(higher, lower, 1.0);
      }
    `,calcPoint:`
      vec2 function(float d, float angle) {
        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);
      }
    `}),f(Ze,"ColorLoop",e=>{let s="";for(let r=2;r<e;r++)s+=`colorOut = mix(colorOut, colors[${r}], clamp((dist - stops[${r-1}]) / (stops[${r}] - stops[${r-1}]), 0.0, 1.0));`;return s}),f(Ze,"onColorize",e=>{const s=e.colors.length||1;return`
      float a = angle - (PI / 180.0 * 90.0);
      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));
      vec2 f = $calcPoint(lineDist * 0.5, a);
      vec2 t = $calcPoint(lineDist * 0.5, a + PI);
      vec2 gradVec = t - f;
      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));
      ${Ze.ColorLoop(s)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let Lr=Ze;class Pr extends oe{constructor(){super(...arguments);f(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){return{amount:e.amount??1}}}f(Pr,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),f(Pr,"onColorize",`
    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;
    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);
  `);class ks extends oe{constructor(){super(...arguments);f(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}f(ks,"z$__type__Props"),f(ks,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Vs,method:"uniform4fv",type:"vec4"}}),f(ks,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),f(ks,"onEffectMask",`
  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),f(ks,"onColorize",`
    return color;
  `);class Is extends oe{constructor(){super(...arguments);f(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}f(Is,"z$__type__Props"),f(Is,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Vs,method:"uniform4fv",type:"vec4"}}),f(Is,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),f(Is,"onEffectMask",`
  vec2 pos = vec2(0.0, width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),f(Is,"onColorize",`
    return color;
  `);class Ls extends oe{constructor(){super(...arguments);f(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}f(Ls,"z$__type__Props"),f(Ls,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Vs,method:"uniform4fv",type:"vec4"}}),f(Ls,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),f(Ls,"onEffectMask",`
  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),f(Ls,"onColorize",`
    return color;
  `);class Ps extends oe{constructor(){super(...arguments);f(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){return{width:e.width??10,color:e.color??4294967295}}}f(Ps,"z$__type__Props"),f(Ps,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Vs,method:"uniform4fv",type:"vec4"}}),f(Ps,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,rectDist:`
      float function(vec2 p, vec2 size) {
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));
      }
    `}),f(Ps,"onEffectMask",`
  vec2 pos = vec2(width * 0.5, 0.0);
  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));
  return mix(shaderColor, maskColor, $fillMask(mask));
  `),f(Ps,"onColorize",`
    return color;
  `);class so extends oe{constructor(){super(...arguments);f(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){return{amplitude:e.amplitude??.2,narrowness:e.narrowness??4,blockiness:e.blockiness??2,minimizer:e.minimizer??8,time:e.time??Date.now()}}}f(so,"z$__type__Props"),f(so,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",updateOnBind:!0,updateProgramValue:e=>{const s=e.value=(Date.now()-e.value)%1e3;e.programValue=s},type:"float"}}),f(so,"methods",{rand:`
      float function(vec2 p, float time) {
        float t = floor(time * 20.) / 10.;
        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);
      }
    `,noise:`
      float function(vec2 uv, float blockiness, float time) {
        vec2 lv = fract(uv);
        vec2 id = floor(uv);

        float n1 = rand(id, time);
        float n2 = rand(id+vec2(1,0), time);
        float n3 = rand(id+vec2(0,1), time);
        float n4 = rand(id+vec2(1,1), time);
        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);
        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);
      }
    `,fbm:`
      float function(vec2 uv, int count, float blockiness, float complexity, float time) {
        float val = 0.0;
        float amp = 0.5;
        const int MAX_ITERATIONS = 10;

        for(int i = 0; i < MAX_ITERATIONS; i++) {
          if(i >= count) {break;}
          val += amp * noise(uv, blockiness, time);
          amp *= 0.5;
          uv *= complexity;
        }
        return val;
      }
    `}),f(so,"onColorize",`
    vec2 uv = v_textureCoordinate.xy;
    float aspect = u_dimensions.x / u_dimensions.y;
    vec2 a = vec2(uv.x * aspect , uv.y);
    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));

    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);
    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);
    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);
    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);

    vec3 f = vec3(colR, colG, colB);
    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);
  `);class Wi extends oe{constructor(){super(...arguments);f(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){return{fade:e.fade??10}}}f(Wi,"z$__type__Props"),f(Wi,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:Kr,updateProgramValue:Va}}),f(Wi,"onColorize",`
  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;
  vec2 pos1;
  vec2 pos2;
  vec2 d;
  float c;
  vec4 result = maskColor;


  if(fade[0] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x, point.y + fade[0]);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[1] > 0.0) {
    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);
    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[2] > 0.0) {
    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);
    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);
    d = pos1 - pos2;
    c = dot(pos2, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  if(fade[3] > 0.0) {
    pos1 = vec2(point.x, point.y);
    pos2 = vec2(point.x + fade[3], point.y);
    d = pos2 - pos1;
    c = dot(pos1, d) / dot(d, d);
    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));
  }

  return result;
  `);const xs=class xs extends oe{constructor(){super(...arguments);f(this,"name","radialGradient")}static getEffectKey(e){return e.colors.value?`linearGradient${e.colors.value.length}`:`linearGradient${e.colors.length}`}static resolveDefaults(e){const s=e.colors??[4278190080,4294967295];let r=e.stops||[];if(r.length===0||r.length!==s.length){const l=s.length;let a=0;const i=r;for(;a<l;a++)r[a]?(i[a]=r[a],r[a-1]===void 0&&i[a-2]!==void 0&&(i[a-1]=i[a-2]+(r[a]-i[a-2])/2)):i[a]=a*(1/(s.length-1));r=i}return{colors:s,stops:r,width:e.width??0,height:e.height??e.width??0,pivot:e.pivot??[.5,.5]}}};f(xs,"z$__type__Props"),f(xs,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],updateProgramValue:Wa,method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.reduce((s,r)=>s.concat(Ws(r)),[]),updateProgramValue:Nn,size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),f(xs,"ColorLoop",e=>{let s="";for(let r=2;r<e;r++)s+=`colorOut = mix(colorOut, colors[${r}], clamp((dist - stops[${r-1}]) / (stops[${r}] - stops[${r-1}]), 0.0, 1.0));`;return s}),f(xs,"onColorize",e=>{const s=e.colors.length||1;return`
      vec2 point = v_textureCoordinate.xy * u_dimensions;
      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);

      float dist = length((point - projection) / vec2(width, height));

      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);
      vec4 colorOut = mix(colors[0], colors[1], stopCalc);
      ${xs.ColorLoop(s)}
      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));
    `});let Fr=xs;class Fs extends oe{constructor(){super(...arguments);f(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){return{width:e.width??10,progress:e.progress??.5,offset:e.offset??0,range:e.range??Math.PI*2,rounded:e.rounded??!1,radius:e.radius??1,color:e.color??4294967295}}}f(Fs,"z$__type__Props"),f(Fs,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,updateProgramValue:Vs,method:"uniform4fv",type:"vec4"}}),f(Fs,"methods",{rotateUV:`
    vec2 function(vec2 uv, float d) {
      float s = sin(d);
      float c = cos(d);
      mat2 rotMatrix = mat2(c, -s, s, c);
      return uv * rotMatrix;
    }
    `,drawDot:`
    float function(vec2 uv, vec2 p, float r) {
      uv += p;
      float circle = length(uv) - r;
      return clamp(-circle, 0.0, 1.0);
    }
    `}),f(Fs,"onEffectMask",`
    float outerRadius = radius * u_dimensions.y * 0.5;

    float endAngle = range * progress - 0.0005;

    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;

    uv = $rotateUV(uv, -(offset));
    float linewidth = width * u_pixelRatio;
    float circle = length(uv) - (outerRadius - linewidth) ;
    circle = abs(circle) - linewidth;
    circle = clamp(-circle, 0.0, 1.0);

    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);
    float p = endAngle / (PI * 2.);

    circle *= step(fract(angle), fract(p));

    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));
    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));

    return mix(shaderColor, maskColor, circle);
  `),f(Fs,"onColorize",`
    return color;
  `);class Bs extends oe{constructor(){super(...arguments);f(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:e.radius??0}}}f(Bs,"z$__type__Props"),f(Bs,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",updateOnBind:!0,validator:Kr,updateProgramValue:Gn}}),f(Bs,"methods",{fillMask:`
      float function(float dist) {
        return clamp(-dist, 0.0, 1.0);
      }
    `,boxDist:`
      float function(vec2 p, vec2 size, float radius) {
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
      }
    `}),f(Bs,"onShaderMask",`
  vec2 halfDimensions = u_dimensions * 0.5;
  vec2 size = vec2(width, height) * 0.5;
  vec2 basePos = v_textureCoordinate.xy * u_dimensions.xy - vec2(x, y);
  vec2 pos = basePos - size;
  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);
  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);
  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);
  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);
  return $boxDist(pos, size, r);
  `),f(Bs,"onEffectMask",`
  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));
  `);const zn="RoundedRectangle";class jr extends Un{constructor(e){super();f(this,"shType");this.shType=e,e!==zn&&console.warn("Unsupported shader:",e)}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class Xa{constructor(t,e,s,r){f(this,"type");f(this,"shader");f(this,"resolvedProps");f(this,"props");this.type=t,this.shader=e,this.resolvedProps=s;const l=Object.keys(s),a=l.length,i={};for(let n=0;n<a;n++){const c=l[n];Object.defineProperty(i,c,{get:()=>this.resolvedProps[c],set:h=>{this.resolvedProps[c]=h,r.requestRender()}})}this.props=i}getResolvedProps(){return this.resolvedProps}}class Ha{constructor(t,e,s){f(this,"shader");f(this,"resolvedProps");f(this,"props");f(this,"type");this.shader=t,this.type="DynamicShader",this.resolvedProps=e;const r=s.getRegisteredEffects(),l={},a=e.effects,i=a.length;for(let n=0;n<i;n++){const{name:c,props:h,type:d}=a[n];if(c===void 0)continue;const m={},p=Object.keys(h),u=p.length;for(let x=0;x<u;x++){const T=p[x];Object.defineProperty(m,T,{get:()=>this.resolvedProps.effects[n].props[T].value,set:b=>{var R,w;const v=this.resolvedProps.effects[n].props[T];v.value=b,v.hasValidator&&(b=v.validatedValue=(R=r[d].uniforms[T])==null?void 0:R.validator(b,h)),v.hasProgramValueUpdater?(w=r[d].uniforms[T])==null||w.updateProgramValue(v):v.programValue=b,s.renderer.stage.requestRender()}})}Object.defineProperty(l,c,{get:()=>m})}this.props=l}getResolvedProps(){return this.resolvedProps}}class Ya{constructor(){f(this,"shCache",new Map);f(this,"shConstructors",{});f(this,"attachedShader",null);f(this,"effectConstructors",{});f(this,"renderer");this.registerShaderType("DefaultShader",$n),this.registerShaderType("DefaultShaderBatched",Dn),this.registerShaderType("RoundedRectangle",kr),this.registerShaderType("DynamicShader",$s),this.registerShaderType("SdfShader",Ir),this.registerEffectType("border",to),this.registerEffectType("borderBottom",Ls),this.registerEffectType("borderLeft",Ps),this.registerEffectType("borderRight",ks),this.registerEffectType("borderTop",Is),this.registerEffectType("fadeOut",Wi),this.registerEffectType("linearGradient",Lr),this.registerEffectType("radialGradient",Fr),this.registerEffectType("grayscale",Pr),this.registerEffectType("glitch",so),this.registerEffectType("radius",Ms),this.registerEffectType("radialProgress",Fs),this.registerEffectType("holePunch",Bs)}registerShaderType(t,e){this.shConstructors[t]=e}registerEffectType(t,e){this.effectConstructors[t]=e}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(t,e){if(!this.renderer)throw new Error("Renderer is not been defined");const s=this.shConstructors[t];if(!s)throw new Error(`Shader type "${t}" is not registered`);if(this.renderer.mode==="canvas"&&s.prototype instanceof Ts)return this._createShaderCtr(t,new jr(t),e);if(t==="DynamicShader")return this.loadDynamicShader(e);const r=s.resolveDefaults(e),l=s.makeCacheKey(r)||s.name;if(l&&this.shCache.has(l))return this._createShaderCtr(t,this.shCache.get(l),r);const a=new s(this.renderer,e);return l&&this.shCache.set(l,a),this._createShaderCtr(t,a,r)}loadDynamicShader(t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=$s.resolveDefaults(t,this.effectConstructors),s=$s.makeCacheKey(e,this.effectConstructors);if(s&&this.shCache.has(s))return this._createDynShaderCtr(this.shCache.get(s),e);const r=new $s(this.renderer,t,this.effectConstructors);return s&&this.shCache.set(s,r),this._createDynShaderCtr(r,e)}_createShaderCtr(t,e,s){return new Xa(t,e,s,this.renderer.stage)}_createDynShaderCtr(t,e){return t.bindUniformMethods(e),new Ha(t,e,this)}useShader(t){this.attachedShader!==t&&(this.attachedShader&&this.attachedShader.detach(),t.attach(),this.attachedShader=t)}}const Ka={x:(o,t)=>{o.props.x=t},y:(o,t)=>{o.props.y=t},width:(o,t)=>{o.props.width=t},height:(o,t)=>{o.props.height=t},color:(o,t)=>{o.props.color=t},zIndex:(o,t)=>{o.props.zIndex=t},fontFamily:(o,t)=>{o.props.fontFamily=t},fontWeight:(o,t)=>{o.props.fontWeight=t},fontStyle:(o,t)=>{o.props.fontStyle=t},fontStretch:(o,t)=>{o.props.fontStretch=t},fontSize:(o,t)=>{o.props.fontSize=t},text:(o,t)=>{o.props.text=t},textAlign:(o,t)=>{o.props.textAlign=t},contain:(o,t)=>{o.props.contain=t},offsetY:(o,t)=>{o.props.offsetY=t},scrollable:(o,t)=>{o.props.scrollable=t},scrollY:(o,t)=>{o.props.scrollY=t},letterSpacing:(o,t)=>{o.props.letterSpacing=t},lineHeight:(o,t)=>{o.props.lineHeight=t},maxLines:(o,t)=>{o.props.maxLines=t},textBaseline:(o,t)=>{o.props.textBaseline=t},verticalAlign:(o,t)=>{o.props.verticalAlign=t},overflowSuffix:(o,t)=>{o.props.overflowSuffix=t},debug:(o,t)=>{o.props.debug=t}};class qr{constructor(t){f(this,"stage");f(this,"set");this.stage=t;const e={...Ka,...this.getPropertySetters()},s={};Object.keys(e).forEach(r=>{Object.defineProperty(s,r,{value:(l,a)=>{l.props[r]!==a&&(e[r](l,a),this.stage.requestRender())},writable:!1,configurable:!1})}),this.set=s}setStatus(t,e,s){t.status!==e&&(t.status=e,t.emitter.emit(e,s))}setIsRenderable(t,e){t.isRenderable=e}destroyState(t){this.setStatus(t,"destroyed"),t.emitter.removeAllListeners()}scheduleUpdateState(t){t.updateScheduled||(t.updateScheduled=!0,queueMicrotask(()=>{t.status!=="destroyed"&&(t.updateScheduled=!1,this.updateState(t))}))}}class ja{constructor(){f(this,"data",{})}reset(){this.data={}}increment(t){this.data[t]||(this.data[t]=0),this.data[t]++}getData(){return{...this.data}}}class qa{constructor(t,e){f(this,"stage");f(this,"memUsed",0);f(this,"loadedTextures",new Map);f(this,"criticalThreshold");f(this,"targetThreshold");f(this,"cleanupInterval");f(this,"debugLogging");f(this,"lastCleanupTime",0);f(this,"criticalCleanupRequested",!1);f(this,"frameTime",0);this.stage=t;const{criticalThreshold:s}=e;this.criticalThreshold=Math.round(s);const r=Math.max(0,Math.min(1,e.targetThresholdLevel));if(this.targetThreshold=Math.round(s*r),this.cleanupInterval=e.cleanupInterval,this.debugLogging=e.debugLogging,e.debugLogging){let l=0;setInterval(()=>{l!==this.memUsed&&(l=this.memUsed,console.log(`[TextureMemoryManager] Memory used: ${nn(this.memUsed)} mb / ${nn(this.criticalThreshold)} mb (${(this.memUsed/this.criticalThreshold*100).toFixed(1)}%)`))},1e3)}s===0&&(this.setTextureMemUse=()=>{})}setTextureMemUse(t,e){if(this.loadedTextures.has(t)&&(this.memUsed-=this.loadedTextures.get(t)),e===0){this.loadedTextures.delete(t);return}else this.memUsed+=e,this.loadedTextures.set(t,e);this.memUsed>this.criticalThreshold&&(this.criticalCleanupRequested=!0)}checkCleanup(){return this.criticalCleanupRequested||this.memUsed>this.targetThreshold&&this.frameTime-this.lastCleanupTime>=this.cleanupInterval}cleanup(){const t=this.criticalCleanupRequested;this.lastCleanupTime=this.frameTime,this.criticalCleanupRequested=!1,t&&this.stage.queueFrameEvent("criticalCleanup",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),this.debugLogging&&console.log(`[TextureMemoryManager] Cleaning up textures. Critical: ${t}`);const e=[...this.loadedTextures.keys()].sort((l,a)=>{const i=l.renderable,n=a.renderable;return i===n?l.lastRenderableChangeTime-a.lastRenderableChangeTime:i?1:n?-1:0}),s=this.targetThreshold,r=this.stage.txManager;for(const l of e)if(l.renderable||(l.preventCleanup===!1&&(l.ctxTexture.free(),r.removeTextureFromCache(l)),this.memUsed<=s))break;this.memUsed>=this.criticalThreshold&&(this.stage.queueFrameEvent("criticalCleanupFailed",{memUsed:this.memUsed,criticalThreshold:this.criticalThreshold}),console.warn(`[TextureMemoryManager] Memory usage above critical threshold after cleanup: ${this.memUsed}`))}getMemoryInfo(){let t=0;const e=[...this.loadedTextures.keys()].reduce((s,r)=>(t+=r.renderable?1:0,s+(r.renderable?this.loadedTextures.get(r):0)),0);return{criticalThreshold:this.criticalThreshold,targetThreshold:this.targetThreshold,renderableMemUsed:e,memUsed:this.memUsed,renderableTexturesLoaded:t,loadedTextures:this.loadedTextures.size}}}class Wn{constructor(t,e){f(this,"textureSource");f(this,"memManager");this.memManager=t,this.textureSource=e}setTextureMemUse(t){this.memManager.setTextureMemUse(this.textureSource,t)}get renderable(){return this.textureSource.renderable}}class Vn{constructor(t){f(this,"options");f(this,"mode");f(this,"stage");f(this,"txManager");f(this,"txMemManager");f(this,"shManager");f(this,"rttNodes",[]);this.options=t,this.stage=t.stage,this.txManager=t.txManager,this.txMemManager=t.txMemManager,this.shManager=t.shManager}}class Za extends Ar{constructor(e,s,r){super(e,s);f(this,"textRenderer");f(this,"trState");f(this,"_textRendererOverride",null);f(this,"onTextLoaded",()=>{const{contain:e}=this,s=this.trState.props.width,r=this.trState.props.height,l=this.trState.textW||0,a=this.trState.textH||0;e==="both"?(this.props.width=s,this.props.height=r):e==="width"?(this.props.width=s,this.props.height=a):e==="none"&&(this.props.width=l,this.props.height=a),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});f(this,"onTextFailed",(e,s)=>{this.emit("failed",{type:"text",error:s})});this._textRendererOverride=s.textRendererOverride,this.textRenderer=r;const l=this.createState({x:this.absX,y:this.absY,width:s.width,height:s.height,textAlign:s.textAlign,color:s.color,zIndex:s.zIndex,contain:s.contain,scrollable:s.scrollable,scrollY:s.scrollY,offsetY:s.offsetY,letterSpacing:s.letterSpacing,debug:s.debug,fontFamily:s.fontFamily,fontSize:s.fontSize,fontStretch:s.fontStretch,fontStyle:s.fontStyle,fontWeight:s.fontWeight,text:s.text,lineHeight:s.lineHeight,maxLines:s.maxLines,textBaseline:s.textBaseline,verticalAlign:s.verticalAlign,overflowSuffix:s.overflowSuffix});this.trState=l}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),this.contain==="none"&&this.setUpdateType(C.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),this.contain!=="both"&&this.setUpdateType(C.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);const s=this.stage.resolveTextRenderer(this.trState.props,this._textRendererOverride);if(!s){console.warn("Text Renderer not found for font",this.trState.props.fontFamily);return}this.textRenderer=s,this.trState=this.createState(this.trState.props)}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,s){super.update(e,s),L(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}hasRenderableProperties(){return this.trState&&this.trState.props.text!==""?!0:super.hasRenderableProperties()}onChangeIsRenderable(e){super.onChangeIsRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){var s;if(L(this.globalTransform),!this.textRenderer.renderQuads){super.renderQuads(e);return}this.parentHasRenderTexture&&(!e.renderToTextureActive||this.parentRenderTexture!==e.activeRttNode)||(this.parentHasRenderTexture&&((s=this.props.parent)!=null&&s.rtt)&&(this.globalTransform=be.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),L(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions))}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}createState(e){const s=this.textRenderer.createState(e,this);return s.emitter.on("loaded",this.onTextLoaded),s.emitter.on("failed",this.onTextFailed),this.textRenderer.scheduleUpdateState(s),s}}function Qa(o){const t={boolean:!0,string:!0,number:!0,undefined:!0},e=Object.keys(o);for(let s=0;s<e.length;s++){const r=e[s];if(!r)continue;const l=o[r],a=typeof l;a==="string"&&l.length>2048&&(console.warn(`Custom Data value for ${r} is too long, it will be truncated to 2048 characters`),o[r]=l.substring(0,2048)),t[a]||(console.warn(`Custom Data value for ${r} is not a boolean, string, or number, it will be ignored`),delete o[r])}return o}const Ja=2e6;class ef{constructor(t){f(this,"options");f(this,"animationManager");f(this,"txManager");f(this,"txMemManager");f(this,"fontManager");f(this,"textRenderers");f(this,"shManager");f(this,"renderer");f(this,"root");f(this,"boundsMargin");f(this,"defShaderCtr");f(this,"strictBound");f(this,"preloadBound");f(this,"strictBounds");f(this,"eventBus");f(this,"deltaTime",0);f(this,"lastFrameTime",0);f(this,"currentFrameTime",0);f(this,"fpsNumFrames",0);f(this,"fpsElapsedTime",0);f(this,"renderRequested",!1);f(this,"frameEventQueue",[]);f(this,"fontResolveMap",{});f(this,"contextSpy",null);this.options=t;const{canvas:e,clearColor:s,appWidth:r,appHeight:l,boundsMargin:a,enableContextSpy:i,forceWebGL2:n,numImageWorkers:c,textureMemory:h,renderEngine:d,fontEngines:m}=t;this.eventBus=t.eventBus,this.txManager=new Oa(c),this.txMemManager=new qa(this,h),this.shManager=new Ya,this.animationManager=new Ma,this.contextSpy=i?new ja:null,this.strictBounds=t.strictBounds;let p=[0,0,0,0];a&&(p=Array.isArray(a)?a:[a,a,a,a]),this.boundsMargin=p,this.strictBound=Us(0,0,r,l),this.preloadBound=Er(this.strictBound,p);const u={stage:this,canvas:e,pixelRatio:t.devicePhysicalPixelRatio*t.deviceLogicalPixelRatio,clearColor:s??4278190080,bufferMemory:Ja,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy,forceWebGL2:n};this.renderer=new d(u);const x=this.renderer.mode||"webgl";this.defShaderCtr=this.renderer.getDefShaderCtr(),ca(x),this.txManager.renderer=this.renderer,this.textRenderers={},m.forEach(b=>{const v=new b(this),R=v.type;if(R==="sdf"&&x==="canvas"){console.warn("SdfTextRenderer is not compatible with Canvas renderer. Skipping...");return}v instanceof qr&&(R==="canvas"?this.textRenderers.canvas=v:R==="sdf"&&(this.textRenderers.sdf=v))}),Object.keys(this.textRenderers).length===0&&console.warn("No text renderers available. Your text will not render."),this.fontManager=new Da(this.textRenderers);const T=new Ar(this,{x:0,y:0,width:r,height:l,alpha:1,autosize:!1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:{},shader:this.defShaderCtr,rtt:!1,src:null,scale:1,preventCleanup:!1,strictBounds:this.strictBounds});this.root=T,Ea(this)}updateFrameTime(){const t=Aa();this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=t,this.deltaTime=this.lastFrameTime?t-this.lastFrameTime:100/6,this.txManager.frameTime=t,this.txMemManager.frameTime=t,this.eventBus.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime})}updateAnimations(){const{animationManager:t}=this;this.root&&t.update(this.deltaTime)}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){const{renderer:t,renderRequested:e}=this;L(t),this.root.updateType!==0&&this.root.update(this.deltaTime,this.root.clippingRect),t.reset(),this.txMemManager.criticalCleanupRequested&&this.txMemManager.cleanup(),t.rttNodes.length>0&&t.renderRTTNodes(),this.addQuads(this.root),t==null||t.render(),this.calculateFps(),e&&(this.renderRequested=!1)}queueFrameEvent(t,e){this.frameEventQueue.push([t,e])}flushFrameEvents(){for(const[t,e]of this.frameEventQueue)this.eventBus.emit(t,e);this.frameEventQueue=[]}calculateFps(){var e,s;const{fpsUpdateInterval:t}=this.options;if(t&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=t)){const r=Math.round(this.fpsNumFrames*1e3/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.queueFrameEvent("fpsUpdate",{fps:r,contextSpyData:((e=this.contextSpy)==null?void 0:e.getData())??null}),(s=this.contextSpy)==null||s.reset()}}addQuads(t){L(this.renderer),t.isRenderable===!0&&t.renderQuads(this.renderer);for(let e=0;e<t.children.length;e++){const s=t.children[e];s!==void 0&&(s.worldAlpha===0||s.strictBounds===!0&&s.renderState===pe.OutOfBounds||this.addQuads(s))}}requestRender(){this.renderRequested=!0}resolveTextRenderer(t,e=null){const s=`${t.fontFamily}${t.fontStyle}${t.fontWeight}${t.fontStretch}${e||""}`;if(this.fontResolveMap[s]!==void 0)return this.fontResolveMap[s];let r=e,l=!1;if(r){const i=this.textRenderers[r];i?i.canRenderFont(t)||(console.warn(`Cannot use override text renderer '${r}' for font`,t),r=null,l=!0):(console.warn(`Text renderer override '${r}' not found.`),r=null,l=!0)}if(!r){for(const[i,n]of Object.entries(this.textRenderers))if(n.canRenderFont(t)){r=i;break}!r&&this.textRenderers.canvas!==void 0&&(r="canvas")}if(l&&console.warn(`Falling back to text renderer ${String(r)}`),!r)return null;const a=this.textRenderers[r];return L(a,"resolvedTextRenderer undefined"),this.fontResolveMap[s]=a,a}createShaderCtr(t,e){return this.shManager.loadShader(t,e)}createNode(t){const e=this.resolveNodeDefaults(t);return new Ar(this,e)}createTextNode(t){const e=t.fontSize??16,s={...this.resolveNodeDefaults(t),text:t.text??"",textRendererOverride:t.textRendererOverride??null,fontSize:e,fontFamily:t.fontFamily??"sans-serif",fontStyle:t.fontStyle??"normal",fontWeight:t.fontWeight??"normal",fontStretch:t.fontStretch??"normal",textAlign:t.textAlign??"left",contain:t.contain??"none",scrollable:t.scrollable??!1,scrollY:t.scrollY??0,offsetY:t.offsetY??0,letterSpacing:t.letterSpacing??0,lineHeight:t.lineHeight,maxLines:t.maxLines??0,textBaseline:t.textBaseline??"alphabetic",verticalAlign:t.verticalAlign??"middle",overflowSuffix:t.overflowSuffix??"...",debug:t.debug??{},shaderProps:null},r=this.resolveTextRenderer(s,t.textRendererOverride);if(!r)throw new Error(`No compatible text renderer found for ${s.fontFamily}`);return new Za(this,s,r)}resolveNodeDefaults(t){const e=t.color??4294967295,s=t.colorTl??t.colorTop??t.colorLeft??e,r=t.colorTr??t.colorTop??t.colorRight??e,l=t.colorBl??t.colorBottom??t.colorLeft??e,a=t.colorBr??t.colorBottom??t.colorRight??e;let i={};return this.options.inspector===!0&&(i=Qa(t.data??{})),{x:t.x??0,y:t.y??0,width:t.width??0,height:t.height??0,alpha:t.alpha??1,autosize:t.autosize??!1,clipping:t.clipping??!1,color:e,colorTop:t.colorTop??e,colorBottom:t.colorBottom??e,colorLeft:t.colorLeft??e,colorRight:t.colorRight??e,colorBl:l,colorBr:a,colorTl:s,colorTr:r,zIndex:t.zIndex??0,zIndexLocked:t.zIndexLocked??0,parent:t.parent??null,texture:t.texture??null,textureOptions:t.textureOptions??{},shader:t.shader??this.defShaderCtr,src:t.src??null,srcHeight:t.srcHeight,srcWidth:t.srcWidth,srcX:t.srcX,srcY:t.srcY,scale:t.scale??null,scaleX:t.scaleX??t.scale??1,scaleY:t.scaleY??t.scale??1,mount:t.mount??0,mountX:t.mountX??t.mount??0,mountY:t.mountY??t.mount??0,pivot:t.pivot??.5,pivotX:t.pivotX??t.pivot??.5,pivotY:t.pivotY??t.pivot??.5,rotation:t.rotation??0,rtt:t.rtt??!1,data:i,preventCleanup:t.preventCleanup??!1,imageType:t.imageType,strictBounds:t.strictBounds??this.strictBounds}}}class tf extends tt{constructor(e,s){var x,T,b,v;super();f(this,"root");f(this,"canvas");f(this,"settings");f(this,"stage");f(this,"inspector",null);const r={criticalThreshold:((x=e.textureMemory)==null?void 0:x.criticalThreshold)||124e6,targetThresholdLevel:((T=e.textureMemory)==null?void 0:T.targetThresholdLevel)||.5,cleanupInterval:((b=e.textureMemory)==null?void 0:b.cleanupInterval)||3e4,debugLogging:((v=e.textureMemory)==null?void 0:v.debugLogging)||!1},l={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,textureMemory:r,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:e.clearColor??0,fpsUpdateInterval:e.fpsUpdateInterval||0,numImageWorkers:e.numImageWorkers!==void 0?e.numImageWorkers:2,enableContextSpy:e.enableContextSpy??!1,forceWebGL2:e.forceWebGL2??!1,inspector:e.inspector??!1,renderEngine:e.renderEngine,quadBufferSize:e.quadBufferSize??4*1024*1024,fontEngines:e.fontEngines,strictBounds:e.strictBounds??!0};this.settings=l;const{appWidth:a,appHeight:i,deviceLogicalPixelRatio:n,devicePhysicalPixelRatio:c,inspector:h}=l,d=a*n,m=i*n,p=document.createElement("canvas");this.canvas=p,p.width=d*c,p.height=m*c,p.style.width=`${d}px`,p.style.height=`${m}px`,this.stage=new ef({appWidth:this.settings.appWidth,appHeight:this.settings.appHeight,boundsMargin:this.settings.boundsMargin,clearColor:this.settings.clearColor,canvas:this.canvas,deviceLogicalPixelRatio:this.settings.deviceLogicalPixelRatio,devicePhysicalPixelRatio:this.settings.devicePhysicalPixelRatio,enableContextSpy:this.settings.enableContextSpy,forceWebGL2:this.settings.forceWebGL2,fpsUpdateInterval:this.settings.fpsUpdateInterval,numImageWorkers:this.settings.numImageWorkers,renderEngine:this.settings.renderEngine,textureMemory:r,eventBus:this,quadBufferSize:this.settings.quadBufferSize,fontEngines:this.settings.fontEngines,inspector:this.settings.inspector!==null,strictBounds:this.settings.strictBounds}),this.root=this.stage.root;let u;if(typeof s=="string"?u=document.getElementById(s):u=s,!u)throw new Error("Could not find target element");u.appendChild(p),h&&!Yr()&&(this.inspector=new h(p,l))}createNode(e){const s=this.stage.createNode(e);return this.inspector?this.inspector.createNode(s):s}createTextNode(e){const s=this.stage.createTextNode(e);return this.inspector?this.inspector.createTextNode(s):s}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e.id),e.destroy()}createTexture(e,s){return this.stage.txManager.loadTexture(e,s)}createShader(e,s){return this.stage.shManager.loadShader(e,s)}createDynamicShader(e){return this.stage.shManager.loadDynamicShader({effects:e})}createEffect(e,s,r){return{name:r,type:e,props:s}}getNodeById(e){var l;const s=(l=this.stage)==null?void 0:l.root;if(!s)return null;const r=a=>{if(a.id===e)return a;for(const i of a.children){const n=r(i);if(n)return n}return null};return r(s)}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}getBufferInfo(){return this.stage.renderer.getBufferInfo()}rerender(){throw new Error("Not implemented")}}class Xn extends tt{constructor(e){super();f(this,"fontFamily");f(this,"descriptors");f(this,"loaded",!1);f(this,"metrics",null);const{fontFamily:s,descriptors:r,metrics:l}=e;l&&(this.metrics={ascender:l.ascender/l.unitsPerEm,descender:l.descender/l.unitsPerEm,lineGap:l.lineGap/l.unitsPerEm}),this.fontFamily=s,this.descriptors={style:"normal",weight:"normal",stretch:"normal",...r}}static convertToCssFontFaceDescriptors(e){return{style:e.style,weight:typeof e.weight=="number"?`${e.weight}`:e.weight,stretch:e.stretch,unicodeRange:e.unicodeRange,featureSettings:e.featureSettings,display:e.display}}}class Vi extends Xn{constructor(e){super(e);f(this,"fontFace");f(this,"fontUrl");const{fontFamily:s,fontUrl:r}=e,l=r.replace(/\(|\)/g,""),a=this.descriptors,i={style:a.style,weight:typeof a.weight=="number"?`${a.weight}`:a.weight,stretch:a.stretch,unicodeRange:a.unicodeRange,featureSettings:a.featureSettings,display:a.display},n=new FontFace(s,`url(${l})`,i);l.length>0?n.load().then(()=>{this.loaded=!0,this.emit("loaded")}).catch(console.error):(this.loaded=!0,this.emit("loaded")),this.fontFace=n,this.fontUrl=r}}class sf{}class Hn extends sf{constructor(e,s,r,l,a,i,n,c,h,d,m,p,u){super();f(this,"glw");f(this,"options");f(this,"buffers");f(this,"shader");f(this,"shaderProps");f(this,"alpha");f(this,"clippingRect");f(this,"dimensions");f(this,"bufferIdx");f(this,"zIndex");f(this,"renderToTexture");f(this,"parentHasRenderTexture");f(this,"framebufferDimensions");f(this,"length",0);f(this,"numQuads",0);f(this,"textures",[]);f(this,"maxTextures");this.glw=e,this.options=s,this.buffers=r,this.shader=l,this.shaderProps=a,this.alpha=i,this.clippingRect=n,this.dimensions=c,this.bufferIdx=h,this.zIndex=d,this.renderToTexture=m,this.parentHasRenderTexture=p,this.framebufferDimensions=u,this.maxTextures=l.supportsIndexedTextures?e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS):1}addTexture(e){const{textures:s,maxTextures:r}=this;let l=-1;const a=s.length;for(let i=0;i<a;i++)if(s[i]===e){l=i;break}return l!==-1?l:a>=r?4294967295:(this.textures.push(e),a)}draw(){const{glw:e,shader:s,shaderProps:r,options:l}=this,{shManager:a}=l;a.useShader(s),s.bindRenderOp(this,r);const i=this.bufferIdx/24*6*2;if(this.clippingRect.valid){const{x:n,y:c,width:h,height:d}=this.clippingRect,m=l.pixelRatio,p=l.canvas.height,u=Math.round(n*m),x=Math.round(h*m),T=Math.round(d*m),b=Math.round(p-T-c*m);e.setScissorTest(!0),e.scissor(u,b,x,T)}else e.setScissorTest(!1);e.drawElements(e.TRIANGLES,6*this.numQuads,e.UNSIGNED_SHORT,i)}}function of(o){const t={MAX_RENDERBUFFER_SIZE:0,MAX_TEXTURE_SIZE:0,MAX_VIEWPORT_DIMS:0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:0,MAX_TEXTURE_IMAGE_UNITS:0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:0,MAX_VERTEX_ATTRIBS:0,MAX_VARYING_VECTORS:0,MAX_VERTEX_UNIFORM_VECTORS:0,MAX_FRAGMENT_UNIFORM_VECTORS:0};return Object.keys(t).forEach(s=>{t[s]=o.getParameter(o[s])}),t}function rf(o){const t={ANGLE_instanced_arrays:null,WEBGL_compressed_texture_s3tc:null,WEBGL_compressed_texture_astc:null,WEBGL_compressed_texture_etc:null,WEBGL_compressed_texture_etc1:null,WEBGL_compressed_texture_pvrtc:null,WEBKIT_WEBGL_compressed_texture_pvrtc:null,WEBGL_compressed_texture_s3tc_srgb:null,OES_vertex_array_object:null};return Object.keys(t).forEach(s=>{t[s]=o.getExtension(s)}),t}function nf(o,t){const e=~~(t/80),s=new Uint16Array(e*6);for(let l=0,a=0;l<e;l+=6,a+=4)s[l]=a,s[l+1]=a+1,s[l+2]=a+2,s[l+3]=a+2,s[l+4]=a+1,s[l+5]=a+3;const r=o.createBuffer();o.elementArrayBufferData(r,s,o.STATIC_DRAW)}function lf(o){return o!==null&&typeof o=="object"&&o.constructor&&o.constructor.name==="HTMLImageElement"}const Sr=new Uint8Array([0,0,0,0]);class Zr extends Wn{constructor(e,s,r){super(s,r);f(this,"glw");f(this,"_nativeCtxTexture",null);f(this,"_state","freed");f(this,"_w",0);f(this,"_h",0);this.glw=e}get ctxTexture(){return this._state==="freed"&&this.load(),L(this._nativeCtxTexture),this._nativeCtxTexture}get w(){return this._w}get h(){return this._h}load(){if(!(this._state==="loading"||this._state==="loaded")){if(this._state="loading",this.textureSource.setState("loading"),this._nativeCtxTexture=this.createNativeCtxTexture(),this._nativeCtxTexture===null){this._state="failed",this.textureSource.setState("failed",new Error("Could not create WebGL Texture")),console.error("Could not create WebGL Texture");return}this.onLoadRequest().then(({width:e,height:s})=>{this._state!=="freed"&&(this._state="loaded",this._w=e,this._h=s,this.textureSource.setState("loaded",{width:e,height:s}))}).catch(e=>{this._state!=="freed"&&(this._state="failed",this.textureSource.setState("failed",e),console.error(e))})}}async onLoadRequest(){var a;const{glw:e}=this;e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(Sr.byteLength);const s=await((a=this.textureSource)==null?void 0:a.getTextureData());if(!this._nativeCtxTexture)return L(this._state==="freed"),{width:0,height:0};let r=0,l=0;if(L(this._nativeCtxTexture),e.activeTexture(0),typeof ImageBitmap<"u"&&s.data instanceof ImageBitmap||s.data instanceof ImageData||lf(s.data)){const i=s.data;r=i.width,l=i.height,e.bindTexture(this._nativeCtxTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!!s.premultiplyAlpha),e.texImage2D(0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),this.setTextureMemUse(r*l*4),(e.isWebGl2()||rn(r)&&rn(l))&&e.generateMipmap()}else if(s.data===null)r=0,l=0,e.bindTexture(this._nativeCtxTexture),e.texImage2D(0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,Sr),this.setTextureMemUse(Sr.byteLength);else if("mipmaps"in s.data&&s.data.mipmaps){const{mipmaps:i,width:n=0,height:c=0,type:h,glInternalFormat:d}=s.data,m=h==="ktx"?new DataView(i[0]??new ArrayBuffer(0)):i[0];e.bindTexture(this._nativeCtxTexture),e.compressedTexImage2D(0,d,n,c,0,m),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),this.setTextureMemUse(m.byteLength)}else console.error("WebGlCoreCtxTexture.onLoadRequest: Unexpected textureData returned",s);return{width:r,height:l}}free(){if(this._state==="freed"||(this._state="freed",this.textureSource.setState("freed"),this._w=0,this._h=0,!this._nativeCtxTexture))return;const{glw:e}=this;e.deleteTexture(this._nativeCtxTexture),this.setTextureMemUse(0),this._nativeCtxTexture=null}createNativeCtxTexture(){const{glw:e}=this,s=e.createTexture();return s?(e.activeTexture(0),e.bindTexture(s),e.texParameteri(e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),s):null}}class af extends Zr{constructor(t,e,s){super(t,e,s)}async onLoadRequest(){var e,s;const t=await this.textureSource.getTextureData();return{width:((e=t.data)==null?void 0:e.width)||0,height:((s=t.data)==null?void 0:s.height)||0}}}class Yn{constructor(t){f(this,"config");this.config=t}getBuffer(t){var e;return(e=this.config.find(s=>s.attributes[t]))==null?void 0:e.buffer}getAttributeInfo(t){var e;return(e=this.config.find(s=>s.attributes[t]))==null?void 0:e.attributes[t]}}function ff(o){return self.WebGL2RenderingContext&&o instanceof self.WebGL2RenderingContext}class cf{constructor(t){f(this,"gl");f(this,"activeTextureUnit",0);f(this,"texture2dUnits");f(this,"texture2dParams",new WeakMap);f(this,"scissorEnabled");f(this,"scissorX");f(this,"scissorY");f(this,"scissorWidth");f(this,"scissorHeight");f(this,"blendEnabled");f(this,"blendSrcRgb");f(this,"blendDstRgb");f(this,"blendSrcAlpha");f(this,"blendDstAlpha");f(this,"boundArrayBuffer");f(this,"boundElementArrayBuffer");f(this,"curProgram");f(this,"canvas");f(this,"MAX_RENDERBUFFER_SIZE");f(this,"MAX_TEXTURE_SIZE");f(this,"MAX_VIEWPORT_DIMS");f(this,"MAX_VERTEX_TEXTURE_IMAGE_UNITS");f(this,"MAX_TEXTURE_IMAGE_UNITS");f(this,"MAX_COMBINED_TEXTURE_IMAGE_UNITS");f(this,"MAX_VERTEX_ATTRIBS");f(this,"MAX_VARYING_VECTORS");f(this,"MAX_VERTEX_UNIFORM_VECTORS");f(this,"MAX_FRAGMENT_UNIFORM_VECTORS");f(this,"TEXTURE_MAG_FILTER");f(this,"TEXTURE_MIN_FILTER");f(this,"TEXTURE_WRAP_S");f(this,"TEXTURE_WRAP_T");f(this,"LINEAR");f(this,"CLAMP_TO_EDGE");f(this,"RGBA");f(this,"UNSIGNED_BYTE");f(this,"UNPACK_PREMULTIPLY_ALPHA_WEBGL");f(this,"UNPACK_FLIP_Y_WEBGL");f(this,"FLOAT");f(this,"TRIANGLES");f(this,"UNSIGNED_SHORT");f(this,"ONE");f(this,"ONE_MINUS_SRC_ALPHA");f(this,"VERTEX_SHADER");f(this,"FRAGMENT_SHADER");f(this,"STATIC_DRAW");f(this,"COMPILE_STATUS");f(this,"LINK_STATUS");f(this,"DYNAMIC_DRAW");f(this,"COLOR_ATTACHMENT0");this.gl=t,this.activeTextureUnit=t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0;const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.texture2dUnits=new Array(e).fill(void 0).map((r,l)=>(this.activeTexture(l),t.getParameter(t.TEXTURE_BINDING_2D))),this.activeTexture(this.activeTextureUnit),this.scissorEnabled=t.isEnabled(t.SCISSOR_TEST);const s=t.getParameter(t.SCISSOR_BOX);this.scissorX=s[0],this.scissorY=s[1],this.scissorWidth=s[2],this.scissorHeight=s[3],this.blendEnabled=t.isEnabled(t.BLEND),this.blendSrcRgb=t.getParameter(t.BLEND_SRC_RGB),this.blendDstRgb=t.getParameter(t.BLEND_DST_RGB),this.blendSrcAlpha=t.getParameter(t.BLEND_SRC_ALPHA),this.blendDstAlpha=t.getParameter(t.BLEND_DST_ALPHA),this.boundArrayBuffer=t.getParameter(t.ARRAY_BUFFER_BINDING),this.boundElementArrayBuffer=t.getParameter(t.ELEMENT_ARRAY_BUFFER_BINDING),this.curProgram=t.getParameter(t.CURRENT_PROGRAM),this.canvas=t.canvas,this.MAX_RENDERBUFFER_SIZE=t.MAX_RENDERBUFFER_SIZE,this.MAX_TEXTURE_SIZE=t.MAX_TEXTURE_SIZE,this.MAX_VIEWPORT_DIMS=t.MAX_VIEWPORT_DIMS,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.MAX_TEXTURE_IMAGE_UNITS=t.MAX_TEXTURE_IMAGE_UNITS,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS,this.MAX_VERTEX_ATTRIBS=t.MAX_VERTEX_ATTRIBS,this.MAX_VARYING_VECTORS=t.MAX_VARYING_VECTORS,this.MAX_VERTEX_UNIFORM_VECTORS=t.MAX_VERTEX_UNIFORM_VECTORS,this.MAX_FRAGMENT_UNIFORM_VECTORS=t.MAX_FRAGMENT_UNIFORM_VECTORS,this.TEXTURE_MAG_FILTER=t.TEXTURE_MAG_FILTER,this.TEXTURE_MIN_FILTER=t.TEXTURE_MIN_FILTER,this.TEXTURE_WRAP_S=t.TEXTURE_WRAP_S,this.TEXTURE_WRAP_T=t.TEXTURE_WRAP_T,this.LINEAR=t.LINEAR,this.CLAMP_TO_EDGE=t.CLAMP_TO_EDGE,this.RGBA=t.RGBA,this.UNSIGNED_BYTE=t.UNSIGNED_BYTE,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.UNPACK_FLIP_Y_WEBGL=t.UNPACK_FLIP_Y_WEBGL,this.FLOAT=t.FLOAT,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.ONE=t.ONE,this.ONE_MINUS_SRC_ALPHA=t.ONE_MINUS_SRC_ALPHA,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.MAX_VERTEX_TEXTURE_IMAGE_UNITS,this.TRIANGLES=t.TRIANGLES,this.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this.VERTEX_SHADER=t.VERTEX_SHADER,this.FRAGMENT_SHADER=t.FRAGMENT_SHADER,this.STATIC_DRAW=t.STATIC_DRAW,this.COMPILE_STATUS=t.COMPILE_STATUS,this.LINK_STATUS=t.LINK_STATUS,this.DYNAMIC_DRAW=t.DYNAMIC_DRAW,this.COLOR_ATTACHMENT0=t.COLOR_ATTACHMENT0}isWebGl2(){return ff(this.gl)}activeTexture(t){const{gl:e}=this;this.activeTextureUnit!==t&&(e.activeTexture(t+e.TEXTURE0),this.activeTextureUnit=t)}bindTexture(t){const{gl:e,activeTextureUnit:s,texture2dUnits:r}=this;r[s]!==t&&(r[s]=t,e.bindTexture(this.gl.TEXTURE_2D,t))}_getActiveTexture(){const{activeTextureUnit:t,texture2dUnits:e}=this;return e[t]}texParameteri(t,e){const{gl:s,texture2dParams:r}=this,l=this._getActiveTexture();if(!l)throw new Error("No active texture");let a=r.get(l);a||(a={},r.set(l,a)),a[t]!==e&&(a[t]=e,s.texParameteri(s.TEXTURE_2D,t,e))}texImage2D(t,e,s,r,l,a,i,n){const{gl:c}=this;a?c.texImage2D(c.TEXTURE_2D,t,e,s,r,l,a,i,n):c.texImage2D(c.TEXTURE_2D,t,e,s,r,l)}compressedTexImage2D(t,e,s,r,l,a){const{gl:i}=this;i.compressedTexImage2D(i.TEXTURE_2D,t,e,s,r,l,a)}pixelStorei(t,e){const{gl:s}=this;s.pixelStorei(t,e)}generateMipmap(){const{gl:t}=this;t.generateMipmap(t.TEXTURE_2D)}createTexture(){const{gl:t}=this;return t.createTexture()}deleteTexture(t){const{gl:e}=this;t&&this.texture2dParams.delete(t),e.deleteTexture(t)}viewport(t,e,s,r){const{gl:l}=this;l.viewport(t,e,s,r)}clearColor(t,e,s,r){const{gl:l}=this;l.clearColor(t,e,s,r)}setScissorTest(t){const{gl:e,scissorEnabled:s}=this;t!==s&&(t?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),this.scissorEnabled=t)}scissor(t,e,s,r){const{gl:l,scissorX:a,scissorY:i,scissorWidth:n,scissorHeight:c}=this;(t!==a||e!==i||s!==n||r!==c)&&(l.scissor(t,e,s,r),this.scissorX=t,this.scissorY=e,this.scissorWidth=s,this.scissorHeight=r)}setBlend(t){const{gl:e,blendEnabled:s}=this;t!==s&&(t?e.enable(e.BLEND):e.disable(e.BLEND),this.blendEnabled=t)}blendFunc(t,e){const{gl:s,blendSrcRgb:r,blendDstRgb:l,blendSrcAlpha:a,blendDstAlpha:i}=this;(t!==r||e!==l||t!==a||e!==i)&&(s.blendFunc(t,e),this.blendSrcRgb=t,this.blendDstRgb=e,this.blendSrcAlpha=t,this.blendDstAlpha=e)}createBuffer(){const{gl:t}=this;return t.createBuffer()}createFramebuffer(){const{gl:t}=this;return t.createFramebuffer()}bindFramebuffer(t){const{gl:e}=this;e.bindFramebuffer(e.FRAMEBUFFER,t)}framebufferTexture2D(t,e,s){const{gl:r}=this;r.framebufferTexture2D(r.FRAMEBUFFER,t,r.TEXTURE_2D,e,s)}clear(){const{gl:t}=this;t.clear(t.COLOR_BUFFER_BIT)}arrayBufferData(t,e,s){const{gl:r,boundArrayBuffer:l}=this;l!==t&&(r.bindBuffer(r.ARRAY_BUFFER,t),this.boundArrayBuffer=t),r.bufferData(r.ARRAY_BUFFER,e,s)}elementArrayBufferData(t,e,s){const{gl:r,boundElementArrayBuffer:l}=this;l!==t&&(r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.boundElementArrayBuffer=t),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,s)}vertexAttribPointer(t,e,s,r,l,a,i){const{gl:n,boundArrayBuffer:c}=this;c!==t&&(n.bindBuffer(n.ARRAY_BUFFER,t),this.boundArrayBuffer=t),n.vertexAttribPointer(e,s,r,l,a,i)}useProgram(t){const{gl:e,curProgram:s}=this;s!==t&&(e.useProgram(t),this.curProgram=t)}uniform1f(t,e){const{gl:s}=this;s.uniform1f(t,e)}uniform1fv(t,e){const{gl:s}=this;s.uniform1fv(t,e)}uniform1i(t,e){const{gl:s}=this;s.uniform1i(t,e)}uniform1iv(t,e){const{gl:s}=this;s.uniform1iv(t,e)}uniform2f(t,e,s){const{gl:r}=this;r.uniform2f(t,e,s)}uniform2fv(t,e){const{gl:s}=this;s.uniform2fv(t,e)}uniform2i(t,e,s){const{gl:r}=this;r.uniform2i(t,e,s)}uniform2iv(t,e){const{gl:s}=this;s.uniform2iv(t,e)}uniform3f(t,e,s,r){const{gl:l}=this;l.uniform3f(t,e,s,r)}uniform3fv(t,e){const{gl:s}=this;s.uniform3fv(t,e)}uniform3i(t,e,s,r){const{gl:l}=this;l.uniform3i(t,e,s,r)}uniform3iv(t,e){const{gl:s}=this;s.uniform3iv(t,e)}uniform4f(t,e,s,r,l){const{gl:a}=this;a.uniform4f(t,e,s,r,l)}uniform4fv(t,e){const{gl:s}=this;s.uniform4fv(t,e)}uniform4i(t,e,s,r,l){const{gl:a}=this;a.uniform4i(t,e,s,r,l)}uniform4iv(t,e){const{gl:s}=this;s.uniform4iv(t,e)}uniformMatrix2fv(t,e){const{gl:s}=this;s.uniformMatrix2fv(t,!1,e)}uniformMatrix3fv(t,e){const{gl:s}=this;s.uniformMatrix3fv(t,!1,e)}uniformMatrix4fv(t,e){const{gl:s}=this;s.uniformMatrix4fv(t,!1,e)}getParameter(t){const{gl:e}=this;return e.getParameter(t)}drawElements(t,e,s,r){const{gl:l}=this;l.drawElements(t,e,s,r)}getExtension(t){const{gl:e}=this;return e.getExtension(t)}createVertexArray(){const{gl:t}=this;return L(t instanceof WebGL2RenderingContext),t.createVertexArray()}bindVertexArray(t){const{gl:e}=this;L(e instanceof WebGL2RenderingContext),e.bindVertexArray(t)}getAttribLocation(t,e){const{gl:s}=this;return s.getAttribLocation(t,e)}getUniformLocation(t,e){const{gl:s}=this;return s.getUniformLocation(t,e)}enableVertexAttribArray(t){const{gl:e}=this;e.enableVertexAttribArray(t)}disableVertexAttribArray(t){const{gl:e}=this;e.disableVertexAttribArray(t)}createShader(t){const{gl:e}=this;return e.createShader(t)}compileShader(t){const{gl:e}=this;e.compileShader(t)}attachShader(t,e){const{gl:s}=this;s.attachShader(t,e)}linkProgram(t){const{gl:e}=this;e.linkProgram(t)}deleteProgram(t){const{gl:e}=this;e.deleteProgram(t)}getShaderParameter(t,e){const{gl:s}=this;return s.getShaderParameter(t,e)}getShaderInfoLog(t){const{gl:e}=this;return e.getShaderInfoLog(t)}createProgram(){const{gl:t}=this;return t.createProgram()}getProgramParameter(t,e){const{gl:s}=this;return s.getProgramParameter(t,e)}getProgramInfoLog(t){const{gl:e}=this;return e.getProgramInfoLog(t)}shaderSource(t,e){const{gl:s}=this;s.shaderSource(t,e)}deleteShader(t){const{gl:e}=this;e.deleteShader(t)}}class hn extends Zr{constructor(e,s,r){super(e,s,r);f(this,"framebuffer");const l=e.createFramebuffer();L(l,"Unable to create framebuffer"),this.framebuffer=l}async onLoadRequest(){const{glw:e}=this,s=this._nativeCtxTexture=this.createNativeCtxTexture(),{width:r,height:l}=this.textureSource;return e.texImage2D(0,e.RGBA,r,l,0,e.RGBA,e.UNSIGNED_BYTE,null),this.setTextureMemUse(r*l*4),e.bindFramebuffer(this.framebuffer),e.framebufferTexture2D(e.COLOR_ATTACHMENT0,s,0),e.bindFramebuffer(null),{width:r,height:l}}}const hf=24;class Qr extends Vn{constructor(e){super(e);f(this,"glw");f(this,"system");f(this,"quadBuffer");f(this,"fQuadBuffer");f(this,"uiQuadBuffer");f(this,"renderOps",[]);f(this,"curBufferIdx",0);f(this,"curRenderOp",null);f(this,"rttNodes",[]);f(this,"activeRttNode",null);f(this,"defShaderCtrl");f(this,"defaultShader");f(this,"quadBufferCollection");f(this,"defaultTexture");f(this,"quadBufferUsage",0);f(this,"renderToTextureActive",!1);this.quadBuffer=new ArrayBuffer(this.stage.options.quadBufferSize),this.fQuadBuffer=new Float32Array(this.quadBuffer),this.uiQuadBuffer=new Uint32Array(this.quadBuffer),this.mode="webgl";const{canvas:s,clearColor:r,bufferMemory:l}=e;this.defaultTexture=new Ji(this.txManager),this.defaultTexture.setRenderableOwner(this,!0),this.defaultTexture.once("loaded",()=>{this.stage.requestRender()});const a=aa(s,e.forceWebGL2,e.contextSpy),i=this.glw=new cf(a),n=Ws(r);i.viewport(0,0,s.width,s.height),i.clearColor(n[0],n[1],n[2],n[3]),i.setBlend(!0),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),nf(i,l),this.system={parameters:of(this.glw),extensions:rf(this.glw)},this.shManager.renderer=this,this.defShaderCtrl=this.shManager.loadShader("DefaultShader"),this.defaultShader=this.defShaderCtrl.shader;const c=i.createBuffer();L(c);const h=6*Float32Array.BYTES_PER_ELEMENT;this.quadBufferCollection=new Yn([{buffer:c,attributes:{a_position:{name:"a_position",size:2,type:i.FLOAT,normalized:!1,stride:h,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:i.FLOAT,normalized:!1,stride:h,offset:2*Float32Array.BYTES_PER_ELEMENT},a_color:{name:"a_color",size:4,type:i.UNSIGNED_BYTE,normalized:!0,stride:h,offset:4*Float32Array.BYTES_PER_ELEMENT},a_textureIndex:{name:"a_textureIndex",size:1,type:i.FLOAT,normalized:!1,stride:h,offset:5*Float32Array.BYTES_PER_ELEMENT}}}])}reset(){const{glw:e}=this;this.curBufferIdx=0,this.curRenderOp=null,this.renderOps.length=0,e.setScissorTest(!1),e.clear()}getShaderManager(){return this.shManager}createCtxTexture(e){return e instanceof fo?new af(this.glw,this.txMemManager,e):e instanceof tr?new hn(this.glw,this.txMemManager,e):new Zr(this.glw,this.txMemManager,e)}addQuad(e){const{fQuadBuffer:s,uiQuadBuffer:r}=this;let l=e.texture||this.defaultTexture;if(e.shaderProps!==null){if(Zi(e.shaderProps,"$dimensions")==!0){const b=e.shaderProps.$dimensions;b.width=e.width,b.height=e.height}Zi(e.shaderProps,"$alpha")===!0&&(e.shaderProps.$alpha=e.alpha)}L(l.ctxTexture!==void 0,"Invalid texture type");let{curBufferIdx:a,curRenderOp:i}=this;const n={width:-1,height:-1};n.width=e.width,n.height=e.height;const c=e.shader||this.defaultShader;L(c.getUniformLocation!==void 0,"Invalid WebGL shader"),this.reuseRenderOp(e)===!1&&(this.newRenderOp(c,e.shaderProps,e.alpha,n,e.clippingRect,a,e.rtt,e.parentHasRenderTexture,e.framebufferDimensions),i=this.curRenderOp,L(i));let h=0,d=0,m=1,p=1;if(l.type===Ue.subTexture){const{x:b,y:v,width:R,height:w}=l.props,{width:E=0,height:S=0}=l.parentTexture.dimensions||{width:0,height:0};h=b/E,m=h+R/E,d=v/S,p=d+w/S,l=l.parentTexture}if(l.type===Ue.image&&e.textureOptions!==null&&e.textureOptions.resizeMode!==void 0&&l.dimensions!==null){const b=e.textureOptions.resizeMode,{width:v,height:R}=l.dimensions;if(b.type==="cover"){const w=e.width/v,E=e.height/R,S=Math.max(w,E),M=1/S;if(S&&w&&w<S){const I=M*e.width;h=(1-I/v)*(b.clipX??.5),m=h+I/v}if(S&&E&&E<S){const I=M*e.height;d=(1-I/R)*(b.clipY??.5),p=d+I/R}}}let u=0;e.textureOptions!==null&&(e.textureOptions.flipX===!0&&([h,m]=[m,h]),u=+(e.textureOptions.flipY||!1)),u^+(l.type===Ue.renderToTexture)&&([d,p]=[p,d]);const x=l.ctxTexture;L(x.ctxTexture!==void 0);const T=this.addTexture(x,a);if(L(this.curRenderOp!==null),e.renderCoords)s[a++]=e.renderCoords.x1,s[a++]=e.renderCoords.y1,s[a++]=h,s[a++]=d,r[a++]=e.colorTl,s[a++]=T,s[a++]=e.renderCoords.x2,s[a++]=e.renderCoords.y2,s[a++]=m,s[a++]=d,r[a++]=e.colorTr,s[a++]=T,s[a++]=e.renderCoords.x4,s[a++]=e.renderCoords.y4,s[a++]=h,s[a++]=p,r[a++]=e.colorBl,s[a++]=T,s[a++]=e.renderCoords.x3,s[a++]=e.renderCoords.y3,s[a++]=m,s[a++]=p,r[a++]=e.colorBr,s[a++]=T;else if(e.tb!==0||e.tc!==0)s[a++]=e.tx,s[a++]=e.ty,s[a++]=h,s[a++]=d,r[a++]=e.colorTl,s[a++]=T,s[a++]=e.tx+e.width*e.ta,s[a++]=e.ty+e.width*e.tc,s[a++]=m,s[a++]=d,r[a++]=e.colorTr,s[a++]=T,s[a++]=e.tx+e.height*e.tb,s[a++]=e.ty+e.height*e.td,s[a++]=h,s[a++]=p,r[a++]=e.colorBl,s[a++]=T,s[a++]=e.tx+e.width*e.ta+e.height*e.tb,s[a++]=e.ty+e.width*e.tc+e.height*e.td,s[a++]=m,s[a++]=p,r[a++]=e.colorBr,s[a++]=T;else{const b=e.tx+e.width*e.ta,v=e.ty+e.height*e.td;s[a++]=e.tx,s[a++]=e.ty,s[a++]=h,s[a++]=d,r[a++]=e.colorTl,s[a++]=T,s[a++]=b,s[a++]=e.ty,s[a++]=m,s[a++]=d,r[a++]=e.colorTr,s[a++]=T,s[a++]=e.tx,s[a++]=v,s[a++]=h,s[a++]=p,r[a++]=e.colorBl,s[a++]=T,s[a++]=b,s[a++]=v,s[a++]=m,s[a++]=p,r[a++]=e.colorBr,s[a++]=T}this.curRenderOp.length+=hf,this.curRenderOp.numQuads++,this.curBufferIdx=a}newRenderOp(e,s,r,l,a,i,n,c,h){const d=new Hn(this.glw,this.options,this.quadBufferCollection,e,s,r,a,l,i,0,n,c,h);this.curRenderOp=d,this.renderOps.push(d)}addTexture(e,s,r){const{curRenderOp:l}=this;L(l);const a=l.addTexture(e);if(a===4294967295){if(r)throw new Error("Unable to add texture to render op");return this.newRenderOp(l.shader,l.shaderProps,l.alpha,l.dimensions,l.clippingRect,s),this.addTexture(e,s,!0)}return a}reuseRenderOp(e){var c;const{shader:s,shaderProps:r,parentHasRenderTexture:l,rtt:a,clippingRect:i}=e,n=s||this.defaultShader;return!(((c=this.curRenderOp)==null?void 0:c.shader)!==n||!ya(this.curRenderOp.clippingRect,i)||l||a||this.curRenderOp.shader!==this.defaultShader&&(!r||!this.curRenderOp.shader.canBatchShaderProps(this.curRenderOp.shaderProps,r)))}addRenderOp(e){this.renderOps.push(e),this.curRenderOp=null}render(e="screen"){const{glw:s,quadBuffer:r}=this,l=new Float32Array(r,0,this.curBufferIdx),a=this.quadBufferCollection.getBuffer("a_position")??null;s.arrayBufferData(a,l,s.STATIC_DRAW);for(let i=0,n=this.renderOps.length;i<n;i++)this.renderOps[i].draw();this.quadBufferUsage=this.curBufferIdx*l.BYTES_PER_ELEMENT}renderToTexture(e){for(let s=0;s<this.rttNodes.length;s++)if(this.rttNodes[s]===e)return;this.rttNodes.unshift(e)}renderRTTNodes(){const{glw:e}=this;this.stage;for(let r=0;r<this.rttNodes.length;r++){const l=this.rttNodes[r];if(!l||!l.hasRTTupdates)continue;this.activeRttNode=l,L(l.texture,"RTT node missing texture");const a=l.texture.ctxTexture;L(a instanceof hn),this.renderToTextureActive=!0,e.bindFramebuffer(a.framebuffer),e.viewport(0,0,a.w,a.h),e.clearColor(0,0,0,0),e.clear();for(let i=0;i<l.children.length;i++){const n=l.children[i];n&&(n.update(this.stage.deltaTime,{x:0,y:0,width:0,height:0,valid:!1}),this.stage.addQuads(n),n.hasRTTupdates=!1)}this.render(),this.renderOps.length=0,l.hasRTTupdates=!1}const s=Ws(this.stage.options.clearColor);e.clearColor(s[0],s[1],s[2],s[3]),e.bindFramebuffer(null),e.viewport(0,0,this.glw.canvas.width,this.glw.canvas.height),this.renderToTextureActive=!1}removeRTTNode(e){const s=this.rttNodes.indexOf(e);s!==-1&&this.rttNodes.splice(s,1)}getBufferInfo(){return{totalAvailable:this.stage.options.quadBufferSize,totalUsed:this.quadBufferUsage}}getDefShaderCtr(){return this.defShaderCtrl}}const uf={LINE_FEED:10,CARRIAGE_RETURN:13,SPACE:32,TAB:9,ZERO_WIDTH_SPACE:8203,ZERO_WIDTH_NON_JOINER:8204,ZERO_WIDTH_JOINER:8205,LEFT_TO_RIGHT_MARK:8206,RIGHT_TO_LEFT_MARK:8207,LEFT_TO_RIGHT_EMBEDDING:8234,RIGHT_TO_LEFT_EMBEDDING:8235,POP_DIRECTIONAL_FORMATTING:8236,LEFT_TO_RIGHT_OVERRIDE:8237,RIGHT_TO_LEFT_OVERRIDE:8238,LINE_SEPARATOR:8232,PARAGRAPH_SEPARATOR:8233,OBJECT_REPLACEMENT_CHARACTER:65532,REPLACEMENT_CHARACTER:65533,ZERO_WIDTH_NO_BREAK_SPACE:65279,LEFT_TO_RIGHT_ISOLATE:8294,RIGHT_TO_LEFT_ISOLATE:8295,FIRST_STRONG_ISOLATE:8296,POP_DIRECTIONAL_ISOLATE:8297,INHIBIT_SYMMETRIC_SWAPPING:8298,ACTIVATE_SYMMETRIC_SWAPPING:8299,INHIBIT_ARABIC_FORM_SHAPING:8300,ACTIVATE_ARABIC_FORM_SHAPING:8301,NATIONAL_DIGIT_SHAPES:8302,NOMINAL_DIGIT_SHAPES:8303,LEFT_TO_RIGHT_BOUNDARY:8206,RIGHT_TO_LEFT_BOUNDARY:8207};class df{}class pf extends df{constructor(e,s){super();f(this,"data");f(this,"glyphMap");f(this,"kernings");this.data=e,this.glyphMap=s;const r=this.kernings={};e.kernings.forEach(l=>{const a=l.second,i=r[a]=r[a]||{};i[l.first]=l.amount}),this.kernings=r}*shapeText(e,s){var a;let r,l;for(;(r=s.peek())&&!r.done;){const i=r.value,n=this.glyphMap.get(i);if(s.next(),n!==void 0){const c=l!==void 0?(((a=this.kernings[n.id])==null?void 0:a[l])||0)+e.letterSpacing:0;l=n.id,yield{mapped:!0,glyphId:n.id,codepoint:i,cluster:s.lastIndex,xAdvance:n.xadvance+c,yAdvance:0,xOffset:n.xoffset+c,yOffset:n.yoffset,xBearing:0,yBearing:0,width:n.width,height:n.height}}else i===uf.LINE_FEED&&(l=void 0),yield{mapped:!1,codepoint:i,cluster:s.lastIndex}}}}class Br extends Xn{constructor(e,s){super(s);f(this,"type");f(this,"texture");f(this,"maxCharHeight",0);f(this,"data");f(this,"shaper");f(this,"glyphMap",new Map);const{atlasUrl:r,atlasDataUrl:l,stage:a}=s;this.type=e;const i=a.renderer;L(i instanceof Qr,"SDF Font Faces can only be used with the WebGL Renderer"),this.texture=a.txManager.loadTexture("ImageTexture",{src:r,premultiplyAlpha:!1}),this.texture.on("loaded",()=>{this.checkLoaded(),a.requestRender()}),this.texture.ctxTexture.load(),fetch(l).then(async n=>{var h;this.data=await n.json(),L(this.data);let c=0;if(this.data.chars.forEach(d=>{this.glyphMap.set(d.id,d);const m=d.yoffset+d.height;m>c&&(c=m)}),this.maxCharHeight=c,this.shaper=new pf(this.data,this.glyphMap),!this.metrics)if((h=this.data)!=null&&h.lightningMetrics){const{ascender:d,descender:m,lineGap:p,unitsPerEm:u}=this.data.lightningMetrics;this.metrics={ascender:d/u,descender:m/u,lineGap:p/u}}else throw new Error(`Font metrics not found in ${this.type} font ${this.fontFamily}. Make sure you are using the latest version of the Lightning 3 \`msdf-generator\` tool to generate your SDF fonts.`);this.checkLoaded()}).catch(console.error)}getAtlasEntry(e){const s=this.glyphMap.get(e);if(s===void 0)throw new Error(`Glyph ${e} not found in font ${this.fontFamily}`);return{x:s.x,y:s.y,width:s.width,height:s.height}}checkLoaded(){this.loaded||this.texture.state==="loaded"&&this.data&&(this.loaded=!0,this.emit("loaded"))}}let Ns=null,sr=null,cr=!1;const mf=()=>{cr=!0},gf=()=>{cr=!1},or=new WeakMap,Xi=new Map,yf=o=>{if(Xi.size!==0)for(const[t,e]of Xi){if(o.indexOf(t)===-1)continue;const s=or.get(e);if(s!==void 0)for(const r of s.values())r.delete(t),Xi.delete(t)}},Hi=(o,t,e=!1)=>{if(Ns){if(cr||sr!==null&&t!==sr)return;let s=or.get(o);s||(s=new Map,or.set(o,s));let r=s.get(t);r||(r=new Set,s.set(t,r)),r.add(Ns),e===!0&&Xi.set(Ns,o)}},Gs=(o,t,e=!1)=>{if(cr===!0)return;const s=or.get(o);if(!s)return;const r=s.get(t);if(r)for(let l of r)l(e)},Di=(o,t=null)=>{Ns=o,sr=t,Ns(),Ns=null,sr=null},Or=(o,t)=>{if(o===t)return!0;if(o.length!==t.length)return!1;let e=o.length;for(;e--;){const s=o[e],r=t[e];if(Array.isArray(s)&&Array.isArray(r)){if(Or(s,r)===!1)return!1}else if(typeof s=="object"&&s!==null&&typeof r=="object"&&r!==null){if(Or(Object.entries(s),Object.entries(r))===!1)return!1}else if(s!==r)return!1}return!0},Yi=["push","pop","shift","unshift","splice","sort"],un=new WeakMap,ys=o=>{const t=o&&o[g.raw];return t?ys(t):o},Ur=(o,t=null,e,s)=>{if(typeof o=="object"&&(o[g.id]!==void 0||o.constructor.name===er.name))return o;const r=un.get(o);if(r!==void 0)return r;const l={get(i,n,c){return n===g.raw?o:Array.isArray(i)===!0?typeof i[n]=="object"&&i[n]!==null?(Array.isArray(i[n])===!0&&Hi(i,n,s),Ur(ys(i[n]),i,n)):Yi.indexOf(n)!==-1?function(...h){mf();const d=i[n].apply(this,h);return gf(),Gs(t,e),d}:n==="length"?o.length:Reflect.get(i,n,c):typeof i[n]=="object"&&i[n]!==null?(Array.isArray(i[n])===!0&&Hi(i,n,s),Ur(ys(i[n]),i,n)):(Hi(i,n,s),Reflect.get(i,n,c))},set(i,n,c,h){const d=ys(i[n]),m=ys(c);let p=!0;const u=Array.isArray(m)===!0?Or(d,m):d===m;return u===!1&&(Array.isArray(c)===!0&&(c=ys(c).slice(0)),p=Reflect.set(i,n,c,h)),p===!0&&u===!1&&(Array.isArray(i)===!0&&n in i&&Gs(t,e,!0),Gs(i,n,!0)),p}},a=new Proxy(o,l);return un.set(o,a),a},Kn=(o,t)=>(Object.keys(o).forEach(e=>{let s=o[e];if(o[e]!==null&&typeof o[e]=="object"){if(Object.getPrototypeOf(o[e])===Object.prototype)return Kn(o[e]);if(Array.isArray(o[e])===!0)for(let r=0;r<Yi.length-1;r++)o[e][Yi[r]]=function(l){Array.prototype[Yi[r]].call(this,l),Gs(o,e)}}Object.defineProperty(o,e,{enumerable:!0,configurable:!0,get(){return Hi(o,e,t),s},set(r){s!==r&&(s=r,Gs(o,e))}})}),o),dn=(o,t="Proxy",e=!1)=>t==="defineProperty"?Kn(o,e):Ur(o,void 0,void 0,e),xf=["init","ready","focus","unfocus","destroy","attach","detach","enter","exit"],Tf={previous:null,current:null,get state(){return this.current},set state(o){xf.indexOf(o)>-1&&(o!==this.current||o==="focus")&&(Z.debug(`Setting lifecycle state from ${this.current} to ${o} for ${this.component.componentId}`),this.previous=this.current,this.current=o,ra(o,this.component[g.identifier],this.component),Rr(o,this.component[g.identifier],this.component))}},bf=24;function Sf(o,t,e,s,r,l,a,i,n){const c=Math.min(Math.max(a.firstLineIdx,0),i.length),h=0,{metrics:d}=e;L(d,"Font metrics not loaded"),L(e.data,"Font data not loaded");const m=(d.ascender-d.descender)*o;let p=0;s==="middle"?p=(t-m)/2:s==="bottom"&&(p=t-m);const u=r/l,x=e.data.common.base,b=d.ascender*o-x,v=u+b+c*t+p;if(!(n&&v>=n/l))return{sdfX:h,sdfY:v,lineIndex:c}}class oo{constructor(t,e=0){f(this,"iterator");f(this,"peekBuffer",[]);f(this,"_lastIndex");this.iterator=t,this.iterator=t,this._lastIndex=e-1,this.peekBuffer=[]}next(){const t=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return t.done?this._lastIndex=-1:this._lastIndex++,t}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const t=this.iterator.next();return this.peekBuffer.push(t),t}get lastIndex(){return this._lastIndex}}function*io(o,t=0){let e=t;for(;e<o.length;){const s=o.codePointAt(e);if(s===void 0)throw new Error("Invalid Unicode code point");yield s,e+=s<=65535?1:2}}function wf(o,t,e){const s=e.shapeText(t,new oo(io(o,0),0));let r=0;for(const l of s)l.mapped&&l.codepoint!==8203&&(r+=l.xAdvance);return r}function Cf(o,t,e,s,r,l,a,i,n,c,h,d,m,p,u,x,T,b,v){L(u,"Font face must be loaded"),L(u.loaded,"Font face must be loaded"),L(u.data,"Font face must be loaded"),L(u.shaper,"Font face must be loaded");const R=i/u.data.info.size,w=n/R,E=l/R,S=c/R,M=m[o],I=(M==null?void 0:M.codepointIndex)||0,A=(M==null?void 0:M.maxX)||0,B=(M==null?void 0:M.maxY)||0;let P=A,N=B,z=t,$=e,F=0;const _={codepointIndex:-1,bufferOffset:-1,xStart:-1},k=u.shaper,V={letterSpacing:S};let W=k.shapeText(V,new oo(io(s,I),I)),D,Y=-1;const U=[],K=a/R,me=wf(b,V,k);let j=!0;for(;j;){const q=(v===0||o+1<v)&&(d!=="both"||T||$+w+u.maxCharHeight<=K),Q=q?E:E-me;let X=0;const ge=$+u.maxCharHeight>=p.y1,ee=$<=p.y2,J=ge&&ee;for(;(D=W.next())&&!D.done;){const H=D.value;if(o===m.length)m.push({codepointIndex:H.cluster,maxY:N,maxX:P});else if(o>m.length)throw new Error("Unexpected lineCache length");if(H.codepoint===32||H.codepoint===10||H.codepoint===8203?_.codepointIndex!==-1&&(_.codepointIndex=-1,X=z):_.codepointIndex===-1&&(_.codepointIndex=H.cluster,_.bufferOffset=F,_.xStart=X),H.mapped){const ye=z+H.xOffset+H.width;if(d!=="none"&&ye>=Q&&_.codepointIndex!==-1&&_.xStart>0)if(q){W=k.shapeText(V,new oo(io(s,_.codepointIndex),_.codepointIndex)),F=_.bufferOffset;break}else W=k.shapeText(V,new oo(io(b,0),0)),z=_.xStart,F=_.bufferOffset,d="none";else{const xe=z+H.xOffset,te=$+H.yOffset;if(J){Y===-1&&(Y=F);const Te=u.getAtlasEntry(H.glyphId),Se=Te.x/u.data.common.scaleW,se=Te.y/u.data.common.scaleH,Ae=Te.width/u.data.common.scaleW,we=Te.height/u.data.common.scaleH;h[F++]=xe,h[F++]=te,h[F++]=Se,h[F++]=se,h[F++]=xe+H.width,h[F++]=te,h[F++]=Se+Ae,h[F++]=se,h[F++]=xe,h[F++]=te+H.height,h[F++]=Se,h[F++]=se+we,h[F++]=xe+H.width,h[F++]=te+H.height,h[F++]=Se+Ae,h[F++]=se+we}N=Math.max(N,te+H.height),P=Math.max(P,xe+H.width),z+=H.xAdvance}}else if(H.codepoint===10){if(q)break;W=k.shapeText(V,new oo(io(b,0),0)),d="none"}}Y!==-1&&(U.push({bufferStart:Y,bufferEnd:F}),Y=-1),z=0,$+=w,o++,_.codepointIndex=-1,X=0,!x&&d==="both"&&$>p.y2||D&&D.done?j=!1:q||(j=!1)}if(r==="center"){const q=d==="none"?P:E;for(let Q=0;Q<U.length;Q++){const X=U[Q],ge=h[X.bufferEnd-4]-h[X.bufferStart],ee=(q-ge)/2;for(let J=X.bufferStart;J<X.bufferEnd;J+=4)h[J]+=ee}}else if(r==="right"){const q=d==="none"?P:E;for(let Q=0;Q<U.length;Q++){const X=U[Q],ge=X.bufferEnd===X.bufferStart?0:h[X.bufferEnd-4]-h[X.bufferStart],ee=q-ge;for(let J=X.bufferStart;J<X.bufferEnd;J+=4)h[J]+=ee}}return L(D),{bufferNumFloats:F,bufferNumQuads:F/16,layoutNumCharacters:D.done?s.length-I:D.value.cluster-I+1,fullyProcessed:!!D.done,maxX:P,maxY:N,numLines:m.length}}function vf(o,t){return Math.ceil(o/t)*t}function _f(o,t){return Math.floor(o/t)*t}function Rf(o,t,e,s,r,l,a,i){const{screen:n,sdf:c}=o;if(!Ta(a))n.x1=0,n.y1=0,n.x2=0,n.y2=0,c.x1=0,c.y1=0,c.x2=0,c.y2=0,o.numLines=0,o.firstLineIdx=0;else{const h=a.x1-t,d=h+(a.x2-a.x1),m=a.y1-e+s,p=_f(m-l,r||1),u=vf(m+(a.y2-a.y1)+l,r||1);n.x1=h,n.y1=p,n.x2=d,n.y2=u,c.x1=h/i,c.y1=p/i,c.x2=d/i,c.y2=u/i,o.numLines=Math.ceil((u-p)/r),o.firstLineIdx=r?Math.floor(p/r):0}o.valid=!0}function jn(o,t){return t*(o.ascender-o.descender+o.lineGap)}const Ef={x:0,y:0,width:0,height:0};class Af extends qr{constructor(e){super(e);f(this,"ssdfFontFamilies",{});f(this,"msdfFontFamilies",{});f(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]);f(this,"sdfShader");f(this,"rendererBounds");f(this,"type","sdf");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,s)=>{e.props.fontFamily=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,s)=>{e.props.fontWeight=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,s)=>{e.props.fontStyle=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,s)=>{e.props.fontStretch=s,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,s)=>{e.props.fontSize=s,this.invalidateLayoutCache(e)},text:(e,s)=>{e.props.text=s,this.invalidateLayoutCache(e)},textAlign:(e,s)=>{e.props.textAlign=s,this.invalidateLayoutCache(e)},color:(e,s)=>{e.props.color=s},x:(e,s)=>{e.props.x=s,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&xr(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,s)=>{e.props.y=s,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&xr(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,s)=>{e.props.contain=s,this.invalidateLayoutCache(e)},width:(e,s)=>{e.props.width=s,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,s)=>{e.props.height=s,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,s)=>{e.props.offsetY=s,this.invalidateLayoutCache(e)},scrollable:(e,s)=>{e.props.scrollable=s,this.invalidateLayoutCache(e)},scrollY:(e,s)=>{e.props.scrollY=s,this.scheduleUpdateState(e)},letterSpacing:(e,s)=>{e.props.letterSpacing=s,this.invalidateLayoutCache(e)},lineHeight:(e,s)=>{e.props.lineHeight=s,e.resLineHeight=void 0,this.invalidateLayoutCache(e)},maxLines:(e,s)=>{e.props.maxLines=s,this.invalidateLayoutCache(e)},textBaseline:(e,s)=>{e.props.textBaseline=s,this.invalidateLayoutCache(e)},verticalAlign:(e,s)=>{e.props.verticalAlign=s,this.invalidateLayoutCache(e)},overflowSuffix:(e,s)=>{e.props.overflowSuffix=s,this.invalidateLayoutCache(e)},debug:(e,s)=>{e.props.debug=s}}}canRenderFont(e){const{fontFamily:s}=e;return s in this.ssdfFontFamilies||s in this.msdfFontFamilies||s==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(e){return e instanceof Br}addFontFace(e){L(e instanceof Br);const s=e.fontFamily,r=e.type==="ssdf"?this.ssdfFontFamilies:e.type==="msdf"?this.msdfFontFamilies:void 0;if(!r){console.warn(`Invalid font face type: ${e.type}`);return}let l=r[s];l||(l=new Set,r[s]=l),l.add(e)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new tt,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,resLineHeight:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){let{trFontFace:s}=e;const{textH:r,lineCache:l,debugData:a,forceFullLayoutCalc:i}=e;if(a.updateCount++,e.status==="initialState"&&this.setStatus(e,"loading"),s===void 0){if(s=this.resolveFontFace(e.props),e.trFontFace=s,s===void 0){const k=`SdfTextRenderer: Could not resolve font face for family: '${e.props.fontFamily}'`;console.error(k),this.setStatus(e,"failed",new Error(k));return}s.texture.setRenderableOwner(e,!0)}if(s.loaded===!1){s.once("loaded",()=>{this.scheduleUpdateState(e)});return}L(s.data,"Font face data should be loaded"),L(s.metrics,"Font face metrics should be loaded");const{text:n,fontSize:c,x:h,y:d,contain:m,width:p,height:u,verticalAlign:x,scrollable:T,overflowSuffix:b,maxLines:v}=e.props,R=m==="both"&&T?e.props.scrollY:0,{renderWindow:w}=e,E=s.data.info.size,S=c/E;let M=e.resLineHeight;if(M===void 0){const k=e.props.lineHeight;k===void 0?M=jn(s.metrics,c):M=k,e.resLineHeight=M}const I=M/S;e.distanceRange=S*s.data.distanceField.distanceRange;const A=n.length*bf;let B=e.vertexBuffer;(!B||B.length<A)&&(B=new Float32Array(A*2));const P=e.elementBounds;if(P.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),P.valid=!0),!i&&w.valid){const k=w.screen;if(h+k.x1<=P.x1&&h+k.x2>=P.x2&&d-R+k.y1<=P.y1&&d-R+k.y2>=P.y2){this.setStatus(e,"loaded");return}w.valid=!1,this.setStatus(e,"loading")}const{offsetY:N,textAlign:z}=e.props;if(!w.valid){if(!xr(P,this.rendererBounds))return;Rf(w,h,d,R,M,m==="both"?P.y2-P.y1:0,P,S)}const $=Sf(E,I,s,x,N,S,w,l,r);if(!$){this.setStatus(e,"loaded");return}const{letterSpacing:F}=e.props,_=Cf($.lineIndex,$.sdfX,$.sdfY,n,z,p,u,c,M,F,B,m,l,w.sdf,s,i,T,b,v);e.bufferUploaded=!1,e.bufferNumFloats=_.bufferNumFloats,e.bufferNumQuads=_.bufferNumQuads,e.vertexBuffer=B,e.renderWindow=w,a.lastLayoutNumCharacters=_.layoutNumCharacters,a.bufferSize=B.byteLength,_.fullyProcessed&&(e.textW=_.maxX*S,e.textH=_.numLines*I*S),this.setStatus(e,"loaded")}renderQuads(e,s,r,l,a,i){var P,N;if(!e.vertexBuffer)return;const n=this.stage.renderer;L(n instanceof Qr);const{fontSize:c,color:h,contain:d,scrollable:m,zIndex:p,debug:u}=e.props,x=d==="both"&&m?e.props.scrollY:0,{textW:T=0,textH:b=0,distanceRange:v,vertexBuffer:R,bufferUploaded:w,trFontFace:E,elementBounds:S}=e;let{webGlBuffers:M}=e;if(!M){const z=n.glw,$=4*Float32Array.BYTES_PER_ELEMENT,F=z.createBuffer();L(F),e.webGlBuffers=new Yn([{buffer:F,attributes:{a_position:{name:"a_position",size:2,type:z.FLOAT,normalized:!1,stride:$,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:z.FLOAT,normalized:!1,stride:$,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,L(e.webGlBuffers),M=e.webGlBuffers}if(!w){const z=n.glw,$=(M==null?void 0:M.getBuffer("a_textureCoordinate"))??null;z.arrayBufferData($,R,z.STATIC_DRAW),e.bufferUploaded=!0}if(L(E),m&&d==="both"){L(S.valid);const z=ga(S,Ef);r.valid?(e.clippingRect.valid=!0,r=Fn(r,z,e.clippingRect)):(e.clippingRect.valid=!0,r=Bn(z,e.clippingRect))}const I=new Hn(n.glw,n.options,M,this.sdfShader,{transform:s.getFloatArr(),color:fa(h,l),size:c/(((P=E.data)==null?void 0:P.info.size)||0),scrollY:x,distanceRange:v,debug:u.sdfShaderDebug},l,r,{height:b,width:T},0,p,!1,a,i),A=(N=e.trFontFace)==null?void 0:N.texture;L(A);const B=A.ctxTexture;I.addTexture(B),I.length=e.bufferNumFloats,I.numQuads=e.bufferNumQuads,n.addRenderOp(I)}setIsRenderable(e,s){var r;super.setIsRenderable(e,s),(r=e.trFontFace)==null||r.texture.setRenderableOwner(e,s)}destroyState(e){var s;super.destroyState(e),(s=e.trFontFace)==null||s.texture.setRenderableOwner(e,!1)}resolveFontFace(e){return this.stage.fontManager.resolveFontFace(this.fontFamilyArray,e,"sdf")}releaseFontFace(e){e.resLineHeight=void 0,e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){const{x:s,contain:r,width:l}=e.props,{elementBounds:a}=e;a.x1=s,a.x2=r!=="none"?s+l:1/0}setElementBoundsY(e){const{y:s,contain:r,height:l}=e.props,{elementBounds:a}=e;a.y1=s,a.y2=r==="both"?s+l:1/0}}function pn(o){return o===""||o==="​"}function Mf(o,t,e){if(t.metrics)return t.metrics;const s=o.measureText("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz");console.warn(`Font metrics not provided for Canvas Web font ${t.fontFamily}. Using fallback values. It is HIGHLY recommended you use the latest version of the Lightning 3 \`msdf-generator\` tool to extract the default metrics for the font and provide them in the Canvas Web font definition.`);let r;return s.actualBoundingBoxDescent&&s.actualBoundingBoxAscent?r={ascender:s.actualBoundingBoxAscent/e,descender:-s.actualBoundingBoxDescent/e,lineGap:.2}:r={ascender:.8,descender:-.2,lineGap:.2},t.metrics=r,r}const mn=2048;function gn(o,t,e,s,r){const l=o!=="bottom"?.5*t:0;return e*(s-1)+l+Math.max(e,t)+(r||0)}class kf{constructor(t,e){f(this,"_canvas");f(this,"_context");f(this,"_settings");this._canvas=t,this._context=e,this._settings=this.mergeDefaults({})}set settings(t){this._settings=this.mergeDefaults(t)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const t=[this._settings.fontFamily],e=[];for(let s=0,r=t.length;s<r;s++)t[s]==="serif"||t[s]==="sans-serif"?e.push(t[s]):e.push(`"${t[s]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${e.join(",")}`}_load(){if(document.fonts){const t=this._getFontSetting();try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(e=>{console.warn("[Lightning] Font load error",e,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch{console.warn("[Lightning] Can't check font loading for "+t)}}}calculateRenderInfo(){const t={},e=this.getPrecision(),s=this._settings.paddingLeft*e,r=this._settings.paddingRight*e,l=this._settings.fontSize*e;let a=this._settings.offsetY===null?null:this._settings.offsetY*e;const i=this._settings.w*e,n=this._settings.h*e;let c=this._settings.wordWrapWidth*e;const h=this._settings.cutSx*e,d=this._settings.cutEx*e,m=this._settings.cutSy*e,p=this._settings.cutEy*e,u=(this._settings.letterSpacing||0)*e,x=this._settings.textIndent*e,T=this._settings.trFontFace;this.setFontProperties(),L(T);const b=Mf(this._context,T,l),v=jn(b,l)*e,R=this._settings.lineHeight!==null?this._settings.lineHeight*e:v,w=this._settings.maxHeight,E=w!==null&&R>0?Math.floor(w/R):0,S=this._settings.maxLines,M=E>0&&S>0?Math.min(E,S):Math.max(E,S);let I=i||2048/this.getPrecision(),A=I-s;if(A<10&&(I+=10-A,A=10),c||(c=A),this._settings.textOverflow&&!this._settings.wordWrap){let F;switch(this._settings.textOverflow){case"clip":F="";break;case"ellipsis":F=this._settings.overflowSuffix;break;default:F=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,c-x,F)}let B;if(this._settings.wordWrap)B=this.wrapText(this._settings.text,c,u,x);else{B={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const F=B.l.length;for(let _=0;_<F-1;_++)B.n.push(_)}let P=B.l;if(M&&P.length>M){const F=P.slice(0,M);let _=null;if(this._settings.overflowSuffix){const Y=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,U=this.wrapText(F[F.length-1],c-Y,u,x);F[F.length-1]=`${U.l[0]}${this._settings.overflowSuffix}`,_=[U.l.length>1?U.l[1]:""]}else _=[""];let k;const V=P.length;let W=0;const D=B.n.length;for(k=M;k<V;k++)_[W]+=`${_[W]?" ":""}${P[k]}`,k+1<D&&B.n[k+1]&&W++;t.remainingText=_.join(`
`),t.moreTextLines=!0,P=F}else t.moreTextLines=!1,t.remainingText="";let N=0;const z=[];for(let F=0;F<P.length;F++){const _=this.measureText(P[F],u)+(F===0?x:0);z.push(_),N=Math.max(N,_)}t.lineWidths=z,i||(I=N+s+r,A=N);let $;return n?$=n:$=gn(this._settings.textBaseline,l,R,P.length,a),a===null&&(a=l),t.w=I,t.h=$,t.lines=P,t.precision=e,I||(I=1),$||($=1),(h||d)&&(I=Math.min(I,d-h)),(m||p)&&($=Math.min($,p-m)),t.width=I,t.innerWidth=A,t.height=$,t.fontSize=l,t.cutSx=h,t.cutSy=m,t.cutEx=d,t.cutEy=p,t.lineHeight=R,t.defLineHeight=v,t.lineWidths=z,t.offsetY=a,t.paddingLeft=s,t.paddingRight=r,t.letterSpacing=u,t.textIndent=x,t.metrics=b,t}draw(t,e){const s=this.getPrecision(),r=(e==null?void 0:e.lines)||t.lines,l=(e==null?void 0:e.lineWidths)||t.lineWidths,a=e?gn(this._settings.textBaseline,t.fontSize,t.lineHeight,e.lines.length,this._settings.offsetY===null?null:this._settings.offsetY*s):t.height;this._canvas.width=Math.min(Math.ceil(t.width+this._settings.textRenderIssueMargin),mn),this._canvas.height=Math.min(Math.ceil(a),mn),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);let i,n;const c=[],{metrics:h}=t,d=h?h.ascender*t.fontSize:t.fontSize,m=(h.ascender-h.descender)*t.fontSize;for(let u=0,x=r.length;u<x;u++)i=u===0?t.textIndent:0,n=u*t.lineHeight+d,this._settings.verticalAlign=="middle"?n+=(t.lineHeight-m)/2:this._settings.verticalAlign=="bottom"&&(n+=t.lineHeight-m),this._settings.textAlign==="right"?i+=t.innerWidth-l[u]:this._settings.textAlign==="center"&&(i+=(t.innerWidth-l[u])/2),i+=t.paddingLeft,c.push({text:r[u],x:i,y:n,w:l[u]});if(this._settings.highlight){const u=this._settings.highlightColor,x=this._settings.highlightHeight*s||t.fontSize*1.5,T=this._settings.highlightOffset*s,b=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*s:t.paddingLeft,v=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*s:t.paddingRight;this._context.fillStyle=yr(u);for(let R=0;R<c.length;R++){const w=c[R];this._context.fillRect(w.x-b,w.y-t.offsetY+T,w.w+v+b,x)}}let p=null;this._settings.shadow&&(p=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=yr(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*s,this._context.shadowOffsetY=this._settings.shadowOffsetY*s,this._context.shadowBlur=this._settings.shadowBlur*s),this._context.fillStyle=yr(this._settings.textColor);for(let u=0,x=c.length;u<x;u++){const T=c[u];if(t.letterSpacing===0)this._context.fillText(T.text,T.x,T.y);else{const b=T.text.split("");let v=T.x;for(let R=0,w=b.length;R<w;R++)this._context.fillText(b[R],v,T.y),v+=this.measureText(b[R],t.letterSpacing)}}p&&(this._context.shadowColor=p[0],this._context.shadowOffsetX=p[1],this._context.shadowOffsetY=p[2],this._context.shadowBlur=p[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy)}wrapWord(t,e,s){const r=this._context.measureText(s).width,l=t.length,a=this._context.measureText(t).width;if(a<=e)return t;let i=Math.floor(e*l/a),n=this._context.measureText(t.substring(0,i)).width+r;if(n>e)for(;i>0&&(n=this._context.measureText(t.substring(0,i)).width+r,n>e);)i-=1;else for(;i<l;)if(n=this._context.measureText(t.substring(0,i)).width+r,n<e)i+=1;else{i-=1;break}return t.substring(0,i)+(e>=r?s:"")}wrapText(t,e,s,r=0){const l=/ |\u200B/g,a=t.split(/\r?\n/g);let i=[];const n=[];for(let c=0;c<a.length;c++){const h=[];let d="",m=e-r;const p=a[c].split(l),u=a[c].match(l)||[];for(let x=0;x<p.length;x++){const T=u[x-1]||"",b=p[x],v=this.measureText(b,s),R=pn(T)?v:v+this.measureText(T,s);x===0||R>m?(x>0&&(h.push(d),d=""),d+=b,m=e-v-(x===0?r:0)):(m-=R,d+=T+b)}h.push(d),d="",i=i.concat(h),c<a.length-1&&n.push(i.length)}return{l:i,n}}measureText(t,e=0){return e?t.split("").reduce((s,r)=>pn(r)?s:s+this._context.measureText(r).width+e,0):this._context.measureText(t).width}mergeDefaults(t){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFamily:null,trFontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxHeight:null,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...t}}}const yn=typeof self>"u"?globalThis:self;var An;const xn=((An=yn.document)==null?void 0:An.fonts)||yn.fonts;function If(o){const{fontFamily:t,fontStyle:e,fontWeight:s,fontStretch:r,fontSize:l}=o;return[e,s,r,`${l}px`,t].join(" ")}class Tn extends qr{constructor(e){super(e);f(this,"canvas");f(this,"context");f(this,"fontFamilies",{});f(this,"fontFamilyArray",[this.fontFamilies]);f(this,"type","canvas");f(this,"loadFont",e=>{const s=If(e.props),r=this.stage.fontManager.resolveFontFace(this.fontFamilyArray,e.props,"canvas");if(L(r,`Could not resolve font face for ${s}`),e.fontInfo={fontFace:r,cssString:s,loaded:!1},!e.fontInfo.loaded){xn.load(s).then(this.onFontLoaded.bind(this,e,s)).catch(this.onFontLoadError.bind(this,e,s));return}});typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let s=this.canvas.getContext("2d",{willReadFrequently:!0});s||(this.canvas=document.createElement("canvas"),s=this.canvas.getContext("2d",{willReadFrequently:!0})),L(s),this.context=s,this.addFontFace(new Vi({fontFamily:"sans-serif",descriptors:{},fontUrl:""}))}getPropertySetters(){return{fontFamily:(e,s)=>{e.props.fontFamily=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,s)=>{e.props.fontWeight=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,s)=>{e.props.fontStyle=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,s)=>{e.props.fontStretch=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,s)=>{e.props.fontSize=s,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,s)=>{e.props.text=s,this.invalidateLayoutCache(e)},textAlign:(e,s)=>{e.props.textAlign=s,this.invalidateLayoutCache(e)},color:(e,s)=>{e.props.color=s,this.invalidateLayoutCache(e)},x:(e,s)=>{e.props.x=s},y:(e,s)=>{e.props.y=s},contain:(e,s)=>{e.props.contain=s,this.invalidateLayoutCache(e)},width:(e,s)=>{e.props.width=s,e.props.contain!=="none"&&this.invalidateLayoutCache(e)},height:(e,s)=>{e.props.height=s,e.props.contain==="both"&&this.invalidateLayoutCache(e)},offsetY:(e,s)=>{e.props.offsetY=s,this.invalidateLayoutCache(e)},scrollY:(e,s)=>{e.props.scrollY=s},letterSpacing:(e,s)=>{e.props.letterSpacing=s,this.invalidateLayoutCache(e)},lineHeight:(e,s)=>{e.props.lineHeight=s,this.invalidateLayoutCache(e)},maxLines:(e,s)=>{e.props.maxLines=s,this.invalidateLayoutCache(e)},textBaseline:(e,s)=>{e.props.textBaseline=s,this.invalidateLayoutCache(e)},verticalAlign:(e,s)=>{e.props.verticalAlign=s,this.invalidateLayoutCache(e)},overflowSuffix:(e,s)=>{e.props.overflowSuffix=s,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof Vi}addFontFace(e){L(e instanceof Vi);const s=e.fontFamily;s!=="sans-serif"&&xn.add(e.fontFace);let r=this.fontFamilies[s];r||(r=new Set,this.fontFamilies[s]=r),r.add(e)}createState(e,s){return{node:s,props:e,status:"initialState",updateScheduled:!1,emitter:new tt,textureNode:void 0,lightning2TextRenderer:new kf(this.canvas,this.context),renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if(e.status==="initialState"&&this.setStatus(e,"loading"),e.status!=="loaded"){if(!e.fontInfo)return this.loadFont(e);e.fontInfo.loaded&&(e.renderInfo||(e.renderInfo=this.calculateRenderInfo(e),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,this.renderSingleCanvasPage(e)))}}renderSingleCanvasPage(e){L(e.renderInfo);const s=e.node,r=this.stage.txManager.loadTexture("ImageTexture",{src:(function(l,a){return L(a),l.draw(a,{lines:a.lines,lineWidths:a.lineWidths}),this.canvas.width===0||this.canvas.height===0?null:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}).bind(this,e.lightning2TextRenderer,e.renderInfo)});if(e.textureNode)e.textureNode.texture=r;else{const l=this.stage.createNode({parent:s,texture:r,autosize:!0,alpha:ma(e.props.color)});e.textureNode=l}this.setStatus(e,"loaded")}calculateRenderInfo(e){var s;return e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFamily:e.props.fontFamily,trFontFace:(s=e.fontInfo)==null?void 0:s.fontFace,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:Ws(e.props.color),offsetY:e.props.offsetY,wordWrap:e.props.contain!=="none",wordWrapWidth:e.props.contain==="none"?void 0:e.props.width,letterSpacing:e.props.letterSpacing,lineHeight:e.props.lineHeight??null,maxLines:e.props.maxLines,maxHeight:e.props.contain==="both"?e.props.height-e.props.offsetY:null,textBaseline:e.props.textBaseline,verticalAlign:e.props.verticalAlign,overflowSuffix:e.props.overflowSuffix,w:e.props.contain!=="none"?e.props.width:void 0},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.renderInfo}renderQuads(){}destroyState(e){e.status!=="destroyed"&&(super.destroyState(e),e.textureNode&&(e.textureNode.destroy(),delete e.textureNode),delete e.renderInfo)}invalidateLayoutCache(e){e.renderInfo=void 0,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,s){var r;s!==((r=e.fontInfo)==null?void 0:r.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,s,r){var l;s!==((l=e.fontInfo)==null?void 0:l.cssString)||!e.fontInfo||(e.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${e.fontInfo.cssString}'`,r),this.scheduleUpdateState(e))}}const Lf={isWhite:!0,a:1,r:255,g:255,b:255};function wr(o){if(o===4294967295)return Lf;const t=(o>>>24&255)/255,e=o>>>16&255&255,s=o>>>8&255&255,r=o&255&255;return{isWhite:!1,a:t,r,g:s,b:e}}function Ki({a:o,r:t,g:e,b:s}){return`rgba(${t},${e},${s},${o})`}class Pf extends Wn{constructor(){super(...arguments);f(this,"image");f(this,"tintCache")}load(){this.textureSource.state==="freed"&&(this.textureSource.setState("loading"),this.onLoadRequest().then(e=>{this.textureSource.setState("loaded",e),this.updateMemSize()}).catch(e=>{this.textureSource.setState("failed",e)}))}free(){this.image=void 0,this.tintCache=void 0,this.textureSource.setState("freed"),this.setTextureMemUse(0)}updateMemSize(){const e=this.tintCache?8:4;if(this.textureSource.dimensions){const{width:s,height:r}=this.textureSource.dimensions;this.setTextureMemUse(s*r*e)}}hasImage(){return this.image!==void 0}getImage(e){var a;const s=this.image;if(L(s,"Attempt to get unloaded image texture"),e.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),s;const r=Ki(e);if(((a=this.tintCache)==null?void 0:a.key)===r)return this.tintCache.image;const l=this.tintTexture(s,r);return this.tintCache={key:r,image:l},this.updateMemSize(),l}tintTexture(e,s){const{width:r,height:l}=e,a=document.createElement("canvas");a.width=r,a.height=l;const i=a.getContext("2d");return i&&(i.fillStyle=s,i.globalCompositeOperation="copy",i.fillRect(0,0,r,l),i.globalCompositeOperation="multiply",i.drawImage(e,0,0,r,l,0,0,r,l),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0,r,l,0,0,r,l)),a}async onLoadRequest(){const{data:e}=await this.textureSource.getTextureData();if(e instanceof ImageData){const s=document.createElement("canvas");s.width=e.width,s.height=e.height;const r=s.getContext("2d");return r&&r.putImageData(e,0,0),this.image=s,{width:e.width,height:e.height}}else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)return this.image=e,{width:e.width,height:e.height};return{width:0,height:0}}}function Ff(o){var t;return o.shader instanceof jr&&o.shader.shType===zn?((t=o.shaderProps)==null?void 0:t.radius)??0:0}class Bf extends Vn{constructor(e){super(e);f(this,"context");f(this,"canvas");f(this,"pixelRatio");f(this,"clearColor");f(this,"renderToTextureActive",!1);f(this,"activeRttNode",null);f(this,"defShaderCtr");this.mode="canvas",this.shManager.renderer=this;const{canvas:s,pixelRatio:r,clearColor:l}=e;this.canvas=s,this.context=s.getContext("2d"),this.pixelRatio=r,this.clearColor=l?pa(l):void 0,this.defShaderCtr={type:"DefaultShader",props:{},shader:new jr("DefaultShader"),getResolvedProps:()=>()=>({})}}reset(){this.canvas.width=this.canvas.width;const e=this.context;if(this.clearColor){const[s,r,l,a]=this.clearColor;e.fillStyle=`rgba(${s}, ${r}, ${l}, ${a/255})`,e.fillRect(0,0,this.canvas.width,this.canvas.height)}e.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(e){const s=this.context,{tx:r,ty:l,width:a,height:i,alpha:n,colorTl:c,colorTr:h,colorBr:d,ta:m,tb:p,tc:u,td:x,clippingRect:T}=e;let b=e.texture,v,R;if(b){if(b instanceof fo&&(R=b.props,b=b.parentTexture),v=b.ctxTexture,b.state==="freed"){v.load();return}if(b.state!=="loaded"||!v.hasImage())return}const w=wr(c),E=m!==1,S=T.width!==0&&T.height!==0,M=c!==h||c!==d,I=e.shader?Ff(e):0;if((E||S||I)&&s.save(),S){const A=new Path2D,{x:B,y:P,width:N,height:z}=T;A.rect(B,P,N,z),s.clip(A)}if(E){const A=this.pixelRatio;s.setTransform(m,u,p,x,r*A,l*A),s.scale(A,A),s.translate(-r,-l)}if(I){const A=new Path2D;A.roundRect(r,l,a,i,I),s.clip(A)}if(v){const A=v.getImage(w);s.globalAlpha=n,R?s.drawImage(A,R.x,R.y,R.width,R.height,r,l,a,i):s.drawImage(A,r,l,a,i),s.globalAlpha=1}else if(M){let A=r,B=l,P;c===h?(A=r,B=l+i,P=wr(d)):(A=r+a,B=l,P=wr(h));const N=s.createLinearGradient(r,l,A,B);N.addColorStop(0,Ki(w)),N.addColorStop(1,Ki(P)),s.fillStyle=N,s.fillRect(r,l,a,i)}else s.fillStyle=Ki(w),s.fillRect(r,l,a,i);(E||S||I)&&s.restore()}createCtxTexture(e){return new Pf(this.txMemManager,e)}getShaderManager(){return this.shManager}getDefShaderCtr(){return this.defShaderCtr}renderRTTNodes(){}removeRTTNode(e){}renderToTexture(e){}getBufferInfo(){return null}}const ro={alpha:o=>o===1?null:{prop:"opacity",value:`${o}`},x:o=>({prop:"left",value:`${o}px`}),y:o=>({prop:"top",value:`${o}px`}),width:o=>o===0?null:{prop:"width",value:`${o}px`},height:o=>o===0?null:{prop:"height",value:`${o}px`},zIndex:()=>"zIndex",fontFamily:()=>"font-family",fontSize:()=>"font-size",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",lineHeight:()=>"line-height",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:o=>o===!1?null:{prop:"overflow",value:o?"hidden":"visible"},rotation:o=>o===0?null:{prop:"transform",value:`rotate(${o}rad)`},scale:o=>o===1?null:{prop:"transform",value:`scale(${o})`},scaleX:o=>o===1?null:{prop:"transform",value:`scaleX(${o})`},scaleY:o=>o===1?null:{prop:"transform",value:`scaleY(${o})`},color:o=>o===0?null:{prop:"color",value:qn(o)}},qn=o=>{const t=(o&255)/255,e=o>>8&255,s=o>>16&255;return`rgba(${o>>24&255},${s},${e},${t})`},$r={id:"test-id"},Of=new Set([...Object.keys(ro),...Object.keys($r),"src","parent"]);class Uf{constructor(t,e){f(this,"root",null);f(this,"canvas",null);f(this,"height",1080);f(this,"width",1920);f(this,"scaleX",1);f(this,"scaleY",1);if(Yr())return;if(!e)throw new Error("settings is required");this.height=Math.ceil(e.appHeight??1080/(e.deviceLogicalPixelRatio??1)),this.width=Math.ceil(e.appWidth??1920/(e.deviceLogicalPixelRatio??1)),this.scaleX=e.deviceLogicalPixelRatio??1,this.scaleY=e.deviceLogicalPixelRatio??1,this.canvas=t,this.root=document.createElement("div"),this.setRootPosition(),document.body.appendChild(this.root),new MutationObserver(this.setRootPosition.bind(this)).observe(t,{attributes:!0,childList:!1,subtree:!1}),new ResizeObserver(this.setRootPosition.bind(this)).observe(t),window.addEventListener("resize",this.setRootPosition.bind(this)),console.warn("Inspector is enabled, this will impact performance")}setRootPosition(){if(this.root===null||this.canvas===null)return;const t=this.canvas.getBoundingClientRect(),e=document.documentElement.scrollTop+t.top,s=document.documentElement.scrollLeft+t.left;this.root.id="root",this.root.style.left=`${s}px`,this.root.style.top=`${e}px`,this.root.style.width=`${this.width}px`,this.root.style.height=`${this.height}px`,this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform=`scale(${this.scaleX}, ${this.scaleY})`,this.root.style.overflow="hidden",this.root.style.zIndex="65534"}createDiv(t,e){const s=document.createElement("div");s.style.position="absolute",s.id=t.toString();for(const r in e)this.updateNodeProperty(s,r,e[r]);return s}createNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,t.on("inViewport",()=>e.setAttribute("state","inViewport")),t.on("inBounds",()=>e.setAttribute("state","inBounds")),t.on("outOfBounds",()=>e.setAttribute("state","outOfBounds")),this.createProxy(t,e)}createTextNode(t){const e=this.createDiv(t.id,t.props);return e.node=t,t.div=e,this.createProxy(t,e)}createProxy(t,e){Of.forEach(l=>{const a=Object.getOwnPropertyDescriptor(t,l);a&&Object.defineProperties(t,{[l]:{get(){var i;return(i=a.get)==null?void 0:i.call(t)},set(i){var n;(n=a.set)==null||n.call(t,i),this.updateNodeProperty(e,l,i)},configurable:!0,enumerable:!0}})});const s=t.destroy;Object.defineProperty(t,"destroy",{value:()=>{this.destroyNode(t.id),s.call(t)}});const r=t.animate;return Object.defineProperty(t,"animate",{value:(l,a)=>{const i=r.call(t,l,a);return{...i,start:()=>(this.animateNode(e,l,a),i.start())}}}),t}destroyNode(t){const e=document.getElementById(t.toString());e==null||e.remove()}updateNodeProperty(t,e,s){var r;if(!(this.root===null||s===void 0||s===null)){if(e==="parent"){const l=s.id;if(l===1){this.root.appendChild(t);return}const a=document.getElementById(l.toString());a==null||a.appendChild(t);return}if(e==="text"){t.innerHTML=String(s),t.style.visibility="hidden";return}if(e==="src"&&s){t.setAttribute("data-src",String(s));return}if(ro[e]){const l=(r=ro[e])==null?void 0:r.call(ro,s);if(l===null)return;if(typeof l=="string"){t.style.setProperty(l,String(s));return}typeof l=="object"&&t.style.setProperty(l.prop,l.value);return}if($r[e]){const l=$r[e];if(!l)return;t.setAttribute(String(l),String(s));return}if(e==="data"){for(const l in s){const a=s[l];a===void 0?t.removeAttribute(`data-${l}`):t.setAttribute(`data-${l}`,String(a))}return}}}animateNode(t,e,s){const{duration:r=1e3,delay:l=0}=s,{x:a,y:i,width:n,height:c,alpha:h=1,rotation:d=0,scale:m=1,color:p}=e;function u(){setTimeout(()=>{t.style.top=`${i}px`,t.style.left=`${a}px`,t.style.width=`${n}px`,t.style.height=`${c}px`,t.style.opacity=`${h}`,t.style.rotate=`${d}rad`,t.style.scale=`${m}`,t.style.color=qn(p)},r)}setTimeout(u,l)}}const Zn=50,bn={hd:.66666667,"720p":.66666667,720:.66666667,fhd:1,fullhd:1,"1080p":1,1080:1,"4k":2,"2160p":2,2160:2},$f=()=>{const o=Oe.stage;$e.get("fonts",[]).forEach(t=>{t.type==="sdf"||t.type==="msdf"?(!t.png&&t.file&&(t.png=t.file.replace(/\.[^.]+$/,`.${t.type}.png`)),!t.json&&t.file&&(t.json=t.file.replace(/\.[^.]+$/,`.${t.type}.json`)),o.fontManager.addFontFace(new Br(t.type,{fontFamily:t.family,descriptors:{},atlasUrl:t.png,atlasDataUrl:t.json,stage:o,metrics:t.metrics}))):t.type==="web"&&o.fontManager.addFontFace(new Vi({fontFamily:t.family,fontUrl:t.file,descriptors:{},metrics:t.metrics}))})},Df=()=>{const o=Oe.stage;$e.get("shaders",[]).forEach(t=>{o.shManager.registerShaderType(t.name,t.type)}),$e.get("effects",[]).forEach(t=>{o.shManager.registerShaderType(t.name,t.type)})};let Oe={};const Nf=o=>{const t="renderMode"in o?o.renderMode:"webgl";if(t==="webgl")return Qr;if(t==="canvas")return Bf},Gf=o=>{const t="renderMode"in o?o.renderMode:"webgl";if(t==="webgl")return[Af,Tn];if(t==="canvas")return[Tn]},zf=(o,t,e={})=>{Oe=new tf({appWidth:e.w||1920,appHeight:e.h||1080,fpsUpdateInterval:e.fpsInterval||1e3,deviceLogicalPixelRatio:e.pixelRatio||bn[e.screenResolution]||bn[window.innerHeight]||1,numImageWorkers:"webWorkersLimit"in e?e.webWorkersLimit:window.navigator.hardwareConcurrency||2,clearColor:e.canvasColor&&Ds.normalize(e.canvasColor)||0,inspector:e.inspector===!0?Uf:void 0,boundsMargin:e.viewportMargin||0,txMemByteThreshold:"gpuMemoryLimit"in e?e.gpuMemoryLimit*1024*1024:200*1024*1024,renderEngine:Nf(e),fontEngines:Gf(e)},t);const s=()=>{let r=o();r.quit=()=>{Z.info("Closing App"),r.destroy(),r=null,Oe=null}};return Df(),$f(),s(),Oe},Wf=function(o){let t=0;const e=o.direction==="vertical"?"y":"x",s=o.direction==="vertical"?"height":"width",r=o.direction==="vertical"?"width":"height",l=this.children,a=l.length;let i=0;const n=o.gap||0;for(let c=0;c<a;c++){const h=l[c];h[e]=t,s==="width"?t+=h.width+(h.width!==("text"in h?1:0)?n:0):s==="height"&&(t+="text"in h?h.width>1?h.height+n:0:h.height!==0?h.height+n:0),i=Math.max(i,h[r])}this[s]=t-n,this[r]=i},Sn=o=>o!==null&&typeof o=="object"&&"transition"in o,Ys=o=>typeof o=="string"&&o.startsWith("{")&&o.endsWith("}"),Ks=o=>JSON.parse(o.replace(/'/g,'"').replace(/([\w-_]+)\s*:/g,'"$1":')),As=function(o,t){return typeof o!="string"?o:o.indexOf("%")===o.length-1?this.element.config.parent&&(this.element.config.parent.node[t]||0)*(parseFloat(o)/100)||0:o},Dr=o=>{if(typeof o!="object"||o===null)return o;if(o.constructor===Object){if("value"in o)return o.value;if("transition"in o)return Dr(o.transition)}return o},Vf={top:"colorTop",bottom:"colorBottom",left:"colorLeft",right:"colorRight"};let Nr=null;const Xf={set parent(o){this.props.parent=o==="root"?Oe.root:o.node},set rotation(o){this.props.rotation=o*(Math.PI/180)},set w(o){this.props.width=As.call(this,o,"width")},set width(o){this.props.width=As.call(this,o,"width")},set h(o){this.props.height=As.call(this,o,"height")},set height(o){this.props.height=As.call(this,o,"height")},set x(o){this.props.x=As.call(this,o,"width")},set y(o){this.props.y=As.call(this,o,"height")},set z(o){this.props.zIndex=o},set zIndex(o){this.props.zIndex=o},set color(o){typeof o=="string"&&o.startsWith("{")===!1?this.props.color=Ds.normalize(o):(typeof o=="object"||Ys(o)===!0&&(o=Ks(o)))&&(this.props.color=0,Object.entries(o).forEach(t=>{this.props[Vf[t[0]]]=Ds.normalize(t[1])}))},set src(o){this.props.src=o,this.raw.color===void 0&&(this.props.color=4294967295)},set texture(o){this.props.texture=o,this.raw.color===void 0&&o==null?this.props.color=0:this.raw.color===void 0&&(this.props.color=4294967295)},set fit(o){const t={};if(o==="cover"||o==="contain"){this.props.textureOptions={resizeMode:{type:o}};return}(typeof o=="object"||Ys(o)===!0&&(o=Ks(o)))&&(t.type=o.type||"cover",typeof o.position=="number"&&(t.clipY=t.clipX=o.position),typeof o.position=="object"&&(t.clipX="x"in o.position?o.position.x:null,t.clipY="y"in o.position?o.position.y:null),this.props.textureOptions={resizeMode:t})},set rtt(o){this.props.rtt=o,o===!0&&this.raw.color===void 0&&(this.props.color=4294967295)},set mount(o){typeof o=="object"||Ys(o)===!0&&(o=Ks(o))?("x"in o&&(this.props.mountX=o.x),"y"in o&&(this.props.mountY=o.y)):(this.props.mountX=o,this.props.mountY=o)},set pivot(o){typeof o=="object"||Ys(o)===!0&&(o=Ks(o))?("x"in o&&(this.props.pivotX=o.x),"y"in o&&(this.props.pivotY=o.y)):(this.props.pivotX=o,this.props.pivotY=o)},set scale(o){typeof o=="object"||Ys(o)===!0&&(o=Ks(o))?("x"in o&&(this.props.scaleX=o.x),"y"in o&&(this.props.scaleY=o.y)):this.props.scale=o},set show(o){this.props.alpha=o?1:0},set alpha(o){this.props.alpha=o},set shader(o){o!==null?this.props.shader=Oe.createShader(o.type,o.props):this.props.shader=Oe.createShader("DefaultShader")},set effects(o){for(let t=0;t<o.length;t++)o[t].props&&o[t].props.color&&(o[t].props.color=Ds.normalize(o[t].props.color));this.props.shader=Oe.createShader("DynamicShader",{effects:o})},set clipping(o){this.props.clipping=o},set overflow(o){this.props.clipping=!o},set font(o){this.props.fontFamily=o},set size(o){this.props.fontSize=o},set wordwrap(o){this.props.width=o,this.props.contain="width"},set maxheight(o){this.props.height=o,this.props.contain="both"},set contain(o){this.props.contain=o},set maxlines(o){this.props.maxLines=o},set textoverflow(o){this.props.overflowSuffix=o===!1?" ":o===!0?void 0:o},set letterspacing(o){this.props.letterSpacing=o||1},set lineheight(o){this.props.lineHeight=o},set align(o){this.props.textAlign=o},set content(o){this.props.text=""+o}},Hf={populate(o){const t=o;t.node=this.config.node,t[g.isSlot]===!0&&(this[g.isSlot]=!0),this.props.element=this,this.props.parent=t.parent||this.config.parent,delete t.parent,this.props.raw=o;const e=Object.keys(t),s=e.length;for(let r=0;r<s;r++){const l=e[r],a=t[l];a!==void 0&&(this.props[l]=Dr(a))}this.props.props.color===void 0&&!("__textnode"in t)&&(this.props.props.color=0),this.node=t.__textnode?Oe.createTextNode({...Nr,...this.props.props}):Oe.createNode(this.props.props),t["@loaded"]!==void 0&&typeof t["@loaded"]=="function"&&this.node.on("loaded",(r,{type:l,dimensions:a})=>{t["@loaded"]({w:a.width,h:a.height,type:l},this)}),t["@error"]!==void 0&&typeof t["@error"]=="function"&&this.node.on("failed",(r,l)=>{t["@error"](l,this)}),t.__layout===!0&&(this.triggerLayout=Wf.bind(this.node)),this.config.parent.props!==void 0&&this.config.parent.props.__layout===!0&&(this.config.parent.triggerLayout(this.config.parent.props),this.node.on("loaded",()=>{this.config.parent.triggerLayout(this.config.parent.props)}))},set(o,t){if(t===void 0||this.props.raw[o]===t)return;this.props.raw[o]=t,this.props.props={},this.props[o]=Dr(t);const e=Object.keys(this.props.props);if(e.length===1){if(Sn(t)===!0)return this.animate(e[0],this.props.props[e[0]],t.transition);this.node[e[0]]=this.props.props[e[0]]}else for(let s=0;s<e.length;s++){if(Sn(t)===!0)return this.animate(e[s],this.props.props[e[s]],t.transition);this.node[e[s]]=this.props.props[e[s]]}this.config.parent.props&&this.config.parent.props.__layout===!0&&this.config.parent.triggerLayout(this.config.parent.props)},animate(o,t,e){if(this.scheduledTransitions[o]!==void 0&&this.scheduledTransitions[o].f.state==="scheduled"&&this.scheduledTransitions[o].f.stop(),this.node[o]===t)return;const s={};s[o]=t;const r=this.node.animate(s,{duration:typeof e=="object"&&"duration"in e?e.duration:300,easing:typeof e=="object"&&"easing"in e?e.easing:"ease",delay:typeof e=="object"&&"delay"in e?e.delay:0}),l=this.node[o];if(this.scheduledTransitions[o]={v:s[o],f:r},e.start!==void 0&&typeof e.start=="function"&&r.once("animating",()=>{e.start.call(this.component,this,o,l)}),this.config.parent.props&&this.config.parent.props.__layout===!0&&r.on("tick",()=>{this.config.parent.triggerLayout(this.config.parent.props)}),e.progress!==void 0&&typeof e.progress=="function"){let a=0;r.on("tick",(i,{progress:n})=>{e.progress.call(this.component,this,o,n,a),a=n})}r.once("stopped",()=>{this.scheduledTransitions[o]=void 0,e.end&&typeof e.end=="function"&&e.end.call(this.component,this,o,this.node[o])}),r.start()},destroy(){Z.debug("Deleting  Node",this.nodeId),this.node.destroy()},get nodeId(){return this.node&&this.node.id},get ref(){return this.props.ref||null},get parent(){return this.node&&this.node.parent},get children(){return this.component[g.getChildren]().filter(o=>o.parent===(this[g.isSlot]?this.node.children[0]:this.node))}},Yf=(o,t)=>(Nr===null&&(Nr={fontSize:32,fontFamily:$e.get("defaultFont","sans-serif")}),Object.assign(Object.create(Hf),{props:Object.assign(Object.create(Xf),{props:{}}),scheduledTransitions:{},config:o,component:t})),wn={Element:Yf,Launch:zf};let co={};const Jr={},Kf=(o,t,e)=>{$e.set(e),Hl(),Jr.element=wn.Element,co=wn.Launch(o,t,e)},jf={before:{prop:"alpha",value:0},in:{prop:"alpha",value:1,duration:200},out:{prop:"alpha",value:0,duration:100}},Qe=window.speechSynthesis,qf=()=>(window.navigator||{}).userAgent||"",Cn=()=>/android/i.test(qf());let Qn=!1,ir=null;const en=()=>ir&&clearTimeout(ir),Gr=o=>{if(!o||ir)return en();Qe.pause(),Qe.resume(),ir=setTimeout(()=>{Gr(o)},5e3)},Os={lang:"en-US",pitch:1,rate:1,voice:null,volume:1},Zf=()=>{Os.voice=Qe.getVoices()[0],Qn=!0},Qf=(o,t)=>{const e=new SpeechSynthesisUtterance(t.value);e.lang=t.lang||Os.lang,e.pitch=t.pitch||Os.pitch,e.rate=t.rate||Os.rate,e.voice=t.voice||Os.voice,e.volume=t.volume||Os.volume,e.onstart=()=>{Cn()||Gr(e),o.onstart()},e.onresume=()=>{Cn()||Gr(e),o.onresume()},e.onpause=()=>{o.onpause()},e.onend=()=>{o.onend()},e.onerror=()=>{en(),o.onerror()},Qe.speak(e)},ji={speak(o){Qn||Zf(),this.cancel(),Qf(this,o)},resume(){Qe.resume()},pause(){Qe.pause()},cancel(){Qe.cancel(),en()},getVoices(){return Qe.getVoices()},onend(){},onerror(){},onstart(){},onresume(){},onpause(){}};let vn;const tn=(o,t="off")=>{clearTimeout(vn),ji.cancel(),t==="assertive"?ji.speak({value:o}):vn=setTimeout(()=>{ji.speak({value:o})},400)},Jf=o=>tn(o,"polite"),ec=o=>tn(o,"assertive"),tc=()=>{ji.cancel()},Jn={speak:tn,polite:Jf,assertive:ec,stop:tc};let rr,nr=!1;const el=new WeakMap,tl=[];let sl={},ol={},zr=!1,il;const sc=()=>(document.location.hash||"/").replace(/^#/,""),_n=o=>o.replace(/^\/+|\/+$/g,"").toLowerCase(),oc=o=>typeof o=="object"&&o!==null,ic=o=>typeof o=="string",rc=(o,t=[])=>{const e=o;o=_n(o);let s=!1,r=0;for(;!s&&r<t.length;){const l=t[r];if(l.path=_n(l.path),l.path===o)l.params={},s=l;else if(l.path.indexOf(":")>-1){const a=[...l.path.matchAll(/:([^\s/]+)/gi)];let i=l.path;a.reverse().forEach(c=>{i=i.substring(0,c.index)+"([^\\s/]+)"+i.substring(c.index+c[0].length)});const n=e.match(new RegExp(`${i}`,"i"));n&&(l.params=a.reverse().reduce((c,h,d)=>(c[h[1]]=n[d+1],c),{}),s=l)}else if(l.path.endsWith("*")){const a=new RegExp(l.path.replace(/\/?\*/,"/?([^\\s]*)"),"i"),i=o.match(a);i&&(i[1]&&(l.params={path:i[1]}),s=l)}r++}return s&&(s.options={...s.options,...sl},s.data||(s.data={}),rr=s),s},nc=async function(){if(nr=!0,this.parent[g.routes]){const o=rr,t=sc();let e=rc(t,this.parent[g.routes]),s;if(e){if(e.hooks&&e.hooks.before&&(s=await e.hooks.before(e,o),ic(s))){rr=o,hr(s);return}e=oc(s)?s:e,zr===!1&&o&&o.options.inHistory===!0&&tl.push(o),"transition"in e||(e.transition=jf),typeof e.transition=="function"&&(e.transition=e.transition(o,e));let r,{view:l,focus:a}=el.get(e)||{};if(l)r=l[g.holder];else{r=Jr.element({parent:this[g.children][0]}),r.populate({}),r.set("w","100%"),r.set("h","100%");const n={...this[g.props],...e.params,...ol,...e.data};l=await e.component({props:n},r,this),l[Symbol.toStringTag]==="Module"&&(l.default&&typeof l.default=="function"?l=l.default({props:n},r,this):Z.error("Dynamic import doesn't have a default export or default is not a function")),typeof l=="function"&&(l=l({props:n},r,this))}if(this[g.children].push(l),il=Je.get(),a?Je.set(a):Je.set(l),e.transition.before)if(Array.isArray(e.transition.before))for(let n=0;n<e.transition.before.length;n++)r.set(e.transition.before[n].prop,e.transition.before[n].value);else r.set(e.transition.before.prop,e.transition.before.value);let i=!1;if(o){i=!0;const n=this[g.children].splice(1,1).pop();n&&lc(o,n,e.transition.out)}if(e.transition.in)if(Array.isArray(e.transition.in))for(let n=0;n<e.transition.in.length;n++)n===e.transition.length-1?await zs(r,e.transition.in[n],i):zs(r,e.transition.in[n],i);else await zs(r,e.transition.in,i);e.announce&&(typeof e.announce=="string"&&(e.announce={message:e.announce}),Jn.speak(e.announce.message,e.announce.politeness)),this.activeView=this[g.children][this[g.children].length-1]}else Z.error(`Route ${t} not found`)}zr=!1,nr=!1},lc=async(o,t,e)=>{if(e)if(Array.isArray(e))for(let s=0;s<e.length;s++)s===e.length-1?await zs(t[g.holder],e[s]):zs(t[g.holder],e[s]);else await zs(t[g.holder],e);o.options&&o.options.keepAlive===!0?el.set(o,{view:t,focus:il}):(t.destroy(),t=null)},zs=(o,t,e=!0)=>new Promise(s=>{if(e){const r=t.end;t.end=r?(...l)=>{r(...l),s()}:s,o.set(t.prop,{transition:t})}else o.set(t.prop,t.value),s()}),hr=(o,t={},e={})=>{ol=t,sl=e,window.location.hash=`#${o}`},rl=()=>{const o=tl.pop();if(o){zr=!0;let t=o.path;return t.indexOf(":")>-1&&Object.keys(o.params).forEach(e=>{t=t.replace(`:${e}`,o.params[e])}),hr(t),!0}else return!1},Cr={navigate:nc,to:hr,back:rl};let qe=null,Ni=[],Rn;const Wr=new Map,Je={_hold:!1,set hold(o){this._hold=o},get hold(){return this._hold},get(){return qe},set(o,t){clearTimeout(Rn),qe&&qe!==o.parent&&qe.unfocus(),Ni.reverse().forEach(e=>e.unfocus()),o!==qe&&(Rn=setTimeout(()=>{qe=o,qe.lifecycle.state="focus",t instanceof KeyboardEvent?document.dispatchEvent(new KeyboardEvent("keydown",t)):Ni=[]},this.hold?$e.get("holdTimeout",Zn):0))},input(o,t){if(nr===!0)return;Ni=nl([qe],o);const e=Ni.shift();if(e){let s;e[g.inputEvents][o]?s=e[g.inputEvents][o].call(e,t):e[g.inputEvents].any&&(s=e[g.inputEvents].any.call(e,t)),s!==void 0&&Wr.set(t.code,s)}}},nl=(o,t)=>o[0][g.inputEvents]&&(typeof o[0][g.inputEvents][t]=="function"||typeof o[0][g.inputEvents].any=="function")?o:o[0].parent?(o.unshift(o[0].parent),nl(o,t)):[],js=new Map,qs=new Map,Vr={registerListener(o,t,e,s=0){let r=js.get(t);r===void 0&&(r=new Map,js.set(t,r));let l=r.get(o);l===void 0&&(l=new Set,r.set(o,l)),l.add({cb:e,priority:s}),qs.delete(t)},executeListeners(o,t){const e=js.get(o);if(e===void 0||e.size===0)return!0;if(qs.has(o)===!1){const r=[];for(const[l,a]of e)for(const i of a)r.push({...i,component:l});r.sort((l,a)=>a.priority-l.priority),qs.set(o,r)}const s=qs.get(o);for(let r=0;r<s.length;r++){const{cb:l,component:a}=s[r];if(l.call(a,t)===!1)return!1}return!0},removeListeners(o){for(const[t,e]of js)e.has(o)&&(e.delete(o),qs.delete(t),e.size===0&&js.delete(t))}},ac={focus:{value:function(o){return Z.warn("this.focus is deprecated, use this.$focus instead"),this.$focus(o)},writable:!1,enumerable:!0,configurable:!1},$focus:{value:function(o){this[g.state].hasFocus=!0,Je.set(this,o)},writable:!1,enumerable:!0,configurable:!1},unfocus:{value:function(){this[g.state].hasFocus=!1,this.lifecycle.state="unfocus"},writable:!1,enumerable:!0,configurable:!1},destroy:{value:function(){this.lifecycle.state="destroy",this.$clearTimeouts(),this.$clearIntervals(),Vr.removeListeners(this),ll(this[g.children]),yf(this[g.effects]),Z.debug(`Destroyed component ${this.componentId}`)},writable:!1,enumerable:!0,configurable:!1},select:{value:function(o){return Z.warn("this.select is deprecated, use this.$select instead"),this.$select(o)},writable:!1,enumerable:!0,configurable:!1},$select:{value:function(o){let t=null;return this[g.children].forEach(e=>{Array.isArray(e)?e.forEach(s=>{s.ref===o&&(t=s)}):Object.getPrototypeOf(e)===Object.prototype?Object.keys(e).forEach(s=>{e[s].ref===o&&(t=e[s])}):e.ref===o&&(t=e)}),t},writable:!1,enumerable:!0,configurable:!1},trigger:{value:function(o){return Z.warn("this.trigger is deprecated, use this.$trigger instead"),this.$trigger(o)},writable:!1,enumerable:!0,configurable:!1},$trigger:{value:function(o){let t=this[g.originalState];if(o.indexOf(".")>-1){const e=o.split(".");o=e.pop(e);for(let s=0;s<e.length;s++)t=t[e[s]]}Gs(t,o,!0)},writable:!1,enumerable:!0,configurable:!1},shader:{value:function(o,t){return{type:o,props:t}},writable:!1,enumerable:!0,configurable:!1}},ll=function(o){for(let t=0;t<o.length;t++){if(!o[t])return;o[t].destroy&&typeof o[t].destroy=="function"?o[t].destroy():Object.getPrototypeOf(o[t])===Object.prototype&&ll(Object.values(o[t])),o[t]=null}o.length=0},fc={$setTimeout:{value:function(o,t,...e){const s=setTimeout(()=>{this[g.timeouts]=this[g.timeouts].filter(r=>r!==s),o.apply(null,e)},t,e);return this[g.timeouts].push(s),s},writable:!1,enumerable:!0,configurable:!1},$clearTimeout:{value:function(o){this[g.timeouts].indexOf(o)>-1&&(this[g.timeouts]=this[g.timeouts].filter(t=>t!==o),clearTimeout(o))},writable:!1,enumerable:!0,configurable:!1},$clearTimeouts:{value:function(){for(let o=0;o<this[g.timeouts].length;o++)clearTimeout(this[g.timeouts][o]);this[g.timeouts]=[]},writable:!1,enumerable:!0,configurable:!1},$setInterval:{value:function(o,t,...e){const s=setInterval(()=>o.apply(null,e),t,e);return this[g.intervals].push(s),s},writable:!1,enumerable:!0,configurable:!1},$clearInterval:{value:function(o){this[g.intervals].indexOf(o)>-1&&(this[g.intervals]=this[g.intervals].filter(t=>t!==o),clearInterval(o))},writable:!1,enumerable:!0,configurable:!1},$clearIntervals:{value:function(){for(let o=0;o<this[g.intervals].length;o++)clearInterval(this[g.intervals][o]);this[g.intervals]=[]},writable:!1,enumerable:!0,configurable:!1}},cc={$emit:{value:function(o,t){return Vr.executeListeners(o,t)},writable:!1,enumerable:!0,configurable:!1},$listen:{value:function(o,t,e=0){Vr.registerListener(this,o,t,e)},writable:!1,enumerable:!0,configurable:!1}},hc={$router:{value:{to:hr,back:rl,get currentRoute(){return rr},get routes(){return this[g.routes]},get navigating(){return nr}},writable:!1,enumerable:!0,configurable:!1}},uc={$announcer:{value:Jn,writable:!1,enumerable:!0,configurable:!1}},dc={[g.renderer]:{value:()=>co,writable:!1,enumerable:!0,configurable:!1},[g.getChildren]:{value(){const o=this.rootParent||this.parent;return(this[g.children]||[]).concat(o&&o[g.getChildren]().map(t=>Object.getPrototypeOf(t)===Object.prototype?Object.values(t).map(e=>(e.forComponent=e.config&&e.config.parent.component,e)):t).flat().filter(t=>{if(t&&t.component)return t.component&&t.component.componentId===this.componentId||t.forComponent&&t.forComponent.componentId===this.componentId})||[])},writable:!1,enumerable:!0,configurable:!1}},Zs=Object.defineProperties({[g.launched]:!1},{...ac,...fc,...cc,...hc,...uc,...dc}),pc={cast:o=>o,required:!1},mc=(o,t=[])=>{t.indexOf("ref")===-1&&t.push("ref"),o[g.propKeys]=[];const e=t.length;for(let s=0;s<e;s++){const r={...pc,...typeof t[s]=="object"?t[s]:{key:t[s]}};o[g.propKeys].push(r.key),Object.defineProperty(o,r.key,{get(){const l=r.cast(this[g.props]!==void 0&&r.key in this[g.props]?this[g.props][r.key]:"default"in r?r.default:void 0);return r.required===!0&&l===void 0&&Z.warn(`${r.key} is required`),l},set(l){Z.warn(`Warning! Avoid mutating props directly (${r.key})`),this[g.props][r.key]=l}})}},gc=(o,t)=>{o[g.methodKeys]=[];for(let e in t)o[g.propKeys]&&o[g.propKeys].indexOf(e)>-1?Z.error(`${e} already exists as a prop`):(typeof t[e]!="function"&&Z.warn(`${e} is not a function`),o[g.methodKeys].push(e),o[e]=t[e])},yc=(o,t=()=>{})=>{Object.defineProperty(o,g.stateKeys,{value:[],enumerable:!1,configurable:!1,writable:!1});const e=Object.keys(t.apply(o)||{});e.push(["hasFocus"]);const s=e.length;for(let r=0;r<s;r++){const l=e[r];o[g.propKeys]!==void 0&&o[g.propKeys].indexOf(l)>-1&&Z.error(`State ${l} already exists as a prop`),o[g.methodKeys]!==void 0&&o[g.methodKeys].indexOf(l)>-1&&Z.error(`State ${l} already exists as a method`),o[g.stateKeys].push(l),Object.defineProperty(o,l,{get(){return this[g.state][l]},set(a){this[g.state][l]=a}})}},xc=(o,t)=>{o[g.computedKeys]=[];for(let e in t)o[g.stateKeys]&&o[g.stateKeys].indexOf(e)>-1?Z.error(`${e} already exists as a state variable`):o[g.propKeys]&&o[g.propKeys].indexOf(e)>-1?Z.error(`${e} already exists as a prop`):o[g.methodKeys]&&o[g.methodKeys].indexOf(e)>-1?Z.error(`${e} already exists as a method`):(typeof t[e]!="function"&&Z.warn(`${e} is not a function`),o[g.computedKeys].push(e),Object.defineProperty(o,e,{get(){return t[e].apply(this)}}))},Tc=(o,t)=>{o[g.inputEvents]=[],Object.keys(t).forEach(e=>{typeof t[e]!="function"&&Z.warn(`${t[e]} is not a function`),o[g.inputEvents][e]=t[e]})},bc=(o,t)=>{o[g.routes]=[],Object.keys(t).forEach(e=>{o[g.routes][e]={...t[e],options:{inHistory:!0,...t[e].options}}})},Sc=(o,t)=>{o[g.watchKeys]=[],o[g.watchers]={};for(let e in t)typeof t[e]!="function"&&console.warn(`${e} is not a function`),o[g.watchKeys].push(e),o[g.watchers][e]=function(s,r){t[e].call(this,s,r)}};let wc=0;function Cc(o,t){return o[g.identifier]=++wc,o[g.effects]=[],na(t.hooks,o[g.identifier]),mc(o,t.props),t.methods&&gc(o,t.methods),yc(o,t.state),t.computed&&xc(o,t.computed),t.watch&&Sc(o,t.watch),t.routes&&bc(o,t.routes),t.input&&Tc(o,t.input),o}const vc=()=>Xs("Circle",{code:{render:function(t,e,s,r,l,a){const i=[],n={};return i[0]=this.element({parent:t||"root"},e),n.color=e.color,n.w=e.size,n.h=e.size,n.effects=[e.shader("radius",{radius:e.radius})],i[0].populate(n),i},effects:[function(t,e,s,r,l,a){e[0].set("color",t.color)},function(t,e,s,r,l,a){e[0].set("w",t.size)},function(t,e,s,r,l,a){e[0].set("h",t.size)},function(t,e,s,r,l,a){e[0].set("effects",[t.shader("radius",{radius:t.radius})])}],context:{}},props:[{key:"size",default:40},"color"],computed:{radius(){return this.size/2}}});let vr;const _c=()=>Xs("RouterView",{code:{render:function(t,e,s,r,l,a){const i=[],n={};return i[0]=this.element({parent:t||"root"},e),n.w=t.node.width*(100/100),n.height=t.node.height*(100/100),i[0].populate(n),i},effects:[],context:{}},state(){return{activeView:null}},hooks:{ready(){vr=()=>Cr.navigate.apply(this),Cr.navigate.apply(this),window.addEventListener("hashchange",vr)},destroy(){window.removeEventListener("hashchange",vr,!1)},focus(){this.activeView&&this.activeView.$focus()}},input:{back(){Cr.back()}}}),Rc=()=>Xs("Sprite",{code:{render:function(t,e,s,r,l,a){const i=[],n={};return i[0]=this.element({parent:t||"root"},e),n.w=t.node.width*(100/100),n.h=t.node.height*(100/100),n.texture=e.texture,n.color=e.color,i[0].populate(n),i},effects:[function(t,e,s,r,l,a){e[0].set("texture",t.texture)},function(t,e,s,r,l,a){e[0].set("color",t.color)}],context:{}},props:["image","map","frame","color"],state(){return{spriteTexture:!1}},computed:{texture(){const o="frames"in this.map?Object.assign({},this.map.defaults||{},this.map.frames[this.frame]):this.map[this.frame];if(this.spriteTexture&&o)return this[g.renderer]().createTexture("SubTexture",{texture:this.spriteTexture,x:o.x,y:o.y,width:o.w,height:o.h})}},hooks:{ready(){this.spriteTexture=this[g.renderer]().createTexture("ImageTexture",{src:this.image})}}}),Ec="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaMAAAAbCAYAAADRe+BYAAAAAXNSR0IArs4c6QAAGn9JREFUeF7tXQ1UVdWePxcWFg7ZA0sym5n0Tmk1z4+0YeVU4yo1h1jvPVBo1ETU8QvTdJlhsmKpi0he5jyXX0CKIWkpl3OlME3RGcdJixVEas+nJtq0sMwXN/kIgbxn1m+791n/ezifF0hr7lmrVV3O2Wfv/977//v//h/7uKTQFZJASAIhCYQkEJLADZaAy+j9iqIMkCRpliRJGeSeWkmSClwuV25X9VtRlOGSJI3m7wq6bd5Osqa/6OZSSZJKXC4X+h7UpSgKZABZQCbiKuHt4t+dvri8z5GG3E77rChKtCRJ9TY647ht0aaiKJAx5LCK/4Y5m23jneotiqJgvg84eCaYd6Cf4h/xqgo+ZwUO3h1wK5cx1oIYP/5eJUlSrsvl6tRakGUZbYr9tjQpKanL9lmw4w09F5LAzyUBXTDiih3KAspN76pwuVxjgu2koijYzGibbmg0tzQYoOPt5Zv0xydJ0hiXywWlYfviAAE5UBDSPu9YUep1QFEUvAdKWlyOAYPP26c2BhhM25ivXZo+4lWOxx8EGEHRw6iwdXHjQbu26LMwTlJsNUZusrEeHMuC9kGWZRgSYs/VJiUluZ32MXR/SAK/VAkYgREsdKaAKysr58fFxd0Di23Xrl1ScjKMTUl69913906cODHe6cDNFAVvcyAUHCxNO21rGIVv7969ufHx8djQGatWrZIyMq4bmj6frz4mJuYRSZJsMyQNQJS43e4/19bWThk+fPiA/Px8afhwkDpJKikpKUhJSXHEDujY9MDU7XZLtbWsq1BItvrMWQsAQxozZoxUUQEiYHrZapuzAYCcAOWSnJycv2RmZjZThiRJklMZGDIkyHfWLNgskkRkgXVh+g4N0NUuWLCgYN26dcMHDBiQjPUr5qyoqOjttLS0KVYC0syTui/q6+tX9O7duyU6OnoV2h09+rodEexakGUZG4vNnbiWL18uHT9+HCBsay84Gcv/13s9Hs/osLAwlZW7XK6KxMRES8Pa6/Ue4GuLic7v94+ZMGGC5Qb7OeXcXWMrLS3Nd7lcs+zKKtgxdwAjupnPnDlTNHDgwN9RhlRfXy9FR0dDuUsxMTGYDMuJ1GxooAO0eNWgQYNaX3jhhcfnzp2bhHuWLl0q5eayfWd7AyqKoro2uIJ5jr7vwIEDqqKIi4trqKysfJK7VUxlRl1ebW1tX99yyy3tlCFB+aBtroCklJQUS0Wp90L+Hii5ABYaJBhBtowRjBgxQqqqsiSCdsEISpJZIZcuXVp01113PaPHkKyAQmf8umCE9XXu3Dm2zgCoAFZ+YXGYMiS6HjZt2iSnp6eztYVLZ87gVrPFkCjQX758+d0+ffr8k1gP6Oenn34qDRgwgBkQbrfb8VqQZVnIGCyerYX9+/dLeXl5MERuSoYky7JiU/GoLE+r1A2eh4cEIKG7gD0ez4CwsDCsxwD2qygKmGlFUlKSobtUq7A5sLgnTJhgaPDx91EX+i8CjLpqbHSeXS7XCKN5sbkWDG/TAyNVuSckJHyzZ8+evvxpbNoSRVHgDmMmK1d4toFD0wumOGH9wgruBBip7q2YmBgGkiBCXDGiv6qCnj17tlRQUGBrc5PYgJSZmTk1JyfnAd5/LPTZBESowoTV7igeoSiKUEK1ly5dCo+Njf17vKezYERkAU0etAVHjZPm5uaiqKioxylD4uMNun0DgFbnbNq0aXveeustgB8TixVLpOuTsEPMeYqiKFgXTKkQkLM1ZxTkNPuCrf8rV678qVevXi+QfWGrXdxfXl4e3dbWxmJ933zzzbHz588/OnLkSKmpqUlKT0/Hv9U51CjGDq482hZk1aNHjxEJCQlsU3D2JYxB/MRiXTQG6Pf7TRUzna9uBCPxmg5xM1mW1bVhovxKkpKSdI0MPTAqLi6WvF6voWGt907OWtGFTu2vzipw+nx3jU0wo6+++qpu0aJF/bg+cURC7IxTD4xUK5goRNUipco9JSUFbgks9Bg7L9MBo+EbN24M7wwzIm3S4K+qCKgSIcpphB12xNumSQEqkFElDTYHVgewtmtp42ZqbX/99dfTzp07VzBq1KiIToCRaii4XOrUOhlrh2mk8nv66acr9u/fL+JatpWtk7VBmaLf778QHh5+O2cKtli4jvGB17O+0jkrKCiQYJzYnTMKcnpuQ+pqdWL0cJBQFeybb7557Nq1a4/OmTOHiS0vLw8MKYBpERYlaS1VjbsvNykpiS1MCyWOdc1csMGCUVKSSkDNprvW6/XWCncXUejqM2PHjpXE2PFjdXX10uzsbOYu0Shb39mzZ7MyMjL+BkYt5mTKlCnS4MGDWVunTp0qy8zM/IO2M3oKGyx8yZIlbNvpGTuyLMNFfd0nz69fChh18dgoE+6UXtFbJHpgpDINsulU9DfY7EF3jG7iYNx0ZFA0AQDg6KOK7erVqy2RkZGR/H4nihRgdD14cZ1xCaUGxT/A7/dfue+++27n8R1bCpMDEdoVcRgE1OH2SxaxhyCZEZMBxrpt27ZIEXPhfQdQMjeGQ3BgG7G9vb0pPj4+Cm2KuCFvJ6ikE6M+0PWgcbPZskDpnGNOYDBVVVWNURQFCheGFlMqRL625syAcdF9gTXCKD5Zx7b2hVB2iqL8MHXq1N+gjW3btjERcWWCdQdFyRiO1+udxfsjcateBSuakQcFi+fvvffeD9asWSPiu779+/e/lZeX9wRkAcUPABDX3Llz4Yo1VMx03igz6iowQvsUkI4fPy4tX76csU8Kwh6PZ/uOHTsm0/5ERUVJGzdulPBvXDNmzCjz+XwBgETBCOOMjY1l93JZdfDyeL3e4YqisKSgpqam+qioKGZ43+xg1E1jE8aurT3jRM/gXrtgpFoMBmDEXHhOX86Vst4mDtb1F9AFatVv3br18PTp0/+F32BLsdHGqDIiv1ekpqZuKy4uvq45rrs8bGV9kb75EhMTs3bv3r2OxreCBCM1wG4yFylOUpAVRWHWUEtLy9XIyMhbDdqtgoUezPxrn1EUhY0BivmOO+6Q6uvroZxtuVZFW8gqrKurK+vXrx9cCtqrdv369fnz588XSQG24jt03RNWRfeFyswJGFkaPVTZnT9//sTixYt/iw5v2LDhWN++fR8lilJti7riuLJWvRMiI6+xsVEFtldffbXsgQce+D3a2rdvn1xQUBBAY15//XUGzri6AIwMy0XQPo0ZGSl0Oj64KlNTU/FoCgdaxuBIP1WXPH7Pz88vvfPOO9n4Vq9eLR09ejRgT1Iw8nq9UmJiIhs3/ru4uBhuy4B1TMF93759344bN+4u3K/Xd85KA8oJYPwhlkXjWBp21sHVKsuyuo9RNpGYmGjL9d9dY6P9SUpKYvNL3cUYn6IoyHjNQKID2XCOyhO6CowsN52RoupCZhTwCtruTz/9VBMREYFYDNhIUG5FPTACW5gxY0ZzcXExzCu0i4VsmflG3UU8KwtZXQOqq6svDRs2jJlqQYIR3D0Zp0+fDp88eXKvqqoq9KkkIyNjFjILcTU3N7c9+eSTz1ZWVu62Ag9t7RMSItLT05EEMn7o0KGLNm/eHC+y04LNrqR9oG7L3bt3y4mJiUJpOlpfkK/f738zLCzsXu0YwWRnzpz5fWFhocgMtIxDoQ1togkHHGbUUKMH9zph+FTZbdiwofbgwYPol2/Lli0ro6Oj/8NIUVKWAGXd1NQ0AgpVWPFQnAUFBVCcPlmWsSYZI+T34j9VJU4B4mYAI3ROh3VV8PExNzF3XzKQ0jGEsc9pUhDzlHAlqmbTgVUOGTKEufbAJDB2vofVxAkB7j/88EPF+++/PxquQD0wEnEVkz0VoJg196t/o6wX4zKKfem9h4JRV47NCox4yAPrtkMpEIBq/PjxtrJsf5VgpEnv9Y0cOXLXsWPHhEA6y7ryR48ezZS7UMRz5sw5kZ+fD3eAJRBxxSYsHzAKUF6AiK+xsfHPUVFR/xwsGJEF2oEh0VRpriwt2SwFI7i8kLDiu54hwhYdssfgBsLFs8g6WJZWgKcBI9XVOnDgwK/PnDnzt1yJqC4qq/ZorVVTU9Op+Ph46ciRIw+gr5CBcIOmpqZeKi4uRualbbclBUudfqhxFx4zYrhklZYtlJ3f729IS0vrBSYAJVReXj5bJDUQdqC6/ajS4gxgqSzLeJZZHcJFB9esLMvMWqVsScTRONipacs3AxhRpUpiHj6v17tUuCcJIBkZE2r8lAKWVmE3NzerMSrOdlQmRe997733Prxy5crTemDk9XrB5JmLFvt50aJF2y9cuBDvdruTX3zxRdUVuGrVqvmVlZXrcR/YX0tLy/+Gh4dHYX7nzZt34Z133nm4ra1NgKjv+eefb7p48SL2AC5Lg6w7xob9oQEj1hmPx+MOCwtTMwyPHj0qFRYWFtXX168cMWLE6wsWLEgS7tL09PQV33777XKrvfurAyNt4eeMGTNyCgsLl3FBdEpZ8jbYIqeK+LPPPrv28MMPT7TjqqTunldeeSU9Ozt7I28XGw1WH7P8gmFGZLIZQ+LgiEVcpRO8D4hD6C0UCkaaFGvIkbXb0tJy4tZbb/1HPM8z+CwVsMG71DTv48ePVwwZMkQkSjhqj9aGpaamphYXF2MTMBZEU8YvXLjg79+//7/ZmTPa39OnT//hiy++2JmYmNgDv6N+LTo6+mVaxE3S6k37TpMNvvzyy7+89NJLg/i7mKFA2Y/W5URdWTwFvMrr9SJOOhqxjdTUVJFUBPcWq186ffp0w8svv9yLv0NlC13BjEwUTYAbyspNx2WCPcYMHsKAmK7XnFIhtbe3/xgREbHS7/eXmKVni/5pXVlgW1u2bGmJiIiI1KbSE/biS01NdT333HO/EfE16qaTZRl9ZWtsyZIlQ8+dO4d1xS64AQWA8bGoa4IaFHh3ZGTk3scff/xf8dwnn3wi5+bmCs+ArcSo7hibHTAirBJ6gTEkjFm4QPnatXSH282m040Z8Ww6W6httFi70k2nPTli/fr1GSQ2YNuNZoXg4u/Nzc0Xe/bsyVLfefaaKdtwcFyP2oUDBw6kjh07tthun0zkjEXCLJmSkhIW2Ley3Gl/CRiBAcBCZ24PnSwzR/Ed0V/aTkpKSnVJScnD/G+23GikHRbjunr1al1kZKSIGang2djY+D8a9mnJEHVk2qFAVRSEX7lyBSAXxksMTK1ZCjZW8wvLc/Xq1QEuZvG8SAEXSQ8ffPDBic2bNyP2xO4XLi+iNALm6EaBkdWYz58/v3Px4sXP8vtUQ3LatGn5Dz744CwR5yLtwNNQYBZjoQqbg4/0xhtvnOjfv/9vCQNl7lfBWuvq6vbMnz//GZrsYRDvUuPfnHGneL3eZE2yCbqrrumdO3f+V0REhIhls6EoinJh/PjxIovUtt7qrrFZMSMetxTTwEpfOBtnLJ0YFKoBpDf3pnVGBGwoGKmp38QCtKSQ3Q1G3IpH1guzqD766KOcxx57TDAi/GQrs4koNXFmHn4S7rSAYYhgOwEjU+alc/6c1X5Ehp0tMOLMR6Sf4rimgIJBg7RmS2uFxyCG8yJn9Dcgk4YyEVLbZLrotIOmcvnuu++qY2NjBRBZ9k+nLQZGFy9ebOnXr5/InqTrV5stGhR4kvMUkylLPnLkSOUTTzyBgljTNaepB7JcB7iBx3tU8KTMCjECYYFnZGQ0nD17FgyIyY+mJvM2AuawK8DIRjYdk7PNotdcj8fTtmPHjudJHEKrY5DOnYF4Dyxw4RLie7EiIiIiRdRXUeHqKewJEyaUTZo0iSV4CCtelmXIiDHKDRs27Dl48OAz8+bNa33qqaduwW96YJSVlfV2bGxsXN++ff9Bb0J55iP+pI6FJrCIZwoLCzeXl5f/O/9/256B7hqbAzBS9xItJbCI76miMj2BwSBriJ2fxY/XUV0BTt0dROl3OptOe2bY559/vm7o0KGIB4iAWjDZc1Ds4py3DmfxUQV64sSJ1sGDB7NFqpehqLMwdQ80NcimE4+bjkETz+hwRhplHiTAbkn/deq0VEWmiSn91e1238E765TNqP7911577ciyZctQWIsrmHlTa0K4q5PWhqmB7aampvbbbruN1XTZKaY1QwsKyMOGDfugpqYGadSmblC6WQmT6fAa6u7gykydMw5oLMYAqx4KuaGhoTYtLU0kZwgLX83044ohAIApWHVBzMhIVB3ASK/OyOBhoyxVcTDycIASAFHUGV2+fPnU7NmzH9S2p6eweVwNbUULBsrBCL/5ONBG5+Tk1A4aNIjJloJReXl5VVtbG4ycgFok7bsJGAUADJU/Ya943JGh1B1js+OmI8xI1Q0GYGRKWozOplM3NGdH4vQFlRWtXbv2xMKFC1kaqlPWQSeps2467blptbW1f3S73TNNLCozvRLwN8p8uMWbybOnsOigQNniW7hw4V/Xrl0rFLFpait/geoyoy/sDBihHdpfnt32Co8XqUWVyACMjY2N4m4kS+ZBs8jwzMSJE5s+/PDD2zgQqXU7mZmZp8gpFbaZEW2fH7skArZB1TLQmByy/yZNmoREiL/j71EPevV4PHXJycnCjecIPMWcaU9z52vvJf53U9lSBUSSDTqsTQAqUq9xkWC+Kl+tq+/QoUOH169fD7eP6tKjabgALQDS0aNHWRvaLDAKRvw5duaV3llsBnVGwaR2G+1JgBDWgVWSifBiZGzatCla1A5lZWVVnjx5cpxwKeMlVGETJYokD8iLHWQJGWzatIn1iRfPMta0devW6ttvv52xdgpGpaWlySKlGQkMa9asOYWkGbBnWjOlB0Z6ZxISJuHIGOuOsd0MYIQiR/gyr1ePdbzAFLAAYGk6Qm9tU10ARnaOB1Ff6yJHE1ihEmJQ165dOxQeHi6Cvh0eqaury7/nnntEpl6nEiSohR1MAgP629TUtCcqKup6JV/Hy5eQkPCfe/bsEYFRWy4Aq1O2OyMDCh55eXmVc+fOFS6uzrh+aSZVBym0trYevvvuu4fwGiZHqf4mspjtcrlgSYvEC0OAo66Z77//vm7mzJkCFHXnQwe41Pu0yoy46ALYhCZl2HDpUzAqLS1V60b0UnS7EIwsla5mnIYpz+vWrSvv168fOz6KK/UAo8ZIYXu9XtTKME8IQEowrJUrV1bU1NRgTpHNJxKBAsBIlmVWAI9n09LSahoaGoYKAdsAI5H56vvxxx979ezZM1xk1zU2Nva30lH0790xthsORhggLN+cnJz/XrZsGS0cFN8zAhBdP77bRvqqmUBvZjDicohesWLFl1OmTIlBbIBcBTt27KiZPHnyDELPg1ag/F16p184strBANDfBQsWxCB7jFxLR40aFXP48GFhuVtm09GHy8rKhp09e/bo4sWLaeFrRWVlZVlcXFxaMDKgrKgzRa566ys7O/vtuLi4ySKVm99TVV9fX967d2+kzwvQsGSHtH0NGDGr3e12R+I0d3JmnynIUzZSWlpat337drHHdOOa1OUhMudEcSZ11RHmhC53UPBZWVlTwsLCtglFC5der169cIIGTnRg8jBiRgZFnurxMCRmFAwzsgQjTYzN16NHD7deTIjGpHj8B8NS5WqgsBlg0dgIHmpvbz/57LPPskxRpOhzI4LJSZNNB8Yd3dra2jpx4kThrkebSLfH/SyQr2VGdF5ramq2f/zxx5PFUUh8nh3pk+4Y200BRnwCADqm3zVyemq3CTDRTBRbFrumLUcMyWZsR7zCSg5ssdo9fcEMnPnf6NFGjsCIzBs2iNF3mNj3nRyczye6bPVRvM7IgM5fMPOvJ1ZThiQynqgbx8bcWMnCiQKhcUk7rJqekaYFLno2oxnbo/uMjYWewECKYum6o3KkRw/9bGCEflLlDeA9dOjQsb17947E3wBWra2tq4S7rKGhgdVt8clS58RCYQfokLKysi+LiopEMgKKilfpnKsHEINMmXFOAAdZjAEfYaRg5PF4SkidTu3UqVPDGhsb783Ly/P36dMnDG1xlovCbXHQrehfLXebBtQ1dsfYuhqMPB5PBf+EB3RTQCGw3fiG9rh2xpCsCvocbGzcejODEfonzqjTfvEVckBQ2cqv7UQcnQUj2l8sYEqR2Jdv7Rbo6nRa7wvAGLuQg5NxintpxbwjxmbjZVi7mDP64UIofsigM98JosAs4hqQAVMcNi+q5O0AMFWWWkZH+9PBKOBuLgT5MW7ci7ZGI74i4iN1dXUN8+fPFwqcghFtW2UxP6ebTshz+/btf4qMjGSno5tcvqysrLMnT54ULl81A9FMYWs/FUGAmRkKRjVSvL7LyGhXi6H5kUPo9lKv1ztaABs9oikhIWHz9OnTWSYdZ7oU/E2PCeqOsXU1GPFTNMSHUANq0OyAkc19FbotJIGQBG5GCXAlK8oe6NEzOARUTcQpKir6qqysjH3ChJ/EbwqsNwKM0LGHHnoo9/77739Jm9INpt/Y2Fg+depU1P6JM9ICYtpmChttC8DR1M4wQ8GsYBcyrqqqOvDII48wb0R7ezsKaVf06NGjQJykITLlZs2aJY8bN47FbTWuQFbD5/V6dwmg4myKsWDBDFHUvGTJkphLly7hfhgHjCF119gcpHZbZtNRZrRz5876nTt3IpGGyTcERjej9gj1KSSBLpQAXFjt7e2qgtNruqGh4d20tDRxcoAdlyFthn5awK5OoezfMmak02fqljSSlpk7Wsts6fd5tNmu2uxQo76bufNVhqRx6dO2qIuX9k87H/S4Lz23cHeMjZE14voX80xlpZcBS9k87Sv1hDGDwe7C6cKtEWoqJIGQBG6EBHJzc5+vr69/Iy4ujh1lxK+S6urqquzsbLgzRZ2Mk7gXmrkRYIT3QhGKWiPqirbjhjVT2GhbgISegjUDUvQJCph+dgZuU7jb2AcUSQYyVch6BgB9D3XjqrEjyozInHbX2LoSjCAnjI/FjkLM6EZohNA7QxK4cRKAwlZrrQy64Si78MYNJfTmX5sEQszo1zajofGEJGAtAfHNHVGegSeQ2CD+sW4hdEdIAl0sgRAYdbFAQ82FJBCSQEgCIQk4l0AIjJzLLPRESAIhCYQkEJJAF0vg/wBMng85iZWBHAAAAABJRU5ErkJggg==",Ac=()=>Xs("FPScounter",{code:{render:function(t,e,s,r,l,a){const i=[];let n,c;const h={};i[0]=this.element({parent:t||"root"},e),i[0].populate(h),t=i[0];const d={};i[1]=this.element({parent:t||"root"},e),d.y=15,d.x=20,i[1].populate(d),t=i[1];const m={};i[2]=this.element({parent:t||"root"},e),i[2].populate(m);const p=s.components&&s.components.Sprite||r.Sprite;t=i[2];const u={};i[3]=this.element({parent:t||"root"},e),u.image=e.image,u.w=43,u.h=25,u.map=e.sprite,u.frame="fps";const x=[];if(typeof p<"u")for(let O in p.config.props)delete u[p.config.props[O]],x.push(p.config.props[O]);i[3].populate(u),t=i[3];const T={};T.image=e.image,T.w=43,T.h=25,T.map=e.sprite,T.frame="fps",n=T.is||"Sprite";let b;if(typeof n=="string"){if(b=s.components&&s.components[n]||r[n],!b)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(b=n);i[4]=b.call(null,{props:T},i[3],e),i[4][Symbol.for("slots")][0]?(t=i[4][Symbol.for("slots")][0],e=i[4]):t=i[4][Symbol.for("children")][0],t=i[2];const v={};i[5]=this.element({parent:t||"root"},e),v.x=58,v.y=2,i[5].populate(v);const R=s.components&&s.components.Sprite||r.Sprite;t=i[5];const w={};i[6]=this.element({parent:t||"root"},e),w.image=e.image,w.x=0,w.h=20,w.w=20,w.map=e.sprite,w.frame=e.fps[0];const E=[];if(typeof R<"u")for(let O in R.config.props)delete w[R.config.props[O]],E.push(R.config.props[O]);i[6].populate(w),t=i[6];const S={};S.image=e.image,S.x=0,S.h=20,S.w=20,S.map=e.sprite,c=e.fps[0],Array.isArray(c)===!0&&(c=a(c).slice(0)),S.frame=c,n=S.is||"Sprite";let M;if(typeof n=="string"){if(M=s.components&&s.components[n]||r[n],!M)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(M=n);i[7]=M.call(null,{props:S},i[6],e),i[7][Symbol.for("slots")][0]?(t=i[7][Symbol.for("slots")][0],e=i[7]):t=i[7][Symbol.for("children")][0];const I=s.components&&s.components.Sprite||r.Sprite;t=i[5];const A={};i[8]=this.element({parent:t||"root"},e),A.image=e.image,A.x=18,A.h=20,A.w=20,A.map=e.sprite,A.frame=e.fps[1];const B=[];if(typeof I<"u")for(let O in I.config.props)delete A[I.config.props[O]],B.push(I.config.props[O]);i[8].populate(A),t=i[8];const P={};P.image=e.image,P.x=18,P.h=20,P.w=20,P.map=e.sprite,c=e.fps[1],Array.isArray(c)===!0&&(c=a(c).slice(0)),P.frame=c,n=P.is||"Sprite";let N;if(typeof n=="string"){if(N=s.components&&s.components[n]||r[n],!N)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(N=n);i[9]=N.call(null,{props:P},i[8],e),i[9][Symbol.for("slots")][0]?(t=i[9][Symbol.for("slots")][0],e=i[9]):t=i[9][Symbol.for("children")][0];const z=s.components&&s.components.Sprite||r.Sprite;t=i[5];const $={};i[10]=this.element({parent:t||"root"},e),$.image=e.image,$.x=36,$.h=20,$.w=20,$.map=e.sprite,$.frame=e.fps[2];const F=[];if(typeof z<"u")for(let O in z.config.props)delete $[z.config.props[O]],F.push(z.config.props[O]);i[10].populate($),t=i[10];const _={};_.image=e.image,_.x=36,_.h=20,_.w=20,_.map=e.sprite,c=e.fps[2],Array.isArray(c)===!0&&(c=a(c).slice(0)),_.frame=c,n=_.is||"Sprite";let k;if(typeof n=="string"){if(k=s.components&&s.components[n]||r[n],!k)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(k=n);i[11]=k.call(null,{props:_},i[10],e),i[11][Symbol.for("slots")][0]?(t=i[11][Symbol.for("slots")][0],e=i[11]):t=i[11][Symbol.for("children")][0],t=i[1];const V={};i[12]=this.element({parent:t||"root"},e),V.x=150,i[12].populate(V);const W=s.components&&s.components.Sprite||r.Sprite;t=i[12];const D={};i[13]=this.element({parent:t||"root"},e),D.image=e.image,D.y=2,D.w=48,D.h=25,D.map=e.sprite,D.frame="avg";const Y=[];if(typeof W<"u")for(let O in W.config.props)delete D[W.config.props[O]],Y.push(W.config.props[O]);i[13].populate(D),t=i[13];const U={};U.image=e.image,U.y=2,U.w=48,U.h=25,U.map=e.sprite,U.frame="avg",n=U.is||"Sprite";let K;if(typeof n=="string"){if(K=s.components&&s.components[n]||r[n],!K)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(K=n);i[14]=K.call(null,{props:U},i[13],e),i[14][Symbol.for("slots")][0]?(t=i[14][Symbol.for("slots")][0],e=i[14]):t=i[14][Symbol.for("children")][0],t=i[12];const me={};i[15]=this.element({parent:t||"root"},e),me.x=63,me.y=2,i[15].populate(me);const j=s.components&&s.components.Sprite||r.Sprite;t=i[15];const q={};i[16]=this.element({parent:t||"root"},e),q.image=e.image,q.x=0,q.h=20,q.w=20,q.map=e.sprite,q.frame=e.avgFps[0];const Q=[];if(typeof j<"u")for(let O in j.config.props)delete q[j.config.props[O]],Q.push(j.config.props[O]);i[16].populate(q),t=i[16];const X={};X.image=e.image,X.x=0,X.h=20,X.w=20,X.map=e.sprite,c=e.avgFps[0],Array.isArray(c)===!0&&(c=a(c).slice(0)),X.frame=c,n=X.is||"Sprite";let ge;if(typeof n=="string"){if(ge=s.components&&s.components[n]||r[n],!ge)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ge=n);i[17]=ge.call(null,{props:X},i[16],e),i[17][Symbol.for("slots")][0]?(t=i[17][Symbol.for("slots")][0],e=i[17]):t=i[17][Symbol.for("children")][0];const ee=s.components&&s.components.Sprite||r.Sprite;t=i[15];const J={};i[18]=this.element({parent:t||"root"},e),J.image=e.image,J.x=18,J.h=20,J.w=20,J.map=e.sprite,J.frame=e.avgFps[1];const H=[];if(typeof ee<"u")for(let O in ee.config.props)delete J[ee.config.props[O]],H.push(ee.config.props[O]);i[18].populate(J),t=i[18];const ye={};ye.image=e.image,ye.x=18,ye.h=20,ye.w=20,ye.map=e.sprite,c=e.avgFps[1],Array.isArray(c)===!0&&(c=a(c).slice(0)),ye.frame=c,n=ye.is||"Sprite";let xe;if(typeof n=="string"){if(xe=s.components&&s.components[n]||r[n],!xe)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(xe=n);i[19]=xe.call(null,{props:ye},i[18],e),i[19][Symbol.for("slots")][0]?(t=i[19][Symbol.for("slots")][0],e=i[19]):t=i[19][Symbol.for("children")][0];const te=s.components&&s.components.Sprite||r.Sprite;t=i[15];const Te={};i[20]=this.element({parent:t||"root"},e),Te.image=e.image,Te.x=36,Te.h=20,Te.w=20,Te.map=e.sprite,Te.frame=e.avgFps[2];const Se=[];if(typeof te<"u")for(let O in te.config.props)delete Te[te.config.props[O]],Se.push(te.config.props[O]);i[20].populate(Te),t=i[20];const se={};se.image=e.image,se.x=36,se.h=20,se.w=20,se.map=e.sprite,c=e.avgFps[2],Array.isArray(c)===!0&&(c=a(c).slice(0)),se.frame=c,n=se.is||"Sprite";let Ae;if(typeof n=="string"){if(Ae=s.components&&s.components[n]||r[n],!Ae)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ae=n);i[21]=Ae.call(null,{props:se},i[20],e),i[21][Symbol.for("slots")][0]?(t=i[21][Symbol.for("slots")][0],e=i[21]):t=i[21][Symbol.for("children")][0],t=i[1];const we={};i[22]=this.element({parent:t||"root"},e),we.x=0,we.y=40,i[22].populate(we);const bs=s.components&&s.components.Sprite||r.Sprite;t=i[22];const ie={};i[23]=this.element({parent:t||"root"},e),ie.image=e.image,ie.x=-2,ie.w=47,ie.h=25,ie.map=e.sprite,ie.frame="min";const Ss=[];if(typeof bs<"u")for(let O in bs.config.props)delete ie[bs.config.props[O]],Ss.push(bs.config.props[O]);i[23].populate(ie),t=i[23];const Ce={};Ce.image=e.image,Ce.x=-2,Ce.w=47,Ce.h=25,Ce.map=e.sprite,Ce.frame="min",n=Ce.is||"Sprite";let Me;if(typeof n=="string"){if(Me=s.components&&s.components[n]||r[n],!Me)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Me=n);i[24]=Me.call(null,{props:Ce},i[23],e),i[24][Symbol.for("slots")][0]?(t=i[24][Symbol.for("slots")][0],e=i[24]):t=i[24][Symbol.for("children")][0],t=i[22];const Hs={};i[25]=this.element({parent:t||"root"},e),Hs.x=58,Hs.y=2,i[25].populate(Hs);const ke=s.components&&s.components.Sprite||r.Sprite;t=i[25];const ve={};i[26]=this.element({parent:t||"root"},e),ve.image=e.image,ve.x=0,ve.h=20,ve.w=20,ve.map=e.sprite,ve.frame=e.minFps[0];const ws=[];if(typeof ke<"u")for(let O in ke.config.props)delete ve[ke.config.props[O]],ws.push(ke.config.props[O]);i[26].populate(ve),t=i[26];const re={};re.image=e.image,re.x=0,re.h=20,re.w=20,re.map=e.sprite,c=e.minFps[0],Array.isArray(c)===!0&&(c=a(c).slice(0)),re.frame=c,n=re.is||"Sprite";let Cs;if(typeof n=="string"){if(Cs=s.components&&s.components[n]||r[n],!Cs)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Cs=n);i[27]=Cs.call(null,{props:re},i[26],e),i[27][Symbol.for("slots")][0]?(t=i[27][Symbol.for("slots")][0],e=i[27]):t=i[27][Symbol.for("children")][0];const Ie=s.components&&s.components.Sprite||r.Sprite;t=i[25];const _e={};i[28]=this.element({parent:t||"root"},e),_e.image=e.image,_e.x=18,_e.h=20,_e.w=20,_e.map=e.sprite,_e.frame=e.minFps[1];const vs=[];if(typeof Ie<"u")for(let O in Ie.config.props)delete _e[Ie.config.props[O]],vs.push(Ie.config.props[O]);i[28].populate(_e),t=i[28];const ne={};ne.image=e.image,ne.x=18,ne.h=20,ne.w=20,ne.map=e.sprite,c=e.minFps[1],Array.isArray(c)===!0&&(c=a(c).slice(0)),ne.frame=c,n=ne.is||"Sprite";let _s;if(typeof n=="string"){if(_s=s.components&&s.components[n]||r[n],!_s)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(_s=n);i[29]=_s.call(null,{props:ne},i[28],e),i[29][Symbol.for("slots")][0]?(t=i[29][Symbol.for("slots")][0],e=i[29]):t=i[29][Symbol.for("children")][0];const Le=s.components&&s.components.Sprite||r.Sprite;t=i[25];const Re={};i[30]=this.element({parent:t||"root"},e),Re.image=e.image,Re.x=36,Re.h=20,Re.w=20,Re.map=e.sprite,Re.frame=e.minFps[2];const Rs=[];if(typeof Le<"u")for(let O in Le.config.props)delete Re[Le.config.props[O]],Rs.push(Le.config.props[O]);i[30].populate(Re),t=i[30];const le={};le.image=e.image,le.x=36,le.h=20,le.w=20,le.map=e.sprite,c=e.minFps[2],Array.isArray(c)===!0&&(c=a(c).slice(0)),le.frame=c,n=le.is||"Sprite";let Es;if(typeof n=="string"){if(Es=s.components&&s.components[n]||r[n],!Es)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Es=n);i[31]=Es.call(null,{props:le},i[30],e),i[31][Symbol.for("slots")][0]?(t=i[31][Symbol.for("slots")][0],e=i[31]):t=i[31][Symbol.for("children")][0],t=i[1];const Be={};i[32]=this.element({parent:t||"root"},e),Be.x=150,Be.y=40,i[32].populate(Be);const De=s.components&&s.components.Sprite||r.Sprite;t=i[32];const Pe={};i[33]=this.element({parent:t||"root"},e),Pe.image=e.image,Pe.w=53,Pe.h=25,Pe.map=e.sprite,Pe.frame="max";const Ne=[];if(typeof De<"u")for(let O in De.config.props)delete Pe[De.config.props[O]],Ne.push(De.config.props[O]);i[33].populate(Pe),t=i[33];const Ge={};Ge.image=e.image,Ge.w=53,Ge.h=25,Ge.map=e.sprite,Ge.frame="max",n=Ge.is||"Sprite";let Fe;if(typeof n=="string"){if(Fe=s.components&&s.components[n]||r[n],!Fe)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Fe=n);i[34]=Fe.call(null,{props:Ge},i[33],e),i[34][Symbol.for("slots")][0]?(t=i[34][Symbol.for("slots")][0],e=i[34]):t=i[34][Symbol.for("children")][0],t=i[32];const je={};i[35]=this.element({parent:t||"root"},e),je.x=63,je.y=2,i[35].populate(je);const ze=s.components&&s.components.Sprite||r.Sprite;t=i[35];const ae={};i[36]=this.element({parent:t||"root"},e),ae.image=e.image,ae.x=0,ae.h=20,ae.w=20,ae.map=e.sprite,ae.frame=e.maxFps[0];const ur=[];if(typeof ze<"u")for(let O in ze.config.props)delete ae[ze.config.props[O]],ur.push(ze.config.props[O]);i[36].populate(ae),t=i[36];const fe={};fe.image=e.image,fe.x=0,fe.h=20,fe.w=20,fe.map=e.sprite,c=e.maxFps[0],Array.isArray(c)===!0&&(c=a(c).slice(0)),fe.frame=c,n=fe.is||"Sprite";let We;if(typeof n=="string"){if(We=s.components&&s.components[n]||r[n],!We)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(We=n);i[37]=We.call(null,{props:fe},i[36],e),i[37][Symbol.for("slots")][0]?(t=i[37][Symbol.for("slots")][0],e=i[37]):t=i[37][Symbol.for("children")][0];const Ve=s.components&&s.components.Sprite||r.Sprite;t=i[35];const ce={};i[38]=this.element({parent:t||"root"},e),ce.image=e.image,ce.x=18,ce.h=20,ce.w=20,ce.map=e.sprite,ce.frame=e.maxFps[1];const dr=[];if(typeof Ve<"u")for(let O in Ve.config.props)delete ce[Ve.config.props[O]],dr.push(Ve.config.props[O]);i[38].populate(ce),t=i[38];const he={};he.image=e.image,he.x=18,he.h=20,he.w=20,he.map=e.sprite,c=e.maxFps[1],Array.isArray(c)===!0&&(c=a(c).slice(0)),he.frame=c,n=he.is||"Sprite";let Xe;if(typeof n=="string"){if(Xe=s.components&&s.components[n]||r[n],!Xe)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Xe=n);i[39]=Xe.call(null,{props:he},i[38],e),i[39][Symbol.for("slots")][0]?(t=i[39][Symbol.for("slots")][0],e=i[39]):t=i[39][Symbol.for("children")][0];const He=s.components&&s.components.Sprite||r.Sprite;t=i[35];const ue={};i[40]=this.element({parent:t||"root"},e),ue.image=e.image,ue.x=36,ue.h=20,ue.w=20,ue.map=e.sprite,ue.frame=e.maxFps[2];const pr=[];if(typeof He<"u")for(let O in He.config.props)delete ue[He.config.props[O]],pr.push(He.config.props[O]);i[40].populate(ue),t=i[40];const de={};de.image=e.image,de.x=36,de.h=20,de.w=20,de.map=e.sprite,c=e.maxFps[2],Array.isArray(c)===!0&&(c=a(c).slice(0)),de.frame=c,n=de.is||"Sprite";let Ye;if(typeof n=="string"){if(Ye=s.components&&s.components[n]||r[n],!Ye)throw new Error('Component "Sprite" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ye=n);return i[41]=Ye.call(null,{props:de},i[40],e),i[41][Symbol.for("slots")][0]?(t=i[41][Symbol.for("slots")][0],e=i[41]):t=i[41][Symbol.for("children")][0],i},effects:[function(t,e,s,r,l,a){(typeof skip6>"u"||skip6.indexOf("frame")===-1)&&e[6].set("frame",t.fps[0])},function(t,e,s,r,l,a){e[7][Symbol.for("props")].frame=t.fps[0]},function(t,e,s,r,l,a){(typeof skip8>"u"||skip8.indexOf("frame")===-1)&&e[8].set("frame",t.fps[1])},function(t,e,s,r,l,a){e[9][Symbol.for("props")].frame=t.fps[1]},function(t,e,s,r,l,a){(typeof skip10>"u"||skip10.indexOf("frame")===-1)&&e[10].set("frame",t.fps[2])},function(t,e,s,r,l,a){e[11][Symbol.for("props")].frame=t.fps[2]},function(t,e,s,r,l,a){(typeof skip16>"u"||skip16.indexOf("frame")===-1)&&e[16].set("frame",t.avgFps[0])},function(t,e,s,r,l,a){e[17][Symbol.for("props")].frame=t.avgFps[0]},function(t,e,s,r,l,a){(typeof skip18>"u"||skip18.indexOf("frame")===-1)&&e[18].set("frame",t.avgFps[1])},function(t,e,s,r,l,a){e[19][Symbol.for("props")].frame=t.avgFps[1]},function(t,e,s,r,l,a){(typeof skip20>"u"||skip20.indexOf("frame")===-1)&&e[20].set("frame",t.avgFps[2])},function(t,e,s,r,l,a){e[21][Symbol.for("props")].frame=t.avgFps[2]},function(t,e,s,r,l,a){(typeof skip26>"u"||skip26.indexOf("frame")===-1)&&e[26].set("frame",t.minFps[0])},function(t,e,s,r,l,a){e[27][Symbol.for("props")].frame=t.minFps[0]},function(t,e,s,r,l,a){(typeof skip28>"u"||skip28.indexOf("frame")===-1)&&e[28].set("frame",t.minFps[1])},function(t,e,s,r,l,a){e[29][Symbol.for("props")].frame=t.minFps[1]},function(t,e,s,r,l,a){(typeof skip30>"u"||skip30.indexOf("frame")===-1)&&e[30].set("frame",t.minFps[2])},function(t,e,s,r,l,a){e[31][Symbol.for("props")].frame=t.minFps[2]},function(t,e,s,r,l,a){(typeof skip36>"u"||skip36.indexOf("frame")===-1)&&e[36].set("frame",t.maxFps[0])},function(t,e,s,r,l,a){e[37][Symbol.for("props")].frame=t.maxFps[0]},function(t,e,s,r,l,a){(typeof skip38>"u"||skip38.indexOf("frame")===-1)&&e[38].set("frame",t.maxFps[1])},function(t,e,s,r,l,a){e[39][Symbol.for("props")].frame=t.maxFps[1]},function(t,e,s,r,l,a){(typeof skip40>"u"||skip40.indexOf("frame")===-1)&&e[40].set("frame",t.maxFps[2])},function(t,e,s,r,l,a){e[41][Symbol.for("props")].frame=t.maxFps[2]}],context:{}},state(){return{image:Ec,sprite:{defaults:{y:1,w:20,h:20},frames:{"-":{x:-1e3},0:{x:1},1:{x:23},2:{x:45},3:{x:67},4:{x:89},5:{x:111},6:{x:133},7:{x:155},8:{x:177},9:{x:199},avg:{x:221,w:48,h:25},fps:{x:271,w:43,h:25},max:{x:316,w:53,h:25},min:{x:371,w:47,h:25}}},fps:"---",avgFps:"---",minFps:"---",maxFps:"---"}},hooks:{ready(){let o=1e4,t=0,e=0,s=0,r=0;co.on("fpsUpdate",(l,{fps:a})=>{o=Math.min(a,o),t=Math.max(a,t),s+=a,r++,e=Math.round(s/r),this.fps=a.toString().padStart(3,"0"),this.avgFps=e.toString().padStart(3,"0"),this.minFps=o.toString().padStart(3,"0"),this.maxFps=t.toString().padStart(3,"0")})}}}),Mc=()=>({Circle:vc(),RouterView:_c(),Sprite:Rc(),FPScounter:Ac()}),kc={name:"log",plugin(){return Mn("App")}},Xr={log:kc},al=(o,t="",e={})=>{let s;if(typeof t=="object"?e=t:s=t,typeof o=="function"){if(s===void 0)throw Error("Error registering plugin: name is required for plugin");Xr[s]={plugin:o,options:e}}else o.plugin&&al(o.plugin,s||o.name,e)};let _r;const En=o=>{throw new Error(`Parameter ${o} is required`)},Xs=(o=En("name"),t=En("config"))=>{let e;const s=function(l,a,i,n){this.componentId=oa(o),this.lifecycle=Object.assign(Object.create(Tf),{component:this,previous:null,current:null}),this.parent=i,this.rootParent=n,this[g.holder]=a,this[g.id]=ia(),this[g.props]=dn(l.props||{},$e.get("reactivityMode")),this[g.timeouts]=[],this[g.intervals]=[],this[g.originalState]=t.state&&typeof t.state=="function"&&t.state.apply(this)||{},this[g.originalState].hasFocus=!1,this[g.state]=dn(this[g.originalState],$e.get("reactivityMode")),this.lifecycle.state="init",this[g.children]=t.code.render.apply(Jr,[a,this,t,_r,Di,ys])||[],this[g.wrapper]=this[g.children][0],this[g.slots]=this[g.children].filter(h=>h[g.isSlot]),t.hooks&&(t.hooks.frameTick&&co.on("frameTick",(h,d)=>Rr("frameTick",this[g.identifier],this,[d])),t.hooks.idle&&co.on("idle",()=>{Rr("idle",this[g.identifier],this)}),t.hooks.attach&&this[g.wrapper].node.on("inBounds",()=>{this.lifecycle.state="attach"}),t.hooks.detach&&this[g.wrapper].node.on("outOfBounds",(h,{previous:d})=>{d>0&&(this.lifecycle.state="detach")}),t.hooks.enter&&this[g.wrapper].node.on("inViewport",()=>{this.lifecycle.state="enter"}),t.hooks.exit&&this[g.wrapper].node.on("outOfViewport",()=>{this.lifecycle.state="exit"}));const c=t.code.effects;for(let h=0;h<c.length;h++){const d=()=>{c[h](this,this[g.children],t,_r,n,Di)};this[g.effects].push(d),Di(d)}if(this[g.watchers]){const h=Object.keys(this[g.watchers]),d=h.length;for(let m=0;m<d;m++){let p=this,u=h[m];if(u.indexOf(".")>-1){const T=u.split(".");u=T.pop();for(let b=0;b<T.length;b++)p=p[T[b]]}let x=this[u];Di((T=!1)=>{const b=p[u];(x!==b||T===!0)&&(this[g.watchers][u].apply(this,[b,x]),x=b)})}}return setTimeout(()=>this.lifecycle.state="ready"),this},r=(l={},a,i,n)=>{if(Zs[g.launched]===!1){const c=Object.keys(Xr),h=c.length;for(let d=0;d<h;d++){const m=c[d],p=`$${m}`;p in Zs&&Z.warn(`"${m}" (this.${p}) already exists as a property or plugin on the Base Component. You may be overwriting built-in functionality. Proceed with care!`);const u=Xr[m];Object.defineProperty(Zs,p,{value:u.plugin(u.options),writable:!1,enumerable:!0,configurable:!1})}_r=Mc(),Zs[g.launched]=!0}return e===void 0&&(Z.debug(`Setting up ${o} component`),e=Cc(Object.create(Zs),t)),t.code===void 0&&(Z.debug(`Generating code for ${o} component`),t.code=Zl.call(t,ql(t.template))),s.call(Object.create(e),l,a,i,n)};return r.config=t,r[g.isComponent]=!0,r},Ic=o=>{const t={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Enter:"enter"," ":"space",Backspace:"back",Escape:"escape",37:"left",39:"right",38:"up",40:"down",13:"enter",32:"space",8:"back",27:"escape"};o.hooks=o.hooks||{};let e,s,r;return o.hooks[g.destroy]=function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",s)},o.hooks[g.init]=function(){const l={...t,...$e.get("keymap",{})};e=a=>{const i=l[a.key]||l[a.keyCode]||a.key||a.keyCode;Je.input(i,a),clearTimeout(r),r=setTimeout(()=>{Je.hold=!0},$e.get("holdTimeout",Zn))},s=a=>{const i=Wr.get(a.code);i!==void 0&&typeof i=="function"&&(Wr.delete(a.code),i()),clearTimeout(r),Je.hold=!1},document.addEventListener("keydown",e),document.addEventListener("keyup",s),setTimeout(()=>Je.set(this))},Xs("App",o)},st={Component:Xs,Application:Ic,Launch:Kf,Plugin:al},Lc=()=>"0x"+Math.floor(Math.random()*16777215).toString(16)+"FF";function Qs(o,t){return Math.floor(Math.random()*(t-o+1))+o}const Pc=600,Fc=800,Bc=st.Component("Home",{code:{render:function(t,e,s,r,l,a){const i=[],n={};i[0]=this.element({parent:t||"root"},e),n.w=1920,n.h=1080,n.color="0xf0f0f0ff",i[0].populate(n),t=i[0];const c=[],h=(d=[],m,p)=>{const u=a(d),x=new Set;let T=u.length;for(;T--;){const R=u[T];x.add(""+R.key)}let b=p.length;for(;b--;)if(x.has(p[b])===!1){const R=p[b];m[1][R]&&m[1][R].destroy(),delete m[1][R]}p.length=0;const v=u.length;for(let R=0;R<v;R++){const w=Object.create(e);t=m[0],w.index=R,w.item=u[R],w.key=""+w.item.key,p.push(w.key),t=m[0],m[1]===void 0&&(m[1]={});const E={};m[1][w.key]===void 0&&(m[1][w.key]=this.element({parent:t||"root"},e)),E.w=w.item.width,E.h=w.item.height,E.x=w.item.x,E.y=w.item.y,E.color=w.item.color,E.effects=[{type:"radius",props:{radius:w.item.radius}}],m[1][w.key].nodeId===void 0&&m[1][w.key].populate(E);let S=()=>{m[1][w.key].set("w",w.item.width)};l(S,null),e[Symbol.for("effects")].push(S);let M=()=>{m[1][w.key].set("h",w.item.height)};l(M,null),e[Symbol.for("effects")].push(M);let I=()=>{m[1][w.key].set("x",w.item.x)};l(I,null),e[Symbol.for("effects")].push(I);let A=()=>{m[1][w.key].set("y",w.item.y)};l(A,null),e[Symbol.for("effects")].push(A);let B=()=>{m[1][w.key].set("color",w.item.color)};l(B,null),e[Symbol.for("effects")].push(B);let P=()=>{m[1][w.key].set("effects",[{type:"radius",props:{radius:w.item.radius}}])};l(P,null),e[Symbol.for("effects")].push(P)}};return l(()=>{h(e.items,i,c)},"items"),i},effects:[],context:{}},state(){return{items:new Array}},hooks:{init(){setInterval(()=>{const o=[];for(let t=0;t<1e3;t++)o.push({key:t,width:Qs(50,100),height:Qs(50,100),x:Qs(0,Fc),y:Qs(0,Pc),radius:Qs(0,50),color:Lc()});this.items=o},2e3)}}}),fl=st.Component("Tile",{code:{render:function(t,e,s,r,l,a){const i=[],n={};return i[0]=this.element({parent:t||"root"},e),n.y=e.y,n.x=e.x,n.w=e.w,n.h=e.h,n.color=e.color,n.effects=[{type:"radius",props:{radius:e.radius}}],i[0].populate(n),i},effects:[function(t,e,s,r,l,a){e[0].set("y",t.y)},function(t,e,s,r,l,a){e[0].set("x",t.x)},function(t,e,s,r,l,a){e[0].set("w",t.w)},function(t,e,s,r,l,a){e[0].set("h",t.h)},function(t,e,s,r,l,a){e[0].set("color",t.color)},function(t,e,s,r,l,a){e[0].set("effects",[{type:"radius",props:{radius:t.radius}}])}],context:{}},props:["x","y","w","h","radius","color"]}),Oc=()=>"0x"+Math.floor(Math.random()*16777215).toString(16)+"FF";function Js(o,t){return Math.floor(Math.random()*(t-o+1))+o}const Uc=600,$c=800,Dc=st.Component("TilePage",{components:{Tile:fl},code:{render:function(t,e,s,r,l,a){const i=[];let n,c;const h={};i[0]=this.element({parent:t||"root"},e),h.w=1920,h.h=1080,h.color="0xf0f0f0ff",i[0].populate(h),t=i[0];const d=[],m=(p=[],u,x)=>{const T=a(p),b=new Set;let v=T.length;for(;v--;){const E=T[v];b.add(""+E.key)}let R=x.length;for(;R--;)if(b.has(x[R])===!1){const E=x[R];u[1][E]&&u[1][E].destroy(),delete u[1][E],u[2][E]&&u[2][E].destroy(),delete u[2][E]}x.length=0;const w=T.length;for(let E=0;E<w;E++){const S=Object.create(e);t=u[0],S.index=E,S.item=T[E],S.key=""+S.item.key,x.push(S.key);const M=s.components&&s.components.Tile||r.Tile;u[1]===void 0&&(u[1]={});const I={};u[1][S.key]===void 0&&(u[1][S.key]=this.element({parent:t||"root"},e)),I.w=S.item.width,I.h=S.item.height,I.x=S.item.x,I.y=S.item.y,I.radius=S.item.radius;const A=[];if(typeof M<"u")for(let _ in M.config.props)delete I[M.config.props[_]],A.push(M.config.props[_]);u[1][S.key].nodeId===void 0&&u[1][S.key].populate(I),u[2]===void 0&&(u[2]={}),t=u[1][S.key];const B={};if(u[2][S.key]===void 0){c=S.item.width,Array.isArray(c)===!0&&(c=a(c).slice(0)),B.w=c,c=S.item.height,Array.isArray(c)===!0&&(c=a(c).slice(0)),B.h=c,c=S.item.x,Array.isArray(c)===!0&&(c=a(c).slice(0)),B.x=c,c=S.item.y,Array.isArray(c)===!0&&(c=a(c).slice(0)),B.y=c,c=S.item.color,Array.isArray(c)===!0&&(c=a(c).slice(0)),B.color=c,c=S.item.radius,Array.isArray(c)===!0&&(c=a(c).slice(0)),B.radius=c,n=B.is||"Tile";let _;if(typeof n=="string"){if(_=s.components&&s.components[n]||r[n],!_)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(_=n);u[2][S.key]=_.call(null,{props:B},u[1][S.key],e),u[2][S.key][Symbol.for("slots")][0]?(t=u[2][S.key][Symbol.for("slots")][0],e=u[2][S.key]):t=u[2][S.key][Symbol.for("children")][0]}let P=()=>{(typeof A>"u"||A.indexOf("w")===-1)&&u[1][S.key].set("w",S.item.width)};l(P,null),e[Symbol.for("effects")].push(P);let N=()=>{(typeof A>"u"||A.indexOf("h")===-1)&&u[1][S.key].set("h",S.item.height)};l(N,null),e[Symbol.for("effects")].push(N);let z=()=>{(typeof A>"u"||A.indexOf("x")===-1)&&u[1][S.key].set("x",S.item.x)};l(z,null),e[Symbol.for("effects")].push(z);let $=()=>{(typeof A>"u"||A.indexOf("y")===-1)&&u[1][S.key].set("y",S.item.y)};l($,null),e[Symbol.for("effects")].push($);let F=()=>{(typeof A>"u"||A.indexOf("radius")===-1)&&u[1][S.key].set("radius",S.item.radius)};l(F,null),e[Symbol.for("effects")].push(F),u[2][S.key][Symbol.for("props")].w=S.item.width,u[2][S.key][Symbol.for("props")].h=S.item.height,u[2][S.key][Symbol.for("props")].x=S.item.x,u[2][S.key][Symbol.for("props")].y=S.item.y,u[2][S.key][Symbol.for("props")].color=S.item.color,u[2][S.key][Symbol.for("props")].radius=S.item.radius}};return l(()=>{m(e.items,i,d)},"items"),i},effects:[],context:{}},state(){return{items:new Array}},hooks:{init(){setInterval(()=>{const o=[];for(let t=0;t<1e3;t++)o.push({key:t,width:Js(50,100),height:Js(50,100),x:Js(0,$c),y:Js(0,Uc),radius:Js(0,50),color:Oc()});this.items=o},2e3)}}}),Nc=st.Component("TileOne",{code:{render:function(t,e,s,r,l,a){const i=[],n={};return i[0]=this.element({parent:t||"root"},e),n.y=e.item.y,n.x=e.item.x,n.w=e.item.width,n.h=e.item.height,n.color=e.item.color,n.effects=[{type:"radius",props:{radius:e.item.radius}}],i[0].populate(n),i},effects:[function(t,e,s,r,l,a){e[0].set("y",t.item.y)},function(t,e,s,r,l,a){e[0].set("x",t.item.x)},function(t,e,s,r,l,a){e[0].set("w",t.item.width)},function(t,e,s,r,l,a){e[0].set("h",t.item.height)},function(t,e,s,r,l,a){e[0].set("color",t.item.color)},function(t,e,s,r,l,a){e[0].set("effects",[{type:"radius",props:{radius:t.item.radius}}])}],context:{}},props:["item"]}),Gc=()=>"0x"+Math.floor(Math.random()*16777215).toString(16)+"FF";function eo(o,t){return Math.floor(Math.random()*(t-o+1))+o}const zc=600,Wc=800,Vc=st.Component("TileOnePage",{components:{TileOne:Nc},code:{render:function(t,e,s,r,l,a){const i=[];let n,c;const h={};i[0]=this.element({parent:t||"root"},e),h.w=1920,h.h=1080,h.color="0xf0f0f0ff",i[0].populate(h),t=i[0];const d=[],m=(p=[],u,x)=>{const T=a(p),b=new Set;let v=T.length;for(;v--;){const E=T[v];b.add(""+E.key)}let R=x.length;for(;R--;)if(b.has(x[R])===!1){const E=x[R];u[1][E]&&u[1][E].destroy(),delete u[1][E],u[2][E]&&u[2][E].destroy(),delete u[2][E]}x.length=0;const w=T.length;for(let E=0;E<w;E++){const S=Object.create(e);t=u[0],S.index=E,S.item=T[E],S.key=""+S.item.key,x.push(S.key);const M=s.components&&s.components.TileOne||r.TileOne;u[1]===void 0&&(u[1]={});const I={};u[1][S.key]===void 0&&(u[1][S.key]=this.element({parent:t||"root"},e)),I.item=S.item;const A=[];if(typeof M<"u")for(let P in M.config.props)delete I[M.config.props[P]],A.push(M.config.props[P]);u[1][S.key].nodeId===void 0&&u[1][S.key].populate(I),u[2]===void 0&&(u[2]={}),t=u[1][S.key];const B={};if(u[2][S.key]===void 0){c=S.item,Array.isArray(c)===!0&&(c=a(c).slice(0)),B.item=c,n=B.is||"TileOne";let P;if(typeof n=="string"){if(P=s.components&&s.components[n]||r[n],!P)throw new Error('Component "TileOne" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(P=n);u[2][S.key]=P.call(null,{props:B},u[1][S.key],e),u[2][S.key][Symbol.for("slots")][0]?(t=u[2][S.key][Symbol.for("slots")][0],e=u[2][S.key]):t=u[2][S.key][Symbol.for("children")][0]}}};return l(()=>{m(e.items,i,d)},"items"),l(()=>{e.item;for(let p=0;p<e.items.length;p++){const u={};u.index=p,u.item=e.items[p],u.key=u.item.key,(typeof skip1>"u"||skip1.indexOf("item")===-1)&&i[1][u.key].set("item",u.item)}}),l(()=>{e.item;for(let p=0;p<e.items.length;p++){const u={};u.index=p,u.item=e.items[p],u.key=u.item.key,i[2][u.key][Symbol.for("props")].item=u.item}}),i},effects:[],context:{}},state(){return{items:new Array}},hooks:{init(){setInterval(()=>{const o=[];for(let t=0;t<1e3;t++)o.push({key:t,width:eo(50,100),height:eo(50,100),x:eo(0,Wc),y:eo(0,zc),radius:eo(0,50),color:Gc()});this.items=o},2e3)}}}),Xc=st.Application({code:{render:function(t,e,s,r,l,a){const i=[];let n;const c={};i[0]=this.element({parent:t||"root"},e),c.w=1920,c.h=1080,c.color="0x797777ff",i[0].populate(c);const h=s.components&&s.components.Tile||r.Tile;t=i[0];const d={};i[1]=this.element({parent:t||"root"},e),d.width=35,d.height=26,d.x=475,d.y=78,d.radius=62;const m=[];if(typeof h<"u")for(let y in h.config.props)delete d[h.config.props[y]],m.push(h.config.props[y]);i[1].populate(d),t=i[1];const p={};p.width=35,p.height=26,p.x=475,p.y=78,p.radius=62,n=p.is||"Tile";let u;if(typeof n=="string"){if(u=s.components&&s.components[n]||r[n],!u)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(u=n);i[2]=u.call(null,{props:p},i[1],e),i[2][Symbol.for("slots")][0]?(t=i[2][Symbol.for("slots")][0],e=i[2]):t=i[2][Symbol.for("children")][0];const x=s.components&&s.components.Tile||r.Tile;t=i[0];const T={};i[3]=this.element({parent:t||"root"},e),T.width=28,T.height=57,T.x=547,T.y=277,T.radius=66;const b=[];if(typeof x<"u")for(let y in x.config.props)delete T[x.config.props[y]],b.push(x.config.props[y]);i[3].populate(T),t=i[3];const v={};v.width=28,v.height=57,v.x=547,v.y=277,v.radius=66,n=v.is||"Tile";let R;if(typeof n=="string"){if(R=s.components&&s.components[n]||r[n],!R)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(R=n);i[4]=R.call(null,{props:v},i[3],e),i[4][Symbol.for("slots")][0]?(t=i[4][Symbol.for("slots")][0],e=i[4]):t=i[4][Symbol.for("children")][0];const w=s.components&&s.components.Tile||r.Tile;t=i[0];const E={};i[5]=this.element({parent:t||"root"},e),E.width=41,E.height=41,E.x=768,E.y=869,E.radius=51;const S=[];if(typeof w<"u")for(let y in w.config.props)delete E[w.config.props[y]],S.push(w.config.props[y]);i[5].populate(E),t=i[5];const M={};M.width=41,M.height=41,M.x=768,M.y=869,M.radius=51,n=M.is||"Tile";let I;if(typeof n=="string"){if(I=s.components&&s.components[n]||r[n],!I)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(I=n);i[6]=I.call(null,{props:M},i[5],e),i[6][Symbol.for("slots")][0]?(t=i[6][Symbol.for("slots")][0],e=i[6]):t=i[6][Symbol.for("children")][0];const A=s.components&&s.components.Tile||r.Tile;t=i[0];const B={};i[7]=this.element({parent:t||"root"},e),B.width=69,B.height=66,B.x=613,B.y=130,B.radius=25;const P=[];if(typeof A<"u")for(let y in A.config.props)delete B[A.config.props[y]],P.push(A.config.props[y]);i[7].populate(B),t=i[7];const N={};N.width=69,N.height=66,N.x=613,N.y=130,N.radius=25,n=N.is||"Tile";let z;if(typeof n=="string"){if(z=s.components&&s.components[n]||r[n],!z)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(z=n);i[8]=z.call(null,{props:N},i[7],e),i[8][Symbol.for("slots")][0]?(t=i[8][Symbol.for("slots")][0],e=i[8]):t=i[8][Symbol.for("children")][0];const $=s.components&&s.components.Tile||r.Tile;t=i[0];const F={};i[9]=this.element({parent:t||"root"},e),F.width=25,F.height=61,F.x=953,F.y=416,F.radius=52;const _=[];if(typeof $<"u")for(let y in $.config.props)delete F[$.config.props[y]],_.push($.config.props[y]);i[9].populate(F),t=i[9];const k={};k.width=25,k.height=61,k.x=953,k.y=416,k.radius=52,n=k.is||"Tile";let V;if(typeof n=="string"){if(V=s.components&&s.components[n]||r[n],!V)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(V=n);i[10]=V.call(null,{props:k},i[9],e),i[10][Symbol.for("slots")][0]?(t=i[10][Symbol.for("slots")][0],e=i[10]):t=i[10][Symbol.for("children")][0];const W=s.components&&s.components.Tile||r.Tile;t=i[0];const D={};i[11]=this.element({parent:t||"root"},e),D.width=66,D.height=40,D.x=284,D.y=55,D.radius=36;const Y=[];if(typeof W<"u")for(let y in W.config.props)delete D[W.config.props[y]],Y.push(W.config.props[y]);i[11].populate(D),t=i[11];const U={};U.width=66,U.height=40,U.x=284,U.y=55,U.radius=36,n=U.is||"Tile";let K;if(typeof n=="string"){if(K=s.components&&s.components[n]||r[n],!K)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(K=n);i[12]=K.call(null,{props:U},i[11],e),i[12][Symbol.for("slots")][0]?(t=i[12][Symbol.for("slots")][0],e=i[12]):t=i[12][Symbol.for("children")][0];const me=s.components&&s.components.Tile||r.Tile;t=i[0];const j={};i[13]=this.element({parent:t||"root"},e),j.width=69,j.height=44,j.x=23,j.y=879,j.radius=66;const q=[];if(typeof me<"u")for(let y in me.config.props)delete j[me.config.props[y]],q.push(me.config.props[y]);i[13].populate(j),t=i[13];const Q={};Q.width=69,Q.height=44,Q.x=23,Q.y=879,Q.radius=66,n=Q.is||"Tile";let X;if(typeof n=="string"){if(X=s.components&&s.components[n]||r[n],!X)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(X=n);i[14]=X.call(null,{props:Q},i[13],e),i[14][Symbol.for("slots")][0]?(t=i[14][Symbol.for("slots")][0],e=i[14]):t=i[14][Symbol.for("children")][0];const ge=s.components&&s.components.Tile||r.Tile;t=i[0];const ee={};i[15]=this.element({parent:t||"root"},e),ee.width=56,ee.height=23,ee.x=484,ee.y=349,ee.radius=25;const J=[];if(typeof ge<"u")for(let y in ge.config.props)delete ee[ge.config.props[y]],J.push(ge.config.props[y]);i[15].populate(ee),t=i[15];const H={};H.width=56,H.height=23,H.x=484,H.y=349,H.radius=25,n=H.is||"Tile";let ye;if(typeof n=="string"){if(ye=s.components&&s.components[n]||r[n],!ye)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ye=n);i[16]=ye.call(null,{props:H},i[15],e),i[16][Symbol.for("slots")][0]?(t=i[16][Symbol.for("slots")][0],e=i[16]):t=i[16][Symbol.for("children")][0];const xe=s.components&&s.components.Tile||r.Tile;t=i[0];const te={};i[17]=this.element({parent:t||"root"},e),te.width=23,te.height=33,te.x=441,te.y=601,te.radius=34;const Te=[];if(typeof xe<"u")for(let y in xe.config.props)delete te[xe.config.props[y]],Te.push(xe.config.props[y]);i[17].populate(te),t=i[17];const Se={};Se.width=23,Se.height=33,Se.x=441,Se.y=601,Se.radius=34,n=Se.is||"Tile";let se;if(typeof n=="string"){if(se=s.components&&s.components[n]||r[n],!se)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(se=n);i[18]=se.call(null,{props:Se},i[17],e),i[18][Symbol.for("slots")][0]?(t=i[18][Symbol.for("slots")][0],e=i[18]):t=i[18][Symbol.for("children")][0];const Ae=s.components&&s.components.Tile||r.Tile;t=i[0];const we={};i[19]=this.element({parent:t||"root"},e),we.width=42,we.height=54,we.x=853,we.y=840,we.radius=72;const bs=[];if(typeof Ae<"u")for(let y in Ae.config.props)delete we[Ae.config.props[y]],bs.push(Ae.config.props[y]);i[19].populate(we),t=i[19];const ie={};ie.width=42,ie.height=54,ie.x=853,ie.y=840,ie.radius=72,n=ie.is||"Tile";let Ss;if(typeof n=="string"){if(Ss=s.components&&s.components[n]||r[n],!Ss)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ss=n);i[20]=Ss.call(null,{props:ie},i[19],e),i[20][Symbol.for("slots")][0]?(t=i[20][Symbol.for("slots")][0],e=i[20]):t=i[20][Symbol.for("children")][0];const Ce=s.components&&s.components.Tile||r.Tile;t=i[0];const Me={};i[21]=this.element({parent:t||"root"},e),Me.width=25,Me.height=51,Me.x=132,Me.y=218,Me.radius=44;const Hs=[];if(typeof Ce<"u")for(let y in Ce.config.props)delete Me[Ce.config.props[y]],Hs.push(Ce.config.props[y]);i[21].populate(Me),t=i[21];const ke={};ke.width=25,ke.height=51,ke.x=132,ke.y=218,ke.radius=44,n=ke.is||"Tile";let ve;if(typeof n=="string"){if(ve=s.components&&s.components[n]||r[n],!ve)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ve=n);i[22]=ve.call(null,{props:ke},i[21],e),i[22][Symbol.for("slots")][0]?(t=i[22][Symbol.for("slots")][0],e=i[22]):t=i[22][Symbol.for("children")][0];const ws=s.components&&s.components.Tile||r.Tile;t=i[0];const re={};i[23]=this.element({parent:t||"root"},e),re.width=61,re.height=22,re.x=757,re.y=43,re.radius=54;const Cs=[];if(typeof ws<"u")for(let y in ws.config.props)delete re[ws.config.props[y]],Cs.push(ws.config.props[y]);i[23].populate(re),t=i[23];const Ie={};Ie.width=61,Ie.height=22,Ie.x=757,Ie.y=43,Ie.radius=54,n=Ie.is||"Tile";let _e;if(typeof n=="string"){if(_e=s.components&&s.components[n]||r[n],!_e)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(_e=n);i[24]=_e.call(null,{props:Ie},i[23],e),i[24][Symbol.for("slots")][0]?(t=i[24][Symbol.for("slots")][0],e=i[24]):t=i[24][Symbol.for("children")][0];const vs=s.components&&s.components.Tile||r.Tile;t=i[0];const ne={};i[25]=this.element({parent:t||"root"},e),ne.width=49,ne.height=60,ne.x=506,ne.y=476,ne.radius=34;const _s=[];if(typeof vs<"u")for(let y in vs.config.props)delete ne[vs.config.props[y]],_s.push(vs.config.props[y]);i[25].populate(ne),t=i[25];const Le={};Le.width=49,Le.height=60,Le.x=506,Le.y=476,Le.radius=34,n=Le.is||"Tile";let Re;if(typeof n=="string"){if(Re=s.components&&s.components[n]||r[n],!Re)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Re=n);i[26]=Re.call(null,{props:Le},i[25],e),i[26][Symbol.for("slots")][0]?(t=i[26][Symbol.for("slots")][0],e=i[26]):t=i[26][Symbol.for("children")][0];const Rs=s.components&&s.components.Tile||r.Tile;t=i[0];const le={};i[27]=this.element({parent:t||"root"},e),le.width=30,le.height=67,le.x=35,le.y=646,le.radius=57;const Es=[];if(typeof Rs<"u")for(let y in Rs.config.props)delete le[Rs.config.props[y]],Es.push(Rs.config.props[y]);i[27].populate(le),t=i[27];const Be={};Be.width=30,Be.height=67,Be.x=35,Be.y=646,Be.radius=57,n=Be.is||"Tile";let De;if(typeof n=="string"){if(De=s.components&&s.components[n]||r[n],!De)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(De=n);i[28]=De.call(null,{props:Be},i[27],e),i[28][Symbol.for("slots")][0]?(t=i[28][Symbol.for("slots")][0],e=i[28]):t=i[28][Symbol.for("children")][0];const Pe=s.components&&s.components.Tile||r.Tile;t=i[0];const Ne={};i[29]=this.element({parent:t||"root"},e),Ne.width=44,Ne.height=54,Ne.x=779,Ne.y=677,Ne.radius=24;const Ge=[];if(typeof Pe<"u")for(let y in Pe.config.props)delete Ne[Pe.config.props[y]],Ge.push(Pe.config.props[y]);i[29].populate(Ne),t=i[29];const Fe={};Fe.width=44,Fe.height=54,Fe.x=779,Fe.y=677,Fe.radius=24,n=Fe.is||"Tile";let je;if(typeof n=="string"){if(je=s.components&&s.components[n]||r[n],!je)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(je=n);i[30]=je.call(null,{props:Fe},i[29],e),i[30][Symbol.for("slots")][0]?(t=i[30][Symbol.for("slots")][0],e=i[30]):t=i[30][Symbol.for("children")][0];const ze=s.components&&s.components.Tile||r.Tile;t=i[0];const ae={};i[31]=this.element({parent:t||"root"},e),ae.width=45,ae.height=36,ae.x=542,ae.y=288,ae.radius=53;const ur=[];if(typeof ze<"u")for(let y in ze.config.props)delete ae[ze.config.props[y]],ur.push(ze.config.props[y]);i[31].populate(ae),t=i[31];const fe={};fe.width=45,fe.height=36,fe.x=542,fe.y=288,fe.radius=53,n=fe.is||"Tile";let We;if(typeof n=="string"){if(We=s.components&&s.components[n]||r[n],!We)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(We=n);i[32]=We.call(null,{props:fe},i[31],e),i[32][Symbol.for("slots")][0]?(t=i[32][Symbol.for("slots")][0],e=i[32]):t=i[32][Symbol.for("children")][0];const Ve=s.components&&s.components.Tile||r.Tile;t=i[0];const ce={};i[33]=this.element({parent:t||"root"},e),ce.width=61,ce.height=61,ce.x=846,ce.y=361,ce.radius=67;const dr=[];if(typeof Ve<"u")for(let y in Ve.config.props)delete ce[Ve.config.props[y]],dr.push(Ve.config.props[y]);i[33].populate(ce),t=i[33];const he={};he.width=61,he.height=61,he.x=846,he.y=361,he.radius=67,n=he.is||"Tile";let Xe;if(typeof n=="string"){if(Xe=s.components&&s.components[n]||r[n],!Xe)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Xe=n);i[34]=Xe.call(null,{props:he},i[33],e),i[34][Symbol.for("slots")][0]?(t=i[34][Symbol.for("slots")][0],e=i[34]):t=i[34][Symbol.for("children")][0];const He=s.components&&s.components.Tile||r.Tile;t=i[0];const ue={};i[35]=this.element({parent:t||"root"},e),ue.width=51,ue.height=44,ue.x=507,ue.y=607,ue.radius=66;const pr=[];if(typeof He<"u")for(let y in He.config.props)delete ue[He.config.props[y]],pr.push(He.config.props[y]);i[35].populate(ue),t=i[35];const de={};de.width=51,de.height=44,de.x=507,de.y=607,de.radius=66,n=de.is||"Tile";let Ye;if(typeof n=="string"){if(Ye=s.components&&s.components[n]||r[n],!Ye)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ye=n);i[36]=Ye.call(null,{props:de},i[35],e),i[36][Symbol.for("slots")][0]?(t=i[36][Symbol.for("slots")][0],e=i[36]):t=i[36][Symbol.for("children")][0];const O=s.components&&s.components.Tile||r.Tile;t=i[0];const ot={};i[37]=this.element({parent:t||"root"},e),ot.width=36,ot.height=51,ot.x=52,ot.y=746,ot.radius=46;const cl=[];if(typeof O<"u")for(let y in O.config.props)delete ot[O.config.props[y]],cl.push(O.config.props[y]);i[37].populate(ot),t=i[37];const it={};it.width=36,it.height=51,it.x=52,it.y=746,it.radius=46,n=it.is||"Tile";let po;if(typeof n=="string"){if(po=s.components&&s.components[n]||r[n],!po)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(po=n);i[38]=po.call(null,{props:it},i[37],e),i[38][Symbol.for("slots")][0]?(t=i[38][Symbol.for("slots")][0],e=i[38]):t=i[38][Symbol.for("children")][0];const mo=s.components&&s.components.Tile||r.Tile;t=i[0];const rt={};i[39]=this.element({parent:t||"root"},e),rt.width=33,rt.height=39,rt.x=371,rt.y=69,rt.radius=25;const hl=[];if(typeof mo<"u")for(let y in mo.config.props)delete rt[mo.config.props[y]],hl.push(mo.config.props[y]);i[39].populate(rt),t=i[39];const nt={};nt.width=33,nt.height=39,nt.x=371,nt.y=69,nt.radius=25,n=nt.is||"Tile";let go;if(typeof n=="string"){if(go=s.components&&s.components[n]||r[n],!go)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(go=n);i[40]=go.call(null,{props:nt},i[39],e),i[40][Symbol.for("slots")][0]?(t=i[40][Symbol.for("slots")][0],e=i[40]):t=i[40][Symbol.for("children")][0];const yo=s.components&&s.components.Tile||r.Tile;t=i[0];const lt={};i[41]=this.element({parent:t||"root"},e),lt.width=24,lt.height=63,lt.x=955,lt.y=655,lt.radius=53;const ul=[];if(typeof yo<"u")for(let y in yo.config.props)delete lt[yo.config.props[y]],ul.push(yo.config.props[y]);i[41].populate(lt),t=i[41];const at={};at.width=24,at.height=63,at.x=955,at.y=655,at.radius=53,n=at.is||"Tile";let xo;if(typeof n=="string"){if(xo=s.components&&s.components[n]||r[n],!xo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(xo=n);i[42]=xo.call(null,{props:at},i[41],e),i[42][Symbol.for("slots")][0]?(t=i[42][Symbol.for("slots")][0],e=i[42]):t=i[42][Symbol.for("children")][0];const To=s.components&&s.components.Tile||r.Tile;t=i[0];const ft={};i[43]=this.element({parent:t||"root"},e),ft.width=39,ft.height=69,ft.x=271,ft.y=276,ft.radius=28;const dl=[];if(typeof To<"u")for(let y in To.config.props)delete ft[To.config.props[y]],dl.push(To.config.props[y]);i[43].populate(ft),t=i[43];const ct={};ct.width=39,ct.height=69,ct.x=271,ct.y=276,ct.radius=28,n=ct.is||"Tile";let bo;if(typeof n=="string"){if(bo=s.components&&s.components[n]||r[n],!bo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(bo=n);i[44]=bo.call(null,{props:ct},i[43],e),i[44][Symbol.for("slots")][0]?(t=i[44][Symbol.for("slots")][0],e=i[44]):t=i[44][Symbol.for("children")][0];const So=s.components&&s.components.Tile||r.Tile;t=i[0];const ht={};i[45]=this.element({parent:t||"root"},e),ht.width=71,ht.height=68,ht.x=417,ht.y=680,ht.radius=60;const pl=[];if(typeof So<"u")for(let y in So.config.props)delete ht[So.config.props[y]],pl.push(So.config.props[y]);i[45].populate(ht),t=i[45];const ut={};ut.width=71,ut.height=68,ut.x=417,ut.y=680,ut.radius=60,n=ut.is||"Tile";let wo;if(typeof n=="string"){if(wo=s.components&&s.components[n]||r[n],!wo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(wo=n);i[46]=wo.call(null,{props:ut},i[45],e),i[46][Symbol.for("slots")][0]?(t=i[46][Symbol.for("slots")][0],e=i[46]):t=i[46][Symbol.for("children")][0];const Co=s.components&&s.components.Tile||r.Tile;t=i[0];const dt={};i[47]=this.element({parent:t||"root"},e),dt.width=42,dt.height=38,dt.x=439,dt.y=231,dt.radius=52;const ml=[];if(typeof Co<"u")for(let y in Co.config.props)delete dt[Co.config.props[y]],ml.push(Co.config.props[y]);i[47].populate(dt),t=i[47];const pt={};pt.width=42,pt.height=38,pt.x=439,pt.y=231,pt.radius=52,n=pt.is||"Tile";let vo;if(typeof n=="string"){if(vo=s.components&&s.components[n]||r[n],!vo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(vo=n);i[48]=vo.call(null,{props:pt},i[47],e),i[48][Symbol.for("slots")][0]?(t=i[48][Symbol.for("slots")][0],e=i[48]):t=i[48][Symbol.for("children")][0];const _o=s.components&&s.components.Tile||r.Tile;t=i[0];const mt={};i[49]=this.element({parent:t||"root"},e),mt.width=27,mt.height=39,mt.x=866,mt.y=568,mt.radius=47;const gl=[];if(typeof _o<"u")for(let y in _o.config.props)delete mt[_o.config.props[y]],gl.push(_o.config.props[y]);i[49].populate(mt),t=i[49];const gt={};gt.width=27,gt.height=39,gt.x=866,gt.y=568,gt.radius=47,n=gt.is||"Tile";let Ro;if(typeof n=="string"){if(Ro=s.components&&s.components[n]||r[n],!Ro)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ro=n);i[50]=Ro.call(null,{props:gt},i[49],e),i[50][Symbol.for("slots")][0]?(t=i[50][Symbol.for("slots")][0],e=i[50]):t=i[50][Symbol.for("children")][0];const Eo=s.components&&s.components.Tile||r.Tile;t=i[0];const yt={};i[51]=this.element({parent:t||"root"},e),yt.width=40,yt.height=53,yt.x=967,yt.y=39,yt.radius=21;const yl=[];if(typeof Eo<"u")for(let y in Eo.config.props)delete yt[Eo.config.props[y]],yl.push(Eo.config.props[y]);i[51].populate(yt),t=i[51];const xt={};xt.width=40,xt.height=53,xt.x=967,xt.y=39,xt.radius=21,n=xt.is||"Tile";let Ao;if(typeof n=="string"){if(Ao=s.components&&s.components[n]||r[n],!Ao)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ao=n);i[52]=Ao.call(null,{props:xt},i[51],e),i[52][Symbol.for("slots")][0]?(t=i[52][Symbol.for("slots")][0],e=i[52]):t=i[52][Symbol.for("children")][0];const Mo=s.components&&s.components.Tile||r.Tile;t=i[0];const Tt={};i[53]=this.element({parent:t||"root"},e),Tt.width=24,Tt.height=30,Tt.x=777,Tt.y=195,Tt.radius=37;const xl=[];if(typeof Mo<"u")for(let y in Mo.config.props)delete Tt[Mo.config.props[y]],xl.push(Mo.config.props[y]);i[53].populate(Tt),t=i[53];const bt={};bt.width=24,bt.height=30,bt.x=777,bt.y=195,bt.radius=37,n=bt.is||"Tile";let ko;if(typeof n=="string"){if(ko=s.components&&s.components[n]||r[n],!ko)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ko=n);i[54]=ko.call(null,{props:bt},i[53],e),i[54][Symbol.for("slots")][0]?(t=i[54][Symbol.for("slots")][0],e=i[54]):t=i[54][Symbol.for("children")][0];const Io=s.components&&s.components.Tile||r.Tile;t=i[0];const St={};i[55]=this.element({parent:t||"root"},e),St.width=41,St.height=58,St.x=119,St.y=725,St.radius=71;const Tl=[];if(typeof Io<"u")for(let y in Io.config.props)delete St[Io.config.props[y]],Tl.push(Io.config.props[y]);i[55].populate(St),t=i[55];const wt={};wt.width=41,wt.height=58,wt.x=119,wt.y=725,wt.radius=71,n=wt.is||"Tile";let Lo;if(typeof n=="string"){if(Lo=s.components&&s.components[n]||r[n],!Lo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Lo=n);i[56]=Lo.call(null,{props:wt},i[55],e),i[56][Symbol.for("slots")][0]?(t=i[56][Symbol.for("slots")][0],e=i[56]):t=i[56][Symbol.for("children")][0];const Po=s.components&&s.components.Tile||r.Tile;t=i[0];const Ct={};i[57]=this.element({parent:t||"root"},e),Ct.width=24,Ct.height=53,Ct.x=215,Ct.y=937,Ct.radius=45;const bl=[];if(typeof Po<"u")for(let y in Po.config.props)delete Ct[Po.config.props[y]],bl.push(Po.config.props[y]);i[57].populate(Ct),t=i[57];const vt={};vt.width=24,vt.height=53,vt.x=215,vt.y=937,vt.radius=45,n=vt.is||"Tile";let Fo;if(typeof n=="string"){if(Fo=s.components&&s.components[n]||r[n],!Fo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Fo=n);i[58]=Fo.call(null,{props:vt},i[57],e),i[58][Symbol.for("slots")][0]?(t=i[58][Symbol.for("slots")][0],e=i[58]):t=i[58][Symbol.for("children")][0];const Bo=s.components&&s.components.Tile||r.Tile;t=i[0];const _t={};i[59]=this.element({parent:t||"root"},e),_t.width=44,_t.height=59,_t.x=184,_t.y=204,_t.radius=61;const Sl=[];if(typeof Bo<"u")for(let y in Bo.config.props)delete _t[Bo.config.props[y]],Sl.push(Bo.config.props[y]);i[59].populate(_t),t=i[59];const Rt={};Rt.width=44,Rt.height=59,Rt.x=184,Rt.y=204,Rt.radius=61,n=Rt.is||"Tile";let Oo;if(typeof n=="string"){if(Oo=s.components&&s.components[n]||r[n],!Oo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Oo=n);i[60]=Oo.call(null,{props:Rt},i[59],e),i[60][Symbol.for("slots")][0]?(t=i[60][Symbol.for("slots")][0],e=i[60]):t=i[60][Symbol.for("children")][0];const Uo=s.components&&s.components.Tile||r.Tile;t=i[0];const Et={};i[61]=this.element({parent:t||"root"},e),Et.width=66,Et.height=67,Et.x=399,Et.y=191,Et.radius=36;const wl=[];if(typeof Uo<"u")for(let y in Uo.config.props)delete Et[Uo.config.props[y]],wl.push(Uo.config.props[y]);i[61].populate(Et),t=i[61];const At={};At.width=66,At.height=67,At.x=399,At.y=191,At.radius=36,n=At.is||"Tile";let $o;if(typeof n=="string"){if($o=s.components&&s.components[n]||r[n],!$o)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&($o=n);i[62]=$o.call(null,{props:At},i[61],e),i[62][Symbol.for("slots")][0]?(t=i[62][Symbol.for("slots")][0],e=i[62]):t=i[62][Symbol.for("children")][0];const Do=s.components&&s.components.Tile||r.Tile;t=i[0];const Mt={};i[63]=this.element({parent:t||"root"},e),Mt.width=25,Mt.height=25,Mt.x=268,Mt.y=451,Mt.radius=22;const Cl=[];if(typeof Do<"u")for(let y in Do.config.props)delete Mt[Do.config.props[y]],Cl.push(Do.config.props[y]);i[63].populate(Mt),t=i[63];const kt={};kt.width=25,kt.height=25,kt.x=268,kt.y=451,kt.radius=22,n=kt.is||"Tile";let No;if(typeof n=="string"){if(No=s.components&&s.components[n]||r[n],!No)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(No=n);i[64]=No.call(null,{props:kt},i[63],e),i[64][Symbol.for("slots")][0]?(t=i[64][Symbol.for("slots")][0],e=i[64]):t=i[64][Symbol.for("children")][0];const Go=s.components&&s.components.Tile||r.Tile;t=i[0];const It={};i[65]=this.element({parent:t||"root"},e),It.width=21,It.height=24,It.x=993,It.y=99,It.radius=45;const vl=[];if(typeof Go<"u")for(let y in Go.config.props)delete It[Go.config.props[y]],vl.push(Go.config.props[y]);i[65].populate(It),t=i[65];const Lt={};Lt.width=21,Lt.height=24,Lt.x=993,Lt.y=99,Lt.radius=45,n=Lt.is||"Tile";let zo;if(typeof n=="string"){if(zo=s.components&&s.components[n]||r[n],!zo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(zo=n);i[66]=zo.call(null,{props:Lt},i[65],e),i[66][Symbol.for("slots")][0]?(t=i[66][Symbol.for("slots")][0],e=i[66]):t=i[66][Symbol.for("children")][0];const Wo=s.components&&s.components.Tile||r.Tile;t=i[0];const Pt={};i[67]=this.element({parent:t||"root"},e),Pt.width=67,Pt.height=45,Pt.x=922,Pt.y=388,Pt.radius=25;const _l=[];if(typeof Wo<"u")for(let y in Wo.config.props)delete Pt[Wo.config.props[y]],_l.push(Wo.config.props[y]);i[67].populate(Pt),t=i[67];const Ft={};Ft.width=67,Ft.height=45,Ft.x=922,Ft.y=388,Ft.radius=25,n=Ft.is||"Tile";let Vo;if(typeof n=="string"){if(Vo=s.components&&s.components[n]||r[n],!Vo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Vo=n);i[68]=Vo.call(null,{props:Ft},i[67],e),i[68][Symbol.for("slots")][0]?(t=i[68][Symbol.for("slots")][0],e=i[68]):t=i[68][Symbol.for("children")][0];const Xo=s.components&&s.components.Tile||r.Tile;t=i[0];const Bt={};i[69]=this.element({parent:t||"root"},e),Bt.width=66,Bt.height=69,Bt.x=883,Bt.y=894,Bt.radius=21;const Rl=[];if(typeof Xo<"u")for(let y in Xo.config.props)delete Bt[Xo.config.props[y]],Rl.push(Xo.config.props[y]);i[69].populate(Bt),t=i[69];const Ot={};Ot.width=66,Ot.height=69,Ot.x=883,Ot.y=894,Ot.radius=21,n=Ot.is||"Tile";let Ho;if(typeof n=="string"){if(Ho=s.components&&s.components[n]||r[n],!Ho)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ho=n);i[70]=Ho.call(null,{props:Ot},i[69],e),i[70][Symbol.for("slots")][0]?(t=i[70][Symbol.for("slots")][0],e=i[70]):t=i[70][Symbol.for("children")][0];const Yo=s.components&&s.components.Tile||r.Tile;t=i[0];const Ut={};i[71]=this.element({parent:t||"root"},e),Ut.width=59,Ut.height=57,Ut.x=155,Ut.y=268,Ut.radius=36;const El=[];if(typeof Yo<"u")for(let y in Yo.config.props)delete Ut[Yo.config.props[y]],El.push(Yo.config.props[y]);i[71].populate(Ut),t=i[71];const $t={};$t.width=59,$t.height=57,$t.x=155,$t.y=268,$t.radius=36,n=$t.is||"Tile";let Ko;if(typeof n=="string"){if(Ko=s.components&&s.components[n]||r[n],!Ko)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ko=n);i[72]=Ko.call(null,{props:$t},i[71],e),i[72][Symbol.for("slots")][0]?(t=i[72][Symbol.for("slots")][0],e=i[72]):t=i[72][Symbol.for("children")][0];const jo=s.components&&s.components.Tile||r.Tile;t=i[0];const Dt={};i[73]=this.element({parent:t||"root"},e),Dt.width=56,Dt.height=36,Dt.x=567,Dt.y=741,Dt.radius=43;const Al=[];if(typeof jo<"u")for(let y in jo.config.props)delete Dt[jo.config.props[y]],Al.push(jo.config.props[y]);i[73].populate(Dt),t=i[73];const Nt={};Nt.width=56,Nt.height=36,Nt.x=567,Nt.y=741,Nt.radius=43,n=Nt.is||"Tile";let qo;if(typeof n=="string"){if(qo=s.components&&s.components[n]||r[n],!qo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(qo=n);i[74]=qo.call(null,{props:Nt},i[73],e),i[74][Symbol.for("slots")][0]?(t=i[74][Symbol.for("slots")][0],e=i[74]):t=i[74][Symbol.for("children")][0];const Zo=s.components&&s.components.Tile||r.Tile;t=i[0];const Gt={};i[75]=this.element({parent:t||"root"},e),Gt.width=24,Gt.height=34,Gt.x=866,Gt.y=747,Gt.radius=67;const Ml=[];if(typeof Zo<"u")for(let y in Zo.config.props)delete Gt[Zo.config.props[y]],Ml.push(Zo.config.props[y]);i[75].populate(Gt),t=i[75];const zt={};zt.width=24,zt.height=34,zt.x=866,zt.y=747,zt.radius=67,n=zt.is||"Tile";let Qo;if(typeof n=="string"){if(Qo=s.components&&s.components[n]||r[n],!Qo)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Qo=n);i[76]=Qo.call(null,{props:zt},i[75],e),i[76][Symbol.for("slots")][0]?(t=i[76][Symbol.for("slots")][0],e=i[76]):t=i[76][Symbol.for("children")][0];const Jo=s.components&&s.components.Tile||r.Tile;t=i[0];const Wt={};i[77]=this.element({parent:t||"root"},e),Wt.width=38,Wt.height=45,Wt.x=141,Wt.y=401,Wt.radius=34;const kl=[];if(typeof Jo<"u")for(let y in Jo.config.props)delete Wt[Jo.config.props[y]],kl.push(Jo.config.props[y]);i[77].populate(Wt),t=i[77];const Vt={};Vt.width=38,Vt.height=45,Vt.x=141,Vt.y=401,Vt.radius=34,n=Vt.is||"Tile";let ei;if(typeof n=="string"){if(ei=s.components&&s.components[n]||r[n],!ei)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ei=n);i[78]=ei.call(null,{props:Vt},i[77],e),i[78][Symbol.for("slots")][0]?(t=i[78][Symbol.for("slots")][0],e=i[78]):t=i[78][Symbol.for("children")][0];const ti=s.components&&s.components.Tile||r.Tile;t=i[0];const Xt={};i[79]=this.element({parent:t||"root"},e),Xt.width=38,Xt.height=62,Xt.x=381,Xt.y=777,Xt.radius=35;const Il=[];if(typeof ti<"u")for(let y in ti.config.props)delete Xt[ti.config.props[y]],Il.push(ti.config.props[y]);i[79].populate(Xt),t=i[79];const Ht={};Ht.width=38,Ht.height=62,Ht.x=381,Ht.y=777,Ht.radius=35,n=Ht.is||"Tile";let si;if(typeof n=="string"){if(si=s.components&&s.components[n]||r[n],!si)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(si=n);i[80]=si.call(null,{props:Ht},i[79],e),i[80][Symbol.for("slots")][0]?(t=i[80][Symbol.for("slots")][0],e=i[80]):t=i[80][Symbol.for("children")][0];const oi=s.components&&s.components.Tile||r.Tile;t=i[0];const Yt={};i[81]=this.element({parent:t||"root"},e),Yt.width=24,Yt.height=67,Yt.x=63,Yt.y=222,Yt.radius=54;const Ll=[];if(typeof oi<"u")for(let y in oi.config.props)delete Yt[oi.config.props[y]],Ll.push(oi.config.props[y]);i[81].populate(Yt),t=i[81];const Kt={};Kt.width=24,Kt.height=67,Kt.x=63,Kt.y=222,Kt.radius=54,n=Kt.is||"Tile";let ii;if(typeof n=="string"){if(ii=s.components&&s.components[n]||r[n],!ii)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ii=n);i[82]=ii.call(null,{props:Kt},i[81],e),i[82][Symbol.for("slots")][0]?(t=i[82][Symbol.for("slots")][0],e=i[82]):t=i[82][Symbol.for("children")][0];const ri=s.components&&s.components.Tile||r.Tile;t=i[0];const jt={};i[83]=this.element({parent:t||"root"},e),jt.width=28,jt.height=25,jt.x=951,jt.y=499,jt.radius=24;const Pl=[];if(typeof ri<"u")for(let y in ri.config.props)delete jt[ri.config.props[y]],Pl.push(ri.config.props[y]);i[83].populate(jt),t=i[83];const qt={};qt.width=28,qt.height=25,qt.x=951,qt.y=499,qt.radius=24,n=qt.is||"Tile";let ni;if(typeof n=="string"){if(ni=s.components&&s.components[n]||r[n],!ni)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ni=n);i[84]=ni.call(null,{props:qt},i[83],e),i[84][Symbol.for("slots")][0]?(t=i[84][Symbol.for("slots")][0],e=i[84]):t=i[84][Symbol.for("children")][0];const li=s.components&&s.components.Tile||r.Tile;t=i[0];const Zt={};i[85]=this.element({parent:t||"root"},e),Zt.width=69,Zt.height=70,Zt.x=813,Zt.y=738,Zt.radius=58;const Fl=[];if(typeof li<"u")for(let y in li.config.props)delete Zt[li.config.props[y]],Fl.push(li.config.props[y]);i[85].populate(Zt),t=i[85];const Qt={};Qt.width=69,Qt.height=70,Qt.x=813,Qt.y=738,Qt.radius=58,n=Qt.is||"Tile";let ai;if(typeof n=="string"){if(ai=s.components&&s.components[n]||r[n],!ai)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ai=n);i[86]=ai.call(null,{props:Qt},i[85],e),i[86][Symbol.for("slots")][0]?(t=i[86][Symbol.for("slots")][0],e=i[86]):t=i[86][Symbol.for("children")][0];const fi=s.components&&s.components.Tile||r.Tile;t=i[0];const Jt={};i[87]=this.element({parent:t||"root"},e),Jt.width=37,Jt.height=42,Jt.x=109,Jt.y=870,Jt.radius=49;const Bl=[];if(typeof fi<"u")for(let y in fi.config.props)delete Jt[fi.config.props[y]],Bl.push(fi.config.props[y]);i[87].populate(Jt),t=i[87];const es={};es.width=37,es.height=42,es.x=109,es.y=870,es.radius=49,n=es.is||"Tile";let ci;if(typeof n=="string"){if(ci=s.components&&s.components[n]||r[n],!ci)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ci=n);i[88]=ci.call(null,{props:es},i[87],e),i[88][Symbol.for("slots")][0]?(t=i[88][Symbol.for("slots")][0],e=i[88]):t=i[88][Symbol.for("children")][0];const hi=s.components&&s.components.Tile||r.Tile;t=i[0];const ts={};i[89]=this.element({parent:t||"root"},e),ts.width=66,ts.height=22,ts.x=330,ts.y=167,ts.radius=60;const Ol=[];if(typeof hi<"u")for(let y in hi.config.props)delete ts[hi.config.props[y]],Ol.push(hi.config.props[y]);i[89].populate(ts),t=i[89];const ss={};ss.width=66,ss.height=22,ss.x=330,ss.y=167,ss.radius=60,n=ss.is||"Tile";let ui;if(typeof n=="string"){if(ui=s.components&&s.components[n]||r[n],!ui)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(ui=n);i[90]=ui.call(null,{props:ss},i[89],e),i[90][Symbol.for("slots")][0]?(t=i[90][Symbol.for("slots")][0],e=i[90]):t=i[90][Symbol.for("children")][0];const di=s.components&&s.components.Tile||r.Tile;t=i[0];const os={};i[91]=this.element({parent:t||"root"},e),os.width=41,os.height=51,os.x=634,os.y=888,os.radius=51;const Ul=[];if(typeof di<"u")for(let y in di.config.props)delete os[di.config.props[y]],Ul.push(di.config.props[y]);i[91].populate(os),t=i[91];const is={};is.width=41,is.height=51,is.x=634,is.y=888,is.radius=51,n=is.is||"Tile";let pi;if(typeof n=="string"){if(pi=s.components&&s.components[n]||r[n],!pi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(pi=n);i[92]=pi.call(null,{props:is},i[91],e),i[92][Symbol.for("slots")][0]?(t=i[92][Symbol.for("slots")][0],e=i[92]):t=i[92][Symbol.for("children")][0];const mi=s.components&&s.components.Tile||r.Tile;t=i[0];const rs={};i[93]=this.element({parent:t||"root"},e),rs.width=60,rs.height=56,rs.x=429,rs.y=328,rs.radius=52;const $l=[];if(typeof mi<"u")for(let y in mi.config.props)delete rs[mi.config.props[y]],$l.push(mi.config.props[y]);i[93].populate(rs),t=i[93];const ns={};ns.width=60,ns.height=56,ns.x=429,ns.y=328,ns.radius=52,n=ns.is||"Tile";let gi;if(typeof n=="string"){if(gi=s.components&&s.components[n]||r[n],!gi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(gi=n);i[94]=gi.call(null,{props:ns},i[93],e),i[94][Symbol.for("slots")][0]?(t=i[94][Symbol.for("slots")][0],e=i[94]):t=i[94][Symbol.for("children")][0];const yi=s.components&&s.components.Tile||r.Tile;t=i[0];const ls={};i[95]=this.element({parent:t||"root"},e),ls.width=33,ls.height=31,ls.x=803,ls.y=586,ls.radius=69;const Dl=[];if(typeof yi<"u")for(let y in yi.config.props)delete ls[yi.config.props[y]],Dl.push(yi.config.props[y]);i[95].populate(ls),t=i[95];const as={};as.width=33,as.height=31,as.x=803,as.y=586,as.radius=69,n=as.is||"Tile";let xi;if(typeof n=="string"){if(xi=s.components&&s.components[n]||r[n],!xi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(xi=n);i[96]=xi.call(null,{props:as},i[95],e),i[96][Symbol.for("slots")][0]?(t=i[96][Symbol.for("slots")][0],e=i[96]):t=i[96][Symbol.for("children")][0];const Ti=s.components&&s.components.Tile||r.Tile;t=i[0];const fs={};i[97]=this.element({parent:t||"root"},e),fs.width=41,fs.height=35,fs.x=510,fs.y=812,fs.radius=53;const Nl=[];if(typeof Ti<"u")for(let y in Ti.config.props)delete fs[Ti.config.props[y]],Nl.push(Ti.config.props[y]);i[97].populate(fs),t=i[97];const cs={};cs.width=41,cs.height=35,cs.x=510,cs.y=812,cs.radius=53,n=cs.is||"Tile";let bi;if(typeof n=="string"){if(bi=s.components&&s.components[n]||r[n],!bi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(bi=n);i[98]=bi.call(null,{props:cs},i[97],e),i[98][Symbol.for("slots")][0]?(t=i[98][Symbol.for("slots")][0],e=i[98]):t=i[98][Symbol.for("children")][0];const Si=s.components&&s.components.Tile||r.Tile;t=i[0];const hs={};i[99]=this.element({parent:t||"root"},e),hs.width=69,hs.height=60,hs.x=382,hs.y=688,hs.radius=57;const Gl=[];if(typeof Si<"u")for(let y in Si.config.props)delete hs[Si.config.props[y]],Gl.push(Si.config.props[y]);i[99].populate(hs),t=i[99];const us={};us.width=69,us.height=60,us.x=382,us.y=688,us.radius=57,n=us.is||"Tile";let wi;if(typeof n=="string"){if(wi=s.components&&s.components[n]||r[n],!wi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(wi=n);i[100]=wi.call(null,{props:us},i[99],e),i[100][Symbol.for("slots")][0]?(t=i[100][Symbol.for("slots")][0],e=i[100]):t=i[100][Symbol.for("children")][0];const Ci=s.components&&s.components.Tile||r.Tile;t=i[0];const ds={};i[101]=this.element({parent:t||"root"},e),ds.width=26,ds.height=28,ds.x=358,ds.y=254,ds.radius=51;const zl=[];if(typeof Ci<"u")for(let y in Ci.config.props)delete ds[Ci.config.props[y]],zl.push(Ci.config.props[y]);i[101].populate(ds),t=i[101];const ps={};ps.width=26,ps.height=28,ps.x=358,ps.y=254,ps.radius=51,n=ps.is||"Tile";let vi;if(typeof n=="string"){if(vi=s.components&&s.components[n]||r[n],!vi)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(vi=n);i[102]=vi.call(null,{props:ps},i[101],e),i[102][Symbol.for("slots")][0]?(t=i[102][Symbol.for("slots")][0],e=i[102]):t=i[102][Symbol.for("children")][0];const _i=s.components&&s.components.Tile||r.Tile;t=i[0];const ms={};i[103]=this.element({parent:t||"root"},e),ms.width=36,ms.height=27,ms.x=833,ms.y=178,ms.radius=36;const Wl=[];if(typeof _i<"u")for(let y in _i.config.props)delete ms[_i.config.props[y]],Wl.push(_i.config.props[y]);i[103].populate(ms),t=i[103];const gs={};gs.width=36,gs.height=27,gs.x=833,gs.y=178,gs.radius=36,n=gs.is||"Tile";let Ri;if(typeof n=="string"){if(Ri=s.components&&s.components[n]||r[n],!Ri)throw new Error('Component "Tile" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(Ri=n);return i[104]=Ri.call(null,{props:gs},i[103],e),i[104][Symbol.for("slots")][0]?(t=i[104][Symbol.for("slots")][0],e=i[104]):t=i[104][Symbol.for("children")][0],i},effects:[],context:{}},components:{Tile:fl},state(){return{items:[],active:!1}},hooks:{init(){setTimeout(()=>{this.active=!0},2e3)}}}),Hc=st.Application({code:{render:function(t,e,s,r,l,a){const i=[];let n;const c={};i[0]=this.element({parent:t||"root"},e),c.w=1920,c.h=1080,i[0].populate(c);const h=s.components&&s.components.RouterView||r.RouterView;t=i[0];const d={};i[1]=this.element({parent:t||"root"},e),d.w=t.node.width*(100/100),d.h=t.node.height*(100/100);const m=[];if(typeof h<"u")for(let x in h.config.props)delete d[h.config.props[x]],m.push(h.config.props[x]);i[1].populate(d),t=i[1];const p={};p.w=t.node.width*(100/100),p.h=t.node.height*(100/100),n=p.is||"RouterView";let u;if(typeof n=="string"){if(u=s.components&&s.components[n]||r[n],!u)throw new Error('Component "RouterView" not found')}else typeof n=="function"&&n[Symbol.for("isComponent")]===!0&&(u=n);return i[2]=u.call(null,{props:p},i[1],e),i[2][Symbol.for("slots")][0]?(t=i[2][Symbol.for("slots")][0],e=i[2]):t=i[2][Symbol.for("children")][0],i},effects:[],context:{}},routes:[{path:"/",component:Bc},{path:"/tile",component:Dc},{path:"/tileone",component:Vc},{path:"/static",component:Xc}]});st.Launch(Hc,"app",{w:1920,h:1080,inspector:!1,multithreaded:!0,debugLevel:1,reactivityMode:"Proxy",fonts:[{family:"lato",type:"msdf",file:"fonts/Lato-Regular.ttf"},{family:"raleway",type:"msdf",file:"fonts/Raleway-ExtraBold.ttf"},{family:"opensans",type:"web",file:"fonts/OpenSans-Medium.ttf"}]});
